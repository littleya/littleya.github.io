{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/yilia/source/main.507b3a.css","path":"main.507b3a.css","modified":1,"renderable":1},{"_id":"themes/yilia/source/slider.e37972.js","path":"slider.e37972.js","modified":1,"renderable":1},{"_id":"themes/yilia/source/main.507b3a.js","path":"main.507b3a.js","modified":1,"renderable":1},{"_id":"themes/yilia/source/mobile.fdc4b7.js","path":"mobile.fdc4b7.js","modified":1,"renderable":1},{"_id":"themes/yilia/source/fonts/default-skin.b257fa.svg","path":"fonts/default-skin.b257fa.svg","modified":1,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.16acc2.ttf","path":"fonts/iconfont.16acc2.ttf","modified":1,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.45d7ee.svg","path":"fonts/iconfont.45d7ee.svg","modified":1,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.8c627f.woff","path":"fonts/iconfont.8c627f.woff","modified":1,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.b322fa.eot","path":"fonts/iconfont.b322fa.eot","modified":1,"renderable":1},{"_id":"themes/yilia/source/fonts/tooltip.4004ff.svg","path":"fonts/tooltip.4004ff.svg","modified":1,"renderable":1},{"_id":"themes/yilia/source/img/default-skin.png","path":"img/default-skin.png","modified":1,"renderable":1},{"_id":"themes/yilia/source/img/preloader.gif","path":"img/preloader.gif","modified":1,"renderable":1},{"_id":"themes/yilia/source/img/scrollbar_arrow.png","path":"img/scrollbar_arrow.png","modified":1,"renderable":1}],"Cache":[{"_id":"themes/yilia/.babelrc","hash":"b1b76475ac17dc9e2fa50af96c9e31eea2d0f2b4","modified":1507540761093},{"_id":"themes/yilia/.editorconfig","hash":"da6d022b8f4d9c961e2f8f80677e92af8de0db4d","modified":1507540761093},{"_id":"themes/yilia/.eslintignore","hash":"df0a50b13cc00acb749226fee3cee6e0351fb1d9","modified":1507540761093},{"_id":"themes/yilia/.eslintrc.js","hash":"5696ae049de010ed3786768b0c359f14c05b5ec6","modified":1507540761093},{"_id":"themes/yilia/.gitattributes","hash":"e0f24dceeb1e6878a1dd9b01a2b9df1bc037a867","modified":1507540761093},{"_id":"themes/yilia/.gitignore","hash":"9c4b7d27a1e3e5efa0c8ed143a032a85d586b03b","modified":1507540761093},{"_id":"themes/yilia/README.md","hash":"1bf755806af9d8874bd22e1abbdaaa24328ef4dc","modified":1507540761093},{"_id":"themes/yilia/_config.yml","hash":"6fbe0d88c731c01c62dc28a49939f909c2c64a6a","modified":1507540761093},{"_id":"themes/yilia/package.json","hash":"367cb9579d35968a942c243ab248a5f5ebfaf462","modified":1507540761093},{"_id":"themes/yilia/webpack.config.js","hash":"05ba46a4ae744272f5312e684928910dccad3755","modified":1507540761097},{"_id":"source/_posts/201710091601.md","hash":"83490548a0df8449635630843a98809e831d9a3c","modified":1507540761060},{"_id":"source/_posts/201710091643.md","hash":"d4d4f0a3196cc16dbbc4b958fc8532d287cf9ebe","modified":1507540761073},{"_id":"source/_posts/201710091701.md","hash":"291d4569e79fc203f64ea43180cd849e438ea9d6","modified":1507540761083},{"_id":"source/_posts/201710091703.md","hash":"c16def2e045edb6ae019312fc535df437331725a","modified":1507540761083},{"_id":"source/_posts/201710091704.md","hash":"24d248e82c16f0d0a104674a00de1959cbced5ab","modified":1507540761083},{"_id":"source/_posts/201710091705.md","hash":"5230bcf0024eba969123fbdb186403ff569df0c7","modified":1507540761083},{"_id":"source/_posts/201710091706.md","hash":"db47c6232691ef8cf6b2108b8fe6f8d44635cc0e","modified":1507540761083},{"_id":"source/_posts/201710091708.md","hash":"5fb54b66002e38d2226722446e33797a66036f69","modified":1507540761083},{"_id":"source/_posts/201710091709.md","hash":"343dda4e886c3ef5628e73de7f912dfcda10930f","modified":1507540761083},{"_id":"source/_posts/201710091710.md","hash":"4e3a9b541876b63456685414b49a7418447d8f9a","modified":1507540761083},{"_id":"source/_posts/201710091712.md","hash":"5fea5ce75738cdc7c5cc60cf59847d6e80c6d098","modified":1507540761083},{"_id":"source/_posts/201710091714.md","hash":"ab3b136b485160aa3dc1ca1f4ac58329382de30d","modified":1507543461527},{"_id":"source/_posts/201710091715.md","hash":"f2be6bed855f3ad10b244dd058a5b52e36c3be80","modified":1507540761083},{"_id":"source/_posts/201710091723.md","hash":"fb72927c332d126621b6940a81461f5863316b1d","modified":1507546489360},{"_id":"themes/yilia/languages/default.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1507540761093},{"_id":"themes/yilia/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1507540761093},{"_id":"themes/yilia/languages/fr.yml","hash":"84ab164b37c6abf625473e9a0c18f6f815dd5fd9","modified":1507540761093},{"_id":"themes/yilia/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1507540761093},{"_id":"themes/yilia/languages/zh-CN.yml","hash":"ca40697097ab0b3672a80b455d3f4081292d1eed","modified":1507540761093},{"_id":"themes/yilia/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1507540761093},{"_id":"themes/yilia/languages/zh-tw.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1507540761093},{"_id":"themes/yilia/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1507540761093},{"_id":"themes/yilia/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1507540761093},{"_id":"themes/yilia/layout/index.ejs","hash":"a35dc900203f9d8dd863ea4c1722198d6d457ec8","modified":1507540761093},{"_id":"themes/yilia/layout/layout.ejs","hash":"0a332bdbd3b86c231d690614687f5b97186b85d5","modified":1507540761093},{"_id":"themes/yilia/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1507540761093},{"_id":"themes/yilia/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1507540761093},{"_id":"themes/yilia/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1507540761093},{"_id":"themes/yilia/source/main.507b3a.css","hash":"ddf6e2c6b953c2c59a3c271e6070010a4cc81cf9","modified":1507540761097},{"_id":"themes/yilia/source/slider.e37972.js","hash":"6dec4e220c89049037eebc44404abd8455d22ad7","modified":1507540761097},{"_id":"themes/yilia/source-src/css.ejs","hash":"94dbdb02ca11849e415d54fb28546a598f2cffb1","modified":1507540761093},{"_id":"themes/yilia/source-src/script.ejs","hash":"c21381e1317db7bb157f1d182b8c088cb7cba411","modified":1507540761097},{"_id":"themes/yilia/layout/_partial/toc.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1507540761093},{"_id":"themes/yilia/source/main.507b3a.js","hash":"59ccafbd45d28c397a8a901152ef5e196077e4f4","modified":1507540761097},{"_id":"themes/yilia/source/mobile.fdc4b7.js","hash":"6bfff9bfe4d7e067b6289e851a4c424ac815af5e","modified":1507540761097},{"_id":"source/_posts/201710091601/031b589e22e15416.jpg","hash":"a960076d215f95b3414ce08ecafea261193c6bbc","modified":1507540761063},{"_id":"source/_posts/201710091601/06132485ab59545a.jpg","hash":"d539713225e1613f848c1dd9f07042a0c142a0f1","modified":1507540761067},{"_id":"source/_posts/201710091601/06c092ba2bbcc190.jpg","hash":"073e575d1995d805632442bc726679da8f6022f2","modified":1507540761063},{"_id":"source/_posts/201710091601/0afa78fbca1dc288.jpg","hash":"4382b01aa479cd2bccfa3042c7fb596eec583c02","modified":1507540761060},{"_id":"source/_posts/201710091601/0c837e38c20eba10.jpg","hash":"38ce53fd4341ee7bdba1a649f6570459eba4877f","modified":1507540761060},{"_id":"source/_posts/201710091601/0cfc23cd25d88711.jpg","hash":"25a99d2492006bfafb92c778664e7b4c5e61d435","modified":1507540761060},{"_id":"source/_posts/201710091601/0e655e34fd585501.jpg","hash":"aeed89c8d0fb08cc620187070838b552b4fc1aed","modified":1507540761060},{"_id":"source/_posts/201710091601/0feee6754fbdf152.jpg","hash":"872dc8a5ea43e24464c6f500410110687294aa50","modified":1507540761060},{"_id":"source/_posts/201710091601/1508a77d6a8ea1c8.jpg","hash":"2704449a3940c696ceb27a651f05d2cfa699fd24","modified":1507540761067},{"_id":"source/_posts/201710091601/180a716339eaac7d.jpg","hash":"7a6c6c8e25683e225e9bee3d4736b307ccb078c5","modified":1507540761063},{"_id":"source/_posts/201710091601/1a594160a1ba91e0.jpg","hash":"9ce3fe356a9d7065af025a19b419d84ffb6c4dd0","modified":1507540761060},{"_id":"source/_posts/201710091601/1cda4b829db27966.jpg","hash":"432d30c15bf0b0d6890eba587e9142300c5f73a5","modified":1507540761060},{"_id":"source/_posts/201710091601/21eef25b932cef4f.jpg","hash":"ebf9581f32f5e8ceeaa89f81828d03484a022e4a","modified":1507540761063},{"_id":"source/_posts/201710091601/2324f721115c3785.jpg","hash":"32418051355737fe2a03df53b50b450bfdaaf253","modified":1507540761067},{"_id":"source/_posts/201710091601/2354389b190af5b4.jpg","hash":"29900846608d69163a94d835b86a10c05c367d0d","modified":1507540761067},{"_id":"source/_posts/201710091601/266f5cf2a5c7db28.jpg","hash":"5db6b4a52ec984163a7954ebc3a7dd51bce9461f","modified":1507540761067},{"_id":"source/_posts/201710091601/2a5be182dfce2f21.jpg","hash":"bd56381ced5575a4f63756c1bf4d07e634b7b532","modified":1507540761060},{"_id":"source/_posts/201710091601/2d6ca36262af1fb1.jpg","hash":"339c9816496142c2f27f32eef648ae6743f02eab","modified":1507540761060},{"_id":"source/_posts/201710091601/2d95d2595ef8cf3b.jpg","hash":"3f82a10578ed5229e985c875dc874ba7ebad6729","modified":1507540761060},{"_id":"source/_posts/201710091601/2f56d5f920ff1ade.jpg","hash":"a9a48c1c32e8ffaee945406bb7c7e07605eae54f","modified":1507540761060},{"_id":"source/_posts/201710091601/3d6c3c2b7962e631.jpg","hash":"289fef44fa607816f3ceecac2b3fab779e893942","modified":1507540761060},{"_id":"source/_posts/201710091601/42997c9404fbb3c5.jpg","hash":"194e3c9d06e34ad924903459df1f03fea74a7e0b","modified":1507540761067},{"_id":"source/_posts/201710091601/48071838f3615424.jpg","hash":"a0057cdec1b9df02bdb117d0bf8527f9968edbef","modified":1507540761067},{"_id":"source/_posts/201710091601/4c9a2f038cdaeb71.jpg","hash":"8fd14f3e165de0e421fa372f5ce60a68af2591fb","modified":1507540761060},{"_id":"source/_posts/201710091601/551b7ab676551748.jpg","hash":"b80585902e24b1c169c0b49bb424cf888b058594","modified":1507540761067},{"_id":"source/_posts/201710091601/566bae7cacf04cc7.jpg","hash":"0409ef7e5b2bdbc55d8d1183ec2122dad147d095","modified":1507540761067},{"_id":"source/_posts/201710091601/5691d99da449aeb2.jpg","hash":"fff9482807003b97180733cce50c20e214d48961","modified":1507540761067},{"_id":"source/_posts/201710091601/5a74c07b6f07c6d7.jpg","hash":"6bcef3017dd557affbf4b2f77afdfaa3993bd735","modified":1507540761060},{"_id":"source/_posts/201710091601/5b4ae1ddf38c5bac.jpg","hash":"21504c5548218278acd7f65c87ac33b6b735ee90","modified":1507540761060},{"_id":"source/_posts/201710091601/5cf991d40fd5681e.jpg","hash":"1d04c303e5d74162308b6e553146734c2cd00055","modified":1507540761063},{"_id":"source/_posts/201710091601/6062c404ce14a9d1.jpg","hash":"97a1767bdf8dcc0c523ce63f7e111330a9915348","modified":1507540761067},{"_id":"source/_posts/201710091601/61e865e896205541.jpg","hash":"7ed1c00ff40cce7f9fade9c87fcab08ab3d7ad03","modified":1507540761063},{"_id":"source/_posts/201710091601/62ab2af515b36b54.jpg","hash":"caaf310a6726a094443321ddc14748c0185d64cd","modified":1507540761063},{"_id":"source/_posts/201710091601/633b5face3642b7c.jpg","hash":"da4cd75081184add38c36fd09380b9dd23e2d4bc","modified":1507540761067},{"_id":"source/_posts/201710091601/63d531446c748da6.jpg","hash":"95670faabc64e724d9d760385ba53a5d6dbd928f","modified":1507540761063},{"_id":"source/_posts/201710091601/66e88f1227120852.jpg","hash":"1498bd82b17e2279eeae103fe237c9da8faefc61","modified":1507540761063},{"_id":"source/_posts/201710091601/6848d154f70459a4.jpg","hash":"b2629f49f8b7d8334234f02aa3f580f320df096b","modified":1507540761067},{"_id":"source/_posts/201710091601/6a9abbd5bcd8ae9b.jpg","hash":"c39b6a82fefdc354421bfb421a3b688ab8915f3e","modified":1507540761063},{"_id":"source/_posts/201710091601/6cbc855c0e0788ca.jpg","hash":"c4f32a438b69f1a5533a7d45c40371b7229f7b01","modified":1507540761063},{"_id":"source/_posts/201710091601/6e480ad0f8a2f6f8.jpg","hash":"fe844689bef01a6f5c452ccca162a651047ab0eb","modified":1507540761063},{"_id":"source/_posts/201710091601/6e979887453d65b1.jpg","hash":"4309d1a5916cf56fd1003f28694745ea69d37bad","modified":1507540761063},{"_id":"source/_posts/201710091601/744d4a1d9493956f.jpg","hash":"a85fe9ee94035a648daa27fd1c77a18999aaf1c2","modified":1507540761067},{"_id":"source/_posts/201710091601/751bb2b097bb76bf.jpg","hash":"8572522d1f49461397ad9a4b2bfc0ca536fbad19","modified":1507540761067},{"_id":"source/_posts/201710091601/785e0001fc28c841.jpg","hash":"ffff32cf356922b194441a888d9abb7be68b080f","modified":1507540761067},{"_id":"source/_posts/201710091601/7896501557e9646b.jpg","hash":"4cacc74b81e04260fac1fd255c5c3b6940c3448c","modified":1507540761067},{"_id":"source/_posts/201710091601/7977fce67fad7ab2.jpg","hash":"e02bffc0d92fc18fde8119e93c395263faf32ae6","modified":1507540761067},{"_id":"source/_posts/201710091601/7d3f472d90225cb6.jpg","hash":"f2dca5f7e423a3d6a31a91e9d021ec553b6f847f","modified":1507540761063},{"_id":"source/_posts/201710091601/873b13631b0a2d43.jpg","hash":"b119aee541d0b1b60a9755f136178baa1180ad78","modified":1507540761067},{"_id":"source/_posts/201710091601/89d7a010bcc96bca.jpg","hash":"85f606af3db48cf9c484862fa45abd75492487a9","modified":1507540761063},{"_id":"source/_posts/201710091601/8e5ebabc9106f714.jpg","hash":"8b56f395b4c9bedfa36258fcc1fe13203a4f5915","modified":1507540761063},{"_id":"source/_posts/201710091601/8f4b4c50b604bbdf.jpg","hash":"a45d56bd3255a6ae87a80445f4a7c049dc183b29","modified":1507540761063},{"_id":"source/_posts/201710091601/8f82cb2725fa616e.jpg","hash":"e824c65783589ccd1a257e98f1ba6ce44c6189d1","modified":1507540761063},{"_id":"source/_posts/201710091601/939dfa4b1fcc1ce4.jpg","hash":"b2c799d22bfccc3ed88f591b2d50142197f3e81f","modified":1507540761067},{"_id":"source/_posts/201710091601/941e2ac251f1c098.jpg","hash":"af1d838fad72057c51c070dbbfff750125b16727","modified":1507540761067},{"_id":"source/_posts/201710091601/95811662f155207b.jpg","hash":"1ff1b72bdb58ea89d2639445a288974d9c4d7b98","modified":1507540761067},{"_id":"source/_posts/201710091601/95b0d3bf93fe30ff.jpg","hash":"2bf35e04003961d552d87ca95942c850da7e2f40","modified":1507540761063},{"_id":"source/_posts/201710091601/96ac1f339e1a918c.jpg","hash":"a56ced3d2754be1293258af7f40560ee0ea5d90e","modified":1507540761063},{"_id":"source/_posts/201710091601/973098e8bf92ca7d.jpg","hash":"0f77461bdef71697f75bed895f39e45718c853fd","modified":1507540761067},{"_id":"source/_posts/201710091601/99c342e6c648a626.jpg","hash":"a1c5c8a9a68ce827b8c240becfec07b39d31c936","modified":1507540761063},{"_id":"source/_posts/201710091601/9b3ba694564ec5f0.jpg","hash":"a6333525f0be13c6edb586f8909026d20d0634ca","modified":1507540761063},{"_id":"source/_posts/201710091601/9e2505199e03c37c.jpg","hash":"755ce2d8416ad171e50b8fa3b452f759fcf6d958","modified":1507540761063},{"_id":"source/_posts/201710091601/a182ce0049370fe2.jpg","hash":"d0797250d0ce8d3afcffdb7c0ec9da75af554336","modified":1507540761067},{"_id":"source/_posts/201710091601/a5e44268d9368b5e.jpg","hash":"67d0e73b5fbef0185d0572a8416b4540c9ac969a","modified":1507540761067},{"_id":"source/_posts/201710091601/a73157c0e03e0bef.jpg","hash":"e571bb814496352d9a45749c3a6e24e941e73e8a","modified":1507540761067},{"_id":"source/_posts/201710091601/abfe4002d809a330.jpg","hash":"5f06e5dab3ef939ed953cae07e93ea078926db65","modified":1507540761070},{"_id":"source/_posts/201710091601/ad32819d93b8330c.jpg","hash":"d7e8e173945497225be21006a97bbd5dcf56d029","modified":1507540761070},{"_id":"source/_posts/201710091601/ae6370a150336ea8.jpg","hash":"0d98583862a2aafbec539308bb71191eb59f6ede","modified":1507540761070},{"_id":"source/_posts/201710091601/aff21e7004340e15.jpg","hash":"6d0f0953119810c732f10fa144fb3e8cd439a308","modified":1507540761070},{"_id":"source/_posts/201710091601/b121ca70c26deb9b.jpg","hash":"ab16934bda96ed75db9fff6d57e452bd6865199a","modified":1507540761070},{"_id":"source/_posts/201710091601/b169f5c72441e23a.jpg","hash":"b173db6932e770ad9e4099107e36ce4087bae326","modified":1507540761070},{"_id":"source/_posts/201710091601/b1e83ae7831df206.jpg","hash":"d5f055ebc7d65c65b28cd4992001a94e65dca08d","modified":1507540761070},{"_id":"source/_posts/201710091601/b39860a01ad48dc3.jpg","hash":"d3f7579b1d9874c738e19e2d60c68458a64aaa3d","modified":1507540761070},{"_id":"source/_posts/201710091601/b4b3d6a322cdc35d.jpg","hash":"f14cf1fe3e4e881c7f84a91235a4754a10e0cc14","modified":1507540761070},{"_id":"source/_posts/201710091601/b9575e72d62e7474.jpg","hash":"06268d3d3baceb96560a8749815b8c8aa8070a5d","modified":1507540761070},{"_id":"source/_posts/201710091601/ba5c85b09c522978.jpg","hash":"ae978d482f2c839df2c9f842cd304125700f83b8","modified":1507540761070},{"_id":"source/_posts/201710091601/bd5f4888a2ae5a64.jpg","hash":"f5e902eaaf80d747cbb4443ca3ec2815f71cfa0c","modified":1507540761070},{"_id":"source/_posts/201710091601/c1e7b073aa72b3c1.jpg","hash":"c73aa23b52451fd7d4cee9b60115ddf5a40344cf","modified":1507540761070},{"_id":"source/_posts/201710091601/c3138d78572d2472.jpg","hash":"50df7ad61e7750297f9b6fbb1d386630d14d1a78","modified":1507540761070},{"_id":"source/_posts/201710091601/c34e5c68c50e2534.jpg","hash":"ce3bc18f464a3719d42e0ec759ccdd4e43612f99","modified":1507540761070},{"_id":"source/_posts/201710091601/c48ab6841594e0ac.jpg","hash":"0eb7082ff240676e7f6ab929a2bd6d914a74c0e1","modified":1507540761070},{"_id":"source/_posts/201710091601/c4c9fe68e495067a.jpg","hash":"d578679f9f0cf966714836db05406657ef78eecf","modified":1507540761070},{"_id":"source/_posts/201710091601/cbedaa2848096de4.jpg","hash":"4d57db07d0b3d79a74a43d4da98b471d61ff4f5b","modified":1507540761070},{"_id":"source/_posts/201710091601/cdbf09ff9e323ccf.jpg","hash":"9b7b4b719d1c14f3d6cb4db71c08f268a5e6b175","modified":1507540761070},{"_id":"source/_posts/201710091601/d0e16aa7a3eecca7.jpg","hash":"d2942fb53220a548307f2cf3476cfd84de2d3853","modified":1507540761070},{"_id":"source/_posts/201710091601/d547095ccdfa9a70.jpg","hash":"32bcb4821ad50eb2634d308378f11070a4b57cce","modified":1507540761070},{"_id":"source/_posts/201710091601/d6e56c27934793e5.jpg","hash":"2b52b8f2fa93a64cb172eead420884f0ba60b3bf","modified":1507540761070},{"_id":"source/_posts/201710091601/d805875fea4f71d5.jpg","hash":"a15a8021864e5057914041700d437aaab1462ded","modified":1507540761070},{"_id":"source/_posts/201710091601/d9fd15b03ad56209.jpg","hash":"6f85fe0c474e3080a9ef0bbc458c09361dce64aa","modified":1507540761070},{"_id":"source/_posts/201710091601/d84386cd9bcedc8f.jpg","hash":"27f834498a0f484989c954ebd96941e6c559f9dc","modified":1507540761070},{"_id":"source/_posts/201710091601/e0b95334d12d044f.jpg","hash":"756cfe15c2c796a2156347ce8b6aafae01d03050","modified":1507540761070},{"_id":"source/_posts/201710091601/e0bb2f4c6b455757.jpg","hash":"b527a7706f26ce803db0e284179fee84b8457b5a","modified":1507540761070},{"_id":"source/_posts/201710091601/e53df4dd51341905.jpg","hash":"86da1f35da29b42db95549414dc8f6fe262b6e18","modified":1507540761073},{"_id":"source/_posts/201710091601/e5aa907519fce1c0.jpg","hash":"5b8fd015ef1e7a1a8bad96cb000ca6786a8fe1da","modified":1507540761070},{"_id":"source/_posts/201710091601/e620aae6ab7c8e13.jpg","hash":"4b34ab12f32a2b3c00bc863c744d8dd367a2ac6c","modified":1507540761073},{"_id":"source/_posts/201710091601/e649a7b010a24b60.jpg","hash":"5fec9f5f099cc927a275116e29e33af0fbaed70b","modified":1507540761073},{"_id":"source/_posts/201710091601/e6eaabb5e0327380.jpg","hash":"aae8af8282152037112fe8455574c24095dddc3f","modified":1507540761070},{"_id":"source/_posts/201710091601/e83ee1ff8a839a1c.jpg","hash":"f58c0d8698602cbdac97a93587b093d92d38f790","modified":1507540761073},{"_id":"source/_posts/201710091601/eb9fae41092bd441.jpg","hash":"c612e91b1e00b061a6f406b00fd4edb90e6b51d1","modified":1507540761073},{"_id":"source/_posts/201710091601/f10b4296db3e0a05.jpg","hash":"ba7ee6ef91f12dd4b8bb86715200c3e1e0310c54","modified":1507540761073},{"_id":"source/_posts/201710091601/f410bb787d1fb33f.jpg","hash":"0289aa17eda8bf280e456c68fa0e0cae96c31383","modified":1507540761073},{"_id":"source/_posts/201710091601/f48bf0716013ac11.jpg","hash":"4fe45f6b3c8021883eb28316e0fc6542eacb4640","modified":1507540761073},{"_id":"source/_posts/201710091601/f9120d53fb7c396b.jpg","hash":"02f7cbe27e9a1c5e30349261edd61eab0a957857","modified":1507540761073},{"_id":"source/_posts/201710091601/f92ff5e1e860a45c.jpg","hash":"86a2bc112cd300a0921726a1b124f0ba9b85a7a8","modified":1507540761073},{"_id":"source/_posts/201710091601/fb218f399632a938.jpg","hash":"95fd1d790d94f9f8d0b2f4821c5c0f3be768c186","modified":1507540761073},{"_id":"source/_posts/201710091601/fb85018c73538669.jpg","hash":"04d12b71b7854f521d5f7be256fbb77ef3f7b549","modified":1507540761073},{"_id":"source/_posts/201710091643/031b589e22e15416.jpg","hash":"a960076d215f95b3414ce08ecafea261193c6bbc","modified":1507540761077},{"_id":"source/_posts/201710091643/06132485ab59545a.jpg","hash":"d539713225e1613f848c1dd9f07042a0c142a0f1","modified":1507540761080},{"_id":"source/_posts/201710091643/06c092ba2bbcc190.jpg","hash":"073e575d1995d805632442bc726679da8f6022f2","modified":1507540761073},{"_id":"source/_posts/201710091643/0afa78fbca1dc288.jpg","hash":"4382b01aa479cd2bccfa3042c7fb596eec583c02","modified":1507540761073},{"_id":"source/_posts/201710091643/0c837e38c20eba10.jpg","hash":"38ce53fd4341ee7bdba1a649f6570459eba4877f","modified":1507540761073},{"_id":"source/_posts/201710091643/0cfc23cd25d88711.jpg","hash":"25a99d2492006bfafb92c778664e7b4c5e61d435","modified":1507540761073},{"_id":"source/_posts/201710091643/0e655e34fd585501.jpg","hash":"aeed89c8d0fb08cc620187070838b552b4fc1aed","modified":1507540761073},{"_id":"source/_posts/201710091643/0feee6754fbdf152.jpg","hash":"872dc8a5ea43e24464c6f500410110687294aa50","modified":1507540761073},{"_id":"source/_posts/201710091643/1508a77d6a8ea1c8.jpg","hash":"2704449a3940c696ceb27a651f05d2cfa699fd24","modified":1507540761080},{"_id":"source/_posts/201710091643/180a716339eaac7d.jpg","hash":"7a6c6c8e25683e225e9bee3d4736b307ccb078c5","modified":1507540761077},{"_id":"source/_posts/201710091601/4812df9dc90e7725.jpg","hash":"defc040ebec8dd818d92c8baf009252fc2c8e09c","modified":1507540761067},{"_id":"source/_posts/201710091643/1a594160a1ba91e0.jpg","hash":"9ce3fe356a9d7065af025a19b419d84ffb6c4dd0","modified":1507540761073},{"_id":"source/_posts/201710091643/2324f721115c3785.jpg","hash":"32418051355737fe2a03df53b50b450bfdaaf253","modified":1507540761080},{"_id":"source/_posts/201710091643/1cda4b829db27966.jpg","hash":"432d30c15bf0b0d6890eba587e9142300c5f73a5","modified":1507540761073},{"_id":"source/_posts/201710091643/2354389b190af5b4.jpg","hash":"29900846608d69163a94d835b86a10c05c367d0d","modified":1507540761080},{"_id":"source/_posts/201710091643/266f5cf2a5c7db28.jpg","hash":"5db6b4a52ec984163a7954ebc3a7dd51bce9461f","modified":1507540761077},{"_id":"source/_posts/201710091643/2a5be182dfce2f21.jpg","hash":"bd56381ced5575a4f63756c1bf4d07e634b7b532","modified":1507540761073},{"_id":"source/_posts/201710091643/2d6ca36262af1fb1.jpg","hash":"339c9816496142c2f27f32eef648ae6743f02eab","modified":1507540761073},{"_id":"source/_posts/201710091643/2f56d5f920ff1ade.jpg","hash":"a9a48c1c32e8ffaee945406bb7c7e07605eae54f","modified":1507540761073},{"_id":"source/_posts/201710091643/2d95d2595ef8cf3b.jpg","hash":"3f82a10578ed5229e985c875dc874ba7ebad6729","modified":1507540761073},{"_id":"source/_posts/201710091643/3d6c3c2b7962e631.jpg","hash":"289fef44fa607816f3ceecac2b3fab779e893942","modified":1507540761073},{"_id":"source/_posts/201710091643/42997c9404fbb3c5.jpg","hash":"194e3c9d06e34ad924903459df1f03fea74a7e0b","modified":1507540761080},{"_id":"source/_posts/201710091643/48071838f3615424.jpg","hash":"a0057cdec1b9df02bdb117d0bf8527f9968edbef","modified":1507540761080},{"_id":"source/_posts/201710091643/4812df9dc90e7725.jpg","hash":"defc040ebec8dd818d92c8baf009252fc2c8e09c","modified":1507540761080},{"_id":"source/_posts/201710091643/4c9a2f038cdaeb71.jpg","hash":"8fd14f3e165de0e421fa372f5ce60a68af2591fb","modified":1507540761073},{"_id":"source/_posts/201710091643/551b7ab676551748.jpg","hash":"b80585902e24b1c169c0b49bb424cf888b058594","modified":1507540761077},{"_id":"source/_posts/201710091643/566bae7cacf04cc7.jpg","hash":"0409ef7e5b2bdbc55d8d1183ec2122dad147d095","modified":1507540761077},{"_id":"source/_posts/201710091643/5691d99da449aeb2.jpg","hash":"fff9482807003b97180733cce50c20e214d48961","modified":1507540761080},{"_id":"source/_posts/201710091643/5a74c07b6f07c6d7.jpg","hash":"6bcef3017dd557affbf4b2f77afdfaa3993bd735","modified":1507540761073},{"_id":"source/_posts/201710091643/5b4ae1ddf38c5bac.jpg","hash":"21504c5548218278acd7f65c87ac33b6b735ee90","modified":1507540761073},{"_id":"source/_posts/201710091643/5cf991d40fd5681e.jpg","hash":"1d04c303e5d74162308b6e553146734c2cd00055","modified":1507540761073},{"_id":"source/_posts/201710091643/6062c404ce14a9d1.jpg","hash":"97a1767bdf8dcc0c523ce63f7e111330a9915348","modified":1507540761080},{"_id":"source/_posts/201710091643/61e865e896205541.jpg","hash":"7ed1c00ff40cce7f9fade9c87fcab08ab3d7ad03","modified":1507540761077},{"_id":"source/_posts/201710091643/62ab2af515b36b54.jpg","hash":"caaf310a6726a094443321ddc14748c0185d64cd","modified":1507540761077},{"_id":"source/_posts/201710091643/633b5face3642b7c.jpg","hash":"da4cd75081184add38c36fd09380b9dd23e2d4bc","modified":1507540761077},{"_id":"source/_posts/201710091643/63d531446c748da6.jpg","hash":"95670faabc64e724d9d760385ba53a5d6dbd928f","modified":1507540761077},{"_id":"source/_posts/201710091643/66e88f1227120852.jpg","hash":"1498bd82b17e2279eeae103fe237c9da8faefc61","modified":1507540761077},{"_id":"source/_posts/201710091643/6848d154f70459a4.jpg","hash":"b2629f49f8b7d8334234f02aa3f580f320df096b","modified":1507540761080},{"_id":"source/_posts/201710091643/6a9abbd5bcd8ae9b.jpg","hash":"c39b6a82fefdc354421bfb421a3b688ab8915f3e","modified":1507540761073},{"_id":"source/_posts/201710091643/6cbc855c0e0788ca.jpg","hash":"c4f32a438b69f1a5533a7d45c40371b7229f7b01","modified":1507540761073},{"_id":"source/_posts/201710091643/6e480ad0f8a2f6f8.jpg","hash":"fe844689bef01a6f5c452ccca162a651047ab0eb","modified":1507540761073},{"_id":"source/_posts/201710091643/6e979887453d65b1.jpg","hash":"4309d1a5916cf56fd1003f28694745ea69d37bad","modified":1507540761073},{"_id":"source/_posts/201710091643/744d4a1d9493956f.jpg","hash":"a85fe9ee94035a648daa27fd1c77a18999aaf1c2","modified":1507540761077},{"_id":"source/_posts/201710091643/751bb2b097bb76bf.jpg","hash":"8572522d1f49461397ad9a4b2bfc0ca536fbad19","modified":1507540761077},{"_id":"source/_posts/201710091643/785e0001fc28c841.jpg","hash":"ffff32cf356922b194441a888d9abb7be68b080f","modified":1507540761077},{"_id":"source/_posts/201710091643/7896501557e9646b.jpg","hash":"4cacc74b81e04260fac1fd255c5c3b6940c3448c","modified":1507540761080},{"_id":"source/_posts/201710091643/7977fce67fad7ab2.jpg","hash":"e02bffc0d92fc18fde8119e93c395263faf32ae6","modified":1507540761080},{"_id":"source/_posts/201710091643/7d3f472d90225cb6.jpg","hash":"f2dca5f7e423a3d6a31a91e9d021ec553b6f847f","modified":1507540761077},{"_id":"source/_posts/201710091643/873b13631b0a2d43.jpg","hash":"b119aee541d0b1b60a9755f136178baa1180ad78","modified":1507540761077},{"_id":"source/_posts/201710091643/89d7a010bcc96bca.jpg","hash":"85f606af3db48cf9c484862fa45abd75492487a9","modified":1507540761077},{"_id":"source/_posts/201710091643/8e5ebabc9106f714.jpg","hash":"8b56f395b4c9bedfa36258fcc1fe13203a4f5915","modified":1507540761077},{"_id":"source/_posts/201710091643/8f4b4c50b604bbdf.jpg","hash":"a45d56bd3255a6ae87a80445f4a7c049dc183b29","modified":1507540761077},{"_id":"source/_posts/201710091643/8f82cb2725fa616e.jpg","hash":"e824c65783589ccd1a257e98f1ba6ce44c6189d1","modified":1507540761077},{"_id":"source/_posts/201710091643/939dfa4b1fcc1ce4.jpg","hash":"b2c799d22bfccc3ed88f591b2d50142197f3e81f","modified":1507540761077},{"_id":"source/_posts/201710091643/941e2ac251f1c098.jpg","hash":"af1d838fad72057c51c070dbbfff750125b16727","modified":1507540761080},{"_id":"source/_posts/201710091643/95811662f155207b.jpg","hash":"1ff1b72bdb58ea89d2639445a288974d9c4d7b98","modified":1507540761080},{"_id":"source/_posts/201710091643/95b0d3bf93fe30ff.jpg","hash":"2bf35e04003961d552d87ca95942c850da7e2f40","modified":1507540761077},{"_id":"source/_posts/201710091643/96ac1f339e1a918c.jpg","hash":"a56ced3d2754be1293258af7f40560ee0ea5d90e","modified":1507540761077},{"_id":"source/_posts/201710091643/973098e8bf92ca7d.jpg","hash":"0f77461bdef71697f75bed895f39e45718c853fd","modified":1507540761080},{"_id":"source/_posts/201710091643/99c342e6c648a626.jpg","hash":"a1c5c8a9a68ce827b8c240becfec07b39d31c936","modified":1507540761077},{"_id":"source/_posts/201710091643/9b3ba694564ec5f0.jpg","hash":"a6333525f0be13c6edb586f8909026d20d0634ca","modified":1507540761077},{"_id":"source/_posts/201710091643/9e2505199e03c37c.jpg","hash":"755ce2d8416ad171e50b8fa3b452f759fcf6d958","modified":1507540761077},{"_id":"source/_posts/201710091643/a182ce0049370fe2.jpg","hash":"d0797250d0ce8d3afcffdb7c0ec9da75af554336","modified":1507540761080},{"_id":"source/_posts/201710091643/a5e44268d9368b5e.jpg","hash":"67d0e73b5fbef0185d0572a8416b4540c9ac969a","modified":1507540761080},{"_id":"source/_posts/201710091643/a73157c0e03e0bef.jpg","hash":"e571bb814496352d9a45749c3a6e24e941e73e8a","modified":1507540761080},{"_id":"source/_posts/201710091643/abfe4002d809a330.jpg","hash":"5f06e5dab3ef939ed953cae07e93ea078926db65","modified":1507540761080},{"_id":"source/_posts/201710091643/ad32819d93b8330c.jpg","hash":"d7e8e173945497225be21006a97bbd5dcf56d029","modified":1507540761080},{"_id":"source/_posts/201710091643/ae6370a150336ea8.jpg","hash":"0d98583862a2aafbec539308bb71191eb59f6ede","modified":1507540761080},{"_id":"source/_posts/201710091643/aff21e7004340e15.jpg","hash":"6d0f0953119810c732f10fa144fb3e8cd439a308","modified":1507540761080},{"_id":"source/_posts/201710091643/b121ca70c26deb9b.jpg","hash":"ab16934bda96ed75db9fff6d57e452bd6865199a","modified":1507540761080},{"_id":"source/_posts/201710091643/b169f5c72441e23a.jpg","hash":"b173db6932e770ad9e4099107e36ce4087bae326","modified":1507540761080},{"_id":"source/_posts/201710091643/b1e83ae7831df206.jpg","hash":"d5f055ebc7d65c65b28cd4992001a94e65dca08d","modified":1507540761080},{"_id":"source/_posts/201710091643/b39860a01ad48dc3.jpg","hash":"d3f7579b1d9874c738e19e2d60c68458a64aaa3d","modified":1507540761080},{"_id":"source/_posts/201710091643/b4b3d6a322cdc35d.jpg","hash":"f14cf1fe3e4e881c7f84a91235a4754a10e0cc14","modified":1507540761080},{"_id":"source/_posts/201710091643/b9575e72d62e7474.jpg","hash":"06268d3d3baceb96560a8749815b8c8aa8070a5d","modified":1507540761080},{"_id":"source/_posts/201710091643/ba5c85b09c522978.jpg","hash":"ae978d482f2c839df2c9f842cd304125700f83b8","modified":1507540761080},{"_id":"source/_posts/201710091643/bd5f4888a2ae5a64.jpg","hash":"f5e902eaaf80d747cbb4443ca3ec2815f71cfa0c","modified":1507540761080},{"_id":"source/_posts/201710091643/c1e7b073aa72b3c1.jpg","hash":"c73aa23b52451fd7d4cee9b60115ddf5a40344cf","modified":1507540761080},{"_id":"source/_posts/201710091643/c3138d78572d2472.jpg","hash":"50df7ad61e7750297f9b6fbb1d386630d14d1a78","modified":1507540761080},{"_id":"source/_posts/201710091643/c34e5c68c50e2534.jpg","hash":"ce3bc18f464a3719d42e0ec759ccdd4e43612f99","modified":1507540761080},{"_id":"source/_posts/201710091643/c48ab6841594e0ac.jpg","hash":"0eb7082ff240676e7f6ab929a2bd6d914a74c0e1","modified":1507540761080},{"_id":"source/_posts/201710091643/c4c9fe68e495067a.jpg","hash":"d578679f9f0cf966714836db05406657ef78eecf","modified":1507540761080},{"_id":"source/_posts/201710091643/cbedaa2848096de4.jpg","hash":"4d57db07d0b3d79a74a43d4da98b471d61ff4f5b","modified":1507540761080},{"_id":"source/_posts/201710091643/cdbf09ff9e323ccf.jpg","hash":"9b7b4b719d1c14f3d6cb4db71c08f268a5e6b175","modified":1507540761080},{"_id":"source/_posts/201710091643/d0e16aa7a3eecca7.jpg","hash":"d2942fb53220a548307f2cf3476cfd84de2d3853","modified":1507540761080},{"_id":"source/_posts/201710091643/d547095ccdfa9a70.jpg","hash":"32bcb4821ad50eb2634d308378f11070a4b57cce","modified":1507540761080},{"_id":"source/_posts/201710091643/d6e56c27934793e5.jpg","hash":"2b52b8f2fa93a64cb172eead420884f0ba60b3bf","modified":1507540761080},{"_id":"source/_posts/201710091643/d805875fea4f71d5.jpg","hash":"a15a8021864e5057914041700d437aaab1462ded","modified":1507540761080},{"_id":"source/_posts/201710091643/d84386cd9bcedc8f.jpg","hash":"27f834498a0f484989c954ebd96941e6c559f9dc","modified":1507540761080},{"_id":"source/_posts/201710091643/d9fd15b03ad56209.jpg","hash":"6f85fe0c474e3080a9ef0bbc458c09361dce64aa","modified":1507540761080},{"_id":"source/_posts/201710091643/e0b95334d12d044f.jpg","hash":"756cfe15c2c796a2156347ce8b6aafae01d03050","modified":1507540761080},{"_id":"source/_posts/201710091643/e0bb2f4c6b455757.jpg","hash":"b527a7706f26ce803db0e284179fee84b8457b5a","modified":1507540761080},{"_id":"source/_posts/201710091643/e53df4dd51341905.jpg","hash":"86da1f35da29b42db95549414dc8f6fe262b6e18","modified":1507540761083},{"_id":"source/_posts/201710091643/e5aa907519fce1c0.jpg","hash":"5b8fd015ef1e7a1a8bad96cb000ca6786a8fe1da","modified":1507540761083},{"_id":"source/_posts/201710091643/e620aae6ab7c8e13.jpg","hash":"4b34ab12f32a2b3c00bc863c744d8dd367a2ac6c","modified":1507540761083},{"_id":"source/_posts/201710091643/e649a7b010a24b60.jpg","hash":"5fec9f5f099cc927a275116e29e33af0fbaed70b","modified":1507540761083},{"_id":"source/_posts/201710091643/e6eaabb5e0327380.jpg","hash":"aae8af8282152037112fe8455574c24095dddc3f","modified":1507540761083},{"_id":"source/_posts/201710091643/e83ee1ff8a839a1c.jpg","hash":"f58c0d8698602cbdac97a93587b093d92d38f790","modified":1507540761083},{"_id":"source/_posts/201710091643/eb9fae41092bd441.jpg","hash":"c612e91b1e00b061a6f406b00fd4edb90e6b51d1","modified":1507540761083},{"_id":"source/_posts/201710091643/f10b4296db3e0a05.jpg","hash":"ba7ee6ef91f12dd4b8bb86715200c3e1e0310c54","modified":1507540761083},{"_id":"source/_posts/201710091643/f410bb787d1fb33f.jpg","hash":"0289aa17eda8bf280e456c68fa0e0cae96c31383","modified":1507540761083},{"_id":"source/_posts/201710091643/f48bf0716013ac11.jpg","hash":"4fe45f6b3c8021883eb28316e0fc6542eacb4640","modified":1507540761083},{"_id":"source/_posts/201710091643/f9120d53fb7c396b.jpg","hash":"02f7cbe27e9a1c5e30349261edd61eab0a957857","modified":1507540761083},{"_id":"source/_posts/201710091643/f92ff5e1e860a45c.jpg","hash":"86a2bc112cd300a0921726a1b124f0ba9b85a7a8","modified":1507540761083},{"_id":"source/_posts/201710091643/fb218f399632a938.jpg","hash":"95fd1d790d94f9f8d0b2f4821c5c0f3be768c186","modified":1507540761083},{"_id":"source/_posts/201710091643/fb85018c73538669.jpg","hash":"04d12b71b7854f521d5f7be256fbb77ef3f7b549","modified":1507540761083},{"_id":"themes/yilia/layout/_partial/archive-post.ejs","hash":"1f7d4819b7f67602c4a1b99871808d2160b60978","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/archive.ejs","hash":"a6e94061ac55b9eb55275f87b608d62f6ea35659","modified":1507540761093},{"_id":"source/_posts/201710091643/21eef25b932cef4f.jpg","hash":"ebf9581f32f5e8ceeaa89f81828d03484a022e4a","modified":1507540761077},{"_id":"themes/yilia/layout/_partial/after-footer.ejs","hash":"b86b248720ad415ec1b5fee53fb583776c776f83","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/article.ejs","hash":"630c6ec866d056657d3d91e34b4c64eb993c0654","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/aside.ejs","hash":"8edbd7993b9b061611a193533a664e2e85eae748","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/baidu-analytics.ejs","hash":"f0e6e88f9f7eb08b8fe51449a8a3016273507924","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/css.ejs","hash":"b011d92be321ebe09fa2b3179c08aa435b9d051c","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/footer.ejs","hash":"f2994e0acd1d606ebf4680afc4fa652e148ccf4e","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/head.ejs","hash":"64f092186b5a744aa1603ce22bb1d44a34446add","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/header.ejs","hash":"6387a93dad7c3d778eb91e3821852fbf6813880c","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/left-col.ejs","hash":"183d7ca4ba8e7c80694ffdc8cf39957092238346","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/mathjax.ejs","hash":"151a1ef2173ba7b6789d349f0f8da89616cc1394","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/mobile-nav.ejs","hash":"7fbbfabf5e29525b24ada14613c21a26789132b4","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/tools.ejs","hash":"c41341b9618e591538e1136a2d1637587c1bbd90","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/viewer.ejs","hash":"e495790b2abe2290875817e42bd505bc611d3e26","modified":1507540761093},{"_id":"themes/yilia/source/fonts/default-skin.b257fa.svg","hash":"2ac727c9e092331d35cce95af209ccfac6d4c7c7","modified":1507540761097},{"_id":"themes/yilia/source/fonts/iconfont.16acc2.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1507540761097},{"_id":"themes/yilia/source/fonts/iconfont.45d7ee.svg","hash":"f9304e5714d20861be7d8f4d36687e88e86b9e1b","modified":1507540761097},{"_id":"themes/yilia/source/fonts/iconfont.8c627f.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1507540761097},{"_id":"themes/yilia/source/fonts/iconfont.b322fa.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1507540761097},{"_id":"themes/yilia/source/fonts/tooltip.4004ff.svg","hash":"397fe4b1093bf9b62457dac48aa15dac06b54a3c","modified":1507540761097},{"_id":"themes/yilia/source/img/default-skin.png","hash":"ed95a8e40a2c3478c5915376acb8e5f33677f24d","modified":1507540761097},{"_id":"themes/yilia/source/img/preloader.gif","hash":"6342367c93c82da1b9c620e97c84a389cc43d96d","modified":1507540761097},{"_id":"themes/yilia/source/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1507540761097},{"_id":"themes/yilia/source-src/css/_core.scss","hash":"24f347a2412abbf58318369152504da9538f8d3b","modified":1507540761093},{"_id":"themes/yilia/source-src/css/_function.scss","hash":"93a50dd19a93485712da1f8d0a1672482dd1eabc","modified":1507540761093},{"_id":"themes/yilia/source-src/css/archive.scss","hash":"7d27e22ac898e8fafec14549e940c73cbea1fba8","modified":1507540761093},{"_id":"themes/yilia/source-src/css/article-inner.scss","hash":"d79f2d35a06de83a2a226ca790b7a0a34789c115","modified":1507540761093},{"_id":"themes/yilia/source-src/css/article-main.scss","hash":"3fad68bd74260326f83090b0974dd80707e7bac7","modified":1507540761093},{"_id":"themes/yilia/source-src/css/article-nav.scss","hash":"43e507f2a48504079afd9471353337e23ca47470","modified":1507540761093},{"_id":"themes/yilia/source-src/css/article.scss","hash":"0f6d61af99ed4db87f8589db1feaea7747b55963","modified":1507540761097},{"_id":"themes/yilia/source-src/css/aside.scss","hash":"578a67464dd0f542197f7fcee158c991db058563","modified":1507540761097},{"_id":"themes/yilia/source-src/css/comment.scss","hash":"cafe3834017a3bf47420f37543725025225a2c89","modified":1507540761097},{"_id":"themes/yilia/source-src/css/fonts.scss","hash":"97b8fba41c914145710b90091f400b845879577f","modified":1507540761097},{"_id":"themes/yilia/source-src/css/footer.scss","hash":"7c995410b25baaf61dfc5e148e22ca60330abcd3","modified":1507540761097},{"_id":"themes/yilia/source-src/css/global.scss","hash":"b4cb4f45a55d4250cd9056f76dab2a3c0dabcec4","modified":1507540761097},{"_id":"themes/yilia/source-src/css/grid.scss","hash":"849a29fcd7150214fcf7b9715fa5dc71d1f9b896","modified":1507540761097},{"_id":"themes/yilia/source-src/css/highlight.scss","hash":"3719994c2c9393813cc1d42b657205c368a329cb","modified":1507540761097},{"_id":"themes/yilia/source-src/css/left.scss","hash":"0d30c0e7cdb831c3881a017006c782f2214ac195","modified":1507540761097},{"_id":"themes/yilia/source-src/css/main.scss","hash":"2f86a014af93583caba78a563d9549826bf28294","modified":1507540761097},{"_id":"themes/yilia/source-src/css/mobile-slider.scss","hash":"f053c609d84df0dd9eee1d11ddf0c19163a456be","modified":1507540761097},{"_id":"themes/yilia/source-src/css/mobile.scss","hash":"ace041d72f95b419f6a5e443191703c2b62007f4","modified":1507540761097},{"_id":"themes/yilia/source-src/css/page.scss","hash":"bf206bb7f7d0967bc8b7fdf01b7ffc99aff9ba88","modified":1507540761097},{"_id":"themes/yilia/source-src/css/reward.scss","hash":"80a4fcf9171d4a33235da96ac8a2b7dcabc45dfb","modified":1507540761097},{"_id":"themes/yilia/source-src/css/scroll.scss","hash":"9c8dfd1c76854ef063494ca76fac6360b391ed6d","modified":1507540761097},{"_id":"themes/yilia/source-src/css/share.scss","hash":"150c6425f6582e7ec78a873256ce49c9930e8805","modified":1507540761097},{"_id":"themes/yilia/source-src/css/social.scss","hash":"724162ccf3977e70a45d189abfaa20b6e2fba87b","modified":1507540761097},{"_id":"themes/yilia/source-src/css/tags-cloud.scss","hash":"c8aa84fca93862d3caae77c552873b8610f33327","modified":1507540761097},{"_id":"themes/yilia/source-src/css/tags.scss","hash":"ac67a3c7097849206244db9b0ba91daaba017ef5","modified":1507540761097},{"_id":"themes/yilia/source-src/css/tools.scss","hash":"1b1aa0908e58cf942b28e3881d07c5573c4129e1","modified":1507540761097},{"_id":"themes/yilia/source-src/css/tooltip.scss","hash":"53d5a554bc2f38e9bb3d26400a47767013c05216","modified":1507540761097},{"_id":"themes/yilia/source-src/js/Q.js","hash":"d011af172064b6c6e0c7051d8f9879373ddac113","modified":1507540761097},{"_id":"themes/yilia/source-src/js/anm.js","hash":"4a4c5d82b09a3063f91a434388e6aa064fd7fd98","modified":1507540761097},{"_id":"themes/yilia/source-src/js/aside.js","hash":"754f771264548a6c5a8ad842908e59ae4e7ed099","modified":1507540761097},{"_id":"themes/yilia/source-src/js/browser.js","hash":"04095b38cfd4316a23f8eb14b1ffaf95f78a4260","modified":1507540761097},{"_id":"themes/yilia/source-src/js/fix.js","hash":"7f9599ffd5c5551538e90b97023e7d6c599d1ee6","modified":1507540761097},{"_id":"themes/yilia/source-src/js/main.js","hash":"3894e60827c817319e43c9ff3ed045fc3d7336ce","modified":1507540761097},{"_id":"themes/yilia/source-src/js/mobile.js","hash":"4d823b039fd296d24a454eae5a798b93c44560cb","modified":1507540761097},{"_id":"themes/yilia/source-src/js/report.js","hash":"4f1d9a18a936ce40b037f636a39127dd19175b6e","modified":1507540761097},{"_id":"themes/yilia/source-src/js/share.js","hash":"b090f82cf80cba7da764753906d9e2cc2acdf30d","modified":1507540761097},{"_id":"themes/yilia/source-src/js/slider.js","hash":"e846bcc5aac9c68b93f7b8de353df54d8d29f666","modified":1507540761097},{"_id":"themes/yilia/source-src/js/util.js","hash":"8456e9d6b19532742582c99b2fb9d09e146e1c58","modified":1507540761097},{"_id":"themes/yilia/source-src/js/viewer.js","hash":"e8a35d4497fe1e0f119662ae08bd8404e5dab2a4","modified":1507540761097},{"_id":"source/_posts/201710091601/07d3ef73b5c3f8ce.jpg","hash":"7f6a07ae54c128ab528bba8d8249db3f63af3628","modified":1507540761063},{"_id":"source/_posts/201710091601/1673c7249c05f467.jpg","hash":"463d8267a7742c21f99350c07dc64bb738370d3e","modified":1507540761067},{"_id":"source/_posts/201710091601/1d6b5e876b43563e.jpg","hash":"254c9a770214fc5a7e0802ab2d873fa48d930f61","modified":1507540761060},{"_id":"source/_posts/201710091601/32e3eb023f6ee3ba.jpg","hash":"5a3cfde215322b3d7f9b0d1a8898cc17921c7599","modified":1507540761063},{"_id":"source/_posts/201710091601/339c821002d465d5.jpg","hash":"b1d3fcb9c19508b5e60b98fb4560deb64ec44e1a","modified":1507540761067},{"_id":"source/_posts/201710091601/37bfc853a59b3cea.jpg","hash":"6e9c2d14d77545de8737825dcd6fb6e1befa6d3d","modified":1507540761063},{"_id":"source/_posts/201710091601/42d722931576c18a.jpg","hash":"e200a5ca584e6fadcf99e5afeac0598b98a9103c","modified":1507540761063},{"_id":"source/_posts/201710091601/528dcf36c7d52e6e.jpg","hash":"3e4feb9e3f2e7a85f4337f04e728505646032121","modified":1507540761067},{"_id":"source/_posts/201710091601/545eaec054fd5218.jpg","hash":"d78033d1dcfd9cc79e2e29fe09f677ea7c069d17","modified":1507540761067},{"_id":"source/_posts/201710091601/5ae453ac46cb1abd.jpg","hash":"32e1b7938f75c0e0552adb93e6128a679b361aa0","modified":1507540761060},{"_id":"source/_posts/201710091601/73411fbff77a7f7f.jpg","hash":"50d6c8ddcb327e507de936f0d3bb438d10d96639","modified":1507540761067},{"_id":"source/_posts/201710091601/7775353d41d1249a.jpg","hash":"a098164b065a69d0a66efde33db39ea8201fb307","modified":1507540761067},{"_id":"source/_posts/201710091601/89edccb8d8efc05c.jpg","hash":"36bc1cdd0bcb806ab9ed29a038cd3120814b7112","modified":1507540761063},{"_id":"source/_posts/201710091601/8f64eab0ae66fc3a.jpg","hash":"218650b02e2aaf3085d17c68590161737823edf9","modified":1507540761063},{"_id":"source/_posts/201710091601/8ff306dda9496ae3.jpg","hash":"126ef4ee1a2908120c50cadf4b88e7062d346546","modified":1507540761063},{"_id":"source/_posts/201710091601/9aecf98177c7cca2.jpg","hash":"2f491a739d7bdc22cb03fc05337cef6a6edee086","modified":1507540761063},{"_id":"source/_posts/201710091601/9f4a8ebbc574434d.jpg","hash":"57747b4761c3420157e6148260c27af80a3f37b2","modified":1507540761063},{"_id":"source/_posts/201710091601/a20500ba11982b27.jpg","hash":"65e3bc80018da86053e0685ca7e38c3145b1fcfa","modified":1507540761067},{"_id":"source/_posts/201710091601/a2709486cef98dd9.jpg","hash":"64fa50da65a64fcd94974d24ff6075b6277116e0","modified":1507540761067},{"_id":"source/_posts/201710091601/a88904ba22eff8e8.jpg","hash":"37a16b5017cddb36e801748005d18008eca2ee43","modified":1507540761067},{"_id":"source/_posts/201710091601/af16537d53144f5b.jpg","hash":"1f3feeb7c80dd10c88ef47bbcb4007208a2d8f67","modified":1507540761070},{"_id":"source/_posts/201710091601/b1969927bd8996fc.jpg","hash":"6b4a4c7ce2128a3c03bd3fda53e47d3a43084d4a","modified":1507540761070},{"_id":"source/_posts/201710091601/b54c525c75ddad2c.jpg","hash":"b0e1675b7c960a5709d5f22d3990593ff94a5862","modified":1507540761070},{"_id":"source/_posts/201710091601/c50e8879ac7789e9.jpg","hash":"4e50923c18bd46ef56ffcb76df90383edb51b4a7","modified":1507540761070},{"_id":"source/_posts/201710091601/d4c4710cfbbb1b48.jpg","hash":"f281ab730895dd1d36b907a9e22e7fdf86f60fd6","modified":1507540761070},{"_id":"source/_posts/201710091601/d52ef53e746bc4cb.jpg","hash":"ea797a2b34406c7230445a82a9de6c3aeb297c8b","modified":1507540761070},{"_id":"source/_posts/201710091601/e0099648baa42e6f.jpg","hash":"2f8dba71abe8e40da15fd5fdfd196a420218993c","modified":1507540761073},{"_id":"source/_posts/201710091601/e01e25032e3cd3a8.jpg","hash":"a3ec9f4e6011998debf879229f63abf8724a182a","modified":1507540761070},{"_id":"source/_posts/201710091601/e0b981f651d23679.jpg","hash":"c0b079a856cc495f925a7599fe2f74a53849c4d8","modified":1507540761070},{"_id":"source/_posts/201710091601/e696685082cabdab.jpg","hash":"1ec94e8d2c8bccb786d74550b0d0a55eb3fd447c","modified":1507540761073},{"_id":"source/_posts/201710091601/f4526c5a2570e5b2.jpg","hash":"0722f0f620920b103692a0048c89bad387ecc090","modified":1507540761073},{"_id":"source/_posts/201710091601/f48dc945f00e213f.jpg","hash":"55385f1d5221b46e710bc5f91400ce93e1e26dff","modified":1507540761073},{"_id":"source/_posts/201710091601/fba20274fc7b6174.jpg","hash":"5f1fe4a144bec40e2cd894e07f73854819e73945","modified":1507540761073},{"_id":"source/_posts/201710091643/07d3ef73b5c3f8ce.jpg","hash":"7f6a07ae54c128ab528bba8d8249db3f63af3628","modified":1507540761073},{"_id":"source/_posts/201710091643/1673c7249c05f467.jpg","hash":"463d8267a7742c21f99350c07dc64bb738370d3e","modified":1507540761080},{"_id":"source/_posts/201710091601/50b60481426d3afd.jpg","hash":"e9ca53ec40998003e538c925a107b98e4eb2b278","modified":1507540761063},{"_id":"source/_posts/201710091643/1d6b5e876b43563e.jpg","hash":"254c9a770214fc5a7e0802ab2d873fa48d930f61","modified":1507540761073},{"_id":"source/_posts/201710091643/32e3eb023f6ee3ba.jpg","hash":"5a3cfde215322b3d7f9b0d1a8898cc17921c7599","modified":1507540761077},{"_id":"source/_posts/201710091643/339c821002d465d5.jpg","hash":"b1d3fcb9c19508b5e60b98fb4560deb64ec44e1a","modified":1507540761077},{"_id":"source/_posts/201710091643/37bfc853a59b3cea.jpg","hash":"6e9c2d14d77545de8737825dcd6fb6e1befa6d3d","modified":1507540761077},{"_id":"source/_posts/201710091643/42d722931576c18a.jpg","hash":"e200a5ca584e6fadcf99e5afeac0598b98a9103c","modified":1507540761077},{"_id":"source/_posts/201710091643/50b60481426d3afd.jpg","hash":"e9ca53ec40998003e538c925a107b98e4eb2b278","modified":1507540761077},{"_id":"source/_posts/201710091643/528dcf36c7d52e6e.jpg","hash":"3e4feb9e3f2e7a85f4337f04e728505646032121","modified":1507540761077},{"_id":"source/_posts/201710091643/545eaec054fd5218.jpg","hash":"d78033d1dcfd9cc79e2e29fe09f677ea7c069d17","modified":1507540761077},{"_id":"source/_posts/201710091643/5ae453ac46cb1abd.jpg","hash":"32e1b7938f75c0e0552adb93e6128a679b361aa0","modified":1507540761073},{"_id":"source/_posts/201710091643/73411fbff77a7f7f.jpg","hash":"50d6c8ddcb327e507de936f0d3bb438d10d96639","modified":1507540761080},{"_id":"source/_posts/201710091643/7775353d41d1249a.jpg","hash":"a098164b065a69d0a66efde33db39ea8201fb307","modified":1507540761080},{"_id":"source/_posts/201710091643/89edccb8d8efc05c.jpg","hash":"36bc1cdd0bcb806ab9ed29a038cd3120814b7112","modified":1507540761077},{"_id":"source/_posts/201710091643/8f64eab0ae66fc3a.jpg","hash":"218650b02e2aaf3085d17c68590161737823edf9","modified":1507540761077},{"_id":"source/_posts/201710091643/8ff306dda9496ae3.jpg","hash":"126ef4ee1a2908120c50cadf4b88e7062d346546","modified":1507540761077},{"_id":"source/_posts/201710091643/9aecf98177c7cca2.jpg","hash":"2f491a739d7bdc22cb03fc05337cef6a6edee086","modified":1507540761077},{"_id":"source/_posts/201710091643/9f4a8ebbc574434d.jpg","hash":"57747b4761c3420157e6148260c27af80a3f37b2","modified":1507540761077},{"_id":"source/_posts/201710091643/a20500ba11982b27.jpg","hash":"65e3bc80018da86053e0685ca7e38c3145b1fcfa","modified":1507540761080},{"_id":"source/_posts/201710091643/a2709486cef98dd9.jpg","hash":"64fa50da65a64fcd94974d24ff6075b6277116e0","modified":1507540761080},{"_id":"source/_posts/201710091643/a88904ba22eff8e8.jpg","hash":"37a16b5017cddb36e801748005d18008eca2ee43","modified":1507540761080},{"_id":"source/_posts/201710091643/af16537d53144f5b.jpg","hash":"1f3feeb7c80dd10c88ef47bbcb4007208a2d8f67","modified":1507540761080},{"_id":"source/_posts/201710091643/b1969927bd8996fc.jpg","hash":"6b4a4c7ce2128a3c03bd3fda53e47d3a43084d4a","modified":1507540761080},{"_id":"source/_posts/201710091643/b54c525c75ddad2c.jpg","hash":"b0e1675b7c960a5709d5f22d3990593ff94a5862","modified":1507540761080},{"_id":"source/_posts/201710091643/c50e8879ac7789e9.jpg","hash":"4e50923c18bd46ef56ffcb76df90383edb51b4a7","modified":1507540761080},{"_id":"source/_posts/201710091643/d4c4710cfbbb1b48.jpg","hash":"f281ab730895dd1d36b907a9e22e7fdf86f60fd6","modified":1507540761080},{"_id":"source/_posts/201710091643/d52ef53e746bc4cb.jpg","hash":"ea797a2b34406c7230445a82a9de6c3aeb297c8b","modified":1507540761080},{"_id":"source/_posts/201710091643/e0099648baa42e6f.jpg","hash":"2f8dba71abe8e40da15fd5fdfd196a420218993c","modified":1507540761083},{"_id":"source/_posts/201710091643/e01e25032e3cd3a8.jpg","hash":"a3ec9f4e6011998debf879229f63abf8724a182a","modified":1507540761080},{"_id":"source/_posts/201710091643/e0b981f651d23679.jpg","hash":"c0b079a856cc495f925a7599fe2f74a53849c4d8","modified":1507540761080},{"_id":"source/_posts/201710091643/e696685082cabdab.jpg","hash":"1ec94e8d2c8bccb786d74550b0d0a55eb3fd447c","modified":1507540761083},{"_id":"source/_posts/201710091643/f4526c5a2570e5b2.jpg","hash":"0722f0f620920b103692a0048c89bad387ecc090","modified":1507540761083},{"_id":"source/_posts/201710091643/f48dc945f00e213f.jpg","hash":"55385f1d5221b46e710bc5f91400ce93e1e26dff","modified":1507540761083},{"_id":"source/_posts/201710091643/fba20274fc7b6174.jpg","hash":"5f1fe4a144bec40e2cd894e07f73854819e73945","modified":1507540761083},{"_id":"themes/yilia/layout/_partial/script.ejs","hash":"439f2afa6c3515a7edd67d512aae6eba5b1b0d0b","modified":1507540761093},{"_id":"source/_posts/201710091601/183e05351cd1cd68.jpg","hash":"db9528c384e97178e353615bc883c5e066b5079e","modified":1507540761063},{"_id":"source/_posts/201710091601/295ffe7e24431533.jpg","hash":"0a5b5018b2c5ad736687f948dba30706a934d590","modified":1507540761067},{"_id":"source/_posts/201710091601/59918027883d893c.jpg","hash":"4ff1aa4f737c4b568159bae4077cb15a47e0b3f4","modified":1507540761067},{"_id":"source/_posts/201710091601/68b12c83fd82b947.jpg","hash":"31c190cd64a750d268686c606a1b8dba95c167e0","modified":1507540761063},{"_id":"source/_posts/201710091601/90b48b8f16df2557.jpg","hash":"eeedd8b9985743ded601581d15a0ea130120c5ce","modified":1507540761063},{"_id":"source/_posts/201710091601/ba39d3720b24a03f.jpg","hash":"39e10a0be812d2b8a42cbd0e2c07328ff22a44b4","modified":1507540761070},{"_id":"source/_posts/201710091643/183e05351cd1cd68.jpg","hash":"db9528c384e97178e353615bc883c5e066b5079e","modified":1507540761077},{"_id":"source/_posts/201710091643/295ffe7e24431533.jpg","hash":"0a5b5018b2c5ad736687f948dba30706a934d590","modified":1507540761077},{"_id":"source/_posts/201710091643/59918027883d893c.jpg","hash":"4ff1aa4f737c4b568159bae4077cb15a47e0b3f4","modified":1507540761080},{"_id":"source/_posts/201710091643/68b12c83fd82b947.jpg","hash":"31c190cd64a750d268686c606a1b8dba95c167e0","modified":1507540761077},{"_id":"source/_posts/201710091643/90b48b8f16df2557.jpg","hash":"eeedd8b9985743ded601581d15a0ea130120c5ce","modified":1507540761077},{"_id":"source/_posts/201710091643/ba39d3720b24a03f.jpg","hash":"39e10a0be812d2b8a42cbd0e2c07328ff22a44b4","modified":1507540761080},{"_id":"themes/yilia/layout/_partial/post/category.ejs","hash":"0809a4829aabeb4e911a3ed04ec28db4df7dfe3f","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/changyan.ejs","hash":"ec71ffc2023cebd933c96bd35a7a23d44a30a422","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/date.ejs","hash":"ef71c4081e866a494367575c59610e7e6339ece0","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/duoshuo.ejs","hash":"e8399025ed3b980aedb821c92855889f5f12fd5b","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/gitment.ejs","hash":"e68bbac9ffb1ad27b56837c9abad6ed6bb7daa0c","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/nav.ejs","hash":"1036c8e4e1a7bc935ba173744da735a0d6ed09cd","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/share.ejs","hash":"341103df70d0b476e3acd0afbc507a4a120d8f5f","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/tag.ejs","hash":"2e783e68755abb852760eb0e627a3fbb50a05a55","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1507540761093},{"_id":"themes/yilia/layout/_partial/post/wangyiyun.ejs","hash":"ea41c462168d9697caef9485862e9cac718a12c1","modified":1507540761093},{"_id":"themes/yilia/source-src/css/fonts/iconfont.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1507540761097},{"_id":"themes/yilia/source-src/css/fonts/iconfont.svg","hash":"f9304e5714d20861be7d8f4d36687e88e86b9e1b","modified":1507540761097},{"_id":"themes/yilia/source-src/css/fonts/iconfont.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1507540761097},{"_id":"themes/yilia/source-src/css/fonts/iconfont.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1507540761097},{"_id":"themes/yilia/source-src/css/core/_animation.scss","hash":"63a37f26276f9207405afe0f2d65339ce295bbaf","modified":1507540761097},{"_id":"themes/yilia/source-src/css/core/_media-queries.scss","hash":"491ab3378d5c11005ba65c607608bb36b368a9d5","modified":1507540761097},{"_id":"themes/yilia/source-src/css/core/_mixin.scss","hash":"3bba5c77bad5981eac859fe05c9561d580ba7fa9","modified":1507540761097},{"_id":"themes/yilia/source-src/css/core/_reset.scss","hash":"fab871fa93bd542e76a71a56428f2994a4aaf443","modified":1507540761097},{"_id":"themes/yilia/source-src/css/core/_variables.scss","hash":"fb511c505d1309249f21dc577d4ad2bad99a764f","modified":1507540761097},{"_id":"themes/yilia/source-src/css/img/checkered-pattern.png","hash":"049262fa0886989d750637b264bed34ab51c23c8","modified":1507540761097},{"_id":"themes/yilia/source-src/css/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1507540761097},{"_id":"themes/yilia/source-src/css/img/tooltip.svg","hash":"397fe4b1093bf9b62457dac48aa15dac06b54a3c","modified":1507540761097},{"_id":"public/content.json","hash":"e3fba6c9e5ea170d2430fd498998446027f01c02","modified":1507546529728},{"_id":"public/2017/10/09/201710091723/index.html","hash":"795a4f234b635b2c33b574e842d72c713666ba28","modified":1507546530131},{"_id":"public/2017/10/09/201710091715/index.html","hash":"e0eef64f53c45cf1e9db2758100e2de84bd006e7","modified":1507546530131},{"_id":"public/2017/10/09/201710091714/index.html","hash":"82157b18b2af6a2ad41d8f0544e6deaf0a8da977","modified":1507546530133},{"_id":"public/2017/10/09/201710091712/index.html","hash":"28c6d922f1d590cfa8c90861a4c8832eb368a602","modified":1507546530133},{"_id":"public/2017/10/09/201710091710/index.html","hash":"2354c4b1e6079cbdf68cc7aed8b3ec18fd0dbfc6","modified":1507546530133},{"_id":"public/2017/10/09/201710091709/index.html","hash":"420b4d3c3f831b36224ce269c2bfee48ffe81045","modified":1507546530133},{"_id":"public/2017/10/09/201710091708/index.html","hash":"3c9330ba464a84cde97827cf8154a64481d583fe","modified":1507546530134},{"_id":"public/2017/10/09/201710091706/index.html","hash":"a8f1bdfdb7bd0482d0f4d08c731aaf588188d9fb","modified":1507546530134},{"_id":"public/2017/10/09/201710091705/index.html","hash":"7d424f25a60a0bd0b12c2d8b56cbe5e81c37818a","modified":1507546530134},{"_id":"public/2017/10/09/201710091704/index.html","hash":"d2c3d90eaefdc4700ed17e14d4bb71bf27ea12e6","modified":1507546530134},{"_id":"public/2017/10/09/201710091703/index.html","hash":"5d617cb509183d7f331ccfa53c95080add6bc8e7","modified":1507546530134},{"_id":"public/2017/10/09/201710091701/index.html","hash":"b37558ad2156900be5afc6be76804ae57be39c07","modified":1507546530135},{"_id":"public/2017/10/09/201710091643/index.html","hash":"6d39b5a6e5c9a7cce394a074d107cedc45e1d909","modified":1507546530135},{"_id":"public/2017/10/09/201710091601/index.html","hash":"8bf3fcb41ddc649536666b2537df2e56224db468","modified":1507546530135},{"_id":"public/archives/index.html","hash":"83fce768d09df64710976606b9024a8dd48f01dd","modified":1507546530135},{"_id":"public/archives/page/2/index.html","hash":"e80dd30b9e88f19f0918884cabef73071a6b43d5","modified":1507546530135},{"_id":"public/archives/2017/index.html","hash":"7ce4f1a02d8697523a7d8e91fdc526208e0fbfb3","modified":1507546530136},{"_id":"public/archives/2017/page/2/index.html","hash":"9f59576ca9112e261a18e58aa2bade50932a27c7","modified":1507546530136},{"_id":"public/archives/2017/10/index.html","hash":"d64b5af52f1eb75893c8fc053dd0fc1f40d27883","modified":1507546530136},{"_id":"public/archives/2017/10/page/2/index.html","hash":"f63ff0fac2f8301f26675c8245344b090455e328","modified":1507546530136},{"_id":"public/index.html","hash":"29143235a0f3429c024a4c14d0182590264792ce","modified":1507546530136},{"_id":"public/page/2/index.html","hash":"b7e93e29a9b5846330d47db468b4b6d71c99821b","modified":1507546530136},{"_id":"public/tags/virtualization/index.html","hash":"c3a4480a2be712b36ac00da19e3e069080784cc7","modified":1507546530137},{"_id":"public/tags/ESXi/index.html","hash":"9af4f50f480e4e565ca21f562108264910c69aec","modified":1507546530137},{"_id":"public/tags/linux/index.html","hash":"476596c1cb55f367b83e9c5e3093ffa96245ea6a","modified":1507546530137},{"_id":"public/tags/linux/page/2/index.html","hash":"43aba676b77211d4aaa405473c304fc22ff6d0fd","modified":1507546530137},{"_id":"public/tags/other/index.html","hash":"ca002c451cd40b6c8387d04ddd0bd95aa257070b","modified":1507546530137},{"_id":"public/tags/network/index.html","hash":"1bfe95f949611fe7efcf27bc1a385789ba902b83","modified":1507546530137},{"_id":"public/tags/gfw/index.html","hash":"9fc4d558d08051e42e3ae6cc7f7ce88c54b1394d","modified":1507546530138},{"_id":"public/tags/tools/index.html","hash":"98db75e9531c77eb0de1897dfb7cc6e73f1e21ed","modified":1507546530138},{"_id":"public/fonts/default-skin.b257fa.svg","hash":"2ac727c9e092331d35cce95af209ccfac6d4c7c7","modified":1507546530161},{"_id":"public/fonts/iconfont.16acc2.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1507546530161},{"_id":"public/fonts/iconfont.45d7ee.svg","hash":"f9304e5714d20861be7d8f4d36687e88e86b9e1b","modified":1507546530161},{"_id":"public/fonts/iconfont.8c627f.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1507546530162},{"_id":"public/fonts/iconfont.b322fa.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1507546530162},{"_id":"public/fonts/tooltip.4004ff.svg","hash":"397fe4b1093bf9b62457dac48aa15dac06b54a3c","modified":1507546530162},{"_id":"public/img/default-skin.png","hash":"ed95a8e40a2c3478c5915376acb8e5f33677f24d","modified":1507546530162},{"_id":"public/img/preloader.gif","hash":"6342367c93c82da1b9c620e97c84a389cc43d96d","modified":1507546530162},{"_id":"public/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/031b589e22e15416.jpg","hash":"a960076d215f95b3414ce08ecafea261193c6bbc","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/06132485ab59545a.jpg","hash":"d539713225e1613f848c1dd9f07042a0c142a0f1","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/06c092ba2bbcc190.jpg","hash":"073e575d1995d805632442bc726679da8f6022f2","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/0c837e38c20eba10.jpg","hash":"38ce53fd4341ee7bdba1a649f6570459eba4877f","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/0afa78fbca1dc288.jpg","hash":"4382b01aa479cd2bccfa3042c7fb596eec583c02","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/0cfc23cd25d88711.jpg","hash":"25a99d2492006bfafb92c778664e7b4c5e61d435","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/0e655e34fd585501.jpg","hash":"aeed89c8d0fb08cc620187070838b552b4fc1aed","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/0feee6754fbdf152.jpg","hash":"872dc8a5ea43e24464c6f500410110687294aa50","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/1508a77d6a8ea1c8.jpg","hash":"2704449a3940c696ceb27a651f05d2cfa699fd24","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/180a716339eaac7d.jpg","hash":"7a6c6c8e25683e225e9bee3d4736b307ccb078c5","modified":1507546530162},{"_id":"public/2017/10/09/201710091601/1a594160a1ba91e0.jpg","hash":"9ce3fe356a9d7065af025a19b419d84ffb6c4dd0","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/1cda4b829db27966.jpg","hash":"432d30c15bf0b0d6890eba587e9142300c5f73a5","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/21eef25b932cef4f.jpg","hash":"ebf9581f32f5e8ceeaa89f81828d03484a022e4a","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/2324f721115c3785.jpg","hash":"32418051355737fe2a03df53b50b450bfdaaf253","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/2354389b190af5b4.jpg","hash":"29900846608d69163a94d835b86a10c05c367d0d","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/266f5cf2a5c7db28.jpg","hash":"5db6b4a52ec984163a7954ebc3a7dd51bce9461f","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/2a5be182dfce2f21.jpg","hash":"bd56381ced5575a4f63756c1bf4d07e634b7b532","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/2d6ca36262af1fb1.jpg","hash":"339c9816496142c2f27f32eef648ae6743f02eab","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/2f56d5f920ff1ade.jpg","hash":"a9a48c1c32e8ffaee945406bb7c7e07605eae54f","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/2d95d2595ef8cf3b.jpg","hash":"3f82a10578ed5229e985c875dc874ba7ebad6729","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/3d6c3c2b7962e631.jpg","hash":"289fef44fa607816f3ceecac2b3fab779e893942","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/42997c9404fbb3c5.jpg","hash":"194e3c9d06e34ad924903459df1f03fea74a7e0b","modified":1507546530163},{"_id":"public/2017/10/09/201710091601/48071838f3615424.jpg","hash":"a0057cdec1b9df02bdb117d0bf8527f9968edbef","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/4812df9dc90e7725.jpg","hash":"defc040ebec8dd818d92c8baf009252fc2c8e09c","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/4c9a2f038cdaeb71.jpg","hash":"8fd14f3e165de0e421fa372f5ce60a68af2591fb","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/551b7ab676551748.jpg","hash":"b80585902e24b1c169c0b49bb424cf888b058594","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/566bae7cacf04cc7.jpg","hash":"0409ef7e5b2bdbc55d8d1183ec2122dad147d095","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/5691d99da449aeb2.jpg","hash":"fff9482807003b97180733cce50c20e214d48961","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/5a74c07b6f07c6d7.jpg","hash":"6bcef3017dd557affbf4b2f77afdfaa3993bd735","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/5b4ae1ddf38c5bac.jpg","hash":"21504c5548218278acd7f65c87ac33b6b735ee90","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/5cf991d40fd5681e.jpg","hash":"1d04c303e5d74162308b6e553146734c2cd00055","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/61e865e896205541.jpg","hash":"7ed1c00ff40cce7f9fade9c87fcab08ab3d7ad03","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/6062c404ce14a9d1.jpg","hash":"97a1767bdf8dcc0c523ce63f7e111330a9915348","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/62ab2af515b36b54.jpg","hash":"caaf310a6726a094443321ddc14748c0185d64cd","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/633b5face3642b7c.jpg","hash":"da4cd75081184add38c36fd09380b9dd23e2d4bc","modified":1507546530164},{"_id":"public/2017/10/09/201710091601/66e88f1227120852.jpg","hash":"1498bd82b17e2279eeae103fe237c9da8faefc61","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/63d531446c748da6.jpg","hash":"95670faabc64e724d9d760385ba53a5d6dbd928f","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/6848d154f70459a4.jpg","hash":"b2629f49f8b7d8334234f02aa3f580f320df096b","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/6a9abbd5bcd8ae9b.jpg","hash":"c39b6a82fefdc354421bfb421a3b688ab8915f3e","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/6cbc855c0e0788ca.jpg","hash":"c4f32a438b69f1a5533a7d45c40371b7229f7b01","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/6e480ad0f8a2f6f8.jpg","hash":"fe844689bef01a6f5c452ccca162a651047ab0eb","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/6e979887453d65b1.jpg","hash":"4309d1a5916cf56fd1003f28694745ea69d37bad","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/744d4a1d9493956f.jpg","hash":"a85fe9ee94035a648daa27fd1c77a18999aaf1c2","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/751bb2b097bb76bf.jpg","hash":"8572522d1f49461397ad9a4b2bfc0ca536fbad19","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/785e0001fc28c841.jpg","hash":"ffff32cf356922b194441a888d9abb7be68b080f","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/7896501557e9646b.jpg","hash":"4cacc74b81e04260fac1fd255c5c3b6940c3448c","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/7977fce67fad7ab2.jpg","hash":"e02bffc0d92fc18fde8119e93c395263faf32ae6","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/7d3f472d90225cb6.jpg","hash":"f2dca5f7e423a3d6a31a91e9d021ec553b6f847f","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/873b13631b0a2d43.jpg","hash":"b119aee541d0b1b60a9755f136178baa1180ad78","modified":1507546530165},{"_id":"public/2017/10/09/201710091601/89d7a010bcc96bca.jpg","hash":"85f606af3db48cf9c484862fa45abd75492487a9","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/8e5ebabc9106f714.jpg","hash":"8b56f395b4c9bedfa36258fcc1fe13203a4f5915","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/8f4b4c50b604bbdf.jpg","hash":"a45d56bd3255a6ae87a80445f4a7c049dc183b29","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/8f82cb2725fa616e.jpg","hash":"e824c65783589ccd1a257e98f1ba6ce44c6189d1","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/939dfa4b1fcc1ce4.jpg","hash":"b2c799d22bfccc3ed88f591b2d50142197f3e81f","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/941e2ac251f1c098.jpg","hash":"af1d838fad72057c51c070dbbfff750125b16727","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/95811662f155207b.jpg","hash":"1ff1b72bdb58ea89d2639445a288974d9c4d7b98","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/95b0d3bf93fe30ff.jpg","hash":"2bf35e04003961d552d87ca95942c850da7e2f40","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/96ac1f339e1a918c.jpg","hash":"a56ced3d2754be1293258af7f40560ee0ea5d90e","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/973098e8bf92ca7d.jpg","hash":"0f77461bdef71697f75bed895f39e45718c853fd","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/9b3ba694564ec5f0.jpg","hash":"a6333525f0be13c6edb586f8909026d20d0634ca","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/99c342e6c648a626.jpg","hash":"a1c5c8a9a68ce827b8c240becfec07b39d31c936","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/9e2505199e03c37c.jpg","hash":"755ce2d8416ad171e50b8fa3b452f759fcf6d958","modified":1507546530166},{"_id":"public/2017/10/09/201710091601/a182ce0049370fe2.jpg","hash":"d0797250d0ce8d3afcffdb7c0ec9da75af554336","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/a5e44268d9368b5e.jpg","hash":"67d0e73b5fbef0185d0572a8416b4540c9ac969a","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/abfe4002d809a330.jpg","hash":"5f06e5dab3ef939ed953cae07e93ea078926db65","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/a73157c0e03e0bef.jpg","hash":"e571bb814496352d9a45749c3a6e24e941e73e8a","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/ad32819d93b8330c.jpg","hash":"d7e8e173945497225be21006a97bbd5dcf56d029","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/ae6370a150336ea8.jpg","hash":"0d98583862a2aafbec539308bb71191eb59f6ede","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/aff21e7004340e15.jpg","hash":"6d0f0953119810c732f10fa144fb3e8cd439a308","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/b121ca70c26deb9b.jpg","hash":"ab16934bda96ed75db9fff6d57e452bd6865199a","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/b169f5c72441e23a.jpg","hash":"b173db6932e770ad9e4099107e36ce4087bae326","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/b39860a01ad48dc3.jpg","hash":"d3f7579b1d9874c738e19e2d60c68458a64aaa3d","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/b1e83ae7831df206.jpg","hash":"d5f055ebc7d65c65b28cd4992001a94e65dca08d","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/b4b3d6a322cdc35d.jpg","hash":"f14cf1fe3e4e881c7f84a91235a4754a10e0cc14","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/b9575e72d62e7474.jpg","hash":"06268d3d3baceb96560a8749815b8c8aa8070a5d","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/ba5c85b09c522978.jpg","hash":"ae978d482f2c839df2c9f842cd304125700f83b8","modified":1507546530167},{"_id":"public/2017/10/09/201710091601/bd5f4888a2ae5a64.jpg","hash":"f5e902eaaf80d747cbb4443ca3ec2815f71cfa0c","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/c1e7b073aa72b3c1.jpg","hash":"c73aa23b52451fd7d4cee9b60115ddf5a40344cf","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/c3138d78572d2472.jpg","hash":"50df7ad61e7750297f9b6fbb1d386630d14d1a78","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/c34e5c68c50e2534.jpg","hash":"ce3bc18f464a3719d42e0ec759ccdd4e43612f99","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/c48ab6841594e0ac.jpg","hash":"0eb7082ff240676e7f6ab929a2bd6d914a74c0e1","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/c4c9fe68e495067a.jpg","hash":"d578679f9f0cf966714836db05406657ef78eecf","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/cbedaa2848096de4.jpg","hash":"4d57db07d0b3d79a74a43d4da98b471d61ff4f5b","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/d0e16aa7a3eecca7.jpg","hash":"d2942fb53220a548307f2cf3476cfd84de2d3853","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/cdbf09ff9e323ccf.jpg","hash":"9b7b4b719d1c14f3d6cb4db71c08f268a5e6b175","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/d547095ccdfa9a70.jpg","hash":"32bcb4821ad50eb2634d308378f11070a4b57cce","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/d805875fea4f71d5.jpg","hash":"a15a8021864e5057914041700d437aaab1462ded","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/d6e56c27934793e5.jpg","hash":"2b52b8f2fa93a64cb172eead420884f0ba60b3bf","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/d9fd15b03ad56209.jpg","hash":"6f85fe0c474e3080a9ef0bbc458c09361dce64aa","modified":1507546530168},{"_id":"public/2017/10/09/201710091601/d84386cd9bcedc8f.jpg","hash":"27f834498a0f484989c954ebd96941e6c559f9dc","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e0b95334d12d044f.jpg","hash":"756cfe15c2c796a2156347ce8b6aafae01d03050","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e0bb2f4c6b455757.jpg","hash":"b527a7706f26ce803db0e284179fee84b8457b5a","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e53df4dd51341905.jpg","hash":"86da1f35da29b42db95549414dc8f6fe262b6e18","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e5aa907519fce1c0.jpg","hash":"5b8fd015ef1e7a1a8bad96cb000ca6786a8fe1da","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e620aae6ab7c8e13.jpg","hash":"4b34ab12f32a2b3c00bc863c744d8dd367a2ac6c","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e649a7b010a24b60.jpg","hash":"5fec9f5f099cc927a275116e29e33af0fbaed70b","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e6eaabb5e0327380.jpg","hash":"aae8af8282152037112fe8455574c24095dddc3f","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/e83ee1ff8a839a1c.jpg","hash":"f58c0d8698602cbdac97a93587b093d92d38f790","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/f10b4296db3e0a05.jpg","hash":"ba7ee6ef91f12dd4b8bb86715200c3e1e0310c54","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/eb9fae41092bd441.jpg","hash":"c612e91b1e00b061a6f406b00fd4edb90e6b51d1","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/f410bb787d1fb33f.jpg","hash":"0289aa17eda8bf280e456c68fa0e0cae96c31383","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/f48bf0716013ac11.jpg","hash":"4fe45f6b3c8021883eb28316e0fc6542eacb4640","modified":1507546530169},{"_id":"public/2017/10/09/201710091601/f9120d53fb7c396b.jpg","hash":"02f7cbe27e9a1c5e30349261edd61eab0a957857","modified":1507546530170},{"_id":"public/2017/10/09/201710091601/f92ff5e1e860a45c.jpg","hash":"86a2bc112cd300a0921726a1b124f0ba9b85a7a8","modified":1507546530170},{"_id":"public/2017/10/09/201710091601/fb218f399632a938.jpg","hash":"95fd1d790d94f9f8d0b2f4821c5c0f3be768c186","modified":1507546530170},{"_id":"public/2017/10/09/201710091601/fb85018c73538669.jpg","hash":"04d12b71b7854f521d5f7be256fbb77ef3f7b549","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/031b589e22e15416.jpg","hash":"a960076d215f95b3414ce08ecafea261193c6bbc","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/06132485ab59545a.jpg","hash":"d539713225e1613f848c1dd9f07042a0c142a0f1","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/06c092ba2bbcc190.jpg","hash":"073e575d1995d805632442bc726679da8f6022f2","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/0afa78fbca1dc288.jpg","hash":"4382b01aa479cd2bccfa3042c7fb596eec583c02","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/0c837e38c20eba10.jpg","hash":"38ce53fd4341ee7bdba1a649f6570459eba4877f","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/0cfc23cd25d88711.jpg","hash":"25a99d2492006bfafb92c778664e7b4c5e61d435","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/0e655e34fd585501.jpg","hash":"aeed89c8d0fb08cc620187070838b552b4fc1aed","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/0feee6754fbdf152.jpg","hash":"872dc8a5ea43e24464c6f500410110687294aa50","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/1508a77d6a8ea1c8.jpg","hash":"2704449a3940c696ceb27a651f05d2cfa699fd24","modified":1507546530170},{"_id":"public/2017/10/09/201710091643/180a716339eaac7d.jpg","hash":"7a6c6c8e25683e225e9bee3d4736b307ccb078c5","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/1a594160a1ba91e0.jpg","hash":"9ce3fe356a9d7065af025a19b419d84ffb6c4dd0","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/21eef25b932cef4f.jpg","hash":"ebf9581f32f5e8ceeaa89f81828d03484a022e4a","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/1cda4b829db27966.jpg","hash":"432d30c15bf0b0d6890eba587e9142300c5f73a5","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/2324f721115c3785.jpg","hash":"32418051355737fe2a03df53b50b450bfdaaf253","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/2354389b190af5b4.jpg","hash":"29900846608d69163a94d835b86a10c05c367d0d","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/266f5cf2a5c7db28.jpg","hash":"5db6b4a52ec984163a7954ebc3a7dd51bce9461f","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/2a5be182dfce2f21.jpg","hash":"bd56381ced5575a4f63756c1bf4d07e634b7b532","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/2d6ca36262af1fb1.jpg","hash":"339c9816496142c2f27f32eef648ae6743f02eab","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/2f56d5f920ff1ade.jpg","hash":"a9a48c1c32e8ffaee945406bb7c7e07605eae54f","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/2d95d2595ef8cf3b.jpg","hash":"3f82a10578ed5229e985c875dc874ba7ebad6729","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/3d6c3c2b7962e631.jpg","hash":"289fef44fa607816f3ceecac2b3fab779e893942","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/42997c9404fbb3c5.jpg","hash":"194e3c9d06e34ad924903459df1f03fea74a7e0b","modified":1507546530171},{"_id":"public/2017/10/09/201710091643/48071838f3615424.jpg","hash":"a0057cdec1b9df02bdb117d0bf8527f9968edbef","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/4812df9dc90e7725.jpg","hash":"defc040ebec8dd818d92c8baf009252fc2c8e09c","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/4c9a2f038cdaeb71.jpg","hash":"8fd14f3e165de0e421fa372f5ce60a68af2591fb","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/551b7ab676551748.jpg","hash":"b80585902e24b1c169c0b49bb424cf888b058594","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/566bae7cacf04cc7.jpg","hash":"0409ef7e5b2bdbc55d8d1183ec2122dad147d095","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/5691d99da449aeb2.jpg","hash":"fff9482807003b97180733cce50c20e214d48961","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/5a74c07b6f07c6d7.jpg","hash":"6bcef3017dd557affbf4b2f77afdfaa3993bd735","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/5b4ae1ddf38c5bac.jpg","hash":"21504c5548218278acd7f65c87ac33b6b735ee90","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/5cf991d40fd5681e.jpg","hash":"1d04c303e5d74162308b6e553146734c2cd00055","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/61e865e896205541.jpg","hash":"7ed1c00ff40cce7f9fade9c87fcab08ab3d7ad03","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/6062c404ce14a9d1.jpg","hash":"97a1767bdf8dcc0c523ce63f7e111330a9915348","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/62ab2af515b36b54.jpg","hash":"caaf310a6726a094443321ddc14748c0185d64cd","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/633b5face3642b7c.jpg","hash":"da4cd75081184add38c36fd09380b9dd23e2d4bc","modified":1507546530172},{"_id":"public/2017/10/09/201710091643/63d531446c748da6.jpg","hash":"95670faabc64e724d9d760385ba53a5d6dbd928f","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/66e88f1227120852.jpg","hash":"1498bd82b17e2279eeae103fe237c9da8faefc61","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/6848d154f70459a4.jpg","hash":"b2629f49f8b7d8334234f02aa3f580f320df096b","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/6a9abbd5bcd8ae9b.jpg","hash":"c39b6a82fefdc354421bfb421a3b688ab8915f3e","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/6cbc855c0e0788ca.jpg","hash":"c4f32a438b69f1a5533a7d45c40371b7229f7b01","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/6e480ad0f8a2f6f8.jpg","hash":"fe844689bef01a6f5c452ccca162a651047ab0eb","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/6e979887453d65b1.jpg","hash":"4309d1a5916cf56fd1003f28694745ea69d37bad","modified":1507546530173},{"_id":"public/2017/10/09/201710091643/744d4a1d9493956f.jpg","hash":"a85fe9ee94035a648daa27fd1c77a18999aaf1c2","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/751bb2b097bb76bf.jpg","hash":"8572522d1f49461397ad9a4b2bfc0ca536fbad19","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/785e0001fc28c841.jpg","hash":"ffff32cf356922b194441a888d9abb7be68b080f","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/7896501557e9646b.jpg","hash":"4cacc74b81e04260fac1fd255c5c3b6940c3448c","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/7977fce67fad7ab2.jpg","hash":"e02bffc0d92fc18fde8119e93c395263faf32ae6","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/7d3f472d90225cb6.jpg","hash":"f2dca5f7e423a3d6a31a91e9d021ec553b6f847f","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/873b13631b0a2d43.jpg","hash":"b119aee541d0b1b60a9755f136178baa1180ad78","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/89d7a010bcc96bca.jpg","hash":"85f606af3db48cf9c484862fa45abd75492487a9","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/8e5ebabc9106f714.jpg","hash":"8b56f395b4c9bedfa36258fcc1fe13203a4f5915","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/8f4b4c50b604bbdf.jpg","hash":"a45d56bd3255a6ae87a80445f4a7c049dc183b29","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/8f82cb2725fa616e.jpg","hash":"e824c65783589ccd1a257e98f1ba6ce44c6189d1","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/939dfa4b1fcc1ce4.jpg","hash":"b2c799d22bfccc3ed88f591b2d50142197f3e81f","modified":1507546530174},{"_id":"public/2017/10/09/201710091643/941e2ac251f1c098.jpg","hash":"af1d838fad72057c51c070dbbfff750125b16727","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/95811662f155207b.jpg","hash":"1ff1b72bdb58ea89d2639445a288974d9c4d7b98","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/95b0d3bf93fe30ff.jpg","hash":"2bf35e04003961d552d87ca95942c850da7e2f40","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/96ac1f339e1a918c.jpg","hash":"a56ced3d2754be1293258af7f40560ee0ea5d90e","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/973098e8bf92ca7d.jpg","hash":"0f77461bdef71697f75bed895f39e45718c853fd","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/99c342e6c648a626.jpg","hash":"a1c5c8a9a68ce827b8c240becfec07b39d31c936","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/9b3ba694564ec5f0.jpg","hash":"a6333525f0be13c6edb586f8909026d20d0634ca","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/9e2505199e03c37c.jpg","hash":"755ce2d8416ad171e50b8fa3b452f759fcf6d958","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/a182ce0049370fe2.jpg","hash":"d0797250d0ce8d3afcffdb7c0ec9da75af554336","modified":1507546530175},{"_id":"public/2017/10/09/201710091643/a5e44268d9368b5e.jpg","hash":"67d0e73b5fbef0185d0572a8416b4540c9ac969a","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/a73157c0e03e0bef.jpg","hash":"e571bb814496352d9a45749c3a6e24e941e73e8a","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/abfe4002d809a330.jpg","hash":"5f06e5dab3ef939ed953cae07e93ea078926db65","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/ad32819d93b8330c.jpg","hash":"d7e8e173945497225be21006a97bbd5dcf56d029","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/ae6370a150336ea8.jpg","hash":"0d98583862a2aafbec539308bb71191eb59f6ede","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/aff21e7004340e15.jpg","hash":"6d0f0953119810c732f10fa144fb3e8cd439a308","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/b121ca70c26deb9b.jpg","hash":"ab16934bda96ed75db9fff6d57e452bd6865199a","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/b169f5c72441e23a.jpg","hash":"b173db6932e770ad9e4099107e36ce4087bae326","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/b1e83ae7831df206.jpg","hash":"d5f055ebc7d65c65b28cd4992001a94e65dca08d","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/b39860a01ad48dc3.jpg","hash":"d3f7579b1d9874c738e19e2d60c68458a64aaa3d","modified":1507546530176},{"_id":"public/2017/10/09/201710091643/b4b3d6a322cdc35d.jpg","hash":"f14cf1fe3e4e881c7f84a91235a4754a10e0cc14","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/b9575e72d62e7474.jpg","hash":"06268d3d3baceb96560a8749815b8c8aa8070a5d","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/ba5c85b09c522978.jpg","hash":"ae978d482f2c839df2c9f842cd304125700f83b8","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/bd5f4888a2ae5a64.jpg","hash":"f5e902eaaf80d747cbb4443ca3ec2815f71cfa0c","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/c1e7b073aa72b3c1.jpg","hash":"c73aa23b52451fd7d4cee9b60115ddf5a40344cf","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/c3138d78572d2472.jpg","hash":"50df7ad61e7750297f9b6fbb1d386630d14d1a78","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/c34e5c68c50e2534.jpg","hash":"ce3bc18f464a3719d42e0ec759ccdd4e43612f99","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/c48ab6841594e0ac.jpg","hash":"0eb7082ff240676e7f6ab929a2bd6d914a74c0e1","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/c4c9fe68e495067a.jpg","hash":"d578679f9f0cf966714836db05406657ef78eecf","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/cbedaa2848096de4.jpg","hash":"4d57db07d0b3d79a74a43d4da98b471d61ff4f5b","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/cdbf09ff9e323ccf.jpg","hash":"9b7b4b719d1c14f3d6cb4db71c08f268a5e6b175","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/d0e16aa7a3eecca7.jpg","hash":"d2942fb53220a548307f2cf3476cfd84de2d3853","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/d547095ccdfa9a70.jpg","hash":"32bcb4821ad50eb2634d308378f11070a4b57cce","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/d6e56c27934793e5.jpg","hash":"2b52b8f2fa93a64cb172eead420884f0ba60b3bf","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/d805875fea4f71d5.jpg","hash":"a15a8021864e5057914041700d437aaab1462ded","modified":1507546530177},{"_id":"public/2017/10/09/201710091643/d84386cd9bcedc8f.jpg","hash":"27f834498a0f484989c954ebd96941e6c559f9dc","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/d9fd15b03ad56209.jpg","hash":"6f85fe0c474e3080a9ef0bbc458c09361dce64aa","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e0b95334d12d044f.jpg","hash":"756cfe15c2c796a2156347ce8b6aafae01d03050","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e0bb2f4c6b455757.jpg","hash":"b527a7706f26ce803db0e284179fee84b8457b5a","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e53df4dd51341905.jpg","hash":"86da1f35da29b42db95549414dc8f6fe262b6e18","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e5aa907519fce1c0.jpg","hash":"5b8fd015ef1e7a1a8bad96cb000ca6786a8fe1da","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e620aae6ab7c8e13.jpg","hash":"4b34ab12f32a2b3c00bc863c744d8dd367a2ac6c","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e649a7b010a24b60.jpg","hash":"5fec9f5f099cc927a275116e29e33af0fbaed70b","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e6eaabb5e0327380.jpg","hash":"aae8af8282152037112fe8455574c24095dddc3f","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/e83ee1ff8a839a1c.jpg","hash":"f58c0d8698602cbdac97a93587b093d92d38f790","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/eb9fae41092bd441.jpg","hash":"c612e91b1e00b061a6f406b00fd4edb90e6b51d1","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/f10b4296db3e0a05.jpg","hash":"ba7ee6ef91f12dd4b8bb86715200c3e1e0310c54","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/f410bb787d1fb33f.jpg","hash":"0289aa17eda8bf280e456c68fa0e0cae96c31383","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/f48bf0716013ac11.jpg","hash":"4fe45f6b3c8021883eb28316e0fc6542eacb4640","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/f9120d53fb7c396b.jpg","hash":"02f7cbe27e9a1c5e30349261edd61eab0a957857","modified":1507546530178},{"_id":"public/2017/10/09/201710091643/f92ff5e1e860a45c.jpg","hash":"86a2bc112cd300a0921726a1b124f0ba9b85a7a8","modified":1507546530179},{"_id":"public/2017/10/09/201710091643/fb218f399632a938.jpg","hash":"95fd1d790d94f9f8d0b2f4821c5c0f3be768c186","modified":1507546530179},{"_id":"public/2017/10/09/201710091643/fb85018c73538669.jpg","hash":"04d12b71b7854f521d5f7be256fbb77ef3f7b549","modified":1507546530179},{"_id":"public/2017/10/09/201710091601/07d3ef73b5c3f8ce.jpg","hash":"7f6a07ae54c128ab528bba8d8249db3f63af3628","modified":1507546530193},{"_id":"public/2017/10/09/201710091601/1673c7249c05f467.jpg","hash":"463d8267a7742c21f99350c07dc64bb738370d3e","modified":1507546530195},{"_id":"public/2017/10/09/201710091601/1d6b5e876b43563e.jpg","hash":"254c9a770214fc5a7e0802ab2d873fa48d930f61","modified":1507546530195},{"_id":"public/2017/10/09/201710091601/32e3eb023f6ee3ba.jpg","hash":"5a3cfde215322b3d7f9b0d1a8898cc17921c7599","modified":1507546530195},{"_id":"public/2017/10/09/201710091601/339c821002d465d5.jpg","hash":"b1d3fcb9c19508b5e60b98fb4560deb64ec44e1a","modified":1507546530195},{"_id":"public/2017/10/09/201710091601/37bfc853a59b3cea.jpg","hash":"6e9c2d14d77545de8737825dcd6fb6e1befa6d3d","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/42d722931576c18a.jpg","hash":"e200a5ca584e6fadcf99e5afeac0598b98a9103c","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/50b60481426d3afd.jpg","hash":"e9ca53ec40998003e538c925a107b98e4eb2b278","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/528dcf36c7d52e6e.jpg","hash":"3e4feb9e3f2e7a85f4337f04e728505646032121","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/545eaec054fd5218.jpg","hash":"d78033d1dcfd9cc79e2e29fe09f677ea7c069d17","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/5ae453ac46cb1abd.jpg","hash":"32e1b7938f75c0e0552adb93e6128a679b361aa0","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/73411fbff77a7f7f.jpg","hash":"50d6c8ddcb327e507de936f0d3bb438d10d96639","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/7775353d41d1249a.jpg","hash":"a098164b065a69d0a66efde33db39ea8201fb307","modified":1507546530196},{"_id":"public/2017/10/09/201710091601/89edccb8d8efc05c.jpg","hash":"36bc1cdd0bcb806ab9ed29a038cd3120814b7112","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/8f64eab0ae66fc3a.jpg","hash":"218650b02e2aaf3085d17c68590161737823edf9","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/8ff306dda9496ae3.jpg","hash":"126ef4ee1a2908120c50cadf4b88e7062d346546","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/9aecf98177c7cca2.jpg","hash":"2f491a739d7bdc22cb03fc05337cef6a6edee086","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/9f4a8ebbc574434d.jpg","hash":"57747b4761c3420157e6148260c27af80a3f37b2","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/a20500ba11982b27.jpg","hash":"65e3bc80018da86053e0685ca7e38c3145b1fcfa","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/a2709486cef98dd9.jpg","hash":"64fa50da65a64fcd94974d24ff6075b6277116e0","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/a88904ba22eff8e8.jpg","hash":"37a16b5017cddb36e801748005d18008eca2ee43","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/af16537d53144f5b.jpg","hash":"1f3feeb7c80dd10c88ef47bbcb4007208a2d8f67","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/b1969927bd8996fc.jpg","hash":"6b4a4c7ce2128a3c03bd3fda53e47d3a43084d4a","modified":1507546530197},{"_id":"public/2017/10/09/201710091601/b54c525c75ddad2c.jpg","hash":"b0e1675b7c960a5709d5f22d3990593ff94a5862","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/c50e8879ac7789e9.jpg","hash":"4e50923c18bd46ef56ffcb76df90383edb51b4a7","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/d4c4710cfbbb1b48.jpg","hash":"f281ab730895dd1d36b907a9e22e7fdf86f60fd6","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/d52ef53e746bc4cb.jpg","hash":"ea797a2b34406c7230445a82a9de6c3aeb297c8b","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/e0099648baa42e6f.jpg","hash":"2f8dba71abe8e40da15fd5fdfd196a420218993c","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/e01e25032e3cd3a8.jpg","hash":"a3ec9f4e6011998debf879229f63abf8724a182a","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/e0b981f651d23679.jpg","hash":"c0b079a856cc495f925a7599fe2f74a53849c4d8","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/e696685082cabdab.jpg","hash":"1ec94e8d2c8bccb786d74550b0d0a55eb3fd447c","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/f4526c5a2570e5b2.jpg","hash":"0722f0f620920b103692a0048c89bad387ecc090","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/f48dc945f00e213f.jpg","hash":"55385f1d5221b46e710bc5f91400ce93e1e26dff","modified":1507546530198},{"_id":"public/2017/10/09/201710091601/fba20274fc7b6174.jpg","hash":"5f1fe4a144bec40e2cd894e07f73854819e73945","modified":1507546530198},{"_id":"public/2017/10/09/201710091643/07d3ef73b5c3f8ce.jpg","hash":"7f6a07ae54c128ab528bba8d8249db3f63af3628","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/1673c7249c05f467.jpg","hash":"463d8267a7742c21f99350c07dc64bb738370d3e","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/1d6b5e876b43563e.jpg","hash":"254c9a770214fc5a7e0802ab2d873fa48d930f61","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/339c821002d465d5.jpg","hash":"b1d3fcb9c19508b5e60b98fb4560deb64ec44e1a","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/32e3eb023f6ee3ba.jpg","hash":"5a3cfde215322b3d7f9b0d1a8898cc17921c7599","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/37bfc853a59b3cea.jpg","hash":"6e9c2d14d77545de8737825dcd6fb6e1befa6d3d","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/42d722931576c18a.jpg","hash":"e200a5ca584e6fadcf99e5afeac0598b98a9103c","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/50b60481426d3afd.jpg","hash":"e9ca53ec40998003e538c925a107b98e4eb2b278","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/528dcf36c7d52e6e.jpg","hash":"3e4feb9e3f2e7a85f4337f04e728505646032121","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/545eaec054fd5218.jpg","hash":"d78033d1dcfd9cc79e2e29fe09f677ea7c069d17","modified":1507546530199},{"_id":"public/2017/10/09/201710091643/5ae453ac46cb1abd.jpg","hash":"32e1b7938f75c0e0552adb93e6128a679b361aa0","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/73411fbff77a7f7f.jpg","hash":"50d6c8ddcb327e507de936f0d3bb438d10d96639","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/7775353d41d1249a.jpg","hash":"a098164b065a69d0a66efde33db39ea8201fb307","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/89edccb8d8efc05c.jpg","hash":"36bc1cdd0bcb806ab9ed29a038cd3120814b7112","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/8f64eab0ae66fc3a.jpg","hash":"218650b02e2aaf3085d17c68590161737823edf9","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/8ff306dda9496ae3.jpg","hash":"126ef4ee1a2908120c50cadf4b88e7062d346546","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/9aecf98177c7cca2.jpg","hash":"2f491a739d7bdc22cb03fc05337cef6a6edee086","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/9f4a8ebbc574434d.jpg","hash":"57747b4761c3420157e6148260c27af80a3f37b2","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/a20500ba11982b27.jpg","hash":"65e3bc80018da86053e0685ca7e38c3145b1fcfa","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/a2709486cef98dd9.jpg","hash":"64fa50da65a64fcd94974d24ff6075b6277116e0","modified":1507546530200},{"_id":"public/2017/10/09/201710091643/a88904ba22eff8e8.jpg","hash":"37a16b5017cddb36e801748005d18008eca2ee43","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/af16537d53144f5b.jpg","hash":"1f3feeb7c80dd10c88ef47bbcb4007208a2d8f67","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/b1969927bd8996fc.jpg","hash":"6b4a4c7ce2128a3c03bd3fda53e47d3a43084d4a","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/b54c525c75ddad2c.jpg","hash":"b0e1675b7c960a5709d5f22d3990593ff94a5862","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/c50e8879ac7789e9.jpg","hash":"4e50923c18bd46ef56ffcb76df90383edb51b4a7","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/d4c4710cfbbb1b48.jpg","hash":"f281ab730895dd1d36b907a9e22e7fdf86f60fd6","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/d52ef53e746bc4cb.jpg","hash":"ea797a2b34406c7230445a82a9de6c3aeb297c8b","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/e0099648baa42e6f.jpg","hash":"2f8dba71abe8e40da15fd5fdfd196a420218993c","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/e01e25032e3cd3a8.jpg","hash":"a3ec9f4e6011998debf879229f63abf8724a182a","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/e0b981f651d23679.jpg","hash":"c0b079a856cc495f925a7599fe2f74a53849c4d8","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/e696685082cabdab.jpg","hash":"1ec94e8d2c8bccb786d74550b0d0a55eb3fd447c","modified":1507546530201},{"_id":"public/2017/10/09/201710091643/f4526c5a2570e5b2.jpg","hash":"0722f0f620920b103692a0048c89bad387ecc090","modified":1507546530202},{"_id":"public/2017/10/09/201710091643/f48dc945f00e213f.jpg","hash":"55385f1d5221b46e710bc5f91400ce93e1e26dff","modified":1507546530202},{"_id":"public/2017/10/09/201710091643/fba20274fc7b6174.jpg","hash":"5f1fe4a144bec40e2cd894e07f73854819e73945","modified":1507546530202},{"_id":"public/main.507b3a.js","hash":"59ccafbd45d28c397a8a901152ef5e196077e4f4","modified":1507546530214},{"_id":"public/slider.e37972.js","hash":"6dec4e220c89049037eebc44404abd8455d22ad7","modified":1507546530214},{"_id":"public/mobile.fdc4b7.js","hash":"6bfff9bfe4d7e067b6289e851a4c424ac815af5e","modified":1507546530215},{"_id":"public/main.507b3a.css","hash":"ddf6e2c6b953c2c59a3c271e6070010a4cc81cf9","modified":1507546530215},{"_id":"public/2017/10/09/201710091601/183e05351cd1cd68.jpg","hash":"db9528c384e97178e353615bc883c5e066b5079e","modified":1507546530215},{"_id":"public/2017/10/09/201710091601/295ffe7e24431533.jpg","hash":"0a5b5018b2c5ad736687f948dba30706a934d590","modified":1507546530215},{"_id":"public/2017/10/09/201710091601/59918027883d893c.jpg","hash":"4ff1aa4f737c4b568159bae4077cb15a47e0b3f4","modified":1507546530215},{"_id":"public/2017/10/09/201710091601/68b12c83fd82b947.jpg","hash":"31c190cd64a750d268686c606a1b8dba95c167e0","modified":1507546530215},{"_id":"public/2017/10/09/201710091601/90b48b8f16df2557.jpg","hash":"eeedd8b9985743ded601581d15a0ea130120c5ce","modified":1507546530216},{"_id":"public/2017/10/09/201710091601/ba39d3720b24a03f.jpg","hash":"39e10a0be812d2b8a42cbd0e2c07328ff22a44b4","modified":1507546530216},{"_id":"public/2017/10/09/201710091643/183e05351cd1cd68.jpg","hash":"db9528c384e97178e353615bc883c5e066b5079e","modified":1507546530216},{"_id":"public/2017/10/09/201710091643/295ffe7e24431533.jpg","hash":"0a5b5018b2c5ad736687f948dba30706a934d590","modified":1507546530216},{"_id":"public/2017/10/09/201710091643/59918027883d893c.jpg","hash":"4ff1aa4f737c4b568159bae4077cb15a47e0b3f4","modified":1507546530216},{"_id":"public/2017/10/09/201710091643/68b12c83fd82b947.jpg","hash":"31c190cd64a750d268686c606a1b8dba95c167e0","modified":1507546530216},{"_id":"public/2017/10/09/201710091643/90b48b8f16df2557.jpg","hash":"eeedd8b9985743ded601581d15a0ea130120c5ce","modified":1507546530216},{"_id":"public/2017/10/09/201710091643/ba39d3720b24a03f.jpg","hash":"39e10a0be812d2b8a42cbd0e2c07328ff22a44b4","modified":1507546530217}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"ESXi及Vcenter安装","date":"2017-10-09T08:01:14.000Z","_content":"\nESXi及Vcenter安装\n\n<!-- more -->\n\n# 1 所需软件\n\n## 1.1 VSphere组件\n| 软件                                                |                         |\n| --------------------------------------------------- | ----------------------- |\n| 1.VMware-VMvisor-Installer-5.5.0-1331820.x86_64.iso | ESXi安装镜像            |\n| 2.VMware-viclient-all-5.5.0-1281650.exe             | vsphere client 安装软件 |\n| 3.VMware-VIMSetup-all-5.5.0-1312299（Vcenter）.iso  | Vcenter安装镜像         |\n| VMware_vSphere5keygen.rar                           | Vcenter注册机           |\n\n> 链接: [http://pan.baidu.com/s/1hq0dbda](http://pan.baidu.com/s/1hq0dbda)\n> 密码: jkh4\n\n## 1.2 WindownsServer &　SQLServer\n\n| 镜像                                                                                                  |                   |\n| ----------------------------------------------------------------------------------------------------- | ----------------- |\n| cn_windows_server_2008_r2_standard_enterprise_datacenter_and_web_with_sp1_vl_build_x64_dvd_617396.iso | WindowsServer镜像 |\n| SQLFULL_x64_CHS.exe                                                                                   | SQL Server 2008 R |\n\n> 链接: [http://pan.baidu.com/s/1hqwFm9e](http://pan.baidu.com/s/1hqwFm9e)\n> 密码: ajn3\n> <br>\n>\n> 链接: [http://pan.baidu.com/s/1mg1qOEO](http://pan.baidu.com/s/1mg1qOEO)\n> 密码: qajv\n\n# 2 ESXi5.5安装\n\n## 2.1 安装ESXi5.5\n\n### 2.1.1 选择启动项\n选择第一项\n![](/66e88f1227120852.jpg)\n\n### 2.1.2 读取镜像文件\n\n有的服务器在读的时候可能会卡在LSI_MR3.V00这个文件\n解决方案为:直接在U盘根目录中将\"LSI_MR3.V00\"删除,在U盘根目录下复制一份\"LSI_MSGP.V00\",并重命名为\"LSI_MR3.V00\"即可\n![](/c1e7b073aa72b3c1.jpg)\n\n### 2.1.3 读取模组\n\n可看到CPU,内存等信息,这个过程需要几分钟的时间\n![](/48071838f3615424.jpg)\n\n### 2.1.4 开始安装\n\nEnter即可\n![](/c3138d78572d2472.jpg)\n\n### 2.1.5 用户许可声明\n\nF11同意\n![](/bd5f4888a2ae5a64.jpg)\n\n### 2.1.6 选择安装磁盘\n\n不要选成U盘即可,Enter确定\n![](/941e2ac251f1c098.jpg)\n\n### 2.1.7 选择键盘\n\n默认US即可\n![](/d0e16aa7a3eecca7.jpg)\n\n### 2.1.8 设置ROOT密码\n\nEnter以继续\n![](/9e2505199e03c37c.jpg)\n\n### 2.1.9 确认安装\n\nF11以继续\n![](/42997c9404fbb3c5.jpg)\n\n![](/785e0001fc28c841.jpg)\n\n### 2.1.10 安装完成\n\n拔掉U盘,Enter重启\n![](/d84386cd9bcedc8f.jpg)\n\n## 2.2 配置ESXi\n\n### 2.2.1 进入配置界面\n\n按F2进入配置界面\n![](/c4c9fe68e495067a.jpg)\n\n输入root密码\n![](/cbedaa2848096de4.jpg)\n\n### 2.2.2 配置网络\n\n选择配置网络(Configure Management Network)\n![](/9f4a8ebbc574434d.jpg)\n\n选择配置IP(IP Configuration)\n![](/07d3ef73b5c3f8ce.jpg)\n\n选择设置静态IP并设置IP,Netmask,Gateway,Enter以继续\n![](/8ff306dda9496ae3.jpg)\n\n选择配置DNS(DNS Configuration)\n![](/73411fbff77a7f7f.jpg)\n配置DNS\n![](/a20500ba11982b27.jpg)\n\n重启网络服务\n![](/d52ef53e746bc4cb.jpg)\n\n# 3 安装WindowsServer\n\n## 3.1 安装Vsphere CLient\n\n## 3.2 创建WindowsServer虚拟机\n\n### 3.2.1 连接ESXi服务器\n\n![](/545eaec054fd5218.jpg)\n\n### 3.2.2 创建一个新的虚拟机\n\n右键新建虚拟机\n![](/5a74c07b6f07c6d7.jpg)\n\n选择典型即可\n![](/2324f721115c3785.jpg)\n\n填写名称,建议按照一定的规范来\n![](/e83ee1ff8a839a1c.jpg)\n\n选择虚拟机存放的目标存储,本机只有一块\n![](/1508a77d6a8ea1c8.jpg)\n\n选择操作系统的版本\n![](/751bb2b097bb76bf.jpg)\n\n选择网络,默认即可\n![](/f92ff5e1e860a45c.jpg)\n\n创建磁盘,注意上面两点\n![](/e620aae6ab7c8e13.jpg)\n\n点击完成\n![](/7d3f472d90225cb6.jpg)\n\n### 3.2.3 为创建的虚拟机安装系统\n\n此处介绍两种方法\n\n#### 3.2.3.1 镜像上传至服务器进行安装\n\n打开数据存储管理器,点击浏览数据存储\n![](/2a5be182dfce2f21.jpg)\n\n选择文件夹,右键上传即可\n![](/e0b95334d12d044f.jpg)\n\n等待上传完成\n![](/e0bb2f4c6b455757.jpg)\n\n点击编辑设置\n![](/0afa78fbca1dc288.jpg)\n\n编辑CD/DVD设置,点击浏览,找到上传的文件,确定即可,注意勾选打开电源时连接\n![](/fba20274fc7b6174.jpg)\n\n启动虚拟机\n![](/fb218f399632a938.jpg)\n\n#### 3.2.3.2 本地镜像安装\n\n启动虚拟机\n![](/fb218f399632a938.jpg)\n\n打开控制台\n![](/e6eaabb5e0327380.jpg)\n\n编辑CD/DVD设置,选择ISO镜像\n![](/e5aa907519fce1c0.jpg)\n\n重启虚拟机\n![](/566bae7cacf04cc7.jpg)\n\n# 4 SQLServer安装\n\n## 4.1 添加.NET Framework 3.5.1\n\n![](/4c9a2f038cdaeb71.jpg)\n\n![](/6e979887453d65b1.jpg)\n\n![](/5691d99da449aeb2.jpg)\n\n![](/e01e25032e3cd3a8.jpg)\n\n![](/1673c7249c05f467.jpg)\n\n![](/e696685082cabdab.jpg)\n\n## 4.2 安装SQLServer\n\n### 4.2.1 运行setup.exe\n\n![](/50b60481426d3afd.jpg)\n\n### 4.2.2 选择安装\n\n选择左侧安装选项\n![](/32e3eb023f6ee3ba.jpg)\n\n![](/5cf991d40fd5681e.jpg)\n\n### 4.2.3 输入秘钥\n\n![](/a182ce0049370fe2.jpg)\n\n### 4.2.4 接受条款\n\n![](/180a716339eaac7d.jpg)\n\n### 4.2.5 进行安装\n\n- ![](/7977fce67fad7ab2.jpg)\n\n- 这里防火墙有警告，因为这个SQL Server我们只在本机使用，所以不用管它，如果需要外网连接SQL Server就需要在防火墙中把端口打开\n![](/e0b981f651d23679.jpg)\n\n- ![](/cdbf09ff9e323ccf.jpg)\n\n- 这里只选择了一些必要的组件，当然也可以全部选择（不推荐，一点是会使安装占用空间变大，另一点是Reporting Services程序默认会使用80端口，而vCenter Server默认也需要使用80端口，这样会产生端口占用冲突。）\n![](/b121ca70c26deb9b.jpg)\n\n- ![](/7775353d41d1249a.jpg)\n\n- 配置实例,这里使用默认设置\n![](/6a9abbd5bcd8ae9b.jpg)\n\n- 显示磁盘空间使用摘要\n![](/0e655e34fd585501.jpg)\n\n- 服务配置\n将各项启动类型改为自动,点击对所有SQLServer服务使用相同的账户\n![](/f9120d53fb7c396b.jpg)\n选择NT AUTHORITY\\SYSTEM,确定以返回配置界面,并点击下一步\n![](/c34e5c68c50e2534.jpg)\n\n- 账户配置\n身份验证模式选择混合模式;\n输入的密码为SQL Server 管理员账户sa的密码;\n点击添加当前用户,把当前用户添加为SQL Server管理员;\n![](/eb9fae41092bd441.jpg)\n\n- 错误报告,直接下一步\n![](/3d6c3c2b7962e631.jpg)\n\n- 安装配置规则检查完成\n![](/e53df4dd51341905.jpg)\n\n- 准备安装:查看安装配置信息,确认后点击安装\n![](/551b7ab676551748.jpg)\n\n- 开始安装\n![](/fb85018c73538669.jpg)\n\n- 安装完成\n![](/ae6370a150336ea8.jpg)\n\n## 4.3 配置SQLServer\n\n### 4.3.1 禁用强制密码复杂度\n\n点击 \"开始\" ->　\"运行\"　->　\"secpol.msc\", 打开本地策略设置窗口,在 \"账户策略\" -> \"密码策略\" 下,修改 \"强制密码复杂度\"\n![](/6e480ad0f8a2f6f8.jpg)\n\n### 4.3.2 登录SQLServer\n\n- 点击SQL Server Management Studio\n![](/0cfc23cd25d88711.jpg)\n\n- 直接使用Windows身份验证\n![](/2354389b190af5b4.jpg)\n\n### 4.3.3 为Vcenter创建数据库\n\n在SQLServer中新建查询\n![](/06132485ab59545a.jpg)\n\n运行以下代码\n```\nuse [master]\ngo\nCREATE DATABASE [VCDB] ON PRIMARY\n(NAME = N'vcdb', FILENAME = N'C:\\VCDB.mdf' , SIZE = 3000KB , FILEGROWTH = 10% )\nLOG ON\n(NAME = N'vcdb_log', FILENAME = N'C:\\VCDB.ldf' , SIZE = 1000KB , FILEGROWTH = 10%)\nCOLLATE SQL_Latin1_General_CP1_CI_AS\ngo\nuse VCDB\ngo\nsp_addlogin @loginame=[vpxuser], @passwd=N'vpxuser', @defdb='VCDB', @deflanguage='us_english'\ngo\nALTER LOGIN [vpxuser] WITH CHECK_POLICY = OFF\ngo\nCREATE USER [vpxuser] for LOGIN [vpxuser]\ngo\n```\n\n再运行以下代码\n```\nCREATE SCHEMA [VMW]\ngo\nALTER USER [vpxuser] WITH DEFAULT_SCHEMA =[VMW]\ngo\nif not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = 'VC_ADMIN_ROLE')\nCREATE ROLE VC_ADMIN_ROLE;\nGRANT ALTER ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;\nGRANT REFERENCES ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;\nGRANT INSERT ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;\nGRANT CREATE TABLE to VC_ADMIN_ROLE;\nGRANT CREATE VIEW to VC_ADMIN_ROLE;\nGRANT CREATE Procedure to VC_ADMIN_ROLE;\nif not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = 'VC_USER_ROLE')\nCREATE ROLE VC_USER_ROLE\ngo\nGRANT SELECT ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT INSERT ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT DELETE ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT UPDATE ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT EXECUTE ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nsp_addrolemember VC_USER_ROLE , [vpxuser]\ngo\nsp_addrolemember VC_ADMIN_ROLE , [vpxuser]\ngo\nuse MSDB\ngo\nif not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = 'VC_ADMIN_ROLE')\nCREATE ROLE VC_ADMIN_ROLE;\ngo\nGRANT SELECT on msdb.dbo.syscategories to VC_ADMIN_ROLE\ngo\nGRANT SELECT on msdb.dbo.sysjobsteps to VC_ADMIN_ROLE\ngo\nGRANT SELECT ON msdb.dbo.sysjobs to VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_job TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_delete_job TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_jobstep TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_update_job TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_jobserver TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_jobschedule TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_category TO VC_ADMIN_ROLE\ngo\nsp_addrolemember VC_ADMIN_ROLE , [vpxuser]\ngo\n```\n\n### 4.3.4 外围应用配置\n\n选择方面\n![](/1cda4b829db27966.jpg)\n\n将\"RemoteDACEnable\"值改为\"True\"\n![](/6062c404ce14a9d1.jpg)\n\n### 4.3.5 配置ODBC\n\n- 进入ODBC配置\n![](/339c821002d465d5.jpg)\n\n- 选择系统DSN,点击添加\n![](/aff21e7004340e15.jpg)\n\n- 选择SQL Server Native Client 10.0项,点击完成\n![](/8f82cb2725fa616e.jpg)\n\n- 打开创建到SQLServer的新数据源\n输入名称和描述,服务器填写localhost,点击下一步\n![](/d6e56c27934793e5.jpg)\n\n- 验证方式,这里使用默认的集成Windows身份验证即可,点击下一步\n![](/5b4ae1ddf38c5bac.jpg)\n\n- 选择数据库,将默认的数据库更改为刚才创建的数据库,点击下一步\n![](/a5e44268d9368b5e.jpg)\n\n- 点击完成\n![](/a73157c0e03e0bef.jpg)\n\n- 点击测试数据源\n![](/031b589e22e15416.jpg)\n\n- 测试成功,点击确定以返回,并确定创建数据源\n![](/89d7a010bcc96bca.jpg)\n![](/63d531446c748da6.jpg)\n\n# 5 vCenter安装\n\n## 5.1 解压并运行autorun.exe\n\n## 5.2 选择simple install\n\n![](/68b12c83fd82b947.jpg)\n\n![](/2d95d2595ef8cf3b.jpg)\n\n![](/b1969927bd8996fc.jpg)\n\n![](/f410bb787d1fb33f.jpg)\n\n## 5.3 设置vCenter登录密码\n\n![](/ba5c85b09c522978.jpg)\n\n使用默认的站点名称\n![](/6cbc855c0e0788ca.jpg)\n\n## 5.4 Simple install端口设置\n\n使用默认端口\n![](/b169f5c72441e23a.jpg)\n\n使用默认安装目录\n![](/873b13631b0a2d43.jpg)\n\n检查安装选项\n![](/2d6ca36262af1fb1.jpg)\n\n等待安装完成\n![](/9b3ba694564ec5f0.jpg)\n\n## 5.5 输入秘钥\n\n![](/e649a7b010a24b60.jpg)\n\n这里用注册机生成序列号即可(注意注册机只能在XP环境下运行)\n![](/f48bf0716013ac11.jpg)\n\n## 5.6 配置数据库\n\n选择使用现有的受支持数据库\n![](/4812df9dc90e7725.jpg)\n\n由于设置了集成Windows身份验证,这里默认即可\n![](/8f4b4c50b604bbdf.jpg)\n\n## 5.7 其他配置\n\n- vCenter Server服务账户信息: 这里输入服务器登录密码\n![](/b9575e72d62e7474.jpg)\n\n- 配置端口: 这里默认即可(vCenter Server HTTP端口由于冲突改为了8080)\n![](/a2709486cef98dd9.jpg)\n\n- JVM内存配置: 按需选择\n![](/99c342e6c648a626.jpg)\n\n## 5.8 开始安装\n\n![](/b1e83ae7831df206.jpg)\n\n![](/ad32819d93b8330c.jpg)\n\n![](/abfe4002d809a330.jpg)\n\n## 5.9 使用vsphere client连接vCenter\n\n![](/f4526c5a2570e5b2.jpg)\n\n![](/d547095ccdfa9a70.jpg)\n","source":"_posts/201710091601.md","raw":"---\ntitle: ESXi及Vcenter安装\ndate: 2017-10-09 16:01:14\ntags: \n  - virtualization\n---\n\nESXi及Vcenter安装\n\n<!-- more -->\n\n# 1 所需软件\n\n## 1.1 VSphere组件\n| 软件                                                |                         |\n| --------------------------------------------------- | ----------------------- |\n| 1.VMware-VMvisor-Installer-5.5.0-1331820.x86_64.iso | ESXi安装镜像            |\n| 2.VMware-viclient-all-5.5.0-1281650.exe             | vsphere client 安装软件 |\n| 3.VMware-VIMSetup-all-5.5.0-1312299（Vcenter）.iso  | Vcenter安装镜像         |\n| VMware_vSphere5keygen.rar                           | Vcenter注册机           |\n\n> 链接: [http://pan.baidu.com/s/1hq0dbda](http://pan.baidu.com/s/1hq0dbda)\n> 密码: jkh4\n\n## 1.2 WindownsServer &　SQLServer\n\n| 镜像                                                                                                  |                   |\n| ----------------------------------------------------------------------------------------------------- | ----------------- |\n| cn_windows_server_2008_r2_standard_enterprise_datacenter_and_web_with_sp1_vl_build_x64_dvd_617396.iso | WindowsServer镜像 |\n| SQLFULL_x64_CHS.exe                                                                                   | SQL Server 2008 R |\n\n> 链接: [http://pan.baidu.com/s/1hqwFm9e](http://pan.baidu.com/s/1hqwFm9e)\n> 密码: ajn3\n> <br>\n>\n> 链接: [http://pan.baidu.com/s/1mg1qOEO](http://pan.baidu.com/s/1mg1qOEO)\n> 密码: qajv\n\n# 2 ESXi5.5安装\n\n## 2.1 安装ESXi5.5\n\n### 2.1.1 选择启动项\n选择第一项\n![](/66e88f1227120852.jpg)\n\n### 2.1.2 读取镜像文件\n\n有的服务器在读的时候可能会卡在LSI_MR3.V00这个文件\n解决方案为:直接在U盘根目录中将\"LSI_MR3.V00\"删除,在U盘根目录下复制一份\"LSI_MSGP.V00\",并重命名为\"LSI_MR3.V00\"即可\n![](/c1e7b073aa72b3c1.jpg)\n\n### 2.1.3 读取模组\n\n可看到CPU,内存等信息,这个过程需要几分钟的时间\n![](/48071838f3615424.jpg)\n\n### 2.1.4 开始安装\n\nEnter即可\n![](/c3138d78572d2472.jpg)\n\n### 2.1.5 用户许可声明\n\nF11同意\n![](/bd5f4888a2ae5a64.jpg)\n\n### 2.1.6 选择安装磁盘\n\n不要选成U盘即可,Enter确定\n![](/941e2ac251f1c098.jpg)\n\n### 2.1.7 选择键盘\n\n默认US即可\n![](/d0e16aa7a3eecca7.jpg)\n\n### 2.1.8 设置ROOT密码\n\nEnter以继续\n![](/9e2505199e03c37c.jpg)\n\n### 2.1.9 确认安装\n\nF11以继续\n![](/42997c9404fbb3c5.jpg)\n\n![](/785e0001fc28c841.jpg)\n\n### 2.1.10 安装完成\n\n拔掉U盘,Enter重启\n![](/d84386cd9bcedc8f.jpg)\n\n## 2.2 配置ESXi\n\n### 2.2.1 进入配置界面\n\n按F2进入配置界面\n![](/c4c9fe68e495067a.jpg)\n\n输入root密码\n![](/cbedaa2848096de4.jpg)\n\n### 2.2.2 配置网络\n\n选择配置网络(Configure Management Network)\n![](/9f4a8ebbc574434d.jpg)\n\n选择配置IP(IP Configuration)\n![](/07d3ef73b5c3f8ce.jpg)\n\n选择设置静态IP并设置IP,Netmask,Gateway,Enter以继续\n![](/8ff306dda9496ae3.jpg)\n\n选择配置DNS(DNS Configuration)\n![](/73411fbff77a7f7f.jpg)\n配置DNS\n![](/a20500ba11982b27.jpg)\n\n重启网络服务\n![](/d52ef53e746bc4cb.jpg)\n\n# 3 安装WindowsServer\n\n## 3.1 安装Vsphere CLient\n\n## 3.2 创建WindowsServer虚拟机\n\n### 3.2.1 连接ESXi服务器\n\n![](/545eaec054fd5218.jpg)\n\n### 3.2.2 创建一个新的虚拟机\n\n右键新建虚拟机\n![](/5a74c07b6f07c6d7.jpg)\n\n选择典型即可\n![](/2324f721115c3785.jpg)\n\n填写名称,建议按照一定的规范来\n![](/e83ee1ff8a839a1c.jpg)\n\n选择虚拟机存放的目标存储,本机只有一块\n![](/1508a77d6a8ea1c8.jpg)\n\n选择操作系统的版本\n![](/751bb2b097bb76bf.jpg)\n\n选择网络,默认即可\n![](/f92ff5e1e860a45c.jpg)\n\n创建磁盘,注意上面两点\n![](/e620aae6ab7c8e13.jpg)\n\n点击完成\n![](/7d3f472d90225cb6.jpg)\n\n### 3.2.3 为创建的虚拟机安装系统\n\n此处介绍两种方法\n\n#### 3.2.3.1 镜像上传至服务器进行安装\n\n打开数据存储管理器,点击浏览数据存储\n![](/2a5be182dfce2f21.jpg)\n\n选择文件夹,右键上传即可\n![](/e0b95334d12d044f.jpg)\n\n等待上传完成\n![](/e0bb2f4c6b455757.jpg)\n\n点击编辑设置\n![](/0afa78fbca1dc288.jpg)\n\n编辑CD/DVD设置,点击浏览,找到上传的文件,确定即可,注意勾选打开电源时连接\n![](/fba20274fc7b6174.jpg)\n\n启动虚拟机\n![](/fb218f399632a938.jpg)\n\n#### 3.2.3.2 本地镜像安装\n\n启动虚拟机\n![](/fb218f399632a938.jpg)\n\n打开控制台\n![](/e6eaabb5e0327380.jpg)\n\n编辑CD/DVD设置,选择ISO镜像\n![](/e5aa907519fce1c0.jpg)\n\n重启虚拟机\n![](/566bae7cacf04cc7.jpg)\n\n# 4 SQLServer安装\n\n## 4.1 添加.NET Framework 3.5.1\n\n![](/4c9a2f038cdaeb71.jpg)\n\n![](/6e979887453d65b1.jpg)\n\n![](/5691d99da449aeb2.jpg)\n\n![](/e01e25032e3cd3a8.jpg)\n\n![](/1673c7249c05f467.jpg)\n\n![](/e696685082cabdab.jpg)\n\n## 4.2 安装SQLServer\n\n### 4.2.1 运行setup.exe\n\n![](/50b60481426d3afd.jpg)\n\n### 4.2.2 选择安装\n\n选择左侧安装选项\n![](/32e3eb023f6ee3ba.jpg)\n\n![](/5cf991d40fd5681e.jpg)\n\n### 4.2.3 输入秘钥\n\n![](/a182ce0049370fe2.jpg)\n\n### 4.2.4 接受条款\n\n![](/180a716339eaac7d.jpg)\n\n### 4.2.5 进行安装\n\n- ![](/7977fce67fad7ab2.jpg)\n\n- 这里防火墙有警告，因为这个SQL Server我们只在本机使用，所以不用管它，如果需要外网连接SQL Server就需要在防火墙中把端口打开\n![](/e0b981f651d23679.jpg)\n\n- ![](/cdbf09ff9e323ccf.jpg)\n\n- 这里只选择了一些必要的组件，当然也可以全部选择（不推荐，一点是会使安装占用空间变大，另一点是Reporting Services程序默认会使用80端口，而vCenter Server默认也需要使用80端口，这样会产生端口占用冲突。）\n![](/b121ca70c26deb9b.jpg)\n\n- ![](/7775353d41d1249a.jpg)\n\n- 配置实例,这里使用默认设置\n![](/6a9abbd5bcd8ae9b.jpg)\n\n- 显示磁盘空间使用摘要\n![](/0e655e34fd585501.jpg)\n\n- 服务配置\n将各项启动类型改为自动,点击对所有SQLServer服务使用相同的账户\n![](/f9120d53fb7c396b.jpg)\n选择NT AUTHORITY\\SYSTEM,确定以返回配置界面,并点击下一步\n![](/c34e5c68c50e2534.jpg)\n\n- 账户配置\n身份验证模式选择混合模式;\n输入的密码为SQL Server 管理员账户sa的密码;\n点击添加当前用户,把当前用户添加为SQL Server管理员;\n![](/eb9fae41092bd441.jpg)\n\n- 错误报告,直接下一步\n![](/3d6c3c2b7962e631.jpg)\n\n- 安装配置规则检查完成\n![](/e53df4dd51341905.jpg)\n\n- 准备安装:查看安装配置信息,确认后点击安装\n![](/551b7ab676551748.jpg)\n\n- 开始安装\n![](/fb85018c73538669.jpg)\n\n- 安装完成\n![](/ae6370a150336ea8.jpg)\n\n## 4.3 配置SQLServer\n\n### 4.3.1 禁用强制密码复杂度\n\n点击 \"开始\" ->　\"运行\"　->　\"secpol.msc\", 打开本地策略设置窗口,在 \"账户策略\" -> \"密码策略\" 下,修改 \"强制密码复杂度\"\n![](/6e480ad0f8a2f6f8.jpg)\n\n### 4.3.2 登录SQLServer\n\n- 点击SQL Server Management Studio\n![](/0cfc23cd25d88711.jpg)\n\n- 直接使用Windows身份验证\n![](/2354389b190af5b4.jpg)\n\n### 4.3.3 为Vcenter创建数据库\n\n在SQLServer中新建查询\n![](/06132485ab59545a.jpg)\n\n运行以下代码\n```\nuse [master]\ngo\nCREATE DATABASE [VCDB] ON PRIMARY\n(NAME = N'vcdb', FILENAME = N'C:\\VCDB.mdf' , SIZE = 3000KB , FILEGROWTH = 10% )\nLOG ON\n(NAME = N'vcdb_log', FILENAME = N'C:\\VCDB.ldf' , SIZE = 1000KB , FILEGROWTH = 10%)\nCOLLATE SQL_Latin1_General_CP1_CI_AS\ngo\nuse VCDB\ngo\nsp_addlogin @loginame=[vpxuser], @passwd=N'vpxuser', @defdb='VCDB', @deflanguage='us_english'\ngo\nALTER LOGIN [vpxuser] WITH CHECK_POLICY = OFF\ngo\nCREATE USER [vpxuser] for LOGIN [vpxuser]\ngo\n```\n\n再运行以下代码\n```\nCREATE SCHEMA [VMW]\ngo\nALTER USER [vpxuser] WITH DEFAULT_SCHEMA =[VMW]\ngo\nif not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = 'VC_ADMIN_ROLE')\nCREATE ROLE VC_ADMIN_ROLE;\nGRANT ALTER ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;\nGRANT REFERENCES ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;\nGRANT INSERT ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;\nGRANT CREATE TABLE to VC_ADMIN_ROLE;\nGRANT CREATE VIEW to VC_ADMIN_ROLE;\nGRANT CREATE Procedure to VC_ADMIN_ROLE;\nif not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = 'VC_USER_ROLE')\nCREATE ROLE VC_USER_ROLE\ngo\nGRANT SELECT ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT INSERT ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT DELETE ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT UPDATE ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nGRANT EXECUTE ON SCHEMA ::[VMW] to VC_USER_ROLE\ngo\nsp_addrolemember VC_USER_ROLE , [vpxuser]\ngo\nsp_addrolemember VC_ADMIN_ROLE , [vpxuser]\ngo\nuse MSDB\ngo\nif not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = 'VC_ADMIN_ROLE')\nCREATE ROLE VC_ADMIN_ROLE;\ngo\nGRANT SELECT on msdb.dbo.syscategories to VC_ADMIN_ROLE\ngo\nGRANT SELECT on msdb.dbo.sysjobsteps to VC_ADMIN_ROLE\ngo\nGRANT SELECT ON msdb.dbo.sysjobs to VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_job TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_delete_job TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_jobstep TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_update_job TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_jobserver TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_jobschedule TO VC_ADMIN_ROLE\ngo\nGRANT EXECUTE ON msdb.dbo.sp_add_category TO VC_ADMIN_ROLE\ngo\nsp_addrolemember VC_ADMIN_ROLE , [vpxuser]\ngo\n```\n\n### 4.3.4 外围应用配置\n\n选择方面\n![](/1cda4b829db27966.jpg)\n\n将\"RemoteDACEnable\"值改为\"True\"\n![](/6062c404ce14a9d1.jpg)\n\n### 4.3.5 配置ODBC\n\n- 进入ODBC配置\n![](/339c821002d465d5.jpg)\n\n- 选择系统DSN,点击添加\n![](/aff21e7004340e15.jpg)\n\n- 选择SQL Server Native Client 10.0项,点击完成\n![](/8f82cb2725fa616e.jpg)\n\n- 打开创建到SQLServer的新数据源\n输入名称和描述,服务器填写localhost,点击下一步\n![](/d6e56c27934793e5.jpg)\n\n- 验证方式,这里使用默认的集成Windows身份验证即可,点击下一步\n![](/5b4ae1ddf38c5bac.jpg)\n\n- 选择数据库,将默认的数据库更改为刚才创建的数据库,点击下一步\n![](/a5e44268d9368b5e.jpg)\n\n- 点击完成\n![](/a73157c0e03e0bef.jpg)\n\n- 点击测试数据源\n![](/031b589e22e15416.jpg)\n\n- 测试成功,点击确定以返回,并确定创建数据源\n![](/89d7a010bcc96bca.jpg)\n![](/63d531446c748da6.jpg)\n\n# 5 vCenter安装\n\n## 5.1 解压并运行autorun.exe\n\n## 5.2 选择simple install\n\n![](/68b12c83fd82b947.jpg)\n\n![](/2d95d2595ef8cf3b.jpg)\n\n![](/b1969927bd8996fc.jpg)\n\n![](/f410bb787d1fb33f.jpg)\n\n## 5.3 设置vCenter登录密码\n\n![](/ba5c85b09c522978.jpg)\n\n使用默认的站点名称\n![](/6cbc855c0e0788ca.jpg)\n\n## 5.4 Simple install端口设置\n\n使用默认端口\n![](/b169f5c72441e23a.jpg)\n\n使用默认安装目录\n![](/873b13631b0a2d43.jpg)\n\n检查安装选项\n![](/2d6ca36262af1fb1.jpg)\n\n等待安装完成\n![](/9b3ba694564ec5f0.jpg)\n\n## 5.5 输入秘钥\n\n![](/e649a7b010a24b60.jpg)\n\n这里用注册机生成序列号即可(注意注册机只能在XP环境下运行)\n![](/f48bf0716013ac11.jpg)\n\n## 5.6 配置数据库\n\n选择使用现有的受支持数据库\n![](/4812df9dc90e7725.jpg)\n\n由于设置了集成Windows身份验证,这里默认即可\n![](/8f4b4c50b604bbdf.jpg)\n\n## 5.7 其他配置\n\n- vCenter Server服务账户信息: 这里输入服务器登录密码\n![](/b9575e72d62e7474.jpg)\n\n- 配置端口: 这里默认即可(vCenter Server HTTP端口由于冲突改为了8080)\n![](/a2709486cef98dd9.jpg)\n\n- JVM内存配置: 按需选择\n![](/99c342e6c648a626.jpg)\n\n## 5.8 开始安装\n\n![](/b1e83ae7831df206.jpg)\n\n![](/ad32819d93b8330c.jpg)\n\n![](/abfe4002d809a330.jpg)\n\n## 5.9 使用vsphere client连接vCenter\n\n![](/f4526c5a2570e5b2.jpg)\n\n![](/d547095ccdfa9a70.jpg)\n","slug":"201710091601","published":1,"updated":"2017-10-09T09:19:21.060Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a24r0000zizpavcpsk1z","content":"<p>ESXi及Vcenter安装</p>\n<a id=\"more\"></a>\n<h1 id=\"1-所需软件\"><a href=\"#1-所需软件\" class=\"headerlink\" title=\"1 所需软件\"></a>1 所需软件</h1><h2 id=\"1-1-VSphere组件\"><a href=\"#1-1-VSphere组件\" class=\"headerlink\" title=\"1.1 VSphere组件\"></a>1.1 VSphere组件</h2><table>\n<thead>\n<tr>\n<th>软件</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1.VMware-VMvisor-Installer-5.5.0-1331820.x86_64.iso</td>\n<td>ESXi安装镜像</td>\n</tr>\n<tr>\n<td>2.VMware-viclient-all-5.5.0-1281650.exe</td>\n<td>vsphere client 安装软件</td>\n</tr>\n<tr>\n<td>3.VMware-VIMSetup-all-5.5.0-1312299（Vcenter）.iso</td>\n<td>Vcenter安装镜像</td>\n</tr>\n<tr>\n<td>VMware_vSphere5keygen.rar</td>\n<td>Vcenter注册机</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>链接: <a href=\"http://pan.baidu.com/s/1hq0dbda\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1hq0dbda</a><br>密码: jkh4</p>\n</blockquote>\n<h2 id=\"1-2-WindownsServer-amp-SQLServer\"><a href=\"#1-2-WindownsServer-amp-SQLServer\" class=\"headerlink\" title=\"1.2 WindownsServer &amp;　SQLServer\"></a>1.2 WindownsServer &amp;　SQLServer</h2><table>\n<thead>\n<tr>\n<th>镜像</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>cn_windows_server_2008_r2_standard_enterprise_datacenter_and_web_with_sp1_vl_build_x64_dvd_617396.iso</td>\n<td>WindowsServer镜像</td>\n</tr>\n<tr>\n<td>SQLFULL_x64_CHS.exe</td>\n<td>SQL Server 2008 R</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>链接: <a href=\"http://pan.baidu.com/s/1hqwFm9e\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1hqwFm9e</a><br>密码: ajn3<br><br></p>\n<p>链接: <a href=\"http://pan.baidu.com/s/1mg1qOEO\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1mg1qOEO</a><br>密码: qajv</p>\n</blockquote>\n<h1 id=\"2-ESXi5-5安装\"><a href=\"#2-ESXi5-5安装\" class=\"headerlink\" title=\"2 ESXi5.5安装\"></a>2 ESXi5.5安装</h1><h2 id=\"2-1-安装ESXi5-5\"><a href=\"#2-1-安装ESXi5-5\" class=\"headerlink\" title=\"2.1 安装ESXi5.5\"></a>2.1 安装ESXi5.5</h2><h3 id=\"2-1-1-选择启动项\"><a href=\"#2-1-1-选择启动项\" class=\"headerlink\" title=\"2.1.1 选择启动项\"></a>2.1.1 选择启动项</h3><p>选择第一项<br><img src=\"/2017/10/09/201710091601/66e88f1227120852.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-2-读取镜像文件\"><a href=\"#2-1-2-读取镜像文件\" class=\"headerlink\" title=\"2.1.2 读取镜像文件\"></a>2.1.2 读取镜像文件</h3><p>有的服务器在读的时候可能会卡在LSI_MR3.V00这个文件<br>解决方案为:直接在U盘根目录中将”LSI_MR3.V00”删除,在U盘根目录下复制一份”LSI_MSGP.V00”,并重命名为”LSI_MR3.V00”即可<br><img src=\"/2017/10/09/201710091601/c1e7b073aa72b3c1.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-3-读取模组\"><a href=\"#2-1-3-读取模组\" class=\"headerlink\" title=\"2.1.3 读取模组\"></a>2.1.3 读取模组</h3><p>可看到CPU,内存等信息,这个过程需要几分钟的时间<br><img src=\"/2017/10/09/201710091601/48071838f3615424.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-4-开始安装\"><a href=\"#2-1-4-开始安装\" class=\"headerlink\" title=\"2.1.4 开始安装\"></a>2.1.4 开始安装</h3><p>Enter即可<br><img src=\"/2017/10/09/201710091601/c3138d78572d2472.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-5-用户许可声明\"><a href=\"#2-1-5-用户许可声明\" class=\"headerlink\" title=\"2.1.5 用户许可声明\"></a>2.1.5 用户许可声明</h3><p>F11同意<br><img src=\"/2017/10/09/201710091601/bd5f4888a2ae5a64.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-6-选择安装磁盘\"><a href=\"#2-1-6-选择安装磁盘\" class=\"headerlink\" title=\"2.1.6 选择安装磁盘\"></a>2.1.6 选择安装磁盘</h3><p>不要选成U盘即可,Enter确定<br><img src=\"/2017/10/09/201710091601/941e2ac251f1c098.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-7-选择键盘\"><a href=\"#2-1-7-选择键盘\" class=\"headerlink\" title=\"2.1.7 选择键盘\"></a>2.1.7 选择键盘</h3><p>默认US即可<br><img src=\"/2017/10/09/201710091601/d0e16aa7a3eecca7.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-8-设置ROOT密码\"><a href=\"#2-1-8-设置ROOT密码\" class=\"headerlink\" title=\"2.1.8 设置ROOT密码\"></a>2.1.8 设置ROOT密码</h3><p>Enter以继续<br><img src=\"/2017/10/09/201710091601/9e2505199e03c37c.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-9-确认安装\"><a href=\"#2-1-9-确认安装\" class=\"headerlink\" title=\"2.1.9 确认安装\"></a>2.1.9 确认安装</h3><p>F11以继续<br><img src=\"/2017/10/09/201710091601/42997c9404fbb3c5.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/785e0001fc28c841.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-10-安装完成\"><a href=\"#2-1-10-安装完成\" class=\"headerlink\" title=\"2.1.10 安装完成\"></a>2.1.10 安装完成</h3><p>拔掉U盘,Enter重启<br><img src=\"/2017/10/09/201710091601/d84386cd9bcedc8f.jpg\" alt=\"\"></p>\n<h2 id=\"2-2-配置ESXi\"><a href=\"#2-2-配置ESXi\" class=\"headerlink\" title=\"2.2 配置ESXi\"></a>2.2 配置ESXi</h2><h3 id=\"2-2-1-进入配置界面\"><a href=\"#2-2-1-进入配置界面\" class=\"headerlink\" title=\"2.2.1 进入配置界面\"></a>2.2.1 进入配置界面</h3><p>按F2进入配置界面<br><img src=\"/2017/10/09/201710091601/c4c9fe68e495067a.jpg\" alt=\"\"></p>\n<p>输入root密码<br><img src=\"/2017/10/09/201710091601/cbedaa2848096de4.jpg\" alt=\"\"></p>\n<h3 id=\"2-2-2-配置网络\"><a href=\"#2-2-2-配置网络\" class=\"headerlink\" title=\"2.2.2 配置网络\"></a>2.2.2 配置网络</h3><p>选择配置网络(Configure Management Network)<br><img src=\"/2017/10/09/201710091601/9f4a8ebbc574434d.jpg\" alt=\"\"></p>\n<p>选择配置IP(IP Configuration)<br><img src=\"/2017/10/09/201710091601/07d3ef73b5c3f8ce.jpg\" alt=\"\"></p>\n<p>选择设置静态IP并设置IP,Netmask,Gateway,Enter以继续<br><img src=\"/2017/10/09/201710091601/8ff306dda9496ae3.jpg\" alt=\"\"></p>\n<p>选择配置DNS(DNS Configuration)<br><img src=\"/2017/10/09/201710091601/73411fbff77a7f7f.jpg\" alt=\"\"><br>配置DNS<br><img src=\"/2017/10/09/201710091601/a20500ba11982b27.jpg\" alt=\"\"></p>\n<p>重启网络服务<br><img src=\"/2017/10/09/201710091601/d52ef53e746bc4cb.jpg\" alt=\"\"></p>\n<h1 id=\"3-安装WindowsServer\"><a href=\"#3-安装WindowsServer\" class=\"headerlink\" title=\"3 安装WindowsServer\"></a>3 安装WindowsServer</h1><h2 id=\"3-1-安装Vsphere-CLient\"><a href=\"#3-1-安装Vsphere-CLient\" class=\"headerlink\" title=\"3.1 安装Vsphere CLient\"></a>3.1 安装Vsphere CLient</h2><h2 id=\"3-2-创建WindowsServer虚拟机\"><a href=\"#3-2-创建WindowsServer虚拟机\" class=\"headerlink\" title=\"3.2 创建WindowsServer虚拟机\"></a>3.2 创建WindowsServer虚拟机</h2><h3 id=\"3-2-1-连接ESXi服务器\"><a href=\"#3-2-1-连接ESXi服务器\" class=\"headerlink\" title=\"3.2.1 连接ESXi服务器\"></a>3.2.1 连接ESXi服务器</h3><p><img src=\"/2017/10/09/201710091601/545eaec054fd5218.jpg\" alt=\"\"></p>\n<h3 id=\"3-2-2-创建一个新的虚拟机\"><a href=\"#3-2-2-创建一个新的虚拟机\" class=\"headerlink\" title=\"3.2.2 创建一个新的虚拟机\"></a>3.2.2 创建一个新的虚拟机</h3><p>右键新建虚拟机<br><img src=\"/2017/10/09/201710091601/5a74c07b6f07c6d7.jpg\" alt=\"\"></p>\n<p>选择典型即可<br><img src=\"/2017/10/09/201710091601/2324f721115c3785.jpg\" alt=\"\"></p>\n<p>填写名称,建议按照一定的规范来<br><img src=\"/2017/10/09/201710091601/e83ee1ff8a839a1c.jpg\" alt=\"\"></p>\n<p>选择虚拟机存放的目标存储,本机只有一块<br><img src=\"/2017/10/09/201710091601/1508a77d6a8ea1c8.jpg\" alt=\"\"></p>\n<p>选择操作系统的版本<br><img src=\"/2017/10/09/201710091601/751bb2b097bb76bf.jpg\" alt=\"\"></p>\n<p>选择网络,默认即可<br><img src=\"/2017/10/09/201710091601/f92ff5e1e860a45c.jpg\" alt=\"\"></p>\n<p>创建磁盘,注意上面两点<br><img src=\"/2017/10/09/201710091601/e620aae6ab7c8e13.jpg\" alt=\"\"></p>\n<p>点击完成<br><img src=\"/2017/10/09/201710091601/7d3f472d90225cb6.jpg\" alt=\"\"></p>\n<h3 id=\"3-2-3-为创建的虚拟机安装系统\"><a href=\"#3-2-3-为创建的虚拟机安装系统\" class=\"headerlink\" title=\"3.2.3 为创建的虚拟机安装系统\"></a>3.2.3 为创建的虚拟机安装系统</h3><p>此处介绍两种方法</p>\n<h4 id=\"3-2-3-1-镜像上传至服务器进行安装\"><a href=\"#3-2-3-1-镜像上传至服务器进行安装\" class=\"headerlink\" title=\"3.2.3.1 镜像上传至服务器进行安装\"></a>3.2.3.1 镜像上传至服务器进行安装</h4><p>打开数据存储管理器,点击浏览数据存储<br><img src=\"/2017/10/09/201710091601/2a5be182dfce2f21.jpg\" alt=\"\"></p>\n<p>选择文件夹,右键上传即可<br><img src=\"/2017/10/09/201710091601/e0b95334d12d044f.jpg\" alt=\"\"></p>\n<p>等待上传完成<br><img src=\"/2017/10/09/201710091601/e0bb2f4c6b455757.jpg\" alt=\"\"></p>\n<p>点击编辑设置<br><img src=\"/2017/10/09/201710091601/0afa78fbca1dc288.jpg\" alt=\"\"></p>\n<p>编辑CD/DVD设置,点击浏览,找到上传的文件,确定即可,注意勾选打开电源时连接<br><img src=\"/2017/10/09/201710091601/fba20274fc7b6174.jpg\" alt=\"\"></p>\n<p>启动虚拟机<br><img src=\"/2017/10/09/201710091601/fb218f399632a938.jpg\" alt=\"\"></p>\n<h4 id=\"3-2-3-2-本地镜像安装\"><a href=\"#3-2-3-2-本地镜像安装\" class=\"headerlink\" title=\"3.2.3.2 本地镜像安装\"></a>3.2.3.2 本地镜像安装</h4><p>启动虚拟机<br><img src=\"/2017/10/09/201710091601/fb218f399632a938.jpg\" alt=\"\"></p>\n<p>打开控制台<br><img src=\"/2017/10/09/201710091601/e6eaabb5e0327380.jpg\" alt=\"\"></p>\n<p>编辑CD/DVD设置,选择ISO镜像<br><img src=\"/2017/10/09/201710091601/e5aa907519fce1c0.jpg\" alt=\"\"></p>\n<p>重启虚拟机<br><img src=\"/2017/10/09/201710091601/566bae7cacf04cc7.jpg\" alt=\"\"></p>\n<h1 id=\"4-SQLServer安装\"><a href=\"#4-SQLServer安装\" class=\"headerlink\" title=\"4 SQLServer安装\"></a>4 SQLServer安装</h1><h2 id=\"4-1-添加-NET-Framework-3-5-1\"><a href=\"#4-1-添加-NET-Framework-3-5-1\" class=\"headerlink\" title=\"4.1 添加.NET Framework 3.5.1\"></a>4.1 添加.NET Framework 3.5.1</h2><p><img src=\"/2017/10/09/201710091601/4c9a2f038cdaeb71.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/6e979887453d65b1.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/5691d99da449aeb2.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/e01e25032e3cd3a8.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/1673c7249c05f467.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/e696685082cabdab.jpg\" alt=\"\"></p>\n<h2 id=\"4-2-安装SQLServer\"><a href=\"#4-2-安装SQLServer\" class=\"headerlink\" title=\"4.2 安装SQLServer\"></a>4.2 安装SQLServer</h2><h3 id=\"4-2-1-运行setup-exe\"><a href=\"#4-2-1-运行setup-exe\" class=\"headerlink\" title=\"4.2.1 运行setup.exe\"></a>4.2.1 运行setup.exe</h3><p><img src=\"/2017/10/09/201710091601/50b60481426d3afd.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-2-选择安装\"><a href=\"#4-2-2-选择安装\" class=\"headerlink\" title=\"4.2.2 选择安装\"></a>4.2.2 选择安装</h3><p>选择左侧安装选项<br><img src=\"/2017/10/09/201710091601/32e3eb023f6ee3ba.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/5cf991d40fd5681e.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-3-输入秘钥\"><a href=\"#4-2-3-输入秘钥\" class=\"headerlink\" title=\"4.2.3 输入秘钥\"></a>4.2.3 输入秘钥</h3><p><img src=\"/2017/10/09/201710091601/a182ce0049370fe2.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-4-接受条款\"><a href=\"#4-2-4-接受条款\" class=\"headerlink\" title=\"4.2.4 接受条款\"></a>4.2.4 接受条款</h3><p><img src=\"/2017/10/09/201710091601/180a716339eaac7d.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-5-进行安装\"><a href=\"#4-2-5-进行安装\" class=\"headerlink\" title=\"4.2.5 进行安装\"></a>4.2.5 进行安装</h3><ul>\n<li><p><img src=\"/2017/10/09/201710091601/7977fce67fad7ab2.jpg\" alt=\"\"></p>\n</li>\n<li><p>这里防火墙有警告，因为这个SQL Server我们只在本机使用，所以不用管它，如果需要外网连接SQL Server就需要在防火墙中把端口打开<br><img src=\"/2017/10/09/201710091601/e0b981f651d23679.jpg\" alt=\"\"></p>\n</li>\n<li><p><img src=\"/2017/10/09/201710091601/cdbf09ff9e323ccf.jpg\" alt=\"\"></p>\n</li>\n<li><p>这里只选择了一些必要的组件，当然也可以全部选择（不推荐，一点是会使安装占用空间变大，另一点是Reporting Services程序默认会使用80端口，而vCenter Server默认也需要使用80端口，这样会产生端口占用冲突。）<br><img src=\"/2017/10/09/201710091601/b121ca70c26deb9b.jpg\" alt=\"\"></p>\n</li>\n<li><p><img src=\"/2017/10/09/201710091601/7775353d41d1249a.jpg\" alt=\"\"></p>\n</li>\n<li><p>配置实例,这里使用默认设置<br><img src=\"/2017/10/09/201710091601/6a9abbd5bcd8ae9b.jpg\" alt=\"\"></p>\n</li>\n<li><p>显示磁盘空间使用摘要<br><img src=\"/2017/10/09/201710091601/0e655e34fd585501.jpg\" alt=\"\"></p>\n</li>\n<li><p>服务配置<br>将各项启动类型改为自动,点击对所有SQLServer服务使用相同的账户<br><img src=\"/2017/10/09/201710091601/f9120d53fb7c396b.jpg\" alt=\"\"><br>选择NT AUTHORITY\\SYSTEM,确定以返回配置界面,并点击下一步<br><img src=\"/2017/10/09/201710091601/c34e5c68c50e2534.jpg\" alt=\"\"></p>\n</li>\n<li><p>账户配置<br>身份验证模式选择混合模式;<br>输入的密码为SQL Server 管理员账户sa的密码;<br>点击添加当前用户,把当前用户添加为SQL Server管理员;<br><img src=\"/2017/10/09/201710091601/eb9fae41092bd441.jpg\" alt=\"\"></p>\n</li>\n<li><p>错误报告,直接下一步<br><img src=\"/2017/10/09/201710091601/3d6c3c2b7962e631.jpg\" alt=\"\"></p>\n</li>\n<li><p>安装配置规则检查完成<br><img src=\"/2017/10/09/201710091601/e53df4dd51341905.jpg\" alt=\"\"></p>\n</li>\n<li><p>准备安装:查看安装配置信息,确认后点击安装<br><img src=\"/2017/10/09/201710091601/551b7ab676551748.jpg\" alt=\"\"></p>\n</li>\n<li><p>开始安装<br><img src=\"/2017/10/09/201710091601/fb85018c73538669.jpg\" alt=\"\"></p>\n</li>\n<li><p>安装完成<br><img src=\"/2017/10/09/201710091601/ae6370a150336ea8.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h2 id=\"4-3-配置SQLServer\"><a href=\"#4-3-配置SQLServer\" class=\"headerlink\" title=\"4.3 配置SQLServer\"></a>4.3 配置SQLServer</h2><h3 id=\"4-3-1-禁用强制密码复杂度\"><a href=\"#4-3-1-禁用强制密码复杂度\" class=\"headerlink\" title=\"4.3.1 禁用强制密码复杂度\"></a>4.3.1 禁用强制密码复杂度</h3><p>点击 “开始” -&gt;　“运行”　-&gt;　“secpol.msc”, 打开本地策略设置窗口,在 “账户策略” -&gt; “密码策略” 下,修改 “强制密码复杂度”<br><img src=\"/2017/10/09/201710091601/6e480ad0f8a2f6f8.jpg\" alt=\"\"></p>\n<h3 id=\"4-3-2-登录SQLServer\"><a href=\"#4-3-2-登录SQLServer\" class=\"headerlink\" title=\"4.3.2 登录SQLServer\"></a>4.3.2 登录SQLServer</h3><ul>\n<li><p>点击SQL Server Management Studio<br><img src=\"/2017/10/09/201710091601/0cfc23cd25d88711.jpg\" alt=\"\"></p>\n</li>\n<li><p>直接使用Windows身份验证<br><img src=\"/2017/10/09/201710091601/2354389b190af5b4.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h3 id=\"4-3-3-为Vcenter创建数据库\"><a href=\"#4-3-3-为Vcenter创建数据库\" class=\"headerlink\" title=\"4.3.3 为Vcenter创建数据库\"></a>4.3.3 为Vcenter创建数据库</h3><p>在SQLServer中新建查询<br><img src=\"/2017/10/09/201710091601/06132485ab59545a.jpg\" alt=\"\"></p>\n<p>运行以下代码<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">use [master]</div><div class=\"line\">go</div><div class=\"line\">CREATE DATABASE [VCDB] ON PRIMARY</div><div class=\"line\">(NAME = N&apos;vcdb&apos;, FILENAME = N&apos;C:\\VCDB.mdf&apos; , SIZE = 3000KB , FILEGROWTH = 10% )</div><div class=\"line\">LOG ON</div><div class=\"line\">(NAME = N&apos;vcdb_log&apos;, FILENAME = N&apos;C:\\VCDB.ldf&apos; , SIZE = 1000KB , FILEGROWTH = 10%)</div><div class=\"line\">COLLATE SQL_Latin1_General_CP1_CI_AS</div><div class=\"line\">go</div><div class=\"line\">use VCDB</div><div class=\"line\">go</div><div class=\"line\">sp_addlogin @loginame=[vpxuser], @passwd=N&apos;vpxuser&apos;, @defdb=&apos;VCDB&apos;, @deflanguage=&apos;us_english&apos;</div><div class=\"line\">go</div><div class=\"line\">ALTER LOGIN [vpxuser] WITH CHECK_POLICY = OFF</div><div class=\"line\">go</div><div class=\"line\">CREATE USER [vpxuser] for LOGIN [vpxuser]</div><div class=\"line\">go</div></pre></td></tr></table></figure></p>\n<p>再运行以下代码<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE SCHEMA [VMW]</div><div class=\"line\">go</div><div class=\"line\">ALTER USER [vpxuser] WITH DEFAULT_SCHEMA =[VMW]</div><div class=\"line\">go</div><div class=\"line\">if not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = &apos;VC_ADMIN_ROLE&apos;)</div><div class=\"line\">CREATE ROLE VC_ADMIN_ROLE;</div><div class=\"line\">GRANT ALTER ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT REFERENCES ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT INSERT ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT CREATE TABLE to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT CREATE VIEW to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT CREATE Procedure to VC_ADMIN_ROLE;</div><div class=\"line\">if not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = &apos;VC_USER_ROLE&apos;)</div><div class=\"line\">CREATE ROLE VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT INSERT ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT DELETE ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT UPDATE ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">sp_addrolemember VC_USER_ROLE , [vpxuser]</div><div class=\"line\">go</div><div class=\"line\">sp_addrolemember VC_ADMIN_ROLE , [vpxuser]</div><div class=\"line\">go</div><div class=\"line\">use MSDB</div><div class=\"line\">go</div><div class=\"line\">if not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = &apos;VC_ADMIN_ROLE&apos;)</div><div class=\"line\">CREATE ROLE VC_ADMIN_ROLE;</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT on msdb.dbo.syscategories to VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT on msdb.dbo.sysjobsteps to VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT ON msdb.dbo.sysjobs to VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_job TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_delete_job TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_jobstep TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_update_job TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_jobserver TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_jobschedule TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_category TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">sp_addrolemember VC_ADMIN_ROLE , [vpxuser]</div><div class=\"line\">go</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-3-4-外围应用配置\"><a href=\"#4-3-4-外围应用配置\" class=\"headerlink\" title=\"4.3.4 外围应用配置\"></a>4.3.4 外围应用配置</h3><p>选择方面<br><img src=\"/2017/10/09/201710091601/1cda4b829db27966.jpg\" alt=\"\"></p>\n<p>将”RemoteDACEnable”值改为”True”<br><img src=\"/2017/10/09/201710091601/6062c404ce14a9d1.jpg\" alt=\"\"></p>\n<h3 id=\"4-3-5-配置ODBC\"><a href=\"#4-3-5-配置ODBC\" class=\"headerlink\" title=\"4.3.5 配置ODBC\"></a>4.3.5 配置ODBC</h3><ul>\n<li><p>进入ODBC配置<br><img src=\"/2017/10/09/201710091601/339c821002d465d5.jpg\" alt=\"\"></p>\n</li>\n<li><p>选择系统DSN,点击添加<br><img src=\"/2017/10/09/201710091601/aff21e7004340e15.jpg\" alt=\"\"></p>\n</li>\n<li><p>选择SQL Server Native Client 10.0项,点击完成<br><img src=\"/2017/10/09/201710091601/8f82cb2725fa616e.jpg\" alt=\"\"></p>\n</li>\n<li><p>打开创建到SQLServer的新数据源<br>输入名称和描述,服务器填写localhost,点击下一步<br><img src=\"/2017/10/09/201710091601/d6e56c27934793e5.jpg\" alt=\"\"></p>\n</li>\n<li><p>验证方式,这里使用默认的集成Windows身份验证即可,点击下一步<br><img src=\"/2017/10/09/201710091601/5b4ae1ddf38c5bac.jpg\" alt=\"\"></p>\n</li>\n<li><p>选择数据库,将默认的数据库更改为刚才创建的数据库,点击下一步<br><img src=\"/2017/10/09/201710091601/a5e44268d9368b5e.jpg\" alt=\"\"></p>\n</li>\n<li><p>点击完成<br><img src=\"/2017/10/09/201710091601/a73157c0e03e0bef.jpg\" alt=\"\"></p>\n</li>\n<li><p>点击测试数据源<br><img src=\"/2017/10/09/201710091601/031b589e22e15416.jpg\" alt=\"\"></p>\n</li>\n<li><p>测试成功,点击确定以返回,并确定创建数据源<br><img src=\"/2017/10/09/201710091601/89d7a010bcc96bca.jpg\" alt=\"\"><br><img src=\"/2017/10/09/201710091601/63d531446c748da6.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h1 id=\"5-vCenter安装\"><a href=\"#5-vCenter安装\" class=\"headerlink\" title=\"5 vCenter安装\"></a>5 vCenter安装</h1><h2 id=\"5-1-解压并运行autorun-exe\"><a href=\"#5-1-解压并运行autorun-exe\" class=\"headerlink\" title=\"5.1 解压并运行autorun.exe\"></a>5.1 解压并运行autorun.exe</h2><h2 id=\"5-2-选择simple-install\"><a href=\"#5-2-选择simple-install\" class=\"headerlink\" title=\"5.2 选择simple install\"></a>5.2 选择simple install</h2><p><img src=\"/2017/10/09/201710091601/68b12c83fd82b947.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/2d95d2595ef8cf3b.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/b1969927bd8996fc.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/f410bb787d1fb33f.jpg\" alt=\"\"></p>\n<h2 id=\"5-3-设置vCenter登录密码\"><a href=\"#5-3-设置vCenter登录密码\" class=\"headerlink\" title=\"5.3 设置vCenter登录密码\"></a>5.3 设置vCenter登录密码</h2><p><img src=\"/2017/10/09/201710091601/ba5c85b09c522978.jpg\" alt=\"\"></p>\n<p>使用默认的站点名称<br><img src=\"/2017/10/09/201710091601/6cbc855c0e0788ca.jpg\" alt=\"\"></p>\n<h2 id=\"5-4-Simple-install端口设置\"><a href=\"#5-4-Simple-install端口设置\" class=\"headerlink\" title=\"5.4 Simple install端口设置\"></a>5.4 Simple install端口设置</h2><p>使用默认端口<br><img src=\"/2017/10/09/201710091601/b169f5c72441e23a.jpg\" alt=\"\"></p>\n<p>使用默认安装目录<br><img src=\"/2017/10/09/201710091601/873b13631b0a2d43.jpg\" alt=\"\"></p>\n<p>检查安装选项<br><img src=\"/2017/10/09/201710091601/2d6ca36262af1fb1.jpg\" alt=\"\"></p>\n<p>等待安装完成<br><img src=\"/2017/10/09/201710091601/9b3ba694564ec5f0.jpg\" alt=\"\"></p>\n<h2 id=\"5-5-输入秘钥\"><a href=\"#5-5-输入秘钥\" class=\"headerlink\" title=\"5.5 输入秘钥\"></a>5.5 输入秘钥</h2><p><img src=\"/2017/10/09/201710091601/e649a7b010a24b60.jpg\" alt=\"\"></p>\n<p>这里用注册机生成序列号即可(注意注册机只能在XP环境下运行)<br><img src=\"/2017/10/09/201710091601/f48bf0716013ac11.jpg\" alt=\"\"></p>\n<h2 id=\"5-6-配置数据库\"><a href=\"#5-6-配置数据库\" class=\"headerlink\" title=\"5.6 配置数据库\"></a>5.6 配置数据库</h2><p>选择使用现有的受支持数据库<br><img src=\"/2017/10/09/201710091601/4812df9dc90e7725.jpg\" alt=\"\"></p>\n<p>由于设置了集成Windows身份验证,这里默认即可<br><img src=\"/2017/10/09/201710091601/8f4b4c50b604bbdf.jpg\" alt=\"\"></p>\n<h2 id=\"5-7-其他配置\"><a href=\"#5-7-其他配置\" class=\"headerlink\" title=\"5.7 其他配置\"></a>5.7 其他配置</h2><ul>\n<li><p>vCenter Server服务账户信息: 这里输入服务器登录密码<br><img src=\"/2017/10/09/201710091601/b9575e72d62e7474.jpg\" alt=\"\"></p>\n</li>\n<li><p>配置端口: 这里默认即可(vCenter Server HTTP端口由于冲突改为了8080)<br><img src=\"/2017/10/09/201710091601/a2709486cef98dd9.jpg\" alt=\"\"></p>\n</li>\n<li><p>JVM内存配置: 按需选择<br><img src=\"/2017/10/09/201710091601/99c342e6c648a626.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h2 id=\"5-8-开始安装\"><a href=\"#5-8-开始安装\" class=\"headerlink\" title=\"5.8 开始安装\"></a>5.8 开始安装</h2><p><img src=\"/2017/10/09/201710091601/b1e83ae7831df206.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/ad32819d93b8330c.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/abfe4002d809a330.jpg\" alt=\"\"></p>\n<h2 id=\"5-9-使用vsphere-client连接vCenter\"><a href=\"#5-9-使用vsphere-client连接vCenter\" class=\"headerlink\" title=\"5.9 使用vsphere client连接vCenter\"></a>5.9 使用vsphere client连接vCenter</h2><p><img src=\"/2017/10/09/201710091601/f4526c5a2570e5b2.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/d547095ccdfa9a70.jpg\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"<p>ESXi及Vcenter安装</p>","more":"<h1 id=\"1-所需软件\"><a href=\"#1-所需软件\" class=\"headerlink\" title=\"1 所需软件\"></a>1 所需软件</h1><h2 id=\"1-1-VSphere组件\"><a href=\"#1-1-VSphere组件\" class=\"headerlink\" title=\"1.1 VSphere组件\"></a>1.1 VSphere组件</h2><table>\n<thead>\n<tr>\n<th>软件</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1.VMware-VMvisor-Installer-5.5.0-1331820.x86_64.iso</td>\n<td>ESXi安装镜像</td>\n</tr>\n<tr>\n<td>2.VMware-viclient-all-5.5.0-1281650.exe</td>\n<td>vsphere client 安装软件</td>\n</tr>\n<tr>\n<td>3.VMware-VIMSetup-all-5.5.0-1312299（Vcenter）.iso</td>\n<td>Vcenter安装镜像</td>\n</tr>\n<tr>\n<td>VMware_vSphere5keygen.rar</td>\n<td>Vcenter注册机</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>链接: <a href=\"http://pan.baidu.com/s/1hq0dbda\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1hq0dbda</a><br>密码: jkh4</p>\n</blockquote>\n<h2 id=\"1-2-WindownsServer-amp-SQLServer\"><a href=\"#1-2-WindownsServer-amp-SQLServer\" class=\"headerlink\" title=\"1.2 WindownsServer &amp;　SQLServer\"></a>1.2 WindownsServer &amp;　SQLServer</h2><table>\n<thead>\n<tr>\n<th>镜像</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>cn_windows_server_2008_r2_standard_enterprise_datacenter_and_web_with_sp1_vl_build_x64_dvd_617396.iso</td>\n<td>WindowsServer镜像</td>\n</tr>\n<tr>\n<td>SQLFULL_x64_CHS.exe</td>\n<td>SQL Server 2008 R</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>链接: <a href=\"http://pan.baidu.com/s/1hqwFm9e\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1hqwFm9e</a><br>密码: ajn3<br><br></p>\n<p>链接: <a href=\"http://pan.baidu.com/s/1mg1qOEO\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1mg1qOEO</a><br>密码: qajv</p>\n</blockquote>\n<h1 id=\"2-ESXi5-5安装\"><a href=\"#2-ESXi5-5安装\" class=\"headerlink\" title=\"2 ESXi5.5安装\"></a>2 ESXi5.5安装</h1><h2 id=\"2-1-安装ESXi5-5\"><a href=\"#2-1-安装ESXi5-5\" class=\"headerlink\" title=\"2.1 安装ESXi5.5\"></a>2.1 安装ESXi5.5</h2><h3 id=\"2-1-1-选择启动项\"><a href=\"#2-1-1-选择启动项\" class=\"headerlink\" title=\"2.1.1 选择启动项\"></a>2.1.1 选择启动项</h3><p>选择第一项<br><img src=\"/2017/10/09/201710091601/66e88f1227120852.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-2-读取镜像文件\"><a href=\"#2-1-2-读取镜像文件\" class=\"headerlink\" title=\"2.1.2 读取镜像文件\"></a>2.1.2 读取镜像文件</h3><p>有的服务器在读的时候可能会卡在LSI_MR3.V00这个文件<br>解决方案为:直接在U盘根目录中将”LSI_MR3.V00”删除,在U盘根目录下复制一份”LSI_MSGP.V00”,并重命名为”LSI_MR3.V00”即可<br><img src=\"/2017/10/09/201710091601/c1e7b073aa72b3c1.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-3-读取模组\"><a href=\"#2-1-3-读取模组\" class=\"headerlink\" title=\"2.1.3 读取模组\"></a>2.1.3 读取模组</h3><p>可看到CPU,内存等信息,这个过程需要几分钟的时间<br><img src=\"/2017/10/09/201710091601/48071838f3615424.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-4-开始安装\"><a href=\"#2-1-4-开始安装\" class=\"headerlink\" title=\"2.1.4 开始安装\"></a>2.1.4 开始安装</h3><p>Enter即可<br><img src=\"/2017/10/09/201710091601/c3138d78572d2472.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-5-用户许可声明\"><a href=\"#2-1-5-用户许可声明\" class=\"headerlink\" title=\"2.1.5 用户许可声明\"></a>2.1.5 用户许可声明</h3><p>F11同意<br><img src=\"/2017/10/09/201710091601/bd5f4888a2ae5a64.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-6-选择安装磁盘\"><a href=\"#2-1-6-选择安装磁盘\" class=\"headerlink\" title=\"2.1.6 选择安装磁盘\"></a>2.1.6 选择安装磁盘</h3><p>不要选成U盘即可,Enter确定<br><img src=\"/2017/10/09/201710091601/941e2ac251f1c098.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-7-选择键盘\"><a href=\"#2-1-7-选择键盘\" class=\"headerlink\" title=\"2.1.7 选择键盘\"></a>2.1.7 选择键盘</h3><p>默认US即可<br><img src=\"/2017/10/09/201710091601/d0e16aa7a3eecca7.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-8-设置ROOT密码\"><a href=\"#2-1-8-设置ROOT密码\" class=\"headerlink\" title=\"2.1.8 设置ROOT密码\"></a>2.1.8 设置ROOT密码</h3><p>Enter以继续<br><img src=\"/2017/10/09/201710091601/9e2505199e03c37c.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-9-确认安装\"><a href=\"#2-1-9-确认安装\" class=\"headerlink\" title=\"2.1.9 确认安装\"></a>2.1.9 确认安装</h3><p>F11以继续<br><img src=\"/2017/10/09/201710091601/42997c9404fbb3c5.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/785e0001fc28c841.jpg\" alt=\"\"></p>\n<h3 id=\"2-1-10-安装完成\"><a href=\"#2-1-10-安装完成\" class=\"headerlink\" title=\"2.1.10 安装完成\"></a>2.1.10 安装完成</h3><p>拔掉U盘,Enter重启<br><img src=\"/2017/10/09/201710091601/d84386cd9bcedc8f.jpg\" alt=\"\"></p>\n<h2 id=\"2-2-配置ESXi\"><a href=\"#2-2-配置ESXi\" class=\"headerlink\" title=\"2.2 配置ESXi\"></a>2.2 配置ESXi</h2><h3 id=\"2-2-1-进入配置界面\"><a href=\"#2-2-1-进入配置界面\" class=\"headerlink\" title=\"2.2.1 进入配置界面\"></a>2.2.1 进入配置界面</h3><p>按F2进入配置界面<br><img src=\"/2017/10/09/201710091601/c4c9fe68e495067a.jpg\" alt=\"\"></p>\n<p>输入root密码<br><img src=\"/2017/10/09/201710091601/cbedaa2848096de4.jpg\" alt=\"\"></p>\n<h3 id=\"2-2-2-配置网络\"><a href=\"#2-2-2-配置网络\" class=\"headerlink\" title=\"2.2.2 配置网络\"></a>2.2.2 配置网络</h3><p>选择配置网络(Configure Management Network)<br><img src=\"/2017/10/09/201710091601/9f4a8ebbc574434d.jpg\" alt=\"\"></p>\n<p>选择配置IP(IP Configuration)<br><img src=\"/2017/10/09/201710091601/07d3ef73b5c3f8ce.jpg\" alt=\"\"></p>\n<p>选择设置静态IP并设置IP,Netmask,Gateway,Enter以继续<br><img src=\"/2017/10/09/201710091601/8ff306dda9496ae3.jpg\" alt=\"\"></p>\n<p>选择配置DNS(DNS Configuration)<br><img src=\"/2017/10/09/201710091601/73411fbff77a7f7f.jpg\" alt=\"\"><br>配置DNS<br><img src=\"/2017/10/09/201710091601/a20500ba11982b27.jpg\" alt=\"\"></p>\n<p>重启网络服务<br><img src=\"/2017/10/09/201710091601/d52ef53e746bc4cb.jpg\" alt=\"\"></p>\n<h1 id=\"3-安装WindowsServer\"><a href=\"#3-安装WindowsServer\" class=\"headerlink\" title=\"3 安装WindowsServer\"></a>3 安装WindowsServer</h1><h2 id=\"3-1-安装Vsphere-CLient\"><a href=\"#3-1-安装Vsphere-CLient\" class=\"headerlink\" title=\"3.1 安装Vsphere CLient\"></a>3.1 安装Vsphere CLient</h2><h2 id=\"3-2-创建WindowsServer虚拟机\"><a href=\"#3-2-创建WindowsServer虚拟机\" class=\"headerlink\" title=\"3.2 创建WindowsServer虚拟机\"></a>3.2 创建WindowsServer虚拟机</h2><h3 id=\"3-2-1-连接ESXi服务器\"><a href=\"#3-2-1-连接ESXi服务器\" class=\"headerlink\" title=\"3.2.1 连接ESXi服务器\"></a>3.2.1 连接ESXi服务器</h3><p><img src=\"/2017/10/09/201710091601/545eaec054fd5218.jpg\" alt=\"\"></p>\n<h3 id=\"3-2-2-创建一个新的虚拟机\"><a href=\"#3-2-2-创建一个新的虚拟机\" class=\"headerlink\" title=\"3.2.2 创建一个新的虚拟机\"></a>3.2.2 创建一个新的虚拟机</h3><p>右键新建虚拟机<br><img src=\"/2017/10/09/201710091601/5a74c07b6f07c6d7.jpg\" alt=\"\"></p>\n<p>选择典型即可<br><img src=\"/2017/10/09/201710091601/2324f721115c3785.jpg\" alt=\"\"></p>\n<p>填写名称,建议按照一定的规范来<br><img src=\"/2017/10/09/201710091601/e83ee1ff8a839a1c.jpg\" alt=\"\"></p>\n<p>选择虚拟机存放的目标存储,本机只有一块<br><img src=\"/2017/10/09/201710091601/1508a77d6a8ea1c8.jpg\" alt=\"\"></p>\n<p>选择操作系统的版本<br><img src=\"/2017/10/09/201710091601/751bb2b097bb76bf.jpg\" alt=\"\"></p>\n<p>选择网络,默认即可<br><img src=\"/2017/10/09/201710091601/f92ff5e1e860a45c.jpg\" alt=\"\"></p>\n<p>创建磁盘,注意上面两点<br><img src=\"/2017/10/09/201710091601/e620aae6ab7c8e13.jpg\" alt=\"\"></p>\n<p>点击完成<br><img src=\"/2017/10/09/201710091601/7d3f472d90225cb6.jpg\" alt=\"\"></p>\n<h3 id=\"3-2-3-为创建的虚拟机安装系统\"><a href=\"#3-2-3-为创建的虚拟机安装系统\" class=\"headerlink\" title=\"3.2.3 为创建的虚拟机安装系统\"></a>3.2.3 为创建的虚拟机安装系统</h3><p>此处介绍两种方法</p>\n<h4 id=\"3-2-3-1-镜像上传至服务器进行安装\"><a href=\"#3-2-3-1-镜像上传至服务器进行安装\" class=\"headerlink\" title=\"3.2.3.1 镜像上传至服务器进行安装\"></a>3.2.3.1 镜像上传至服务器进行安装</h4><p>打开数据存储管理器,点击浏览数据存储<br><img src=\"/2017/10/09/201710091601/2a5be182dfce2f21.jpg\" alt=\"\"></p>\n<p>选择文件夹,右键上传即可<br><img src=\"/2017/10/09/201710091601/e0b95334d12d044f.jpg\" alt=\"\"></p>\n<p>等待上传完成<br><img src=\"/2017/10/09/201710091601/e0bb2f4c6b455757.jpg\" alt=\"\"></p>\n<p>点击编辑设置<br><img src=\"/2017/10/09/201710091601/0afa78fbca1dc288.jpg\" alt=\"\"></p>\n<p>编辑CD/DVD设置,点击浏览,找到上传的文件,确定即可,注意勾选打开电源时连接<br><img src=\"/2017/10/09/201710091601/fba20274fc7b6174.jpg\" alt=\"\"></p>\n<p>启动虚拟机<br><img src=\"/2017/10/09/201710091601/fb218f399632a938.jpg\" alt=\"\"></p>\n<h4 id=\"3-2-3-2-本地镜像安装\"><a href=\"#3-2-3-2-本地镜像安装\" class=\"headerlink\" title=\"3.2.3.2 本地镜像安装\"></a>3.2.3.2 本地镜像安装</h4><p>启动虚拟机<br><img src=\"/2017/10/09/201710091601/fb218f399632a938.jpg\" alt=\"\"></p>\n<p>打开控制台<br><img src=\"/2017/10/09/201710091601/e6eaabb5e0327380.jpg\" alt=\"\"></p>\n<p>编辑CD/DVD设置,选择ISO镜像<br><img src=\"/2017/10/09/201710091601/e5aa907519fce1c0.jpg\" alt=\"\"></p>\n<p>重启虚拟机<br><img src=\"/2017/10/09/201710091601/566bae7cacf04cc7.jpg\" alt=\"\"></p>\n<h1 id=\"4-SQLServer安装\"><a href=\"#4-SQLServer安装\" class=\"headerlink\" title=\"4 SQLServer安装\"></a>4 SQLServer安装</h1><h2 id=\"4-1-添加-NET-Framework-3-5-1\"><a href=\"#4-1-添加-NET-Framework-3-5-1\" class=\"headerlink\" title=\"4.1 添加.NET Framework 3.5.1\"></a>4.1 添加.NET Framework 3.5.1</h2><p><img src=\"/2017/10/09/201710091601/4c9a2f038cdaeb71.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/6e979887453d65b1.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/5691d99da449aeb2.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/e01e25032e3cd3a8.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/1673c7249c05f467.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/e696685082cabdab.jpg\" alt=\"\"></p>\n<h2 id=\"4-2-安装SQLServer\"><a href=\"#4-2-安装SQLServer\" class=\"headerlink\" title=\"4.2 安装SQLServer\"></a>4.2 安装SQLServer</h2><h3 id=\"4-2-1-运行setup-exe\"><a href=\"#4-2-1-运行setup-exe\" class=\"headerlink\" title=\"4.2.1 运行setup.exe\"></a>4.2.1 运行setup.exe</h3><p><img src=\"/2017/10/09/201710091601/50b60481426d3afd.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-2-选择安装\"><a href=\"#4-2-2-选择安装\" class=\"headerlink\" title=\"4.2.2 选择安装\"></a>4.2.2 选择安装</h3><p>选择左侧安装选项<br><img src=\"/2017/10/09/201710091601/32e3eb023f6ee3ba.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/5cf991d40fd5681e.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-3-输入秘钥\"><a href=\"#4-2-3-输入秘钥\" class=\"headerlink\" title=\"4.2.3 输入秘钥\"></a>4.2.3 输入秘钥</h3><p><img src=\"/2017/10/09/201710091601/a182ce0049370fe2.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-4-接受条款\"><a href=\"#4-2-4-接受条款\" class=\"headerlink\" title=\"4.2.4 接受条款\"></a>4.2.4 接受条款</h3><p><img src=\"/2017/10/09/201710091601/180a716339eaac7d.jpg\" alt=\"\"></p>\n<h3 id=\"4-2-5-进行安装\"><a href=\"#4-2-5-进行安装\" class=\"headerlink\" title=\"4.2.5 进行安装\"></a>4.2.5 进行安装</h3><ul>\n<li><p><img src=\"/2017/10/09/201710091601/7977fce67fad7ab2.jpg\" alt=\"\"></p>\n</li>\n<li><p>这里防火墙有警告，因为这个SQL Server我们只在本机使用，所以不用管它，如果需要外网连接SQL Server就需要在防火墙中把端口打开<br><img src=\"/2017/10/09/201710091601/e0b981f651d23679.jpg\" alt=\"\"></p>\n</li>\n<li><p><img src=\"/2017/10/09/201710091601/cdbf09ff9e323ccf.jpg\" alt=\"\"></p>\n</li>\n<li><p>这里只选择了一些必要的组件，当然也可以全部选择（不推荐，一点是会使安装占用空间变大，另一点是Reporting Services程序默认会使用80端口，而vCenter Server默认也需要使用80端口，这样会产生端口占用冲突。）<br><img src=\"/2017/10/09/201710091601/b121ca70c26deb9b.jpg\" alt=\"\"></p>\n</li>\n<li><p><img src=\"/2017/10/09/201710091601/7775353d41d1249a.jpg\" alt=\"\"></p>\n</li>\n<li><p>配置实例,这里使用默认设置<br><img src=\"/2017/10/09/201710091601/6a9abbd5bcd8ae9b.jpg\" alt=\"\"></p>\n</li>\n<li><p>显示磁盘空间使用摘要<br><img src=\"/2017/10/09/201710091601/0e655e34fd585501.jpg\" alt=\"\"></p>\n</li>\n<li><p>服务配置<br>将各项启动类型改为自动,点击对所有SQLServer服务使用相同的账户<br><img src=\"/2017/10/09/201710091601/f9120d53fb7c396b.jpg\" alt=\"\"><br>选择NT AUTHORITY\\SYSTEM,确定以返回配置界面,并点击下一步<br><img src=\"/2017/10/09/201710091601/c34e5c68c50e2534.jpg\" alt=\"\"></p>\n</li>\n<li><p>账户配置<br>身份验证模式选择混合模式;<br>输入的密码为SQL Server 管理员账户sa的密码;<br>点击添加当前用户,把当前用户添加为SQL Server管理员;<br><img src=\"/2017/10/09/201710091601/eb9fae41092bd441.jpg\" alt=\"\"></p>\n</li>\n<li><p>错误报告,直接下一步<br><img src=\"/2017/10/09/201710091601/3d6c3c2b7962e631.jpg\" alt=\"\"></p>\n</li>\n<li><p>安装配置规则检查完成<br><img src=\"/2017/10/09/201710091601/e53df4dd51341905.jpg\" alt=\"\"></p>\n</li>\n<li><p>准备安装:查看安装配置信息,确认后点击安装<br><img src=\"/2017/10/09/201710091601/551b7ab676551748.jpg\" alt=\"\"></p>\n</li>\n<li><p>开始安装<br><img src=\"/2017/10/09/201710091601/fb85018c73538669.jpg\" alt=\"\"></p>\n</li>\n<li><p>安装完成<br><img src=\"/2017/10/09/201710091601/ae6370a150336ea8.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h2 id=\"4-3-配置SQLServer\"><a href=\"#4-3-配置SQLServer\" class=\"headerlink\" title=\"4.3 配置SQLServer\"></a>4.3 配置SQLServer</h2><h3 id=\"4-3-1-禁用强制密码复杂度\"><a href=\"#4-3-1-禁用强制密码复杂度\" class=\"headerlink\" title=\"4.3.1 禁用强制密码复杂度\"></a>4.3.1 禁用强制密码复杂度</h3><p>点击 “开始” -&gt;　“运行”　-&gt;　“secpol.msc”, 打开本地策略设置窗口,在 “账户策略” -&gt; “密码策略” 下,修改 “强制密码复杂度”<br><img src=\"/2017/10/09/201710091601/6e480ad0f8a2f6f8.jpg\" alt=\"\"></p>\n<h3 id=\"4-3-2-登录SQLServer\"><a href=\"#4-3-2-登录SQLServer\" class=\"headerlink\" title=\"4.3.2 登录SQLServer\"></a>4.3.2 登录SQLServer</h3><ul>\n<li><p>点击SQL Server Management Studio<br><img src=\"/2017/10/09/201710091601/0cfc23cd25d88711.jpg\" alt=\"\"></p>\n</li>\n<li><p>直接使用Windows身份验证<br><img src=\"/2017/10/09/201710091601/2354389b190af5b4.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h3 id=\"4-3-3-为Vcenter创建数据库\"><a href=\"#4-3-3-为Vcenter创建数据库\" class=\"headerlink\" title=\"4.3.3 为Vcenter创建数据库\"></a>4.3.3 为Vcenter创建数据库</h3><p>在SQLServer中新建查询<br><img src=\"/2017/10/09/201710091601/06132485ab59545a.jpg\" alt=\"\"></p>\n<p>运行以下代码<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">use [master]</div><div class=\"line\">go</div><div class=\"line\">CREATE DATABASE [VCDB] ON PRIMARY</div><div class=\"line\">(NAME = N&apos;vcdb&apos;, FILENAME = N&apos;C:\\VCDB.mdf&apos; , SIZE = 3000KB , FILEGROWTH = 10% )</div><div class=\"line\">LOG ON</div><div class=\"line\">(NAME = N&apos;vcdb_log&apos;, FILENAME = N&apos;C:\\VCDB.ldf&apos; , SIZE = 1000KB , FILEGROWTH = 10%)</div><div class=\"line\">COLLATE SQL_Latin1_General_CP1_CI_AS</div><div class=\"line\">go</div><div class=\"line\">use VCDB</div><div class=\"line\">go</div><div class=\"line\">sp_addlogin @loginame=[vpxuser], @passwd=N&apos;vpxuser&apos;, @defdb=&apos;VCDB&apos;, @deflanguage=&apos;us_english&apos;</div><div class=\"line\">go</div><div class=\"line\">ALTER LOGIN [vpxuser] WITH CHECK_POLICY = OFF</div><div class=\"line\">go</div><div class=\"line\">CREATE USER [vpxuser] for LOGIN [vpxuser]</div><div class=\"line\">go</div></pre></td></tr></table></figure></p>\n<p>再运行以下代码<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE SCHEMA [VMW]</div><div class=\"line\">go</div><div class=\"line\">ALTER USER [vpxuser] WITH DEFAULT_SCHEMA =[VMW]</div><div class=\"line\">go</div><div class=\"line\">if not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = &apos;VC_ADMIN_ROLE&apos;)</div><div class=\"line\">CREATE ROLE VC_ADMIN_ROLE;</div><div class=\"line\">GRANT ALTER ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT REFERENCES ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT INSERT ON SCHEMA ::[VMW] to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT CREATE TABLE to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT CREATE VIEW to VC_ADMIN_ROLE;</div><div class=\"line\">GRANT CREATE Procedure to VC_ADMIN_ROLE;</div><div class=\"line\">if not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = &apos;VC_USER_ROLE&apos;)</div><div class=\"line\">CREATE ROLE VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT INSERT ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT DELETE ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT UPDATE ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON SCHEMA ::[VMW] to VC_USER_ROLE</div><div class=\"line\">go</div><div class=\"line\">sp_addrolemember VC_USER_ROLE , [vpxuser]</div><div class=\"line\">go</div><div class=\"line\">sp_addrolemember VC_ADMIN_ROLE , [vpxuser]</div><div class=\"line\">go</div><div class=\"line\">use MSDB</div><div class=\"line\">go</div><div class=\"line\">if not exists (SELECT name FROM sysusers WHERE issqlrole=1 AND name = &apos;VC_ADMIN_ROLE&apos;)</div><div class=\"line\">CREATE ROLE VC_ADMIN_ROLE;</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT on msdb.dbo.syscategories to VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT on msdb.dbo.sysjobsteps to VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT SELECT ON msdb.dbo.sysjobs to VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_job TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_delete_job TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_jobstep TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_update_job TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_jobserver TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_jobschedule TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">GRANT EXECUTE ON msdb.dbo.sp_add_category TO VC_ADMIN_ROLE</div><div class=\"line\">go</div><div class=\"line\">sp_addrolemember VC_ADMIN_ROLE , [vpxuser]</div><div class=\"line\">go</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-3-4-外围应用配置\"><a href=\"#4-3-4-外围应用配置\" class=\"headerlink\" title=\"4.3.4 外围应用配置\"></a>4.3.4 外围应用配置</h3><p>选择方面<br><img src=\"/2017/10/09/201710091601/1cda4b829db27966.jpg\" alt=\"\"></p>\n<p>将”RemoteDACEnable”值改为”True”<br><img src=\"/2017/10/09/201710091601/6062c404ce14a9d1.jpg\" alt=\"\"></p>\n<h3 id=\"4-3-5-配置ODBC\"><a href=\"#4-3-5-配置ODBC\" class=\"headerlink\" title=\"4.3.5 配置ODBC\"></a>4.3.5 配置ODBC</h3><ul>\n<li><p>进入ODBC配置<br><img src=\"/2017/10/09/201710091601/339c821002d465d5.jpg\" alt=\"\"></p>\n</li>\n<li><p>选择系统DSN,点击添加<br><img src=\"/2017/10/09/201710091601/aff21e7004340e15.jpg\" alt=\"\"></p>\n</li>\n<li><p>选择SQL Server Native Client 10.0项,点击完成<br><img src=\"/2017/10/09/201710091601/8f82cb2725fa616e.jpg\" alt=\"\"></p>\n</li>\n<li><p>打开创建到SQLServer的新数据源<br>输入名称和描述,服务器填写localhost,点击下一步<br><img src=\"/2017/10/09/201710091601/d6e56c27934793e5.jpg\" alt=\"\"></p>\n</li>\n<li><p>验证方式,这里使用默认的集成Windows身份验证即可,点击下一步<br><img src=\"/2017/10/09/201710091601/5b4ae1ddf38c5bac.jpg\" alt=\"\"></p>\n</li>\n<li><p>选择数据库,将默认的数据库更改为刚才创建的数据库,点击下一步<br><img src=\"/2017/10/09/201710091601/a5e44268d9368b5e.jpg\" alt=\"\"></p>\n</li>\n<li><p>点击完成<br><img src=\"/2017/10/09/201710091601/a73157c0e03e0bef.jpg\" alt=\"\"></p>\n</li>\n<li><p>点击测试数据源<br><img src=\"/2017/10/09/201710091601/031b589e22e15416.jpg\" alt=\"\"></p>\n</li>\n<li><p>测试成功,点击确定以返回,并确定创建数据源<br><img src=\"/2017/10/09/201710091601/89d7a010bcc96bca.jpg\" alt=\"\"><br><img src=\"/2017/10/09/201710091601/63d531446c748da6.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h1 id=\"5-vCenter安装\"><a href=\"#5-vCenter安装\" class=\"headerlink\" title=\"5 vCenter安装\"></a>5 vCenter安装</h1><h2 id=\"5-1-解压并运行autorun-exe\"><a href=\"#5-1-解压并运行autorun-exe\" class=\"headerlink\" title=\"5.1 解压并运行autorun.exe\"></a>5.1 解压并运行autorun.exe</h2><h2 id=\"5-2-选择simple-install\"><a href=\"#5-2-选择simple-install\" class=\"headerlink\" title=\"5.2 选择simple install\"></a>5.2 选择simple install</h2><p><img src=\"/2017/10/09/201710091601/68b12c83fd82b947.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/2d95d2595ef8cf3b.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/b1969927bd8996fc.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/f410bb787d1fb33f.jpg\" alt=\"\"></p>\n<h2 id=\"5-3-设置vCenter登录密码\"><a href=\"#5-3-设置vCenter登录密码\" class=\"headerlink\" title=\"5.3 设置vCenter登录密码\"></a>5.3 设置vCenter登录密码</h2><p><img src=\"/2017/10/09/201710091601/ba5c85b09c522978.jpg\" alt=\"\"></p>\n<p>使用默认的站点名称<br><img src=\"/2017/10/09/201710091601/6cbc855c0e0788ca.jpg\" alt=\"\"></p>\n<h2 id=\"5-4-Simple-install端口设置\"><a href=\"#5-4-Simple-install端口设置\" class=\"headerlink\" title=\"5.4 Simple install端口设置\"></a>5.4 Simple install端口设置</h2><p>使用默认端口<br><img src=\"/2017/10/09/201710091601/b169f5c72441e23a.jpg\" alt=\"\"></p>\n<p>使用默认安装目录<br><img src=\"/2017/10/09/201710091601/873b13631b0a2d43.jpg\" alt=\"\"></p>\n<p>检查安装选项<br><img src=\"/2017/10/09/201710091601/2d6ca36262af1fb1.jpg\" alt=\"\"></p>\n<p>等待安装完成<br><img src=\"/2017/10/09/201710091601/9b3ba694564ec5f0.jpg\" alt=\"\"></p>\n<h2 id=\"5-5-输入秘钥\"><a href=\"#5-5-输入秘钥\" class=\"headerlink\" title=\"5.5 输入秘钥\"></a>5.5 输入秘钥</h2><p><img src=\"/2017/10/09/201710091601/e649a7b010a24b60.jpg\" alt=\"\"></p>\n<p>这里用注册机生成序列号即可(注意注册机只能在XP环境下运行)<br><img src=\"/2017/10/09/201710091601/f48bf0716013ac11.jpg\" alt=\"\"></p>\n<h2 id=\"5-6-配置数据库\"><a href=\"#5-6-配置数据库\" class=\"headerlink\" title=\"5.6 配置数据库\"></a>5.6 配置数据库</h2><p>选择使用现有的受支持数据库<br><img src=\"/2017/10/09/201710091601/4812df9dc90e7725.jpg\" alt=\"\"></p>\n<p>由于设置了集成Windows身份验证,这里默认即可<br><img src=\"/2017/10/09/201710091601/8f4b4c50b604bbdf.jpg\" alt=\"\"></p>\n<h2 id=\"5-7-其他配置\"><a href=\"#5-7-其他配置\" class=\"headerlink\" title=\"5.7 其他配置\"></a>5.7 其他配置</h2><ul>\n<li><p>vCenter Server服务账户信息: 这里输入服务器登录密码<br><img src=\"/2017/10/09/201710091601/b9575e72d62e7474.jpg\" alt=\"\"></p>\n</li>\n<li><p>配置端口: 这里默认即可(vCenter Server HTTP端口由于冲突改为了8080)<br><img src=\"/2017/10/09/201710091601/a2709486cef98dd9.jpg\" alt=\"\"></p>\n</li>\n<li><p>JVM内存配置: 按需选择<br><img src=\"/2017/10/09/201710091601/99c342e6c648a626.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h2 id=\"5-8-开始安装\"><a href=\"#5-8-开始安装\" class=\"headerlink\" title=\"5.8 开始安装\"></a>5.8 开始安装</h2><p><img src=\"/2017/10/09/201710091601/b1e83ae7831df206.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/ad32819d93b8330c.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/abfe4002d809a330.jpg\" alt=\"\"></p>\n<h2 id=\"5-9-使用vsphere-client连接vCenter\"><a href=\"#5-9-使用vsphere-client连接vCenter\" class=\"headerlink\" title=\"5.9 使用vsphere client连接vCenter\"></a>5.9 使用vsphere client连接vCenter</h2><p><img src=\"/2017/10/09/201710091601/f4526c5a2570e5b2.jpg\" alt=\"\"></p>\n<p><img src=\"/2017/10/09/201710091601/d547095ccdfa9a70.jpg\" alt=\"\"></p>"},{"title":"ESXi使用NAT网络","date":"2017-10-09T08:43:21.000Z","_content":"\nESXi使用NAT网络\n\n<!-- more -->\n\n# 简介\n\n由下图可知,当前主机有一个虚拟交换机vSwitch0,构成了VM Network网络,它连接到物理网卡vmnic0上,所以此主机是可以与外网联通的.可见有多台虚拟机连接到此交换机(类似vmware workstation的桥接模式),这些虚拟机都需要分配公网的IP地址才能上网,此外还有一个管理地址\n![](/ba39d3720b24a03f.jpg)\n\n但是,ESXi原生是不支持NAT模式的,下面说明如何添加NAT网络\n原理:想要使用NAT上网,我们必须要添加一个内网,比如10.10.10.*/24,然后通过路由设置(软路由)把这个网段内的请求映射到外网去\n\n# 1. 创建内网\n\n## 1.1 添加网络\n\n- 点击添加网络\n![](/42d722931576c18a.jpg)\n\n- 默认即可\n![](/5ae453ac46cb1abd.jpg)\n\n- 注意,选择创建标准交换机,但不要让它与物理网卡相关,因此去掉vmic1前面的勾\n因为我们要把这个网络的流量都转发到VM Network中,通过Vm Network出去,而不是直接通过物理网卡出去\n![](/59918027883d893c.jpg)\n\n- 命名此网络\n![](/e0099648baa42e6f.jpg)\n\n## 1.2 创建软路由\n\n软路由会连接两个网络(VM Netwok及VM NAT Network),把VM NAT Network的流量转发到VM Netwok\n\n- 这里使用pfsense(下载地址:http://pan.baidu.com/s/1dDhUNyp 密码:3mf5)\n![](/af16537d53144f5b.jpg)\n\n- 部署好之后配置网络,需要添加两张网卡,一张是VM Network,一张是VM NAT Network,注意记一下两张网卡的MAC地址\n![](/a88904ba22eff8e8.jpg)\n\n- 如图,启动pfsense后,它以识别出两个网络(但是这里的显示不一定正确,还需要手动配置),WAN表示外网绑定到了em1上,暂无IP;LAN表示内网,绑定到了em0上,自动分配了192.168.1.1的IP\n![](/f48dc945f00e213f.jpg)\n\n- 配置网卡绑定,先按1,如图,对比之前记录的MAC地址可知,em0为连接VM Network的适配器,可连接外网;em1为连接VM NAT Network的适配器,连接内网\n这里的选项是是否分配VLAN,选择n,不分配\n![](/266f5cf2a5c7db28.jpg)\n这里对应的WAN填写em0,LAN填写em1\n![](/1a594160a1ba91e0.jpg)\n这里询问是否继续,选择y保存\n![](/633b5face3642b7c.jpg)\n下面配置网卡IP,按2,进入配置界面,界面如下图所示\n![](/973098e8bf92ca7d.jpg)\n先选择1,配置WAN\n第一个是是否DHCP获取IP地址,这里选择否\n第二个是IP地址\n第三个是子网掩码\n之后按回车键即可\n![](/8f64eab0ae66fc3a.jpg)\n选择2,配置LAN\n第一个是IP地址,这里我填写的是10.10.10.1\n第二个是子网掩码,这里我填写的是24\n第三个是是否开启DHCP,这里选择n,即否\n![](/89edccb8d8efc05c.jpg)\n- 到这里pfsense就配置好了,下面我们来装一个Win7的虚拟机,来进一步配置和使用\n注意,此虚拟机的网络使用VM NAT Network适配器\n首先配置一下系统的IP地址,如图所示\n![](/0feee6754fbdf152.jpg)\n- 使用浏览器打开10.10.10.1\n账户为admin,密码为pfsense\n![](/295ffe7e24431533.jpg)\n第一次登陆会让你配置\n![](/c50e8879ac7789e9.jpg)\n这里是配置主机名和DNS,填好即可\n![](/1d6b5e876b43563e.jpg)\n这里是配置时区,可改为Asia/Chongqing\n![](/528dcf36c7d52e6e.jpg)\n这里是配置WAN口,因为我的环境是静态地址,所以选择了static,配置了IP地址和网关等,其他的可以不用写,根据你的情况来写\n![](/183e05351cd1cd68.jpg)\n这里是配置LAN口,因为之前配置好了,这里就不做更改了\n![](/b54c525c75ddad2c.jpg)\n修改admin密码\n![](/d4c4710cfbbb1b48.jpg)\nreload,要稍等一会\n![](/37bfc853a59b3cea.jpg)\n到这里配置就结束了,这时候应该可以连接外网了,可以用浏览器打开网页测试一下\n![](/9aecf98177c7cca2.jpg)\n此时主机的网络配置如下图所示:\n![](/90b48b8f16df2557.jpg)\n- pfsense这台软路由跨了两个vSwitch,它将VM NAT Network(内网)的请求转发到VM Network(外网)上,并最终走主机的物理网卡vmnic0到达互联网。以后增加新的虚拟机，只要把网络适配器连到NAT Network上,设置IP为10.10.10.*,网关10.10.10.1就可以上网了\n","source":"_posts/201710091643.md","raw":"---\ntitle: ESXi使用NAT网络\ndate: 2017-10-09 16:43:21\ntags:\n  - virtualization\n  - ESXi\n---\n\nESXi使用NAT网络\n\n<!-- more -->\n\n# 简介\n\n由下图可知,当前主机有一个虚拟交换机vSwitch0,构成了VM Network网络,它连接到物理网卡vmnic0上,所以此主机是可以与外网联通的.可见有多台虚拟机连接到此交换机(类似vmware workstation的桥接模式),这些虚拟机都需要分配公网的IP地址才能上网,此外还有一个管理地址\n![](/ba39d3720b24a03f.jpg)\n\n但是,ESXi原生是不支持NAT模式的,下面说明如何添加NAT网络\n原理:想要使用NAT上网,我们必须要添加一个内网,比如10.10.10.*/24,然后通过路由设置(软路由)把这个网段内的请求映射到外网去\n\n# 1. 创建内网\n\n## 1.1 添加网络\n\n- 点击添加网络\n![](/42d722931576c18a.jpg)\n\n- 默认即可\n![](/5ae453ac46cb1abd.jpg)\n\n- 注意,选择创建标准交换机,但不要让它与物理网卡相关,因此去掉vmic1前面的勾\n因为我们要把这个网络的流量都转发到VM Network中,通过Vm Network出去,而不是直接通过物理网卡出去\n![](/59918027883d893c.jpg)\n\n- 命名此网络\n![](/e0099648baa42e6f.jpg)\n\n## 1.2 创建软路由\n\n软路由会连接两个网络(VM Netwok及VM NAT Network),把VM NAT Network的流量转发到VM Netwok\n\n- 这里使用pfsense(下载地址:http://pan.baidu.com/s/1dDhUNyp 密码:3mf5)\n![](/af16537d53144f5b.jpg)\n\n- 部署好之后配置网络,需要添加两张网卡,一张是VM Network,一张是VM NAT Network,注意记一下两张网卡的MAC地址\n![](/a88904ba22eff8e8.jpg)\n\n- 如图,启动pfsense后,它以识别出两个网络(但是这里的显示不一定正确,还需要手动配置),WAN表示外网绑定到了em1上,暂无IP;LAN表示内网,绑定到了em0上,自动分配了192.168.1.1的IP\n![](/f48dc945f00e213f.jpg)\n\n- 配置网卡绑定,先按1,如图,对比之前记录的MAC地址可知,em0为连接VM Network的适配器,可连接外网;em1为连接VM NAT Network的适配器,连接内网\n这里的选项是是否分配VLAN,选择n,不分配\n![](/266f5cf2a5c7db28.jpg)\n这里对应的WAN填写em0,LAN填写em1\n![](/1a594160a1ba91e0.jpg)\n这里询问是否继续,选择y保存\n![](/633b5face3642b7c.jpg)\n下面配置网卡IP,按2,进入配置界面,界面如下图所示\n![](/973098e8bf92ca7d.jpg)\n先选择1,配置WAN\n第一个是是否DHCP获取IP地址,这里选择否\n第二个是IP地址\n第三个是子网掩码\n之后按回车键即可\n![](/8f64eab0ae66fc3a.jpg)\n选择2,配置LAN\n第一个是IP地址,这里我填写的是10.10.10.1\n第二个是子网掩码,这里我填写的是24\n第三个是是否开启DHCP,这里选择n,即否\n![](/89edccb8d8efc05c.jpg)\n- 到这里pfsense就配置好了,下面我们来装一个Win7的虚拟机,来进一步配置和使用\n注意,此虚拟机的网络使用VM NAT Network适配器\n首先配置一下系统的IP地址,如图所示\n![](/0feee6754fbdf152.jpg)\n- 使用浏览器打开10.10.10.1\n账户为admin,密码为pfsense\n![](/295ffe7e24431533.jpg)\n第一次登陆会让你配置\n![](/c50e8879ac7789e9.jpg)\n这里是配置主机名和DNS,填好即可\n![](/1d6b5e876b43563e.jpg)\n这里是配置时区,可改为Asia/Chongqing\n![](/528dcf36c7d52e6e.jpg)\n这里是配置WAN口,因为我的环境是静态地址,所以选择了static,配置了IP地址和网关等,其他的可以不用写,根据你的情况来写\n![](/183e05351cd1cd68.jpg)\n这里是配置LAN口,因为之前配置好了,这里就不做更改了\n![](/b54c525c75ddad2c.jpg)\n修改admin密码\n![](/d4c4710cfbbb1b48.jpg)\nreload,要稍等一会\n![](/37bfc853a59b3cea.jpg)\n到这里配置就结束了,这时候应该可以连接外网了,可以用浏览器打开网页测试一下\n![](/9aecf98177c7cca2.jpg)\n此时主机的网络配置如下图所示:\n![](/90b48b8f16df2557.jpg)\n- pfsense这台软路由跨了两个vSwitch,它将VM NAT Network(内网)的请求转发到VM Network(外网)上,并最终走主机的物理网卡vmnic0到达互联网。以后增加新的虚拟机，只要把网络适配器连到NAT Network上,设置IP为10.10.10.*,网关10.10.10.1就可以上网了\n","slug":"201710091643","published":1,"updated":"2017-10-09T09:19:21.073Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a24w0001zizpmwxpmio4","content":"<p>ESXi使用NAT网络</p>\n<a id=\"more\"></a>\n<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>由下图可知,当前主机有一个虚拟交换机vSwitch0,构成了VM Network网络,它连接到物理网卡vmnic0上,所以此主机是可以与外网联通的.可见有多台虚拟机连接到此交换机(类似vmware workstation的桥接模式),这些虚拟机都需要分配公网的IP地址才能上网,此外还有一个管理地址<br><img src=\"/2017/10/09/201710091643/ba39d3720b24a03f.jpg\" alt=\"\"></p>\n<p>但是,ESXi原生是不支持NAT模式的,下面说明如何添加NAT网络<br>原理:想要使用NAT上网,我们必须要添加一个内网,比如10.10.10.*/24,然后通过路由设置(软路由)把这个网段内的请求映射到外网去</p>\n<h1 id=\"1-创建内网\"><a href=\"#1-创建内网\" class=\"headerlink\" title=\"1. 创建内网\"></a>1. 创建内网</h1><h2 id=\"1-1-添加网络\"><a href=\"#1-1-添加网络\" class=\"headerlink\" title=\"1.1 添加网络\"></a>1.1 添加网络</h2><ul>\n<li><p>点击添加网络<br><img src=\"/2017/10/09/201710091643/42d722931576c18a.jpg\" alt=\"\"></p>\n</li>\n<li><p>默认即可<br><img src=\"/2017/10/09/201710091643/5ae453ac46cb1abd.jpg\" alt=\"\"></p>\n</li>\n<li><p>注意,选择创建标准交换机,但不要让它与物理网卡相关,因此去掉vmic1前面的勾<br>因为我们要把这个网络的流量都转发到VM Network中,通过Vm Network出去,而不是直接通过物理网卡出去<br><img src=\"/2017/10/09/201710091643/59918027883d893c.jpg\" alt=\"\"></p>\n</li>\n<li><p>命名此网络<br><img src=\"/2017/10/09/201710091643/e0099648baa42e6f.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h2 id=\"1-2-创建软路由\"><a href=\"#1-2-创建软路由\" class=\"headerlink\" title=\"1.2 创建软路由\"></a>1.2 创建软路由</h2><p>软路由会连接两个网络(VM Netwok及VM NAT Network),把VM NAT Network的流量转发到VM Netwok</p>\n<ul>\n<li><p>这里使用pfsense(下载地址:<a href=\"http://pan.baidu.com/s/1dDhUNyp\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1dDhUNyp</a> 密码:3mf5)<br><img src=\"/2017/10/09/201710091643/af16537d53144f5b.jpg\" alt=\"\"></p>\n</li>\n<li><p>部署好之后配置网络,需要添加两张网卡,一张是VM Network,一张是VM NAT Network,注意记一下两张网卡的MAC地址<br><img src=\"/2017/10/09/201710091643/a88904ba22eff8e8.jpg\" alt=\"\"></p>\n</li>\n<li><p>如图,启动pfsense后,它以识别出两个网络(但是这里的显示不一定正确,还需要手动配置),WAN表示外网绑定到了em1上,暂无IP;LAN表示内网,绑定到了em0上,自动分配了192.168.1.1的IP<br><img src=\"/2017/10/09/201710091643/f48dc945f00e213f.jpg\" alt=\"\"></p>\n</li>\n<li><p>配置网卡绑定,先按1,如图,对比之前记录的MAC地址可知,em0为连接VM Network的适配器,可连接外网;em1为连接VM NAT Network的适配器,连接内网<br>这里的选项是是否分配VLAN,选择n,不分配<br><img src=\"/2017/10/09/201710091643/266f5cf2a5c7db28.jpg\" alt=\"\"><br>这里对应的WAN填写em0,LAN填写em1<br><img src=\"/2017/10/09/201710091643/1a594160a1ba91e0.jpg\" alt=\"\"><br>这里询问是否继续,选择y保存<br><img src=\"/2017/10/09/201710091643/633b5face3642b7c.jpg\" alt=\"\"><br>下面配置网卡IP,按2,进入配置界面,界面如下图所示<br><img src=\"/2017/10/09/201710091643/973098e8bf92ca7d.jpg\" alt=\"\"><br>先选择1,配置WAN<br>第一个是是否DHCP获取IP地址,这里选择否<br>第二个是IP地址<br>第三个是子网掩码<br>之后按回车键即可<br><img src=\"/2017/10/09/201710091643/8f64eab0ae66fc3a.jpg\" alt=\"\"><br>选择2,配置LAN<br>第一个是IP地址,这里我填写的是10.10.10.1<br>第二个是子网掩码,这里我填写的是24<br>第三个是是否开启DHCP,这里选择n,即否<br><img src=\"/2017/10/09/201710091643/89edccb8d8efc05c.jpg\" alt=\"\"></p>\n</li>\n<li>到这里pfsense就配置好了,下面我们来装一个Win7的虚拟机,来进一步配置和使用<br>注意,此虚拟机的网络使用VM NAT Network适配器<br>首先配置一下系统的IP地址,如图所示<br><img src=\"/2017/10/09/201710091643/0feee6754fbdf152.jpg\" alt=\"\"></li>\n<li>使用浏览器打开10.10.10.1<br>账户为admin,密码为pfsense<br><img src=\"/2017/10/09/201710091643/295ffe7e24431533.jpg\" alt=\"\"><br>第一次登陆会让你配置<br><img src=\"/2017/10/09/201710091643/c50e8879ac7789e9.jpg\" alt=\"\"><br>这里是配置主机名和DNS,填好即可<br><img src=\"/2017/10/09/201710091643/1d6b5e876b43563e.jpg\" alt=\"\"><br>这里是配置时区,可改为Asia/Chongqing<br><img src=\"/2017/10/09/201710091643/528dcf36c7d52e6e.jpg\" alt=\"\"><br>这里是配置WAN口,因为我的环境是静态地址,所以选择了static,配置了IP地址和网关等,其他的可以不用写,根据你的情况来写<br><img src=\"/2017/10/09/201710091643/183e05351cd1cd68.jpg\" alt=\"\"><br>这里是配置LAN口,因为之前配置好了,这里就不做更改了<br><img src=\"/2017/10/09/201710091643/b54c525c75ddad2c.jpg\" alt=\"\"><br>修改admin密码<br><img src=\"/2017/10/09/201710091643/d4c4710cfbbb1b48.jpg\" alt=\"\"><br>reload,要稍等一会<br><img src=\"/2017/10/09/201710091643/37bfc853a59b3cea.jpg\" alt=\"\"><br>到这里配置就结束了,这时候应该可以连接外网了,可以用浏览器打开网页测试一下<br><img src=\"/2017/10/09/201710091643/9aecf98177c7cca2.jpg\" alt=\"\"><br>此时主机的网络配置如下图所示:<br><img src=\"/2017/10/09/201710091643/90b48b8f16df2557.jpg\" alt=\"\"></li>\n<li>pfsense这台软路由跨了两个vSwitch,它将VM NAT Network(内网)的请求转发到VM Network(外网)上,并最终走主机的物理网卡vmnic0到达互联网。以后增加新的虚拟机，只要把网络适配器连到NAT Network上,设置IP为10.10.10.*,网关10.10.10.1就可以上网了</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>ESXi使用NAT网络</p>","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>由下图可知,当前主机有一个虚拟交换机vSwitch0,构成了VM Network网络,它连接到物理网卡vmnic0上,所以此主机是可以与外网联通的.可见有多台虚拟机连接到此交换机(类似vmware workstation的桥接模式),这些虚拟机都需要分配公网的IP地址才能上网,此外还有一个管理地址<br><img src=\"/2017/10/09/201710091643/ba39d3720b24a03f.jpg\" alt=\"\"></p>\n<p>但是,ESXi原生是不支持NAT模式的,下面说明如何添加NAT网络<br>原理:想要使用NAT上网,我们必须要添加一个内网,比如10.10.10.*/24,然后通过路由设置(软路由)把这个网段内的请求映射到外网去</p>\n<h1 id=\"1-创建内网\"><a href=\"#1-创建内网\" class=\"headerlink\" title=\"1. 创建内网\"></a>1. 创建内网</h1><h2 id=\"1-1-添加网络\"><a href=\"#1-1-添加网络\" class=\"headerlink\" title=\"1.1 添加网络\"></a>1.1 添加网络</h2><ul>\n<li><p>点击添加网络<br><img src=\"/2017/10/09/201710091643/42d722931576c18a.jpg\" alt=\"\"></p>\n</li>\n<li><p>默认即可<br><img src=\"/2017/10/09/201710091643/5ae453ac46cb1abd.jpg\" alt=\"\"></p>\n</li>\n<li><p>注意,选择创建标准交换机,但不要让它与物理网卡相关,因此去掉vmic1前面的勾<br>因为我们要把这个网络的流量都转发到VM Network中,通过Vm Network出去,而不是直接通过物理网卡出去<br><img src=\"/2017/10/09/201710091643/59918027883d893c.jpg\" alt=\"\"></p>\n</li>\n<li><p>命名此网络<br><img src=\"/2017/10/09/201710091643/e0099648baa42e6f.jpg\" alt=\"\"></p>\n</li>\n</ul>\n<h2 id=\"1-2-创建软路由\"><a href=\"#1-2-创建软路由\" class=\"headerlink\" title=\"1.2 创建软路由\"></a>1.2 创建软路由</h2><p>软路由会连接两个网络(VM Netwok及VM NAT Network),把VM NAT Network的流量转发到VM Netwok</p>\n<ul>\n<li><p>这里使用pfsense(下载地址:<a href=\"http://pan.baidu.com/s/1dDhUNyp\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1dDhUNyp</a> 密码:3mf5)<br><img src=\"/2017/10/09/201710091643/af16537d53144f5b.jpg\" alt=\"\"></p>\n</li>\n<li><p>部署好之后配置网络,需要添加两张网卡,一张是VM Network,一张是VM NAT Network,注意记一下两张网卡的MAC地址<br><img src=\"/2017/10/09/201710091643/a88904ba22eff8e8.jpg\" alt=\"\"></p>\n</li>\n<li><p>如图,启动pfsense后,它以识别出两个网络(但是这里的显示不一定正确,还需要手动配置),WAN表示外网绑定到了em1上,暂无IP;LAN表示内网,绑定到了em0上,自动分配了192.168.1.1的IP<br><img src=\"/2017/10/09/201710091643/f48dc945f00e213f.jpg\" alt=\"\"></p>\n</li>\n<li><p>配置网卡绑定,先按1,如图,对比之前记录的MAC地址可知,em0为连接VM Network的适配器,可连接外网;em1为连接VM NAT Network的适配器,连接内网<br>这里的选项是是否分配VLAN,选择n,不分配<br><img src=\"/2017/10/09/201710091643/266f5cf2a5c7db28.jpg\" alt=\"\"><br>这里对应的WAN填写em0,LAN填写em1<br><img src=\"/2017/10/09/201710091643/1a594160a1ba91e0.jpg\" alt=\"\"><br>这里询问是否继续,选择y保存<br><img src=\"/2017/10/09/201710091643/633b5face3642b7c.jpg\" alt=\"\"><br>下面配置网卡IP,按2,进入配置界面,界面如下图所示<br><img src=\"/2017/10/09/201710091643/973098e8bf92ca7d.jpg\" alt=\"\"><br>先选择1,配置WAN<br>第一个是是否DHCP获取IP地址,这里选择否<br>第二个是IP地址<br>第三个是子网掩码<br>之后按回车键即可<br><img src=\"/2017/10/09/201710091643/8f64eab0ae66fc3a.jpg\" alt=\"\"><br>选择2,配置LAN<br>第一个是IP地址,这里我填写的是10.10.10.1<br>第二个是子网掩码,这里我填写的是24<br>第三个是是否开启DHCP,这里选择n,即否<br><img src=\"/2017/10/09/201710091643/89edccb8d8efc05c.jpg\" alt=\"\"></p>\n</li>\n<li>到这里pfsense就配置好了,下面我们来装一个Win7的虚拟机,来进一步配置和使用<br>注意,此虚拟机的网络使用VM NAT Network适配器<br>首先配置一下系统的IP地址,如图所示<br><img src=\"/2017/10/09/201710091643/0feee6754fbdf152.jpg\" alt=\"\"></li>\n<li>使用浏览器打开10.10.10.1<br>账户为admin,密码为pfsense<br><img src=\"/2017/10/09/201710091643/295ffe7e24431533.jpg\" alt=\"\"><br>第一次登陆会让你配置<br><img src=\"/2017/10/09/201710091643/c50e8879ac7789e9.jpg\" alt=\"\"><br>这里是配置主机名和DNS,填好即可<br><img src=\"/2017/10/09/201710091643/1d6b5e876b43563e.jpg\" alt=\"\"><br>这里是配置时区,可改为Asia/Chongqing<br><img src=\"/2017/10/09/201710091643/528dcf36c7d52e6e.jpg\" alt=\"\"><br>这里是配置WAN口,因为我的环境是静态地址,所以选择了static,配置了IP地址和网关等,其他的可以不用写,根据你的情况来写<br><img src=\"/2017/10/09/201710091643/183e05351cd1cd68.jpg\" alt=\"\"><br>这里是配置LAN口,因为之前配置好了,这里就不做更改了<br><img src=\"/2017/10/09/201710091643/b54c525c75ddad2c.jpg\" alt=\"\"><br>修改admin密码<br><img src=\"/2017/10/09/201710091643/d4c4710cfbbb1b48.jpg\" alt=\"\"><br>reload,要稍等一会<br><img src=\"/2017/10/09/201710091643/37bfc853a59b3cea.jpg\" alt=\"\"><br>到这里配置就结束了,这时候应该可以连接外网了,可以用浏览器打开网页测试一下<br><img src=\"/2017/10/09/201710091643/9aecf98177c7cca2.jpg\" alt=\"\"><br>此时主机的网络配置如下图所示:<br><img src=\"/2017/10/09/201710091643/90b48b8f16df2557.jpg\" alt=\"\"></li>\n<li>pfsense这台软路由跨了两个vSwitch,它将VM NAT Network(内网)的请求转发到VM Network(外网)上,并最终走主机的物理网卡vmnic0到达互联网。以后增加新的虚拟机，只要把网络适配器连到NAT Network上,设置IP为10.10.10.*,网关10.10.10.1就可以上网了</li>\n</ul>"},{"title":"Archlinux thunar 无权限挂载本地磁盘","date":"2017-10-09T09:01:18.000Z","_content":"\n\n使用thunar挂载时会出现'Failed to mount \"LocalDisk\". Authentication is required'\n\n<!-- more -->\n\n编辑文件/usr/share/polkit-1/actions/org.freedesktop.UDisks2.policy\n\n修改\n\n> &lt;action id=\"org.freedesktop.udisks2.filesystem-mount\">\n> ...\n> &lt;defaults>\n>   &lt;allow_any>auth_admin&lt;/allow_any>\n>   &lt;allow_inactive>auth_admin&lt;/allow_inactive>\n>   &lt;allow_active>yes&lt;/allow_active>\n> &lt;/defaults>\n> ...\n> <br>\n> \n> &lt;action id=\"org.freedesktop.udisks2.filesystem-mount-system\">\n> ...\n> &lt;defaults>\n>   &lt;allow_any>auth_admin&lt;/allow_any>\n>   &lt;allow_inactive>auth_admin&lt;/allow_inactive>\n>   &lt;allow_active>yes&lt;/allow_active>\n> &lt;/defaults>\n> ...\n","source":"_posts/201710091701.md","raw":"---\ntitle: Archlinux thunar 无权限挂载本地磁盘\ndate: 2017-10-09 17:01:18\ntags:\n  - linux\n  - other\n---\n\n\n使用thunar挂载时会出现'Failed to mount \"LocalDisk\". Authentication is required'\n\n<!-- more -->\n\n编辑文件/usr/share/polkit-1/actions/org.freedesktop.UDisks2.policy\n\n修改\n\n> &lt;action id=\"org.freedesktop.udisks2.filesystem-mount\">\n> ...\n> &lt;defaults>\n>   &lt;allow_any>auth_admin&lt;/allow_any>\n>   &lt;allow_inactive>auth_admin&lt;/allow_inactive>\n>   &lt;allow_active>yes&lt;/allow_active>\n> &lt;/defaults>\n> ...\n> <br>\n> \n> &lt;action id=\"org.freedesktop.udisks2.filesystem-mount-system\">\n> ...\n> &lt;defaults>\n>   &lt;allow_any>auth_admin&lt;/allow_any>\n>   &lt;allow_inactive>auth_admin&lt;/allow_inactive>\n>   &lt;allow_active>yes&lt;/allow_active>\n> &lt;/defaults>\n> ...\n","slug":"201710091701","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a2500003zizp2431a05b","content":"<p>使用thunar挂载时会出现’Failed to mount “LocalDisk”. Authentication is required’</p>\n<a id=\"more\"></a>\n<p>编辑文件/usr/share/polkit-1/actions/org.freedesktop.UDisks2.policy</p>\n<p>修改</p>\n<blockquote>\n<p>&lt;action id=”org.freedesktop.udisks2.filesystem-mount”&gt;<br>…<br>&lt;defaults&gt;<br>  &lt;allow_any&gt;auth_admin&lt;/allow_any&gt;<br>  &lt;allow_inactive&gt;auth_admin&lt;/allow_inactive&gt;<br>  &lt;allow_active&gt;yes&lt;/allow_active&gt;<br>&lt;/defaults&gt;<br>…<br><br></p>\n<p>&lt;action id=”org.freedesktop.udisks2.filesystem-mount-system”&gt;<br>…<br>&lt;defaults&gt;<br>  &lt;allow_any&gt;auth_admin&lt;/allow_any&gt;<br>  &lt;allow_inactive&gt;auth_admin&lt;/allow_inactive&gt;<br>  &lt;allow_active&gt;yes&lt;/allow_active&gt;<br>&lt;/defaults&gt;<br>…</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<p>使用thunar挂载时会出现’Failed to mount “LocalDisk”. Authentication is required’</p>","more":"<p>编辑文件/usr/share/polkit-1/actions/org.freedesktop.UDisks2.policy</p>\n<p>修改</p>\n<blockquote>\n<p>&lt;action id=”org.freedesktop.udisks2.filesystem-mount”&gt;<br>…<br>&lt;defaults&gt;<br>  &lt;allow_any&gt;auth_admin&lt;/allow_any&gt;<br>  &lt;allow_inactive&gt;auth_admin&lt;/allow_inactive&gt;<br>  &lt;allow_active&gt;yes&lt;/allow_active&gt;<br>&lt;/defaults&gt;<br>…<br><br></p>\n<p>&lt;action id=”org.freedesktop.udisks2.filesystem-mount-system”&gt;<br>…<br>&lt;defaults&gt;<br>  &lt;allow_any&gt;auth_admin&lt;/allow_any&gt;<br>  &lt;allow_inactive&gt;auth_admin&lt;/allow_inactive&gt;<br>  &lt;allow_active&gt;yes&lt;/allow_active&gt;<br>&lt;/defaults&gt;<br>…</p>\n</blockquote>"},{"title":"Linux搭建leanote服务器并配置SSL","date":"2017-10-09T09:03:22.000Z","_content":"\nLinux搭建leanote服务器并配置SSL\n\n<!-- more -->\n\n## 本教程适合 Mac 及 linux 用户的**二进制版**安装。\n\n- Mac,Linux 用户的源码版安装,参见[这里](https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Mac-and-Linux)。\n- Windows 用户的二进制版安装,参见[这里](https://github.com/leanote/leanote/wiki/Leanote-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows)。\n- Windows 用户的源码版安装,参见[这里](https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows)。\n\n----------------------------------\n# 安装步骤:\n\n1. 下载 `leanote` 二进制版。\n2. 安装 `mongodb`。\n3. 导入初始数据。\n4. 配置 `leanote`。\n5. 运行 `leanote`。\n\n\n----------------------------\n# 1. 下载 `leanote` 二进制版\n\n由此处下载 [leanote 最新二进制版](http://leanote.org/#download)。\n\n假设将文件下载到 `/home/ya/note` 目录下,解压文件从而在 `/home/ya/note` 目录下生成 `leanote`目录：\n```\ncd /home/ya/note\ntar -xzvf leanote-darwin-amd64.v2.0.bin.tar.gz\n```\n\n----------------------------\n# 2. 安装 `mongodb`\n\n## 2.1 安装 `mongodb`\n\n### 2.1.1 源码安装\n\n到 [mongodb 官网](http://www.mongodb.org/downloads) 下载相应系统的最新版安装包,或者从以下链接下载旧版本：\n\n* 64位 linux mongodb 3.0.1 下载链接: https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.1.tgz\n\n下载到 `/home/ya/note`下,直接解压即可:\n```\ncd /home/ya/note\ntar -xzvf mongodb-linux-x86_64-3.0.1.tgz/\n```\n\n为了快速使用`mongodb`命令,可以配置环境变量。编辑 `~/.profile`或`/etc/profile` 文件,将`mongodb/bin`路径加入即可:\n```\nsudo vim /etc/profile\n```\n此处实例使用了`vim`文本编辑器,你可以使用自己熟悉的编辑器。\n\n在`/etc/profile`中添加以下行,注意把用户名（`ya/note`）和相应的文件目录名（`mongodb-linux-x86_64-3.0.1`）替换成自己系统中的名称：\n```\nexport PATH=$PATH:/home/ya/note/mongodb-linux-x86_64-3.0.1/bin\n```\n\n保存修改后,在终端运行以下命令使环境变量生效:\n```\nsource /etc/profile\n```\n\n### 2.1.2 从源安装\n\n``` bash\nsudo pacman -S mongodb mongodb-tools\n```\n\n## 2.2 测试`mongodb`安装\n\n先在`/home/ya/note`下新建一个目录`data`存放`mongodb`数据:\n```\nmkdir /home/ya/note/data\n```\n\n用以下命令启动`mongod`:\n```\nmongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth \n```\n\n这时`mongod`已经启动,重新打开一个终端,键入`mongo`进入交互程序：\n```\nmongo\n> show dbs\n...数据库列表\n```\n\n`mongodb`安装到此为止,下面为`mongodb`导入`leanote`初始数据。\n\n\n-------------------------------------\n\n# 3. 初始化数据库\n\n## 3.1 导入数据\n`leanote`初始数据存放在 `/home/ya/note/leanote/mongodb_backup/leanote_install_data`中。\n\n打开终端,输入以下命令导入数据。\n\n```\nmongorestore -h localhost -d leanote --dir /home/ya/note/leanote/mongodb_backup/leanote_install_data/\n```\n\n现在在`mongodb`中已经新建了`leanote`数据库,可用命令查看下`leanote`有多少张\"表\":\n```\nmongo\n> show dbs #　查看数据库\nleanote\t0.203125GB\nlocal\t0.078125GB\n> use leanote # 切换到leanote\nswitched to db leanote\n> show collections # 查看表\nfiles\nhas_share_notes\nnote_content_histories\nnote_contents\n....\n```\n\n初始数据的`users`表中已有2个用户:\n```\nya/note username: admin,password: abc123 (管理员,只有该用户才有权管理后台,请及时修改密码)\nuser2 username: demo@leanote.com,password: demo@leanote.com (仅供体验使用)\n```\n\n## 3.2 为mongodb数据库添加用户\n\n像mysql一样有root用户,mongodb初始是没有用户的,这样很不安全,所以要为leanote数据库新建一个用户来连接leanote数据库(注意,并不是为leanote的表users里新建用户,而是新建一个连接leanote数据库的用户,类似mysql的root用户).\n\nmognodb v2与v3创建用户命令有所不同\n\nmongodb v2 创建用户如下:\n```\n# 首先切换到leanote数据库下\n> use leanote;\n# 添加一个用户root,密码是abc123\n> db.addUser(\"root\",\"abc123\");\n{\n\t\"_id\" : ObjectId(\"53688d1950cc1813efb9564c\"),\n\t\"user\" : \"root\",\n\t\"readOnly\" : false,\n\t\"pwd\" : \"e014bfea4a9c3c27ab34e50bd1ef0955\"\n}\n# 测试下是否正确\n> db.auth(\"root\",\"abc123\");\n1 # 返回1表示正确\n```\nmongodb v3 创建用户如下:\n```\n# 首先切换到leanote数据库下\n> use leanote;\n# 添加一个用户root,密码是abc123\n> db.createUser({\n    user: 'root',\n    pwd: 'abc123',\n    roles: [{role: 'dbOwner',db: 'leanote'}]\n});\n# 测试下是否正确\n> db.auth(\"root\",\"abc123\");\n1 # 返回1表示正确\n```\n\n用户添加好后重新运行下mongodb,并开启权限验证. 在mongod的终端按ctrl+c即可退出mongodb.\n\n启动mongodb:\n```\nmongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth\n```\n\n-----------------------------------\n# 4. 配置`leanote`\n\n`leanote`的配置存储在文件 `conf/app.conf` 中\n\n请务必修改`app.secret`一项,在若干个随机位置处,将字符修改成一个其他的值,否则会有安全隐患\n这里顺便贴出部分配置\n```\nhttp.port=9000\n\nsite.url=https://localhost:1443 # or http://x.com:8080,http://www.xx.com:9000\n\n# admin username\nadminUsername=admin\n\n# mongdb\ndb.host=127.0.0.1\ndb.port=27016\ndb.dbname=leanote # required\ndb.username=root # if not exists,please leave it blank\ndb.password=abc123/ # if not exists,please leave it blank\n```\n\n---------------------------------\n# 5. 运行`leanote`\n\n**注意:** 在此之前请确保`mongodb`已在运行!\n\n新开一个窗口,运行:\n```\ncd /home/ya/note/leanote/bin\nbash run.sh\n```\n\n最后出现以下信息证明运行成功:\n```\n...\nTRACE 2013/06/06 15:01:27 watcher.go:72: Watching: /home/life/leanote/bin/src/github.com/leanote/leanote/conf/routes\nGo to /@tests to run the tests.\nListening on :9000...\n```\n\n恭喜你,打开浏览器输入: `http://localhost:9000` 体验`leanote`吧!\n\n---------------------------------\n# 6 配置SSL证书\n\n## 6.1 使用Let's Encrypt\n\n- 通过[sslforfree](https://www.sslforfree.com/)申请证书\n- 将证书放在`/home/ya/note/cert/`中\n\n## 6.2 配置Nginx\n\n假设Leanote运行的端口是9000,域名为gx.littleya.com,那么nginx.conf可以配置如下:\n```\n# 本配置只有http部分,不全\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n   #access_log  logs/access.log  main;\n\n    upstream gx.littleya.com {\n\t    server localhost:9000;\n    }\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       1080;\n        server_name  gx.littleya.com;\n\n        #charset koi8-r;\n        # 强制https\n        # 如果不需要,请注释这一行rewrite\n\t    rewrite ^/(.*) https://gx.littleya.com:1443/$1 permanent;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n\t\tproxy_pass        http://gx.littleya.com;\n\t\tproxy_set_header   Host             $host;\n\t\tproxy_set_header   X-Real-IP        $remote_addr;\n\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   /usr/share/nginx/html;\n        }\n    }\n\n    # HTTPS server\n    #\n    server {\n        listen       1443 ssl;\n        server_name  gx.littleya.com;\n\n        ssl_certificate      /home/ya/note/cert/gx.littleya.com.crt;\n        ssl_certificate_key  /home/ya/note/cert/gx.littleya.com.key;\n\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n\n        location / {\n\t\tproxy_pass        http://gx.littleya.com;\n\t\tproxy_set_header   Host             $host;\n\t\tproxy_set_header   X-Real-IP        $remote_addr;\n\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n    }\n\n}\n```","source":"_posts/201710091703.md","raw":"---\ntitle: Linux搭建leanote服务器并配置SSL\ndate: 2017-10-09 17:03:22\ntags:\n  - linux\n  - other\n---\n\nLinux搭建leanote服务器并配置SSL\n\n<!-- more -->\n\n## 本教程适合 Mac 及 linux 用户的**二进制版**安装。\n\n- Mac,Linux 用户的源码版安装,参见[这里](https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Mac-and-Linux)。\n- Windows 用户的二进制版安装,参见[这里](https://github.com/leanote/leanote/wiki/Leanote-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows)。\n- Windows 用户的源码版安装,参见[这里](https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows)。\n\n----------------------------------\n# 安装步骤:\n\n1. 下载 `leanote` 二进制版。\n2. 安装 `mongodb`。\n3. 导入初始数据。\n4. 配置 `leanote`。\n5. 运行 `leanote`。\n\n\n----------------------------\n# 1. 下载 `leanote` 二进制版\n\n由此处下载 [leanote 最新二进制版](http://leanote.org/#download)。\n\n假设将文件下载到 `/home/ya/note` 目录下,解压文件从而在 `/home/ya/note` 目录下生成 `leanote`目录：\n```\ncd /home/ya/note\ntar -xzvf leanote-darwin-amd64.v2.0.bin.tar.gz\n```\n\n----------------------------\n# 2. 安装 `mongodb`\n\n## 2.1 安装 `mongodb`\n\n### 2.1.1 源码安装\n\n到 [mongodb 官网](http://www.mongodb.org/downloads) 下载相应系统的最新版安装包,或者从以下链接下载旧版本：\n\n* 64位 linux mongodb 3.0.1 下载链接: https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.1.tgz\n\n下载到 `/home/ya/note`下,直接解压即可:\n```\ncd /home/ya/note\ntar -xzvf mongodb-linux-x86_64-3.0.1.tgz/\n```\n\n为了快速使用`mongodb`命令,可以配置环境变量。编辑 `~/.profile`或`/etc/profile` 文件,将`mongodb/bin`路径加入即可:\n```\nsudo vim /etc/profile\n```\n此处实例使用了`vim`文本编辑器,你可以使用自己熟悉的编辑器。\n\n在`/etc/profile`中添加以下行,注意把用户名（`ya/note`）和相应的文件目录名（`mongodb-linux-x86_64-3.0.1`）替换成自己系统中的名称：\n```\nexport PATH=$PATH:/home/ya/note/mongodb-linux-x86_64-3.0.1/bin\n```\n\n保存修改后,在终端运行以下命令使环境变量生效:\n```\nsource /etc/profile\n```\n\n### 2.1.2 从源安装\n\n``` bash\nsudo pacman -S mongodb mongodb-tools\n```\n\n## 2.2 测试`mongodb`安装\n\n先在`/home/ya/note`下新建一个目录`data`存放`mongodb`数据:\n```\nmkdir /home/ya/note/data\n```\n\n用以下命令启动`mongod`:\n```\nmongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth \n```\n\n这时`mongod`已经启动,重新打开一个终端,键入`mongo`进入交互程序：\n```\nmongo\n> show dbs\n...数据库列表\n```\n\n`mongodb`安装到此为止,下面为`mongodb`导入`leanote`初始数据。\n\n\n-------------------------------------\n\n# 3. 初始化数据库\n\n## 3.1 导入数据\n`leanote`初始数据存放在 `/home/ya/note/leanote/mongodb_backup/leanote_install_data`中。\n\n打开终端,输入以下命令导入数据。\n\n```\nmongorestore -h localhost -d leanote --dir /home/ya/note/leanote/mongodb_backup/leanote_install_data/\n```\n\n现在在`mongodb`中已经新建了`leanote`数据库,可用命令查看下`leanote`有多少张\"表\":\n```\nmongo\n> show dbs #　查看数据库\nleanote\t0.203125GB\nlocal\t0.078125GB\n> use leanote # 切换到leanote\nswitched to db leanote\n> show collections # 查看表\nfiles\nhas_share_notes\nnote_content_histories\nnote_contents\n....\n```\n\n初始数据的`users`表中已有2个用户:\n```\nya/note username: admin,password: abc123 (管理员,只有该用户才有权管理后台,请及时修改密码)\nuser2 username: demo@leanote.com,password: demo@leanote.com (仅供体验使用)\n```\n\n## 3.2 为mongodb数据库添加用户\n\n像mysql一样有root用户,mongodb初始是没有用户的,这样很不安全,所以要为leanote数据库新建一个用户来连接leanote数据库(注意,并不是为leanote的表users里新建用户,而是新建一个连接leanote数据库的用户,类似mysql的root用户).\n\nmognodb v2与v3创建用户命令有所不同\n\nmongodb v2 创建用户如下:\n```\n# 首先切换到leanote数据库下\n> use leanote;\n# 添加一个用户root,密码是abc123\n> db.addUser(\"root\",\"abc123\");\n{\n\t\"_id\" : ObjectId(\"53688d1950cc1813efb9564c\"),\n\t\"user\" : \"root\",\n\t\"readOnly\" : false,\n\t\"pwd\" : \"e014bfea4a9c3c27ab34e50bd1ef0955\"\n}\n# 测试下是否正确\n> db.auth(\"root\",\"abc123\");\n1 # 返回1表示正确\n```\nmongodb v3 创建用户如下:\n```\n# 首先切换到leanote数据库下\n> use leanote;\n# 添加一个用户root,密码是abc123\n> db.createUser({\n    user: 'root',\n    pwd: 'abc123',\n    roles: [{role: 'dbOwner',db: 'leanote'}]\n});\n# 测试下是否正确\n> db.auth(\"root\",\"abc123\");\n1 # 返回1表示正确\n```\n\n用户添加好后重新运行下mongodb,并开启权限验证. 在mongod的终端按ctrl+c即可退出mongodb.\n\n启动mongodb:\n```\nmongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth\n```\n\n-----------------------------------\n# 4. 配置`leanote`\n\n`leanote`的配置存储在文件 `conf/app.conf` 中\n\n请务必修改`app.secret`一项,在若干个随机位置处,将字符修改成一个其他的值,否则会有安全隐患\n这里顺便贴出部分配置\n```\nhttp.port=9000\n\nsite.url=https://localhost:1443 # or http://x.com:8080,http://www.xx.com:9000\n\n# admin username\nadminUsername=admin\n\n# mongdb\ndb.host=127.0.0.1\ndb.port=27016\ndb.dbname=leanote # required\ndb.username=root # if not exists,please leave it blank\ndb.password=abc123/ # if not exists,please leave it blank\n```\n\n---------------------------------\n# 5. 运行`leanote`\n\n**注意:** 在此之前请确保`mongodb`已在运行!\n\n新开一个窗口,运行:\n```\ncd /home/ya/note/leanote/bin\nbash run.sh\n```\n\n最后出现以下信息证明运行成功:\n```\n...\nTRACE 2013/06/06 15:01:27 watcher.go:72: Watching: /home/life/leanote/bin/src/github.com/leanote/leanote/conf/routes\nGo to /@tests to run the tests.\nListening on :9000...\n```\n\n恭喜你,打开浏览器输入: `http://localhost:9000` 体验`leanote`吧!\n\n---------------------------------\n# 6 配置SSL证书\n\n## 6.1 使用Let's Encrypt\n\n- 通过[sslforfree](https://www.sslforfree.com/)申请证书\n- 将证书放在`/home/ya/note/cert/`中\n\n## 6.2 配置Nginx\n\n假设Leanote运行的端口是9000,域名为gx.littleya.com,那么nginx.conf可以配置如下:\n```\n# 本配置只有http部分,不全\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n   #access_log  logs/access.log  main;\n\n    upstream gx.littleya.com {\n\t    server localhost:9000;\n    }\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       1080;\n        server_name  gx.littleya.com;\n\n        #charset koi8-r;\n        # 强制https\n        # 如果不需要,请注释这一行rewrite\n\t    rewrite ^/(.*) https://gx.littleya.com:1443/$1 permanent;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n\t\tproxy_pass        http://gx.littleya.com;\n\t\tproxy_set_header   Host             $host;\n\t\tproxy_set_header   X-Real-IP        $remote_addr;\n\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   /usr/share/nginx/html;\n        }\n    }\n\n    # HTTPS server\n    #\n    server {\n        listen       1443 ssl;\n        server_name  gx.littleya.com;\n\n        ssl_certificate      /home/ya/note/cert/gx.littleya.com.crt;\n        ssl_certificate_key  /home/ya/note/cert/gx.littleya.com.key;\n\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n\n        location / {\n\t\tproxy_pass        http://gx.littleya.com;\n\t\tproxy_set_header   Host             $host;\n\t\tproxy_set_header   X-Real-IP        $remote_addr;\n\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n    }\n\n}\n```","slug":"201710091703","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a2530004zizpbersf4t5","content":"<p>Linux搭建leanote服务器并配置SSL</p>\n<a id=\"more\"></a>\n<h2 id=\"本教程适合-Mac-及-linux-用户的二进制版安装。\"><a href=\"#本教程适合-Mac-及-linux-用户的二进制版安装。\" class=\"headerlink\" title=\"本教程适合 Mac 及 linux 用户的二进制版安装。\"></a>本教程适合 Mac 及 linux 用户的<strong>二进制版</strong>安装。</h2><ul>\n<li>Mac,Linux 用户的源码版安装,参见<a href=\"https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Mac-and-Linux\" target=\"_blank\" rel=\"external\">这里</a>。</li>\n<li>Windows 用户的二进制版安装,参见<a href=\"https://github.com/leanote/leanote/wiki/Leanote-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows\" target=\"_blank\" rel=\"external\">这里</a>。</li>\n<li>Windows 用户的源码版安装,参见<a href=\"https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows\" target=\"_blank\" rel=\"external\">这里</a>。</li>\n</ul>\n<hr>\n<h1 id=\"安装步骤\"><a href=\"#安装步骤\" class=\"headerlink\" title=\"安装步骤:\"></a>安装步骤:</h1><ol>\n<li>下载 <code>leanote</code> 二进制版。</li>\n<li>安装 <code>mongodb</code>。</li>\n<li>导入初始数据。</li>\n<li>配置 <code>leanote</code>。</li>\n<li>运行 <code>leanote</code>。</li>\n</ol>\n<hr>\n<h1 id=\"1-下载-leanote-二进制版\"><a href=\"#1-下载-leanote-二进制版\" class=\"headerlink\" title=\"1. 下载 leanote 二进制版\"></a>1. 下载 <code>leanote</code> 二进制版</h1><p>由此处下载 <a href=\"http://leanote.org/#download\" target=\"_blank\" rel=\"external\">leanote 最新二进制版</a>。</p>\n<p>假设将文件下载到 <code>/home/ya/note</code> 目录下,解压文件从而在 <code>/home/ya/note</code> 目录下生成 <code>leanote</code>目录：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/ya/note</div><div class=\"line\">tar -xzvf leanote-darwin-amd64.v2.0.bin.tar.gz</div></pre></td></tr></table></figure></p>\n<hr>\n<h1 id=\"2-安装-mongodb\"><a href=\"#2-安装-mongodb\" class=\"headerlink\" title=\"2. 安装 mongodb\"></a>2. 安装 <code>mongodb</code></h1><h2 id=\"2-1-安装-mongodb\"><a href=\"#2-1-安装-mongodb\" class=\"headerlink\" title=\"2.1 安装 mongodb\"></a>2.1 安装 <code>mongodb</code></h2><h3 id=\"2-1-1-源码安装\"><a href=\"#2-1-1-源码安装\" class=\"headerlink\" title=\"2.1.1 源码安装\"></a>2.1.1 源码安装</h3><p>到 <a href=\"http://www.mongodb.org/downloads\" target=\"_blank\" rel=\"external\">mongodb 官网</a> 下载相应系统的最新版安装包,或者从以下链接下载旧版本：</p>\n<ul>\n<li>64位 linux mongodb 3.0.1 下载链接: <a href=\"https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.1.tgz\" target=\"_blank\" rel=\"external\">https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.1.tgz</a></li>\n</ul>\n<p>下载到 <code>/home/ya/note</code>下,直接解压即可:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/ya/note</div><div class=\"line\">tar -xzvf mongodb-linux-x86_64-3.0.1.tgz/</div></pre></td></tr></table></figure></p>\n<p>为了快速使用<code>mongodb</code>命令,可以配置环境变量。编辑 <code>~/.profile</code>或<code>/etc/profile</code> 文件,将<code>mongodb/bin</code>路径加入即可:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo vim /etc/profile</div></pre></td></tr></table></figure></p>\n<p>此处实例使用了<code>vim</code>文本编辑器,你可以使用自己熟悉的编辑器。</p>\n<p>在<code>/etc/profile</code>中添加以下行,注意把用户名（<code>ya/note</code>）和相应的文件目录名（<code>mongodb-linux-x86_64-3.0.1</code>）替换成自己系统中的名称：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">export PATH=$PATH:/home/ya/note/mongodb-linux-x86_64-3.0.1/bin</div></pre></td></tr></table></figure></p>\n<p>保存修改后,在终端运行以下命令使环境变量生效:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">source /etc/profile</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-1-2-从源安装\"><a href=\"#2-1-2-从源安装\" class=\"headerlink\" title=\"2.1.2 从源安装\"></a>2.1.2 从源安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo pacman -S mongodb mongodb-tools</div></pre></td></tr></table></figure>\n<h2 id=\"2-2-测试mongodb安装\"><a href=\"#2-2-测试mongodb安装\" class=\"headerlink\" title=\"2.2 测试mongodb安装\"></a>2.2 测试<code>mongodb</code>安装</h2><p>先在<code>/home/ya/note</code>下新建一个目录<code>data</code>存放<code>mongodb</code>数据:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /home/ya/note/data</div></pre></td></tr></table></figure></p>\n<p>用以下命令启动<code>mongod</code>:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth</div></pre></td></tr></table></figure></p>\n<p>这时<code>mongod</code>已经启动,重新打开一个终端,键入<code>mongo</code>进入交互程序：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongo</div><div class=\"line\">&gt; show dbs</div><div class=\"line\">...数据库列表</div></pre></td></tr></table></figure></p>\n<p><code>mongodb</code>安装到此为止,下面为<code>mongodb</code>导入<code>leanote</code>初始数据。</p>\n<hr>\n<h1 id=\"3-初始化数据库\"><a href=\"#3-初始化数据库\" class=\"headerlink\" title=\"3. 初始化数据库\"></a>3. 初始化数据库</h1><h2 id=\"3-1-导入数据\"><a href=\"#3-1-导入数据\" class=\"headerlink\" title=\"3.1 导入数据\"></a>3.1 导入数据</h2><p><code>leanote</code>初始数据存放在 <code>/home/ya/note/leanote/mongodb_backup/leanote_install_data</code>中。</p>\n<p>打开终端,输入以下命令导入数据。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongorestore -h localhost -d leanote --dir /home/ya/note/leanote/mongodb_backup/leanote_install_data/</div></pre></td></tr></table></figure>\n<p>现在在<code>mongodb</code>中已经新建了<code>leanote</code>数据库,可用命令查看下<code>leanote</code>有多少张”表”:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongo</div><div class=\"line\">&gt; show dbs #　查看数据库</div><div class=\"line\">leanote\t0.203125GB</div><div class=\"line\">local\t0.078125GB</div><div class=\"line\">&gt; use leanote # 切换到leanote</div><div class=\"line\">switched to db leanote</div><div class=\"line\">&gt; show collections # 查看表</div><div class=\"line\">files</div><div class=\"line\">has_share_notes</div><div class=\"line\">note_content_histories</div><div class=\"line\">note_contents</div><div class=\"line\">....</div></pre></td></tr></table></figure></p>\n<p>初始数据的<code>users</code>表中已有2个用户:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ya/note username: admin,password: abc123 (管理员,只有该用户才有权管理后台,请及时修改密码)</div><div class=\"line\">user2 username: demo@leanote.com,password: demo@leanote.com (仅供体验使用)</div></pre></td></tr></table></figure></p>\n<h2 id=\"3-2-为mongodb数据库添加用户\"><a href=\"#3-2-为mongodb数据库添加用户\" class=\"headerlink\" title=\"3.2 为mongodb数据库添加用户\"></a>3.2 为mongodb数据库添加用户</h2><p>像mysql一样有root用户,mongodb初始是没有用户的,这样很不安全,所以要为leanote数据库新建一个用户来连接leanote数据库(注意,并不是为leanote的表users里新建用户,而是新建一个连接leanote数据库的用户,类似mysql的root用户).</p>\n<p>mognodb v2与v3创建用户命令有所不同</p>\n<p>mongodb v2 创建用户如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 首先切换到leanote数据库下</div><div class=\"line\">&gt; use leanote;</div><div class=\"line\"># 添加一个用户root,密码是abc123</div><div class=\"line\">&gt; db.addUser(&quot;root&quot;,&quot;abc123&quot;);</div><div class=\"line\">&#123;</div><div class=\"line\">\t&quot;_id&quot; : ObjectId(&quot;53688d1950cc1813efb9564c&quot;),</div><div class=\"line\">\t&quot;user&quot; : &quot;root&quot;,</div><div class=\"line\">\t&quot;readOnly&quot; : false,</div><div class=\"line\">\t&quot;pwd&quot; : &quot;e014bfea4a9c3c27ab34e50bd1ef0955&quot;</div><div class=\"line\">&#125;</div><div class=\"line\"># 测试下是否正确</div><div class=\"line\">&gt; db.auth(&quot;root&quot;,&quot;abc123&quot;);</div><div class=\"line\">1 # 返回1表示正确</div></pre></td></tr></table></figure></p>\n<p>mongodb v3 创建用户如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 首先切换到leanote数据库下</div><div class=\"line\">&gt; use leanote;</div><div class=\"line\"># 添加一个用户root,密码是abc123</div><div class=\"line\">&gt; db.createUser(&#123;</div><div class=\"line\">    user: &apos;root&apos;,</div><div class=\"line\">    pwd: &apos;abc123&apos;,</div><div class=\"line\">    roles: [&#123;role: &apos;dbOwner&apos;,db: &apos;leanote&apos;&#125;]</div><div class=\"line\">&#125;);</div><div class=\"line\"># 测试下是否正确</div><div class=\"line\">&gt; db.auth(&quot;root&quot;,&quot;abc123&quot;);</div><div class=\"line\">1 # 返回1表示正确</div></pre></td></tr></table></figure></p>\n<p>用户添加好后重新运行下mongodb,并开启权限验证. 在mongod的终端按ctrl+c即可退出mongodb.</p>\n<p>启动mongodb:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth</div></pre></td></tr></table></figure></p>\n<hr>\n<h1 id=\"4-配置leanote\"><a href=\"#4-配置leanote\" class=\"headerlink\" title=\"4. 配置leanote\"></a>4. 配置<code>leanote</code></h1><p><code>leanote</code>的配置存储在文件 <code>conf/app.conf</code> 中</p>\n<p>请务必修改<code>app.secret</code>一项,在若干个随机位置处,将字符修改成一个其他的值,否则会有安全隐患<br>这里顺便贴出部分配置<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">http.port=9000</div><div class=\"line\"></div><div class=\"line\">site.url=https://localhost:1443 # or http://x.com:8080,http://www.xx.com:9000</div><div class=\"line\"></div><div class=\"line\"># admin username</div><div class=\"line\">adminUsername=admin</div><div class=\"line\"></div><div class=\"line\"># mongdb</div><div class=\"line\">db.host=127.0.0.1</div><div class=\"line\">db.port=27016</div><div class=\"line\">db.dbname=leanote # required</div><div class=\"line\">db.username=root # if not exists,please leave it blank</div><div class=\"line\">db.password=abc123/ # if not exists,please leave it blank</div></pre></td></tr></table></figure></p>\n<hr>\n<h1 id=\"5-运行leanote\"><a href=\"#5-运行leanote\" class=\"headerlink\" title=\"5. 运行leanote\"></a>5. 运行<code>leanote</code></h1><p><strong>注意:</strong> 在此之前请确保<code>mongodb</code>已在运行!</p>\n<p>新开一个窗口,运行:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/ya/note/leanote/bin</div><div class=\"line\">bash run.sh</div></pre></td></tr></table></figure></p>\n<p>最后出现以下信息证明运行成功:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">...</div><div class=\"line\">TRACE 2013/06/06 15:01:27 watcher.go:72: Watching: /home/life/leanote/bin/src/github.com/leanote/leanote/conf/routes</div><div class=\"line\">Go to /@tests to run the tests.</div><div class=\"line\">Listening on :9000...</div></pre></td></tr></table></figure></p>\n<p>恭喜你,打开浏览器输入: <code>http://localhost:9000</code> 体验<code>leanote</code>吧!</p>\n<hr>\n<h1 id=\"6-配置SSL证书\"><a href=\"#6-配置SSL证书\" class=\"headerlink\" title=\"6 配置SSL证书\"></a>6 配置SSL证书</h1><h2 id=\"6-1-使用Let’s-Encrypt\"><a href=\"#6-1-使用Let’s-Encrypt\" class=\"headerlink\" title=\"6.1 使用Let’s Encrypt\"></a>6.1 使用Let’s Encrypt</h2><ul>\n<li>通过<a href=\"https://www.sslforfree.com/\" target=\"_blank\" rel=\"external\">sslforfree</a>申请证书</li>\n<li>将证书放在<code>/home/ya/note/cert/</code>中</li>\n</ul>\n<h2 id=\"6-2-配置Nginx\"><a href=\"#6-2-配置Nginx\" class=\"headerlink\" title=\"6.2 配置Nginx\"></a>6.2 配置Nginx</h2><p>假设Leanote运行的端口是9000,域名为gx.littleya.com,那么nginx.conf可以配置如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 本配置只有http部分,不全</div><div class=\"line\">http &#123;</div><div class=\"line\">    include       mime.types;</div><div class=\"line\">    default_type  application/octet-stream;</div><div class=\"line\"></div><div class=\"line\">   #access_log  logs/access.log  main;</div><div class=\"line\"></div><div class=\"line\">    upstream gx.littleya.com &#123;</div><div class=\"line\">\t    server localhost:9000;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    sendfile        on;</div><div class=\"line\">    #tcp_nopush     on;</div><div class=\"line\"></div><div class=\"line\">    #keepalive_timeout  0;</div><div class=\"line\">    keepalive_timeout  65;</div><div class=\"line\"></div><div class=\"line\">    #gzip  on;</div><div class=\"line\"></div><div class=\"line\">    server &#123;</div><div class=\"line\">        listen       1080;</div><div class=\"line\">        server_name  gx.littleya.com;</div><div class=\"line\"></div><div class=\"line\">        #charset koi8-r;</div><div class=\"line\">        # 强制https</div><div class=\"line\">        # 如果不需要,请注释这一行rewrite</div><div class=\"line\">\t    rewrite ^/(.*) https://gx.littleya.com:1443/$1 permanent;</div><div class=\"line\"></div><div class=\"line\">        #access_log  logs/host.access.log  main;</div><div class=\"line\"></div><div class=\"line\">        location / &#123;</div><div class=\"line\">\t\tproxy_pass        http://gx.littleya.com;</div><div class=\"line\">\t\tproxy_set_header   Host             $host;</div><div class=\"line\">\t\tproxy_set_header   X-Real-IP        $remote_addr;</div><div class=\"line\">\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        #error_page  404              /404.html;</div><div class=\"line\"></div><div class=\"line\">        # redirect server error pages to the static page /50x.html</div><div class=\"line\">        #</div><div class=\"line\">        error_page   500 502 503 504  /50x.html;</div><div class=\"line\">        location = /50x.html &#123;</div><div class=\"line\">            root   /usr/share/nginx/html;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # HTTPS server</div><div class=\"line\">    #</div><div class=\"line\">    server &#123;</div><div class=\"line\">        listen       1443 ssl;</div><div class=\"line\">        server_name  gx.littleya.com;</div><div class=\"line\"></div><div class=\"line\">        ssl_certificate      /home/ya/note/cert/gx.littleya.com.crt;</div><div class=\"line\">        ssl_certificate_key  /home/ya/note/cert/gx.littleya.com.key;</div><div class=\"line\"></div><div class=\"line\">        ssl_session_cache    shared:SSL:1m;</div><div class=\"line\">        ssl_session_timeout  5m;</div><div class=\"line\"></div><div class=\"line\">        ssl_ciphers  HIGH:!aNULL:!MD5;</div><div class=\"line\">        ssl_prefer_server_ciphers  on;</div><div class=\"line\"></div><div class=\"line\">        location / &#123;</div><div class=\"line\">\t\tproxy_pass        http://gx.littleya.com;</div><div class=\"line\">\t\tproxy_set_header   Host             $host;</div><div class=\"line\">\t\tproxy_set_header   X-Real-IP        $remote_addr;</div><div class=\"line\">\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<p>Linux搭建leanote服务器并配置SSL</p>","more":"<h2 id=\"本教程适合-Mac-及-linux-用户的二进制版安装。\"><a href=\"#本教程适合-Mac-及-linux-用户的二进制版安装。\" class=\"headerlink\" title=\"本教程适合 Mac 及 linux 用户的二进制版安装。\"></a>本教程适合 Mac 及 linux 用户的<strong>二进制版</strong>安装。</h2><ul>\n<li>Mac,Linux 用户的源码版安装,参见<a href=\"https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Mac-and-Linux\" target=\"_blank\" rel=\"external\">这里</a>。</li>\n<li>Windows 用户的二进制版安装,参见<a href=\"https://github.com/leanote/leanote/wiki/Leanote-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows\" target=\"_blank\" rel=\"external\">这里</a>。</li>\n<li>Windows 用户的源码版安装,参见<a href=\"https://github.com/leanote/leanote/wiki/Leanote-%E6%BA%90%E7%A0%81%E7%89%88%E8%AF%A6%E7%BB%86%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B----Windows\" target=\"_blank\" rel=\"external\">这里</a>。</li>\n</ul>\n<hr>\n<h1 id=\"安装步骤\"><a href=\"#安装步骤\" class=\"headerlink\" title=\"安装步骤:\"></a>安装步骤:</h1><ol>\n<li>下载 <code>leanote</code> 二进制版。</li>\n<li>安装 <code>mongodb</code>。</li>\n<li>导入初始数据。</li>\n<li>配置 <code>leanote</code>。</li>\n<li>运行 <code>leanote</code>。</li>\n</ol>\n<hr>\n<h1 id=\"1-下载-leanote-二进制版\"><a href=\"#1-下载-leanote-二进制版\" class=\"headerlink\" title=\"1. 下载 leanote 二进制版\"></a>1. 下载 <code>leanote</code> 二进制版</h1><p>由此处下载 <a href=\"http://leanote.org/#download\" target=\"_blank\" rel=\"external\">leanote 最新二进制版</a>。</p>\n<p>假设将文件下载到 <code>/home/ya/note</code> 目录下,解压文件从而在 <code>/home/ya/note</code> 目录下生成 <code>leanote</code>目录：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/ya/note</div><div class=\"line\">tar -xzvf leanote-darwin-amd64.v2.0.bin.tar.gz</div></pre></td></tr></table></figure></p>\n<hr>\n<h1 id=\"2-安装-mongodb\"><a href=\"#2-安装-mongodb\" class=\"headerlink\" title=\"2. 安装 mongodb\"></a>2. 安装 <code>mongodb</code></h1><h2 id=\"2-1-安装-mongodb\"><a href=\"#2-1-安装-mongodb\" class=\"headerlink\" title=\"2.1 安装 mongodb\"></a>2.1 安装 <code>mongodb</code></h2><h3 id=\"2-1-1-源码安装\"><a href=\"#2-1-1-源码安装\" class=\"headerlink\" title=\"2.1.1 源码安装\"></a>2.1.1 源码安装</h3><p>到 <a href=\"http://www.mongodb.org/downloads\" target=\"_blank\" rel=\"external\">mongodb 官网</a> 下载相应系统的最新版安装包,或者从以下链接下载旧版本：</p>\n<ul>\n<li>64位 linux mongodb 3.0.1 下载链接: <a href=\"https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.1.tgz\" target=\"_blank\" rel=\"external\">https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.1.tgz</a></li>\n</ul>\n<p>下载到 <code>/home/ya/note</code>下,直接解压即可:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/ya/note</div><div class=\"line\">tar -xzvf mongodb-linux-x86_64-3.0.1.tgz/</div></pre></td></tr></table></figure></p>\n<p>为了快速使用<code>mongodb</code>命令,可以配置环境变量。编辑 <code>~/.profile</code>或<code>/etc/profile</code> 文件,将<code>mongodb/bin</code>路径加入即可:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo vim /etc/profile</div></pre></td></tr></table></figure></p>\n<p>此处实例使用了<code>vim</code>文本编辑器,你可以使用自己熟悉的编辑器。</p>\n<p>在<code>/etc/profile</code>中添加以下行,注意把用户名（<code>ya/note</code>）和相应的文件目录名（<code>mongodb-linux-x86_64-3.0.1</code>）替换成自己系统中的名称：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">export PATH=$PATH:/home/ya/note/mongodb-linux-x86_64-3.0.1/bin</div></pre></td></tr></table></figure></p>\n<p>保存修改后,在终端运行以下命令使环境变量生效:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">source /etc/profile</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-1-2-从源安装\"><a href=\"#2-1-2-从源安装\" class=\"headerlink\" title=\"2.1.2 从源安装\"></a>2.1.2 从源安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo pacman -S mongodb mongodb-tools</div></pre></td></tr></table></figure>\n<h2 id=\"2-2-测试mongodb安装\"><a href=\"#2-2-测试mongodb安装\" class=\"headerlink\" title=\"2.2 测试mongodb安装\"></a>2.2 测试<code>mongodb</code>安装</h2><p>先在<code>/home/ya/note</code>下新建一个目录<code>data</code>存放<code>mongodb</code>数据:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /home/ya/note/data</div></pre></td></tr></table></figure></p>\n<p>用以下命令启动<code>mongod</code>:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth</div></pre></td></tr></table></figure></p>\n<p>这时<code>mongod</code>已经启动,重新打开一个终端,键入<code>mongo</code>进入交互程序：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongo</div><div class=\"line\">&gt; show dbs</div><div class=\"line\">...数据库列表</div></pre></td></tr></table></figure></p>\n<p><code>mongodb</code>安装到此为止,下面为<code>mongodb</code>导入<code>leanote</code>初始数据。</p>\n<hr>\n<h1 id=\"3-初始化数据库\"><a href=\"#3-初始化数据库\" class=\"headerlink\" title=\"3. 初始化数据库\"></a>3. 初始化数据库</h1><h2 id=\"3-1-导入数据\"><a href=\"#3-1-导入数据\" class=\"headerlink\" title=\"3.1 导入数据\"></a>3.1 导入数据</h2><p><code>leanote</code>初始数据存放在 <code>/home/ya/note/leanote/mongodb_backup/leanote_install_data</code>中。</p>\n<p>打开终端,输入以下命令导入数据。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongorestore -h localhost -d leanote --dir /home/ya/note/leanote/mongodb_backup/leanote_install_data/</div></pre></td></tr></table></figure>\n<p>现在在<code>mongodb</code>中已经新建了<code>leanote</code>数据库,可用命令查看下<code>leanote</code>有多少张”表”:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongo</div><div class=\"line\">&gt; show dbs #　查看数据库</div><div class=\"line\">leanote\t0.203125GB</div><div class=\"line\">local\t0.078125GB</div><div class=\"line\">&gt; use leanote # 切换到leanote</div><div class=\"line\">switched to db leanote</div><div class=\"line\">&gt; show collections # 查看表</div><div class=\"line\">files</div><div class=\"line\">has_share_notes</div><div class=\"line\">note_content_histories</div><div class=\"line\">note_contents</div><div class=\"line\">....</div></pre></td></tr></table></figure></p>\n<p>初始数据的<code>users</code>表中已有2个用户:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ya/note username: admin,password: abc123 (管理员,只有该用户才有权管理后台,请及时修改密码)</div><div class=\"line\">user2 username: demo@leanote.com,password: demo@leanote.com (仅供体验使用)</div></pre></td></tr></table></figure></p>\n<h2 id=\"3-2-为mongodb数据库添加用户\"><a href=\"#3-2-为mongodb数据库添加用户\" class=\"headerlink\" title=\"3.2 为mongodb数据库添加用户\"></a>3.2 为mongodb数据库添加用户</h2><p>像mysql一样有root用户,mongodb初始是没有用户的,这样很不安全,所以要为leanote数据库新建一个用户来连接leanote数据库(注意,并不是为leanote的表users里新建用户,而是新建一个连接leanote数据库的用户,类似mysql的root用户).</p>\n<p>mognodb v2与v3创建用户命令有所不同</p>\n<p>mongodb v2 创建用户如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 首先切换到leanote数据库下</div><div class=\"line\">&gt; use leanote;</div><div class=\"line\"># 添加一个用户root,密码是abc123</div><div class=\"line\">&gt; db.addUser(&quot;root&quot;,&quot;abc123&quot;);</div><div class=\"line\">&#123;</div><div class=\"line\">\t&quot;_id&quot; : ObjectId(&quot;53688d1950cc1813efb9564c&quot;),</div><div class=\"line\">\t&quot;user&quot; : &quot;root&quot;,</div><div class=\"line\">\t&quot;readOnly&quot; : false,</div><div class=\"line\">\t&quot;pwd&quot; : &quot;e014bfea4a9c3c27ab34e50bd1ef0955&quot;</div><div class=\"line\">&#125;</div><div class=\"line\"># 测试下是否正确</div><div class=\"line\">&gt; db.auth(&quot;root&quot;,&quot;abc123&quot;);</div><div class=\"line\">1 # 返回1表示正确</div></pre></td></tr></table></figure></p>\n<p>mongodb v3 创建用户如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 首先切换到leanote数据库下</div><div class=\"line\">&gt; use leanote;</div><div class=\"line\"># 添加一个用户root,密码是abc123</div><div class=\"line\">&gt; db.createUser(&#123;</div><div class=\"line\">    user: &apos;root&apos;,</div><div class=\"line\">    pwd: &apos;abc123&apos;,</div><div class=\"line\">    roles: [&#123;role: &apos;dbOwner&apos;,db: &apos;leanote&apos;&#125;]</div><div class=\"line\">&#125;);</div><div class=\"line\"># 测试下是否正确</div><div class=\"line\">&gt; db.auth(&quot;root&quot;,&quot;abc123&quot;);</div><div class=\"line\">1 # 返回1表示正确</div></pre></td></tr></table></figure></p>\n<p>用户添加好后重新运行下mongodb,并开启权限验证. 在mongod的终端按ctrl+c即可退出mongodb.</p>\n<p>启动mongodb:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mongod --dbpath /home/ya/note/mongodb/data --port 27016 --logpath /home/ya/note/mongodb/mongodb.log --logappend --auth</div></pre></td></tr></table></figure></p>\n<hr>\n<h1 id=\"4-配置leanote\"><a href=\"#4-配置leanote\" class=\"headerlink\" title=\"4. 配置leanote\"></a>4. 配置<code>leanote</code></h1><p><code>leanote</code>的配置存储在文件 <code>conf/app.conf</code> 中</p>\n<p>请务必修改<code>app.secret</code>一项,在若干个随机位置处,将字符修改成一个其他的值,否则会有安全隐患<br>这里顺便贴出部分配置<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">http.port=9000</div><div class=\"line\"></div><div class=\"line\">site.url=https://localhost:1443 # or http://x.com:8080,http://www.xx.com:9000</div><div class=\"line\"></div><div class=\"line\"># admin username</div><div class=\"line\">adminUsername=admin</div><div class=\"line\"></div><div class=\"line\"># mongdb</div><div class=\"line\">db.host=127.0.0.1</div><div class=\"line\">db.port=27016</div><div class=\"line\">db.dbname=leanote # required</div><div class=\"line\">db.username=root # if not exists,please leave it blank</div><div class=\"line\">db.password=abc123/ # if not exists,please leave it blank</div></pre></td></tr></table></figure></p>\n<hr>\n<h1 id=\"5-运行leanote\"><a href=\"#5-运行leanote\" class=\"headerlink\" title=\"5. 运行leanote\"></a>5. 运行<code>leanote</code></h1><p><strong>注意:</strong> 在此之前请确保<code>mongodb</code>已在运行!</p>\n<p>新开一个窗口,运行:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/ya/note/leanote/bin</div><div class=\"line\">bash run.sh</div></pre></td></tr></table></figure></p>\n<p>最后出现以下信息证明运行成功:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">...</div><div class=\"line\">TRACE 2013/06/06 15:01:27 watcher.go:72: Watching: /home/life/leanote/bin/src/github.com/leanote/leanote/conf/routes</div><div class=\"line\">Go to /@tests to run the tests.</div><div class=\"line\">Listening on :9000...</div></pre></td></tr></table></figure></p>\n<p>恭喜你,打开浏览器输入: <code>http://localhost:9000</code> 体验<code>leanote</code>吧!</p>\n<hr>\n<h1 id=\"6-配置SSL证书\"><a href=\"#6-配置SSL证书\" class=\"headerlink\" title=\"6 配置SSL证书\"></a>6 配置SSL证书</h1><h2 id=\"6-1-使用Let’s-Encrypt\"><a href=\"#6-1-使用Let’s-Encrypt\" class=\"headerlink\" title=\"6.1 使用Let’s Encrypt\"></a>6.1 使用Let’s Encrypt</h2><ul>\n<li>通过<a href=\"https://www.sslforfree.com/\" target=\"_blank\" rel=\"external\">sslforfree</a>申请证书</li>\n<li>将证书放在<code>/home/ya/note/cert/</code>中</li>\n</ul>\n<h2 id=\"6-2-配置Nginx\"><a href=\"#6-2-配置Nginx\" class=\"headerlink\" title=\"6.2 配置Nginx\"></a>6.2 配置Nginx</h2><p>假设Leanote运行的端口是9000,域名为gx.littleya.com,那么nginx.conf可以配置如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 本配置只有http部分,不全</div><div class=\"line\">http &#123;</div><div class=\"line\">    include       mime.types;</div><div class=\"line\">    default_type  application/octet-stream;</div><div class=\"line\"></div><div class=\"line\">   #access_log  logs/access.log  main;</div><div class=\"line\"></div><div class=\"line\">    upstream gx.littleya.com &#123;</div><div class=\"line\">\t    server localhost:9000;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    sendfile        on;</div><div class=\"line\">    #tcp_nopush     on;</div><div class=\"line\"></div><div class=\"line\">    #keepalive_timeout  0;</div><div class=\"line\">    keepalive_timeout  65;</div><div class=\"line\"></div><div class=\"line\">    #gzip  on;</div><div class=\"line\"></div><div class=\"line\">    server &#123;</div><div class=\"line\">        listen       1080;</div><div class=\"line\">        server_name  gx.littleya.com;</div><div class=\"line\"></div><div class=\"line\">        #charset koi8-r;</div><div class=\"line\">        # 强制https</div><div class=\"line\">        # 如果不需要,请注释这一行rewrite</div><div class=\"line\">\t    rewrite ^/(.*) https://gx.littleya.com:1443/$1 permanent;</div><div class=\"line\"></div><div class=\"line\">        #access_log  logs/host.access.log  main;</div><div class=\"line\"></div><div class=\"line\">        location / &#123;</div><div class=\"line\">\t\tproxy_pass        http://gx.littleya.com;</div><div class=\"line\">\t\tproxy_set_header   Host             $host;</div><div class=\"line\">\t\tproxy_set_header   X-Real-IP        $remote_addr;</div><div class=\"line\">\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        #error_page  404              /404.html;</div><div class=\"line\"></div><div class=\"line\">        # redirect server error pages to the static page /50x.html</div><div class=\"line\">        #</div><div class=\"line\">        error_page   500 502 503 504  /50x.html;</div><div class=\"line\">        location = /50x.html &#123;</div><div class=\"line\">            root   /usr/share/nginx/html;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    # HTTPS server</div><div class=\"line\">    #</div><div class=\"line\">    server &#123;</div><div class=\"line\">        listen       1443 ssl;</div><div class=\"line\">        server_name  gx.littleya.com;</div><div class=\"line\"></div><div class=\"line\">        ssl_certificate      /home/ya/note/cert/gx.littleya.com.crt;</div><div class=\"line\">        ssl_certificate_key  /home/ya/note/cert/gx.littleya.com.key;</div><div class=\"line\"></div><div class=\"line\">        ssl_session_cache    shared:SSL:1m;</div><div class=\"line\">        ssl_session_timeout  5m;</div><div class=\"line\"></div><div class=\"line\">        ssl_ciphers  HIGH:!aNULL:!MD5;</div><div class=\"line\">        ssl_prefer_server_ciphers  on;</div><div class=\"line\"></div><div class=\"line\">        location / &#123;</div><div class=\"line\">\t\tproxy_pass        http://gx.littleya.com;</div><div class=\"line\">\t\tproxy_set_header   Host             $host;</div><div class=\"line\">\t\tproxy_set_header   X-Real-IP        $remote_addr;</div><div class=\"line\">\t\tproxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>"},{"title":"Linux 搭建L4D2服务器","date":"2017-10-09T09:04:19.000Z","_content":"\n本文仅限于使用steam正版的L4D2\n\n<!-- more -->\n\n# 机器环境\n-   阿里云1G,1核,1Mbps的学生机\n-   Ubuntu 14.04 LTS x64\n\n# 配置过程\n## 下载安装SteamCMD\n\n### 1. 安装运行库\n\nUbuntu/Debian:\n```\napt-get install lib32gcc1\n```\n\nCentos x86:\n```\nyum install glibc libstdc++\n```\n\nCentos x64:\n```\nyum install glibc.i686 ligstdc++.i686\n```\n\n### 2. 创建用户&配置steamcmd\n\n```\nuseradd steamcmd\nsu steamcmd\nmkdir ~/steamcmd && cd ~/steamcmd\nwget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz && tar zxvf steamcmd_linux.tar.gz\n./steamcmd.sh\n```\n\n第一次运行时会下载一些文件,下载完成后会显示\n> Steam Console Client (c) Valve Corporation\n> -- type 'quit' to exit --\n> Loading Steam API...OK.\n> <br>\n> Steam>\n\n### 3. 下载L4D2\n这里可以选择是否匿名登录,有些游戏在匿名模式中无法下载,具体信息参考:https://developer.valvesoftware.com/wiki/Dedicated_Servers_List\nL4D2可以匿名登录下载\n```\nSteam> login anonymous\nConnecting anonymously to Steam Public...Logged in OK\nWaiting for license info...OK\nSteam> force_install_dir ~/game/l4d2\n#使用fore_install_dir指定下载目录\nSteam> app_update 222860 validate\n#下载语法为 app_update <app_id> [-beta <betaname>] [-betapassword <password>]\n#app_id为DedicatedServer在Steam数据库中的ID,该ID可以在上面的链接中查看\n#beta为是否参加测试,这里不使用beta版\n#最后validate为下载完成后验证信息,推荐使用\n#之后慢慢等待下载完成\nSuccess! App '222860' fully installed.\n#此时下载就完成了\nSteam>quit\n#退出SteamCMD\n```\n\n### 4. 配置L4D2\n\n配置~/game/L4D2/left4dead2/cfg/server.cfg\n> hostname \"servername\" \n> //游戏服务器名\n> rcon_password \"password\" \n> //远程管理密码\n> //sv_search_key yourkey \n> //搜索此服务器的关键词\n> //sv_region 255\n> //服务器地区,255表示全球\n> //sv_gametypes \"coop,versus,survival,scavenge\" \n> //游戏模式\n> //map c5m1_waterfront \n> //游戏地图\n> //sv_voiceenable 1\n> //开启语音服务\n> //sv_lan 0\n> //是否是局域网游戏\n> //sv_cheats \"0\"\n> //是否允许作弊\n> //sv_steamgroup \"01234\" \n> //Steam组号\n> //sv_steamgroup_exclusive 1 \n> //将服务器设为Steam组私有\n\n这是全部的设置选项,这里是我的配置(只需要设置服务器名和组号就可以愉快的玩耍了)\n> hostname \"Aasakinagi\"\n> sv_steamgroup 12106576\n> sv_steamgroup_exclusive 1\n\n### 5. 设置启动脚本\n\n建立一个run.sh文件,内容为\n> ./srcds_run -game left4dead2 +exec server.cfg\n\n直接运行run.sh就可以启动服务器了,但是必须要保持ssh会话,否则这个进程就会被关闭\n这里推荐使用screen来后台运行\ndebian安装screen\n```\napt-get install screen\n```\n\n把run.sh文件修改为:\n> screen -S l4d2 ./srcds_run -game left4dead2 +exec server.cfg\n\n之后按Crlt+A+D即可后台运行 ","source":"_posts/201710091704.md","raw":"---\ntitle: Linux 搭建L4D2服务器 \ndate: 2017-10-09 17:04:19\ntags:\n  - linux\n  - other\n---\n\n本文仅限于使用steam正版的L4D2\n\n<!-- more -->\n\n# 机器环境\n-   阿里云1G,1核,1Mbps的学生机\n-   Ubuntu 14.04 LTS x64\n\n# 配置过程\n## 下载安装SteamCMD\n\n### 1. 安装运行库\n\nUbuntu/Debian:\n```\napt-get install lib32gcc1\n```\n\nCentos x86:\n```\nyum install glibc libstdc++\n```\n\nCentos x64:\n```\nyum install glibc.i686 ligstdc++.i686\n```\n\n### 2. 创建用户&配置steamcmd\n\n```\nuseradd steamcmd\nsu steamcmd\nmkdir ~/steamcmd && cd ~/steamcmd\nwget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz && tar zxvf steamcmd_linux.tar.gz\n./steamcmd.sh\n```\n\n第一次运行时会下载一些文件,下载完成后会显示\n> Steam Console Client (c) Valve Corporation\n> -- type 'quit' to exit --\n> Loading Steam API...OK.\n> <br>\n> Steam>\n\n### 3. 下载L4D2\n这里可以选择是否匿名登录,有些游戏在匿名模式中无法下载,具体信息参考:https://developer.valvesoftware.com/wiki/Dedicated_Servers_List\nL4D2可以匿名登录下载\n```\nSteam> login anonymous\nConnecting anonymously to Steam Public...Logged in OK\nWaiting for license info...OK\nSteam> force_install_dir ~/game/l4d2\n#使用fore_install_dir指定下载目录\nSteam> app_update 222860 validate\n#下载语法为 app_update <app_id> [-beta <betaname>] [-betapassword <password>]\n#app_id为DedicatedServer在Steam数据库中的ID,该ID可以在上面的链接中查看\n#beta为是否参加测试,这里不使用beta版\n#最后validate为下载完成后验证信息,推荐使用\n#之后慢慢等待下载完成\nSuccess! App '222860' fully installed.\n#此时下载就完成了\nSteam>quit\n#退出SteamCMD\n```\n\n### 4. 配置L4D2\n\n配置~/game/L4D2/left4dead2/cfg/server.cfg\n> hostname \"servername\" \n> //游戏服务器名\n> rcon_password \"password\" \n> //远程管理密码\n> //sv_search_key yourkey \n> //搜索此服务器的关键词\n> //sv_region 255\n> //服务器地区,255表示全球\n> //sv_gametypes \"coop,versus,survival,scavenge\" \n> //游戏模式\n> //map c5m1_waterfront \n> //游戏地图\n> //sv_voiceenable 1\n> //开启语音服务\n> //sv_lan 0\n> //是否是局域网游戏\n> //sv_cheats \"0\"\n> //是否允许作弊\n> //sv_steamgroup \"01234\" \n> //Steam组号\n> //sv_steamgroup_exclusive 1 \n> //将服务器设为Steam组私有\n\n这是全部的设置选项,这里是我的配置(只需要设置服务器名和组号就可以愉快的玩耍了)\n> hostname \"Aasakinagi\"\n> sv_steamgroup 12106576\n> sv_steamgroup_exclusive 1\n\n### 5. 设置启动脚本\n\n建立一个run.sh文件,内容为\n> ./srcds_run -game left4dead2 +exec server.cfg\n\n直接运行run.sh就可以启动服务器了,但是必须要保持ssh会话,否则这个进程就会被关闭\n这里推荐使用screen来后台运行\ndebian安装screen\n```\napt-get install screen\n```\n\n把run.sh文件修改为:\n> screen -S l4d2 ./srcds_run -game left4dead2 +exec server.cfg\n\n之后按Crlt+A+D即可后台运行 ","slug":"201710091704","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a2570005zizpideapban","content":"<p>本文仅限于使用steam正版的L4D2</p>\n<a id=\"more\"></a>\n<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><ul>\n<li>阿里云1G,1核,1Mbps的学生机</li>\n<li>Ubuntu 14.04 LTS x64</li>\n</ul>\n<h1 id=\"配置过程\"><a href=\"#配置过程\" class=\"headerlink\" title=\"配置过程\"></a>配置过程</h1><h2 id=\"下载安装SteamCMD\"><a href=\"#下载安装SteamCMD\" class=\"headerlink\" title=\"下载安装SteamCMD\"></a>下载安装SteamCMD</h2><h3 id=\"1-安装运行库\"><a href=\"#1-安装运行库\" class=\"headerlink\" title=\"1. 安装运行库\"></a>1. 安装运行库</h3><p>Ubuntu/Debian:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">apt-get install lib32gcc1</div></pre></td></tr></table></figure></p>\n<p>Centos x86:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install glibc libstdc++</div></pre></td></tr></table></figure></p>\n<p>Centos x64:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install glibc.i686 ligstdc++.i686</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-创建用户-amp-配置steamcmd\"><a href=\"#2-创建用户-amp-配置steamcmd\" class=\"headerlink\" title=\"2. 创建用户&amp;配置steamcmd\"></a>2. 创建用户&amp;配置steamcmd</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">useradd steamcmd</div><div class=\"line\">su steamcmd</div><div class=\"line\">mkdir ~/steamcmd &amp;&amp; cd ~/steamcmd</div><div class=\"line\">wget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz &amp;&amp; tar zxvf steamcmd_linux.tar.gz</div><div class=\"line\">./steamcmd.sh</div></pre></td></tr></table></figure>\n<p>第一次运行时会下载一些文件,下载完成后会显示</p>\n<blockquote>\n<p>Steam Console Client (c) Valve Corporation<br>– type ‘quit’ to exit –<br>Loading Steam API…OK.<br><br><br>Steam&gt;</p>\n</blockquote>\n<h3 id=\"3-下载L4D2\"><a href=\"#3-下载L4D2\" class=\"headerlink\" title=\"3. 下载L4D2\"></a>3. 下载L4D2</h3><p>这里可以选择是否匿名登录,有些游戏在匿名模式中无法下载,具体信息参考:<a href=\"https://developer.valvesoftware.com/wiki/Dedicated_Servers_List\" target=\"_blank\" rel=\"external\">https://developer.valvesoftware.com/wiki/Dedicated_Servers_List</a><br>L4D2可以匿名登录下载<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">Steam&gt; login anonymous</div><div class=\"line\">Connecting anonymously to Steam Public...Logged in OK</div><div class=\"line\">Waiting for license info...OK</div><div class=\"line\">Steam&gt; force_install_dir ~/game/l4d2</div><div class=\"line\">#使用fore_install_dir指定下载目录</div><div class=\"line\">Steam&gt; app_update 222860 validate</div><div class=\"line\">#下载语法为 app_update &lt;app_id&gt; [-beta &lt;betaname&gt;] [-betapassword &lt;password&gt;]</div><div class=\"line\">#app_id为DedicatedServer在Steam数据库中的ID,该ID可以在上面的链接中查看</div><div class=\"line\">#beta为是否参加测试,这里不使用beta版</div><div class=\"line\">#最后validate为下载完成后验证信息,推荐使用</div><div class=\"line\">#之后慢慢等待下载完成</div><div class=\"line\">Success! App &apos;222860&apos; fully installed.</div><div class=\"line\">#此时下载就完成了</div><div class=\"line\">Steam&gt;quit</div><div class=\"line\">#退出SteamCMD</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-配置L4D2\"><a href=\"#4-配置L4D2\" class=\"headerlink\" title=\"4. 配置L4D2\"></a>4. 配置L4D2</h3><p>配置~/game/L4D2/left4dead2/cfg/server.cfg</p>\n<blockquote>\n<p>hostname “servername”<br>//游戏服务器名<br>rcon_password “password”<br>//远程管理密码<br>//sv_search_key yourkey<br>//搜索此服务器的关键词<br>//sv_region 255<br>//服务器地区,255表示全球<br>//sv_gametypes “coop,versus,survival,scavenge”<br>//游戏模式<br>//map c5m1_waterfront<br>//游戏地图<br>//sv_voiceenable 1<br>//开启语音服务<br>//sv_lan 0<br>//是否是局域网游戏<br>//sv_cheats “0”<br>//是否允许作弊<br>//sv_steamgroup “01234”<br>//Steam组号<br>//sv_steamgroup_exclusive 1<br>//将服务器设为Steam组私有</p>\n</blockquote>\n<p>这是全部的设置选项,这里是我的配置(只需要设置服务器名和组号就可以愉快的玩耍了)</p>\n<blockquote>\n<p>hostname “Aasakinagi”<br>sv_steamgroup 12106576<br>sv_steamgroup_exclusive 1</p>\n</blockquote>\n<h3 id=\"5-设置启动脚本\"><a href=\"#5-设置启动脚本\" class=\"headerlink\" title=\"5. 设置启动脚本\"></a>5. 设置启动脚本</h3><p>建立一个run.sh文件,内容为</p>\n<blockquote>\n<p>./srcds_run -game left4dead2 +exec server.cfg</p>\n</blockquote>\n<p>直接运行run.sh就可以启动服务器了,但是必须要保持ssh会话,否则这个进程就会被关闭<br>这里推荐使用screen来后台运行<br>debian安装screen<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">apt-get install screen</div></pre></td></tr></table></figure></p>\n<p>把run.sh文件修改为:</p>\n<blockquote>\n<p>screen -S l4d2 ./srcds_run -game left4dead2 +exec server.cfg</p>\n</blockquote>\n<p>之后按Crlt+A+D即可后台运行 </p>\n","site":{"data":{}},"excerpt":"<p>本文仅限于使用steam正版的L4D2</p>","more":"<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><ul>\n<li>阿里云1G,1核,1Mbps的学生机</li>\n<li>Ubuntu 14.04 LTS x64</li>\n</ul>\n<h1 id=\"配置过程\"><a href=\"#配置过程\" class=\"headerlink\" title=\"配置过程\"></a>配置过程</h1><h2 id=\"下载安装SteamCMD\"><a href=\"#下载安装SteamCMD\" class=\"headerlink\" title=\"下载安装SteamCMD\"></a>下载安装SteamCMD</h2><h3 id=\"1-安装运行库\"><a href=\"#1-安装运行库\" class=\"headerlink\" title=\"1. 安装运行库\"></a>1. 安装运行库</h3><p>Ubuntu/Debian:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">apt-get install lib32gcc1</div></pre></td></tr></table></figure></p>\n<p>Centos x86:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install glibc libstdc++</div></pre></td></tr></table></figure></p>\n<p>Centos x64:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install glibc.i686 ligstdc++.i686</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-创建用户-amp-配置steamcmd\"><a href=\"#2-创建用户-amp-配置steamcmd\" class=\"headerlink\" title=\"2. 创建用户&amp;配置steamcmd\"></a>2. 创建用户&amp;配置steamcmd</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">useradd steamcmd</div><div class=\"line\">su steamcmd</div><div class=\"line\">mkdir ~/steamcmd &amp;&amp; cd ~/steamcmd</div><div class=\"line\">wget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz &amp;&amp; tar zxvf steamcmd_linux.tar.gz</div><div class=\"line\">./steamcmd.sh</div></pre></td></tr></table></figure>\n<p>第一次运行时会下载一些文件,下载完成后会显示</p>\n<blockquote>\n<p>Steam Console Client (c) Valve Corporation<br>– type ‘quit’ to exit –<br>Loading Steam API…OK.<br><br><br>Steam&gt;</p>\n</blockquote>\n<h3 id=\"3-下载L4D2\"><a href=\"#3-下载L4D2\" class=\"headerlink\" title=\"3. 下载L4D2\"></a>3. 下载L4D2</h3><p>这里可以选择是否匿名登录,有些游戏在匿名模式中无法下载,具体信息参考:<a href=\"https://developer.valvesoftware.com/wiki/Dedicated_Servers_List\" target=\"_blank\" rel=\"external\">https://developer.valvesoftware.com/wiki/Dedicated_Servers_List</a><br>L4D2可以匿名登录下载<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">Steam&gt; login anonymous</div><div class=\"line\">Connecting anonymously to Steam Public...Logged in OK</div><div class=\"line\">Waiting for license info...OK</div><div class=\"line\">Steam&gt; force_install_dir ~/game/l4d2</div><div class=\"line\">#使用fore_install_dir指定下载目录</div><div class=\"line\">Steam&gt; app_update 222860 validate</div><div class=\"line\">#下载语法为 app_update &lt;app_id&gt; [-beta &lt;betaname&gt;] [-betapassword &lt;password&gt;]</div><div class=\"line\">#app_id为DedicatedServer在Steam数据库中的ID,该ID可以在上面的链接中查看</div><div class=\"line\">#beta为是否参加测试,这里不使用beta版</div><div class=\"line\">#最后validate为下载完成后验证信息,推荐使用</div><div class=\"line\">#之后慢慢等待下载完成</div><div class=\"line\">Success! App &apos;222860&apos; fully installed.</div><div class=\"line\">#此时下载就完成了</div><div class=\"line\">Steam&gt;quit</div><div class=\"line\">#退出SteamCMD</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-配置L4D2\"><a href=\"#4-配置L4D2\" class=\"headerlink\" title=\"4. 配置L4D2\"></a>4. 配置L4D2</h3><p>配置~/game/L4D2/left4dead2/cfg/server.cfg</p>\n<blockquote>\n<p>hostname “servername”<br>//游戏服务器名<br>rcon_password “password”<br>//远程管理密码<br>//sv_search_key yourkey<br>//搜索此服务器的关键词<br>//sv_region 255<br>//服务器地区,255表示全球<br>//sv_gametypes “coop,versus,survival,scavenge”<br>//游戏模式<br>//map c5m1_waterfront<br>//游戏地图<br>//sv_voiceenable 1<br>//开启语音服务<br>//sv_lan 0<br>//是否是局域网游戏<br>//sv_cheats “0”<br>//是否允许作弊<br>//sv_steamgroup “01234”<br>//Steam组号<br>//sv_steamgroup_exclusive 1<br>//将服务器设为Steam组私有</p>\n</blockquote>\n<p>这是全部的设置选项,这里是我的配置(只需要设置服务器名和组号就可以愉快的玩耍了)</p>\n<blockquote>\n<p>hostname “Aasakinagi”<br>sv_steamgroup 12106576<br>sv_steamgroup_exclusive 1</p>\n</blockquote>\n<h3 id=\"5-设置启动脚本\"><a href=\"#5-设置启动脚本\" class=\"headerlink\" title=\"5. 设置启动脚本\"></a>5. 设置启动脚本</h3><p>建立一个run.sh文件,内容为</p>\n<blockquote>\n<p>./srcds_run -game left4dead2 +exec server.cfg</p>\n</blockquote>\n<p>直接运行run.sh就可以启动服务器了,但是必须要保持ssh会话,否则这个进程就会被关闭<br>这里推荐使用screen来后台运行<br>debian安装screen<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">apt-get install screen</div></pre></td></tr></table></figure></p>\n<p>把run.sh文件修改为:</p>\n<blockquote>\n<p>screen -S l4d2 ./srcds_run -game left4dead2 +exec server.cfg</p>\n</blockquote>\n<p>之后按Crlt+A+D即可后台运行 </p>"},{"title":"ocserv搭建与使用","date":"2017-10-09T09:05:09.000Z","_content":"\n\nAnyConnect为思科推出的VPN客户端，目前已有Windows、Android、IOS、Macintosh、Ubuntu、WebOS、Blackberry等操作系统的客户端。AnyConnection主要作用是方便员工在任何设备上安全地办公，AnyConnect最主要的优点是可以给客户端下发走VPN的路由表  \n本文介绍的是利用ocserv搭建openconnect服务器 \n\n<!-- more -->\n\n# 机器环境\n\n操作系统: debian7  \nocserv版本: 0.9.2\n\n# 服务器端配置\n\n## 1. 安装依赖\n\nocserv使用GnuTLS作为SSL的library,所以编译时需要相应的dev包.Debian Stable里面带的版本太老(2.12.20),而ocserv需要的包版本在2.15以上,所以需要从backports安装:\n``` \necho \"deb http://ftp.debian.org/debian wheezy-backports main contrib non-free\" >> /etc/apt/sources.list \napt-get update\napt-get upgarde\napt-get -t wheezy-backports install libgnutls28-dev -y \napt-get install libgmp3-dev m4 gcc pkg-config make gnutls-bin -y \napt-get install build-essential libwrap0-dev libpam0g-dev libdbus-1-dev libreadline-dev libnl-route-3-dev libprotobuf-c0-dev libpcl1-dev libopts25-dev autogen libgnutls28-dev libseccomp-dev liblz4-dev -y \n```\n\n## 2. 修改最大路由数目\n\nocserv可以修改src/vpn.h来支持超过96行(ocserv默认值)但不超过200行(Cisco Anyconnect最大值)的路由表\n> \\# define MAX_CONFIG_ENTRIES 96\n\n注意根据Cisco官方文档,no-route和route不能同时使用\n\n## 3. 下载&编译&安装\n\n```\nwget ftp://ftp.infradead.org/pub/ocserv/ocserv-0.9.2.tar.xz \ntar Jxvf ocserv-0.9.2.tar.xz \ncd ocserv-0.9.2 \n./configure --prefix=/usr --sysconfdir=/etc \nmake \nmake install \n```\n\n## 4. 生成证书\n\n### 4.1 生成CA证书\n\n```\ncerttool --generate-privkey --outfile ca-key.pem\nvim ca.tmpl\n```\n\n> cn = \"aya\"  \n> organization = \"aya\"  \n> serial = 1  \n> expiration_days = 3650  \n> ca  \n> signing_key  \n> cert_signing_key  \n> crl_signing_key  \n\n``` \ncerttool --generate-self-signed --load-privkey ca-key.pem --template ca.tmpl --outfile ca-cert.pem \n```\n\n### 4.2 生成本地服务器证书\n\n``` \ncerttool --generate-privkey --outfile server-key.pem\nvim server.tmpl\n```\n\n> cn = \"littleya.com\"  \n> organization = \"aya\"  \n> serial = 2  \n> expiration_days = 3650  \n> encryption_key  \n> signing_key  \n> tls_www_server  \n\n```\ncerttool --generate-certificate --load-privkey server-key.pem --load-ca-certificate ca-cert.pem --load-ca-privkey ca-key.pem --template server.tmpl --outfile server-cert.pem \n```\n\n### 4.3 移动生成的证书\n\n```\nmkdir /etc/ssl \nmkdir /etc/ssl/certs \nmkdir /etc/ssl/private \ncp ca-cert.pem /etc/ssl/certs \ncp ca-key.pem /etc/ssl/private \ncp server-cert.pem /etc/ssl/certs \ncp server-key.pem /etc/ssl/private\n```\n\n## 5 编辑配置文件\n\n### 5.1 拷贝配置文件到 _/etc/ocserv_ 中\n\n```\nmkdir /etc/ocserv  \ncp ~/ocserv-0.9.2/doc/sample.config /etc/ocserv/ \ncp /etc/ocserv/sample.config /etc/ocserv/ocserv.conf\n```\n\n### 5.2 编辑配置文件\n\n```\nvim /etc/ocserv/ocserv.conf\n```\n\n> auth = \"plain[/etc/ocserv/ocpasswd]\"  \n> \\# ocserv支持多种认证方式，这是自带的密码认证，使用ocpasswd创建密码文件  \n> \\# ocserv还支持证书认证，可以通过Pluggable Authentication Modules (PAM)使用radius等认证方式\n> <br>\n>   \n> \\# 证书路径  \n> server-cert = /etc/ssl/certs/server-cert.pem  \n> server-key = /etc/ssl/private/server-key.pem\n> <br>\n>   \n> \\# if letsencrypt  \n> \\# server-cert = /etc/letsencrypt/live/example.com/fullchain.pem  \n> \\# server-key = /etc/letsencrypt/live/example.com/privkey.pem\n> <br>\n>   \n> \\# 同一个用户最多同时登陆数  \n> max-same-clients = 10\n> <br>\n>   \n> \\# 运行组  \n> run-as-group = nogroup\n> <br>\n>   \n> \\# 分配给VPN客户端的IP段  \n> ipv4-network = 192.168.1.0\n> <br>\n>   \n> \\# DNS  \n> dns = 8.8.8.8  \n> dns = 8.8.4.4\n> <br>\n>   \n> \\# Keepalive in seconds  \n> keepalive = 600\n> <br>\n>   \n> \\#Dead peer detection in seconds.  \n> dpd = 900\n> <br>\n>\n> \\# Dead peer detection for mobile clients. The needs to  \n> \\# be much higher to prevent such clients being awaken too  \n> \\# often by the DPD messages, and save battery.  \n> \\# (clients that send the X-AnyConnect-Identifier-DeviceType)  \n> mobile-dpd = 1800\n> <br>\n>  \n> output-buffer = 23000  \n> try-mtu-discovery = true\n> <br>\n>  \n> \\# The time (in seconds) that a client is allowed to stay idle (no traffic)  \n> \\# before being disconnected. Unset to disable.  \n> idle-timeout = 3600\n> <br>\n>  \n> \\# The time (in seconds) that a mobile client is allowed to stay idle (no traffic) before being disconnected. Unset to disable. \n> mobile-idle-timeout = 3600\n> <br>\n>  \n> \\# 注释掉route的字段，这样表示所有流量都通过 VPN 发送  \n> \\# route = 192.168.16.0/255.255.255.0  \n> \\# route = 192.168.5.0/255.255.255.0\n\n其中路由表的信息,可以从Github上的 [ocserv-cn-no-route][1] 项目配置\n[1]: https://github.com/CNMan/ocserv-cn-no-route \"ocserv-cn-no-route\"\n\n### 5.3 生成用户\n\n```\nocpasswd -c /etc/ocserv/ocpasswd user.name\n#user.name为用户名\n```\n\n## 6. 其他配置\n\n### 6.1 开启转发\n\n```\nvim /etc/sysctl.conf\n```\n\n> net.ipv4.ip_forward = 1\n\n```\nsysctl -p\n```\n\n### 6.2 iptables表\n\n```\niptables -t nat -A POSTROUTING -j MASQUERADE \niptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu \n \n#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式 \n \niptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j SNAT --to-source VPN SERVER'S IP \niptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu \n \n#若打开网页有问题可以尝试把mtu调小\niptables -A FORWARD -p tcp --syn -s 192.168.1.0/24 -j TCPMSS --set-mss 1356\n```\n\n### 6.3 调试\n\n```\nocserv -c /etc/ocserv/ocserv.conf -f -d 1\n```\n\n### 6.4 开机启动\n\n```\nvim /etc/rc.local\n```\n\n> iptables -t nat -A POSTROUTING -j MASQUERADE  \n> iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu\n> <br>\n> \n> \\#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式\n> <br>\n> \n> iptables -t nat -A POSTROUTING -s 192.168.110.0/24 -j SNAT --to-source VPN SERVER'S IP  \n> iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu\n> <br>\n> \n> ocserv\n\n# 客户端配置\n\n## Linux:\n\n```\napt-get install -y openconnect expect screen\nvim /usr/local/sbin/ocdo.sh\n```\n\n> \\#!/usr/bin/expect  \n> spawn screen -S ocdo openconnect -u username --script=/etc/vpnc/vpnc-script --no-dtls vpn.example.com -b  \n> expect \"anything else\"  \n> send \"yes\\r\"  \n> expect \"Password:\"  \n> send \"password\\r\"  \n> interact  \n\n```\necho \"/usr/local/sbin/ocdo.sh\" >> /rc.local \nmkdir /etc/vpnc && cd /etc/vpnc \nwget http://git.infradead.org/users/dwmw2/vpnc-scripts.git/blob_plain/HEAD:/vpnc-script \n```\n\nvpnc-script:\n``` bash\n#!/bin/sh\n#\n# Originally part of vpnc source code:\n# Â© 2005-2012 Maurice Massar, JÃ¶rg Mayer, Antonio Borneo et al.\n# Â© 2009-2012 David Woodhouse <dwmw2@infradead.org>\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 2 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n#\n################\n#\n# List of parameters passed through environment\n#* reason                       -- why this script was called, one of: pre-init connect disconnect reconnect\n#* VPNGATEWAY                   -- vpn gateway address (always present)\n#* TUNDEV                       -- tunnel device (always present)\n#* INTERNAL_IP4_ADDRESS         -- address (always present)\n#* INTERNAL_IP4_MTU             -- mtu (often unset)\n#* INTERNAL_IP4_NETMASK         -- netmask (often unset)\n#* INTERNAL_IP4_NETMASKLEN      -- netmask length (often unset)\n#* INTERNAL_IP4_NETADDR         -- address of network (only present if netmask is set)\n#* INTERNAL_IP4_DNS             -- list of dns servers\n#* INTERNAL_IP4_NBNS            -- list of wins servers\n#* INTERNAL_IP6_ADDRESS         -- IPv6 address\n#* INTERNAL_IP6_NETMASK         -- IPv6 netmask\n#* INTERNAL_IP6_DNS             -- IPv6 list of dns servers\n#* CISCO_DEF_DOMAIN             -- default domain name\n#* CISCO_BANNER                 -- banner from server\n#* CISCO_SPLIT_INC              -- number of networks in split-network-list\n#* CISCO_SPLIT_INC_%d_ADDR      -- network address\n#* CISCO_SPLIT_INC_%d_MASK      -- subnet mask (for example: 255.255.255.0)\n#* CISCO_SPLIT_INC_%d_MASKLEN   -- subnet masklen (for example: 24)\n#* CISCO_SPLIT_INC_%d_PROTOCOL  -- protocol (often just 0)\n#* CISCO_SPLIT_INC_%d_SPORT     -- source port (often just 0)\n#* CISCO_SPLIT_INC_%d_DPORT     -- destination port (often just 0)\n#* CISCO_IPV6_SPLIT_INC         -- number of networks in IPv6 split-network-list\n#* CISCO_IPV6_SPLIT_INC_%d_ADDR -- IPv6 network address\n#* CISCO_IPV6_SPLIT_INC_$%d_MASKLEN -- IPv6 subnet masklen\n\n# FIXMEs:\n\n# Section A: route handling\n\n# 1) The 3 values CISCO_SPLIT_INC_%d_PROTOCOL/SPORT/DPORT are currently being ignored\n#   In order to use them, we'll probably need os specific solutions\n#   * Linux: iptables -t mangle -I PREROUTING <conditions> -j ROUTE --oif $TUNDEV\n#       This would be an *alternative* to changing the routes (and thus 2) and 3)\n#       shouldn't be relevant at all)\n# 2) There are two different functions to set routes: generic routes and the\n#   default route. Why isn't the defaultroute handled via the generic route case?\n# 3) In the split tunnel case, all routes but the default route might get replaced\n#   without getting restored later. We should explicitely check and save them just\n#   like the defaultroute\n# 4) Replies to a dhcp-server should never be sent into the tunnel\n\n# Section B: Split DNS handling\n\n# 1) Maybe dnsmasq can do something like that\n# 2) Parse dns packets going out via tunnel and redirect them to original dns-server\n\n#env | sort\n#set -x\n\n# =========== script (variable) setup ====================================\n\nPATH=/sbin:/usr/sbin:$PATH\n\nOS=\"`uname -s`\"\n\nHOOKS_DIR=/etc/vpnc\nDEFAULT_ROUTE_FILE=/var/run/vpnc/defaultroute\nRESOLV_CONF_BACKUP=/var/run/vpnc/resolv.conf-backup\nSCRIPTNAME=`basename $0`\n\n# some systems, eg. Darwin & FreeBSD, prune /var/run on boot\nif [ ! -d \"/var/run/vpnc\" ]; then\n\tmkdir -p /var/run/vpnc\n\t[ -x /sbin/restorecon ] && /sbin/restorecon /var/run/vpnc\nfi\n\n# stupid SunOS: no blubber in /usr/local/bin ... (on stdout)\nIPROUTE=\"`which ip 2> /dev/null | grep '^/'`\"\n\nif ifconfig --help 2>&1 | grep BusyBox > /dev/null; then\n\tifconfig_syntax_inet=\"\"\nelse\n\tifconfig_syntax_inet=\"inet\"\nfi\n\nif [ \"$OS\" = \"Linux\" ]; then\n\tifconfig_syntax_ptp=\"pointopoint\"\n\troute_syntax_gw=\"gw\"\n\troute_syntax_del=\"del\"\n\troute_syntax_netmask=\"netmask\"\nelse\n\tifconfig_syntax_ptp=\"\"\n\troute_syntax_gw=\"\"\n\troute_syntax_del=\"delete\"\n\troute_syntax_netmask=\"-netmask\"\nfi\nif [ \"$OS\" = \"SunOS\" ]; then\n\troute_syntax_interface=\"-interface\"\n\tifconfig_syntax_ptpv6=\"$INTERNAL_IP6_ADDRESS\"\nelse\n\troute_syntax_interface=\"\"\n\tifconfig_syntax_ptpv6=\"\"\nfi\n\nif [ -r /etc/openwrt_release ] && [ -n \"$OPENWRT_INTERFACE\" ]; then\n        . /etc/functions.sh\n\tinclude /lib/network\n\tMODIFYRESOLVCONF=modify_resolvconf_openwrt\n\tRESTORERESOLVCONF=restore_resolvconf_openwrt\nelif [ -x /usr/bin/busctl ]; then  # For systemd-resolved (version 229 and above)\n\tMODIFYRESOLVCONF=modify_resolved_manager\n\tRESTORERESOLVCONF=restore_resolved_manager\nelif [ -x /sbin/resolvconf ]; then # Optional tool on Debian, Ubuntu, Gentoo and FreeBSD\n\tMODIFYRESOLVCONF=modify_resolvconf_manager\n\tRESTORERESOLVCONF=restore_resolvconf_manager\nelif [ -x /sbin/netconfig ]; then # tool on Suse after 11.1\n\tMODIFYRESOLVCONF=modify_resolvconf_suse_netconfig\n\tRESTORERESOLVCONF=restore_resolvconf_suse_netconfig\nelif [ -x /sbin/modify_resolvconf ]; then # Mandatory tool on Suse earlier than 11.1\n\tMODIFYRESOLVCONF=modify_resolvconf_suse\n\tRESTORERESOLVCONF=restore_resolvconf_suse\nelif [ -x /usr/sbin/unbound-control ] && /usr/sbin/unbound-control status > /dev/null 2>&1; then\n\tMODIFYRESOLVCONF=modify_resolvconf_unbound\n\tRESTORERESOLVCONF=restore_resolvconf_unbound\nelse # Generic for any OS\n\tMODIFYRESOLVCONF=modify_resolvconf_generic\n\tRESTORERESOLVCONF=restore_resolvconf_generic\nfi\n\n\n# =========== script hooks =================================================\n\nrun_hooks() {\n\tHOOK=\"$1\"\n\n\tif [ -d ${HOOKS_DIR}/${HOOK}.d ]; then\n\t    for script in ${HOOKS_DIR}/${HOOK}.d/* ; do\n\t\t[ -f $script ] && . $script\n\t    done\n\tfi\n}\n\n# =========== tunnel interface handling ====================================\n\ndo_ifconfig() {\n\tif [ -n \"$INTERNAL_IP4_MTU\" ]; then\n\t\tMTU=$INTERNAL_IP4_MTU\n\telif [ -n \"$IPROUTE\" ]; then\n\t\tMTUDEV=`$IPROUTE route get \"$VPNGATEWAY\" | sed -ne 's/^.*dev \\([a-z0-9]*\\).*$/\\1/p'`\n\t\tMTU=`$IPROUTE link show \"$MTUDEV\" | sed -ne 's/^.*mtu \\([[:digit:]]\\+\\).*$/\\1/p'`\n\t\tif [ -n \"$MTU\" ]; then\n\t\t\tMTU=`expr $MTU - 88`\n\t\tfi\n\tfi\n\n\tif [ -z \"$MTU\" ]; then\n\t\tMTU=1412\n\tfi\n\n\t# Point to point interface require a netmask of 255.255.255.255 on some systems\n\tif [ -n \"$IPROUTE\" ]; then\n\t\t$IPROUTE link set dev \"$TUNDEV\" up mtu \"$MTU\"\n\t\t$IPROUTE addr add \"$INTERNAL_IP4_ADDRESS/32\" peer \"$INTERNAL_IP4_ADDRESS\" dev \"$TUNDEV\"\n\telse\n\t\tifconfig \"$TUNDEV\" ${ifconfig_syntax_inet} \"$INTERNAL_IP4_ADDRESS\" $ifconfig_syntax_ptp \"$INTERNAL_IP4_ADDRESS\" netmask 255.255.255.255 mtu ${MTU} up\n\tfi\n\n\tif [ -n \"$INTERNAL_IP4_NETMASK\" ]; then\n\t\tset_network_route $INTERNAL_IP4_NETADDR $INTERNAL_IP4_NETMASK $INTERNAL_IP4_NETMASKLEN\n\tfi\n\n\t# If the netmask is provided, it contains the address _and_ netmask\n\tif [ -n \"$INTERNAL_IP6_ADDRESS\" ] && [ -z \"$INTERNAL_IP6_NETMASK\" ]; then\n\t    INTERNAL_IP6_NETMASK=\"$INTERNAL_IP6_ADDRESS/128\"\n\tfi\n\tif [ -n \"$INTERNAL_IP6_NETMASK\" ]; then\n\t    if [ -n \"$IPROUTE\" ]; then\n\t\t$IPROUTE -6 addr add $INTERNAL_IP6_NETMASK dev $TUNDEV\n\t    else\n\t\t# Unlike for Legacy IP, we don't specify the dest_address\n\t\t# here on *BSD. OpenBSD for one will refuse to accept\n\t\t# incoming packets to that address if we do.\n\t\t# OpenVPN does the same (gives dest_address for Legacy IP\n\t\t# but not for IPv6).\n\t\t# Only Solaris needs it; hence $ifconfig_syntax_ptpv6\n\t        ifconfig \"$TUNDEV\" inet6 $INTERNAL_IP6_NETMASK $ifconfig_syntax_ptpv6 mtu $MTU up\n\t    fi\n\tfi\n}\n\ndestroy_tun_device() {\n\tcase \"$OS\" in\n\tNetBSD|OpenBSD) # and probably others...\n\t\tifconfig \"$TUNDEV\" destroy\n\t\t;;\n\tFreeBSD)\n\t\tifconfig \"$TUNDEV\" destroy > /dev/null 2>&1 &\n\t\t;;\n\tesac\n}\n\n# =========== route handling ====================================\n\nif [ -n \"$IPROUTE\" ]; then\n\tfix_ip_get_output () {\n\t\tsed -e 's/ /\\n/g' | \\\n\t\t    sed -ne '1p;/via/{N;p};/dev/{N;p};/src/{N;p};/mtu/{N;p}'\n\t}\n\n\tset_vpngateway_route() {\n\t\t$IPROUTE route add `$IPROUTE route get \"$VPNGATEWAY\" | fix_ip_get_output`\n\t\t$IPROUTE route flush cache\n\t}\n\n\tdel_vpngateway_route() {\n\t\t$IPROUTE route $route_syntax_del \"$VPNGATEWAY\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tset_default_route() {\n\t\t$IPROUTE route | grep '^default' | fix_ip_get_output > \"$DEFAULT_ROUTE_FILE\"\n\t\t$IPROUTE route replace default dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tset_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\t$IPROUTE route replace \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\treset_default_route() {\n\t\tif [ -s \"$DEFAULT_ROUTE_FILE\" ]; then\n\t\t\t$IPROUTE route replace `cat \"$DEFAULT_ROUTE_FILE\"`\n\t\t\t$IPROUTE route flush cache\n\t\t\trm -f -- \"$DEFAULT_ROUTE_FILE\"\n\t\tfi\n\t}\n\n\tdel_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\t$IPROUTE route $route_syntax_del \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tset_ipv6_default_route() {\n\t\t# We don't save/restore IPv6 default route; just add a higher-priority one.\n\t\t$IPROUTE -6 route add default dev \"$TUNDEV\" metric 1\n\t\t$IPROUTE -6 route flush cache\n\t}\n\n\tset_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASKLEN=\"$2\"\n\t\t$IPROUTE -6 route replace \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\treset_ipv6_default_route() {\n\t\t$IPROUTE -6 route del default dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tdel_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASKLEN=\"$2\"\n\t\t$IPROUTE -6 route del \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE -6 route flush cache\n\t}\nelse # use route command\n\tget_default_gw() {\n\t\t# isn't -n supposed to give --numeric output?\n\t\t# apperently not...\n\t\t# Get rid of lines containing IPv6 addresses (':')\n\t\tnetstat -r -n | awk '/:/ { next; } /^(default|0\\.0\\.0\\.0)/ { print $2; }'\n\t}\n\n\tset_vpngateway_route() {\n\t\troute add -host \"$VPNGATEWAY\" $route_syntax_gw \"`get_default_gw`\"\n\t}\n\n\tdel_vpngateway_route() {\n\t\troute $route_syntax_del -host \"$VPNGATEWAY\" $route_syntax_gw \"`get_default_gw`\"\n\t}\n\n\tset_default_route() {\n\t\tDEFAULTGW=\"`get_default_gw`\"\n\t\techo \"$DEFAULTGW\" > \"$DEFAULT_ROUTE_FILE\"\n\t\troute $route_syntax_del default $route_syntax_gw \"$DEFAULTGW\"\n\t\troute add default $route_syntax_gw \"$INTERNAL_IP4_ADDRESS\" $route_syntax_interface\n\t}\n\n\tset_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\tdel_network_route \"$NETWORK\" \"$NETMASK\" \"$NETMASKLEN\"\n\t\troute add -net \"$NETWORK\" $route_syntax_netmask \"$NETMASK\" $route_syntax_gw \"$INTERNAL_IP4_ADDRESS\" $route_syntax_interface\n\t}\n\n\treset_default_route() {\n\t\tif [ -s \"$DEFAULT_ROUTE_FILE\" ]; then\n\t\t\troute $route_syntax_del default $route_syntax_gw \"`get_default_gw`\" $route_syntax_interface\n\t\t\troute add default $route_syntax_gw `cat \"$DEFAULT_ROUTE_FILE\"`\n\t\t\trm -f -- \"$DEFAULT_ROUTE_FILE\"\n\t\tfi\n\t}\n\n\tdel_network_route() {\n\t\tcase \"$OS\" in\n\t\tLinux|NetBSD|OpenBSD|Darwin|SunOS) # and probably others...\n\t\t\t# routes are deleted automatically on device shutdown\n\t\t\treturn\n\t\t\t;;\n\t\tesac\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\troute $route_syntax_del -net \"$NETWORK\" $route_syntax_netmask \"$NETMASK\" $route_syntax_gw \"$INTERNAL_IP4_ADDRESS\"\n\t}\n\n\tset_ipv6_default_route() {\n\t\troute add -inet6 default \"$INTERNAL_IP6_ADDRESS\" $route_syntax_interface\n\t}\n\n\tset_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\troute add -inet6 -net \"$NETWORK/$NETMASK\" \"$INTERNAL_IP6_ADDRESS\" $route_syntax_interface\n\t\t:\n\t}\n\n\treset_ipv6_default_route() {\n\t\troute $route_syntax_del -inet6 default \"$INTERNAL_IP6_ADDRESS\"\n\t\t:\n\t}\n\n\tdel_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\troute $route_syntax_del -inet6 \"$NETWORK/$NETMASK\" \"$INTERNAL_IP6_ADDRESS\"\n\t\t:\n\t}\n\nfi\n\n# =========== resolv.conf handling ====================================\n\n# =========== resolv.conf handling for any OS =========================\n\nmodify_resolvconf_generic() {\n\tgrep '^#@VPNC_GENERATED@' /etc/resolv.conf > /dev/null 2>&1 || cp -- /etc/resolv.conf \"$RESOLV_CONF_BACKUP\"\n\tNEW_RESOLVCONF=\"#@VPNC_GENERATED@ -- this file is generated by vpnc\n# and will be overwritten by vpnc\n# as long as the above mark is intact\"\n\n\tDOMAINS=\"$CISCO_DEF_DOMAIN\"\n\n\texec 6< \"$RESOLV_CONF_BACKUP\"\n\twhile read LINE <&6 ; do\n\t\tcase \"$LINE\" in\n\t\t\t# omit; we will overwrite these\n\t\t\tnameserver*) ;;\n\t\t\t# extract listed domains and prepend to list\n\t\t\tdomain* | search*) DOMAINS=\"${LINE#* } $DOMAINS\" ;;\n\t\t\t# retain other lines\n\t\t\t*) NEW_RESOLVCONF=\"$NEW_RESOLVCONF\n$LINE\" ;;\n\t\tesac\n\tdone\n\texec 6<&-\n\n\tfor i in $INTERNAL_IP4_DNS ; do\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\nnameserver $i\"\n\tdone\n\t# note that \"search\" is mutually exclusive with \"domain\";\n\t# \"search\" allows multiple domains to be listed, so use that\n\tif [ -n \"$DOMAINS\" ]; then\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\nsearch $DOMAINS\"\n\tfi\n\techo \"$NEW_RESOLVCONF\" > /etc/resolv.conf\n\n\tif [ \"$OS\" = \"Darwin\" ]; then\n\t\tcase \"`uname -r`\" in\n\t\t\t# Skip for pre-10.4 systems\n\t\t\t4.*|5.*|6.*|7.*)\n\t\t\t\t;;\n\t\t\t# 10.4 and later require use of scutil for DNS to work properly\n\t\t\t*)\n\t\t\t\tOVERRIDE_PRIMARY=\"\"\n\t\t\t\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\t\t\t\tif [ $CISCO_SPLIT_INC -lt 1 ]; then\n\t\t\t\t\t\t# Must override for correct default route\n\t\t\t\t\t\t# Cannot use multiple DNS matching in this case\n\t\t\t\t\t\tOVERRIDE_PRIMARY='d.add OverridePrimary # 1'\n\t\t\t\t\tfi\n\t\t\t\t\t# Overriding the default gateway breaks split routing\n\t\t\t\t\tOVERRIDE_GATEWAY=\"\"\n\t\t\t\t\t# Not overriding the default gateway breaks usage of\n\t\t\t\t\t# INTERNAL_IP4_DNS. Prepend INTERNAL_IP4_DNS to list\n\t\t\t\t\t# of used DNS servers\n\t\t\t\t\tSERVICE=`echo \"show State:/Network/Global/IPv4\" | scutil | grep -oE '[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}'`\n\t\t\t\t\tSERVICE_DNS=`echo \"show State:/Network/Service/$SERVICE/DNS\" | scutil | grep -oE '([0-9]{1,3}[\\.]){3}[0-9]{1,3}' | xargs`\n\t\t\t\t\tif [ X\"$SERVICE_DNS\" != X\"$INTERNAL_IP4_DNS\" ]; then\n\t\t\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\tget State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\td.add ServerAddresses * $INTERNAL_IP4_DNS $SERVICE_DNS\n\t\t\t\t\t\t\tset State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\tclose\n\t\t\t\t\t\tEOF\n\t\t\t\t\tfi\n\t\t\t\telse\n\t\t\t\t\t# No split routing. Override default gateway\n\t\t\t\t\tOVERRIDE_GATEWAY=\"d.add Router $INTERNAL_IP4_ADDRESS\"\n\t\t\t\tfi\n\t\t\t\t# Uncomment the following if/fi pair to use multiple\n\t\t\t\t# DNS matching when available.  When multiple DNS matching\n\t\t\t\t# is present, anything reading the /etc/resolv.conf file\n\t\t\t\t# directly will probably not work as intended.\n\t\t\t\t#if [ -z \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t\t\t\t# Cannot use multiple DNS matching without a domain\n\t\t\t\t\tOVERRIDE_PRIMARY='d.add OverridePrimary # 1'\n\t\t\t\t#fi\n\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\topen\n\t\t\t\t\td.init\n\t\t\t\t\td.add ServerAddresses * $INTERNAL_IP4_DNS\n\t\t\t\t\tset State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\td.init\n\t\t\t\t\t$OVERRIDE_GATEWAY\n\t\t\t\t\td.add Addresses * $INTERNAL_IP4_ADDRESS\n\t\t\t\t\td.add SubnetMasks * 255.255.255.255\n\t\t\t\t\td.add InterfaceName $TUNDEV\n\t\t\t\t\t$OVERRIDE_PRIMARY\n\t\t\t\t\tset State:/Network/Service/$TUNDEV/IPv4\n\t\t\t\t\tclose\n\t\t\t\tEOF\n\t\t\t\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\t\topen\n\t\t\t\t\t\tget State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\t\td.add DomainName $CISCO_DEF_DOMAIN\n\t\t\t\t\t\td.add SearchDomains * $CISCO_DEF_DOMAIN\n\t\t\t\t\t\td.add SupplementalMatchDomains * $CISCO_DEF_DOMAIN\n\t\t\t\t\t\tset State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\t\tclose\n\t\t\t\t\tEOF\n\t\t\t\tfi\n\t\t\t\t;;\n\t\tesac\n\tfi\n}\n\nrestore_resolvconf_generic() {\n\tif [ ! -f \"$RESOLV_CONF_BACKUP\" ]; then\n\t\treturn\n\tfi\n\tgrep '^#@VPNC_GENERATED@' /etc/resolv.conf > /dev/null 2>&1 && cat \"$RESOLV_CONF_BACKUP\" > /etc/resolv.conf\n\trm -f -- \"$RESOLV_CONF_BACKUP\"\n\n\tif [ \"$OS\" = \"Darwin\" ]; then\n\t\tcase \"`uname -r`\" in\n\t\t\t# Skip for pre-10.4 systems\n\t\t\t4.*|5.*|6.*|7.*)\n\t\t\t\t;;\n\t\t\t# 10.4 and later require use of scutil for DNS to work properly\n\t\t\t*)\n\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\topen\n\t\t\t\t\tremove State:/Network/Service/$TUNDEV/IPv4\n\t\t\t\t\tremove State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\tclose\n\t\t\t\tEOF\n\t\t\t\t# Split routing required prepending of INTERNAL_IP4_DNS\n\t\t\t\t# to list of used DNS servers\n\t\t\t\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\t\t\t\tSERVICE=`echo \"show State:/Network/Global/IPv4\" | scutil | grep -oE '[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}'`\n\t\t\t\t\tSERVICE_DNS=`echo \"show State:/Network/Service/$SERVICE/DNS\" | scutil | grep -oE '([0-9]{1,3}[\\.]){3}[0-9]{1,3}' | xargs`\n\t\t\t\t\tif [ X\"$SERVICE_DNS\" != X\"$INTERNAL_IP4_DNS\" ]; then\n\t\t\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\tget State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\td.add ServerAddresses * ${SERVICE_DNS##$INTERNAL_IP4_DNS}\n\t\t\t\t\t\t\tset State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\tclose\n\t\t\t\t\t\tEOF\n\t\t\t\t\tfi\n\t\t\t\tfi\n\t\t\t\t;;\n\t\tesac\n\tfi\n}\n# === resolv.conf handling via /sbin/netconfig (Suse 11.1) =====================\n\n# Suse provides a script that modifies resolv.conf. Use it because it will\n# restart/reload all other services that care about it (e.g. lwresd).  [unclear if this is still true, but probably --mlk]\n\nmodify_resolvconf_suse_netconfig()\n{\n\t/sbin/netconfig modify -s vpnc -i \"$TUNDEV\" <<-EOF\n\t\tINTERFACE='$TUNDEV'\n\t\tDNSSERVERS='$INTERNAL_IP4_DNS'\n\t\tDNSDOMAIN='$CISCO_DEF_DOMAIN'\n\t\tEOF\n}\n# Restore resolv.conf to old contents on Suse\nrestore_resolvconf_suse_netconfig()\n{\n\t/sbin/netconfig remove -s vpnc -i \"$TUNDEV\"\n}\n\n# === resolv.conf handling via /sbin/modify_resolvconf (Suse) =====================\n\n# Suse provides a script that modifies resolv.conf. Use it because it will\n# restart/reload all other services that care about it (e.g. lwresd).\n\nmodify_resolvconf_suse()\n{\n\tFULL_SCRIPTNAME=`readlink -f $0`\n\tRESOLV_OPTS=''\n\ttest -n \"$INTERNAL_IP4_DNS\" && RESOLV_OPTS=\"-n \\\"$INTERNAL_IP4_DNS\\\"\"\n\ttest -n \"$CISCO_DEF_DOMAIN\" && RESOLV_OPTS=\"$RESOLV_OPTS -d $CISCO_DEF_DOMAIN\"\n\ttest -n \"$RESOLV_OPTS\" && eval /sbin/modify_resolvconf modify -s vpnc -p $SCRIPTNAME -f $FULL_SCRIPTNAME -e $TUNDEV $RESOLV_OPTS -t \\\"This file was created by $SCRIPTNAME\\\"\n}\n\n# Restore resolv.conf to old contents on Suse\nrestore_resolvconf_suse()\n{\n\tFULL_SCRIPTNAME=`readlink -f $0`\n\t/sbin/modify_resolvconf restore -s vpnc -p $SCRIPTNAME -f $FULL_SCRIPTNAME -e $TUNDEV\n}\n\n# === resolv.conf handling via UCI (OpenWRT) =========\n\nmodify_resolvconf_openwrt() {\n\tadd_dns $OPENWRT_INTERFACE $INTERNAL_IP4_DNS\n}\n\nrestore_resolvconf_openwrt() {\n\tremove_dns $OPENWRT_INTERFACE\n}\n# === resolv.conf handling via /sbin/resolvconf (Debian, Ubuntu, Gentoo)) =========\n\nmodify_resolvconf_manager() {\n\tNEW_RESOLVCONF=\"\"\n\tfor i in $INTERNAL_IP4_DNS; do\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\nnameserver $i\"\n\tdone\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\ndomain $CISCO_DEF_DOMAIN\"\n\tfi\n\techo \"$NEW_RESOLVCONF\" | /sbin/resolvconf -a $TUNDEV\n}\n\nrestore_resolvconf_manager() {\n\t/sbin/resolvconf -d $TUNDEV\n}\n\nAF_INET=2\n\nget_if_index() {\n\tlocal link\n\tlink=\"$(ip link show dev \"$1\")\" || return $?\n\techo ${link} | awk -F: '{print $1}'\n}\n\nbusctl_call() {\n\tlocal dest node\n\tdest=org.freedesktop.resolve1\n\tnode=/org/freedesktop/resolve1\n\tbusctl call \"$dest\" \"${node}\" \"${dest}.Manager\" \"$@\"\n}\n\nbusctl_set_nameservers() {\n\tlocal if_index addresses args addr\n\tif_index=$1\n\tshift\n\taddresses=\"$@\"\n\targs=\"$if_index $#\"\n\tfor addr in ${addresses}; do\n\t\targs=\"$args ${AF_INET} 4 $(echo $addr | sed 's/[.]/ /g')\"\n\tdone\n\tbusctl_call SetLinkDNS 'ia(iay)' ${args}\n}\n\nbusctl_set_search() {\n\tlocal if_index domains args domain\n\tif_index=$1\n\tshift\n\tdomains=\"$@\"\n\targs=\"$if_index $#\"\n\tfor domain in ${domains}; do\n\t\targs=\"$args ${domain} false\"\n\tdone\n\tbusctl_call SetLinkDomains 'ia(sb)' ${args}\n}\n\nmodify_resolved_manager() {\n\tlocal if_index\n\tif_index=$(get_if_index $TUNDEV)\n\tbusctl_set_nameservers $if_index $INTERNAL_IP4_DNS\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\tbusctl_set_search $if_index $CISCO_DEF_DOMAIN\n\tfi\n}\n\nrestore_resolved_manager() {\n\tlocal if_index\n\tif_index=$(get_if_index $TUNDEV)\n\tbusctl_call RevertLink 'i' $if_index\n}\n\n# === resolv.conf handling via unbound =========\n\nmodify_resolvconf_unbound() {\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t/usr/sbin/unbound-control forward_add +i ${CISCO_DEF_DOMAIN} ${INTERNAL_IP4_DNS}\n\t\t/usr/sbin/unbound-control flush_requestlist\n\t\t/usr/sbin/unbound-control flush_zone ${CISCO_DEF_DOMAIN}\n\tfi\n}\n\nrestore_resolvconf_unbound() {\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t/usr/sbin/unbound-control forward_remove +i ${CISCO_DEF_DOMAIN}\n\t\t/usr/sbin/unbound-control flush_zone ${CISCO_DEF_DOMAIN}\n\t\t/usr/sbin/unbound-control flush_requestlist\n\tfi\n}\n\n# ========= Toplevel state handling  =======================================\n\nkernel_is_2_6_or_above() {\n\tcase `uname -r` in\n\t\t1.*|2.[012345]*)\n\t\t\treturn 1\n\t\t\t;;\n\t\t*)\n\t\t\treturn 0\n\t\t\t;;\n\tesac\n}\n\ndo_pre_init() {\n\tif [ \"$OS\" = \"Linux\" ]; then\n\t\tif (exec 6< /dev/net/tun) > /dev/null 2>&1 ; then\n\t\t\t:\n\t\telse # can't open /dev/net/tun\n\t\t\ttest -e /proc/sys/kernel/modprobe && `cat /proc/sys/kernel/modprobe` tun 2>/dev/null\n\t\t\t# fix for broken devfs in kernel 2.6.x\n\t\t\tif [ \"`readlink /dev/net/tun`\" = misc/net/tun \\\n\t\t\t\t-a ! -e /dev/net/misc/net/tun -a -e /dev/misc/net/tun ] ; then\n\t\t\t\tln -sf /dev/misc/net/tun /dev/net/tun\n\t\t\tfi\n\t\t\t# make sure tun device exists\n\t\t\tif [ ! -e /dev/net/tun ]; then\n\t\t\t\tmkdir -p /dev/net\n\t\t\t\tmknod -m 0640 /dev/net/tun c 10 200\n\t\t\t\t[ -x /sbin/restorecon ] && /sbin/restorecon /dev/net/tun\n\t\t\tfi\n\t\t\t# workaround for a possible latency caused by udev, sleep max. 10s\n\t\t\tif kernel_is_2_6_or_above ; then\n\t\t\t\tfor x in `seq 100` ; do\n\t\t\t\t\t(exec 6<> /dev/net/tun) > /dev/null 2>&1 && break;\n\t\t\t\t\tsleep 0.1\n\t\t\t\tdone\n\t\t\tfi\n\t\tfi\n\telif [ \"$OS\" = \"FreeBSD\" ]; then\n\t\tif ! kldstat -q -m if_tun > /dev/null; then\n\t\t\tkldload if_tun\n\t\tfi\n\n\t\tif ! ifconfig $TUNDEV > /dev/null; then\n\t\t\tifconfig $TUNDEV create\n\t\tfi\n\telif [ \"$OS\" = \"GNU/kFreeBSD\" ]; then\n\t\tif [ ! -e /dev/tun ]; then\n\t\t\tkldload if_tun\n\t\tfi\n\telif [ \"$OS\" = \"NetBSD\" ]; then\n\t\t:\n\telif [ \"$OS\" = \"OpenBSD\" ]; then\n\t\tif ! ifconfig $TUNDEV > /dev/null; then\n\t\t\tifconfig $TUNDEV create\n\t\tfi\n\t\t:\n\telif [ \"$OS\" = \"SunOS\" ]; then\n\t\t:\n\telif [ \"$OS\" = \"Darwin\" ]; then\n\t\t:\n\tfi\n}\n\ndo_connect() {\n\tif [ -n \"$CISCO_BANNER\" ]; then\n\t\techo \"Connect Banner:\"\n\t\techo \"$CISCO_BANNER\" | while read LINE ; do echo \"|\" \"$LINE\" ; done\n\t\techo\n\tfi\n\n\tset_vpngateway_route\n\tdo_ifconfig\n\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASK=\"\\${CISCO_SPLIT_INC_${i}_MASK}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ \"$NETWORK\" != \"0.0.0.0\" ]; then\n\t\t\t\tset_network_route \"$NETWORK\" \"$NETMASK\" \"$NETMASKLEN\"\n\t\t\telse\n\t\t\t\tset_default_route\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP4_DNS ; do\n\t\t\techo \"$i\" | grep : >/dev/null || \\\n\t\t\t\tset_network_route \"$i\" \"255.255.255.255\" \"32\"\n\t\tdone\n\telif [ -n \"$INTERNAL_IP4_ADDRESS\" ]; then\n\t\tset_default_route\n\tfi\n\tif [ -n \"$CISCO_IPV6_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_IPV6_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_IPV6_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_IPV6_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ $NETMASKLEN -lt 128 ]; then\n\t\t\t\tset_ipv6_network_route \"$NETWORK\" \"$NETMASKLEN\"\n\t\t\telse\n\t\t\t\tset_ipv6_default_route\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP4_DNS ; do\n\t\t\tif echo \"$i\" | grep : >/dev/null; then\n\t\t\t\tset_ipv6_network_route \"$i\" \"128\"\n\t\t\tfi\n\t\tdone\n\telif [ -n \"$INTERNAL_IP6_NETMASK\" -o -n \"$INTERNAL_IP6_ADDRESS\" ]; then\n\t\tset_ipv6_default_route\n\tfi\n\n\tif [ -n \"$INTERNAL_IP4_DNS\" ]; then\n\t\t$MODIFYRESOLVCONF\n\tfi\n}\n\ndo_disconnect() {\n\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASK=\"\\${CISCO_SPLIT_INC_${i}_MASK}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ \"$NETWORK\" != \"0.0.0.0\" ]; then\n\t\t\t\t# FIXME: This doesn't restore previously overwritten\n\t\t\t\t#        routes.\n\t\t\t\tdel_network_route \"$NETWORK\" \"$NETMASK\" \"$NETMASKLEN\"\n\t\t\telse\n\t\t\t\treset_default_route\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP4_DNS ; do\n\t\t\tdel_network_route \"$i\" \"255.255.255.255\" \"32\"\n\t\tdone\n\telse\n\t\treset_default_route\n\tfi\n\tif [ -n \"$CISCO_IPV6_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_IPV6_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_IPV6_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_IPV6_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ $NETMASKLEN -eq 0 ]; then\n\t\t\t\treset_ipv6_default_route\n\t\t\telse\n\t\t\t\tdel_ipv6_network_route \"$NETWORK\" \"$NETMASKLEN\"\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP6_DNS ; do\n\t\t\tdel_ipv6_network_route \"$i\" \"128\"\n\t\tdone\n\telif [ -n \"$INTERNAL_IP6_NETMASK\" -o -n \"$INTERNAL_IP6_ADDRESS\" ]; then\n\t\treset_ipv6_default_route\n\tfi\n\n\tdel_vpngateway_route\n\n\tif [ -n \"$INTERNAL_IP4_DNS\" ]; then\n\t\t$RESTORERESOLVCONF\n\tfi\n\n\n\tif [ -n \"$IPROUTE\" ]; then\n\t\tif [ -n \"$INTERNAL_IP4_ADDRESS\" ]; then\n\t\t\t$IPROUTE addr del \"$INTERNAL_IP4_ADDRESS/255.255.255.255\" peer \"$INTERNAL_IP4_ADDRESS\" dev \"$TUNDEV\"\n\t\tfi\n\t\t# If the netmask is provided, it contains the address _and_ netmask\n\t\tif [ -n \"$INTERNAL_IP6_ADDRESS\" ] && [ -z \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\tINTERNAL_IP6_NETMASK=\"$INTERNAL_IP6_ADDRESS/128\"\n\t\tfi\n\t\tif [ -n \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\t$IPROUTE -6 addr del $INTERNAL_IP6_NETMASK dev $TUNDEV\n\t\tfi\n\telse\n\t\tif [ -n \"$INTERNAL_IP4_ADDRESS\" ]; then\n\t\t\tifconfig \"$TUNDEV\" 0.0.0.0\n\t\tfi\n\t\tif [ -n \"$INTERNAL_IP6_ADDRESS\" ] && [ -z \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\tINTERNAL_IP6_NETMASK=\"$INTERNAL_IP6_ADDRESS/128\"\n\t\tfi\n\t\tif [ -n \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\tifconfig \"$TUNDEV\" inet6 del $INTERNAL_IP6_NETMASK\n\t\tfi\n\tfi\n\n\tdestroy_tun_device\n}\n\n#### Main\n\nif [ -z \"$reason\" ]; then\n\techo \"this script must be called from vpnc\" 1>&2\n\texit 1\nfi\n\ncase \"$reason\" in\n\tpre-init)\n\t\trun_hooks pre-init\n\t\tdo_pre_init\n\t\t;;\n\tconnect)\n\t\trun_hooks connect\n\t\tdo_connect\n\t\trun_hooks post-connect\n\t\t;;\n\tdisconnect)\n\t\trun_hooks disconnect\n\t\tdo_disconnect\n\t\trun_hooks post-disconnect\n\t\t;;\n\treconnect)\n\t\trun_hooks reconnect\n\t\t;;\n\t*)\n\t\techo \"unknown reason '$reason'. Maybe vpnc-script is out of date\" 1>&2\n\t\texit 1\n\t\t;;\nesac\n\nexit 0\n```","source":"_posts/201710091705.md","raw":"---\ntitle: ocserv搭建与使用\ndate: 2017-10-09 17:05:09\ntags:\n  - linux\n  - network\n  - gfw\n---\n\n\nAnyConnect为思科推出的VPN客户端，目前已有Windows、Android、IOS、Macintosh、Ubuntu、WebOS、Blackberry等操作系统的客户端。AnyConnection主要作用是方便员工在任何设备上安全地办公，AnyConnect最主要的优点是可以给客户端下发走VPN的路由表  \n本文介绍的是利用ocserv搭建openconnect服务器 \n\n<!-- more -->\n\n# 机器环境\n\n操作系统: debian7  \nocserv版本: 0.9.2\n\n# 服务器端配置\n\n## 1. 安装依赖\n\nocserv使用GnuTLS作为SSL的library,所以编译时需要相应的dev包.Debian Stable里面带的版本太老(2.12.20),而ocserv需要的包版本在2.15以上,所以需要从backports安装:\n``` \necho \"deb http://ftp.debian.org/debian wheezy-backports main contrib non-free\" >> /etc/apt/sources.list \napt-get update\napt-get upgarde\napt-get -t wheezy-backports install libgnutls28-dev -y \napt-get install libgmp3-dev m4 gcc pkg-config make gnutls-bin -y \napt-get install build-essential libwrap0-dev libpam0g-dev libdbus-1-dev libreadline-dev libnl-route-3-dev libprotobuf-c0-dev libpcl1-dev libopts25-dev autogen libgnutls28-dev libseccomp-dev liblz4-dev -y \n```\n\n## 2. 修改最大路由数目\n\nocserv可以修改src/vpn.h来支持超过96行(ocserv默认值)但不超过200行(Cisco Anyconnect最大值)的路由表\n> \\# define MAX_CONFIG_ENTRIES 96\n\n注意根据Cisco官方文档,no-route和route不能同时使用\n\n## 3. 下载&编译&安装\n\n```\nwget ftp://ftp.infradead.org/pub/ocserv/ocserv-0.9.2.tar.xz \ntar Jxvf ocserv-0.9.2.tar.xz \ncd ocserv-0.9.2 \n./configure --prefix=/usr --sysconfdir=/etc \nmake \nmake install \n```\n\n## 4. 生成证书\n\n### 4.1 生成CA证书\n\n```\ncerttool --generate-privkey --outfile ca-key.pem\nvim ca.tmpl\n```\n\n> cn = \"aya\"  \n> organization = \"aya\"  \n> serial = 1  \n> expiration_days = 3650  \n> ca  \n> signing_key  \n> cert_signing_key  \n> crl_signing_key  \n\n``` \ncerttool --generate-self-signed --load-privkey ca-key.pem --template ca.tmpl --outfile ca-cert.pem \n```\n\n### 4.2 生成本地服务器证书\n\n``` \ncerttool --generate-privkey --outfile server-key.pem\nvim server.tmpl\n```\n\n> cn = \"littleya.com\"  \n> organization = \"aya\"  \n> serial = 2  \n> expiration_days = 3650  \n> encryption_key  \n> signing_key  \n> tls_www_server  \n\n```\ncerttool --generate-certificate --load-privkey server-key.pem --load-ca-certificate ca-cert.pem --load-ca-privkey ca-key.pem --template server.tmpl --outfile server-cert.pem \n```\n\n### 4.3 移动生成的证书\n\n```\nmkdir /etc/ssl \nmkdir /etc/ssl/certs \nmkdir /etc/ssl/private \ncp ca-cert.pem /etc/ssl/certs \ncp ca-key.pem /etc/ssl/private \ncp server-cert.pem /etc/ssl/certs \ncp server-key.pem /etc/ssl/private\n```\n\n## 5 编辑配置文件\n\n### 5.1 拷贝配置文件到 _/etc/ocserv_ 中\n\n```\nmkdir /etc/ocserv  \ncp ~/ocserv-0.9.2/doc/sample.config /etc/ocserv/ \ncp /etc/ocserv/sample.config /etc/ocserv/ocserv.conf\n```\n\n### 5.2 编辑配置文件\n\n```\nvim /etc/ocserv/ocserv.conf\n```\n\n> auth = \"plain[/etc/ocserv/ocpasswd]\"  \n> \\# ocserv支持多种认证方式，这是自带的密码认证，使用ocpasswd创建密码文件  \n> \\# ocserv还支持证书认证，可以通过Pluggable Authentication Modules (PAM)使用radius等认证方式\n> <br>\n>   \n> \\# 证书路径  \n> server-cert = /etc/ssl/certs/server-cert.pem  \n> server-key = /etc/ssl/private/server-key.pem\n> <br>\n>   \n> \\# if letsencrypt  \n> \\# server-cert = /etc/letsencrypt/live/example.com/fullchain.pem  \n> \\# server-key = /etc/letsencrypt/live/example.com/privkey.pem\n> <br>\n>   \n> \\# 同一个用户最多同时登陆数  \n> max-same-clients = 10\n> <br>\n>   \n> \\# 运行组  \n> run-as-group = nogroup\n> <br>\n>   \n> \\# 分配给VPN客户端的IP段  \n> ipv4-network = 192.168.1.0\n> <br>\n>   \n> \\# DNS  \n> dns = 8.8.8.8  \n> dns = 8.8.4.4\n> <br>\n>   \n> \\# Keepalive in seconds  \n> keepalive = 600\n> <br>\n>   \n> \\#Dead peer detection in seconds.  \n> dpd = 900\n> <br>\n>\n> \\# Dead peer detection for mobile clients. The needs to  \n> \\# be much higher to prevent such clients being awaken too  \n> \\# often by the DPD messages, and save battery.  \n> \\# (clients that send the X-AnyConnect-Identifier-DeviceType)  \n> mobile-dpd = 1800\n> <br>\n>  \n> output-buffer = 23000  \n> try-mtu-discovery = true\n> <br>\n>  \n> \\# The time (in seconds) that a client is allowed to stay idle (no traffic)  \n> \\# before being disconnected. Unset to disable.  \n> idle-timeout = 3600\n> <br>\n>  \n> \\# The time (in seconds) that a mobile client is allowed to stay idle (no traffic) before being disconnected. Unset to disable. \n> mobile-idle-timeout = 3600\n> <br>\n>  \n> \\# 注释掉route的字段，这样表示所有流量都通过 VPN 发送  \n> \\# route = 192.168.16.0/255.255.255.0  \n> \\# route = 192.168.5.0/255.255.255.0\n\n其中路由表的信息,可以从Github上的 [ocserv-cn-no-route][1] 项目配置\n[1]: https://github.com/CNMan/ocserv-cn-no-route \"ocserv-cn-no-route\"\n\n### 5.3 生成用户\n\n```\nocpasswd -c /etc/ocserv/ocpasswd user.name\n#user.name为用户名\n```\n\n## 6. 其他配置\n\n### 6.1 开启转发\n\n```\nvim /etc/sysctl.conf\n```\n\n> net.ipv4.ip_forward = 1\n\n```\nsysctl -p\n```\n\n### 6.2 iptables表\n\n```\niptables -t nat -A POSTROUTING -j MASQUERADE \niptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu \n \n#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式 \n \niptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j SNAT --to-source VPN SERVER'S IP \niptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu \n \n#若打开网页有问题可以尝试把mtu调小\niptables -A FORWARD -p tcp --syn -s 192.168.1.0/24 -j TCPMSS --set-mss 1356\n```\n\n### 6.3 调试\n\n```\nocserv -c /etc/ocserv/ocserv.conf -f -d 1\n```\n\n### 6.4 开机启动\n\n```\nvim /etc/rc.local\n```\n\n> iptables -t nat -A POSTROUTING -j MASQUERADE  \n> iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu\n> <br>\n> \n> \\#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式\n> <br>\n> \n> iptables -t nat -A POSTROUTING -s 192.168.110.0/24 -j SNAT --to-source VPN SERVER'S IP  \n> iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu\n> <br>\n> \n> ocserv\n\n# 客户端配置\n\n## Linux:\n\n```\napt-get install -y openconnect expect screen\nvim /usr/local/sbin/ocdo.sh\n```\n\n> \\#!/usr/bin/expect  \n> spawn screen -S ocdo openconnect -u username --script=/etc/vpnc/vpnc-script --no-dtls vpn.example.com -b  \n> expect \"anything else\"  \n> send \"yes\\r\"  \n> expect \"Password:\"  \n> send \"password\\r\"  \n> interact  \n\n```\necho \"/usr/local/sbin/ocdo.sh\" >> /rc.local \nmkdir /etc/vpnc && cd /etc/vpnc \nwget http://git.infradead.org/users/dwmw2/vpnc-scripts.git/blob_plain/HEAD:/vpnc-script \n```\n\nvpnc-script:\n``` bash\n#!/bin/sh\n#\n# Originally part of vpnc source code:\n# Â© 2005-2012 Maurice Massar, JÃ¶rg Mayer, Antonio Borneo et al.\n# Â© 2009-2012 David Woodhouse <dwmw2@infradead.org>\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 2 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\n#\n################\n#\n# List of parameters passed through environment\n#* reason                       -- why this script was called, one of: pre-init connect disconnect reconnect\n#* VPNGATEWAY                   -- vpn gateway address (always present)\n#* TUNDEV                       -- tunnel device (always present)\n#* INTERNAL_IP4_ADDRESS         -- address (always present)\n#* INTERNAL_IP4_MTU             -- mtu (often unset)\n#* INTERNAL_IP4_NETMASK         -- netmask (often unset)\n#* INTERNAL_IP4_NETMASKLEN      -- netmask length (often unset)\n#* INTERNAL_IP4_NETADDR         -- address of network (only present if netmask is set)\n#* INTERNAL_IP4_DNS             -- list of dns servers\n#* INTERNAL_IP4_NBNS            -- list of wins servers\n#* INTERNAL_IP6_ADDRESS         -- IPv6 address\n#* INTERNAL_IP6_NETMASK         -- IPv6 netmask\n#* INTERNAL_IP6_DNS             -- IPv6 list of dns servers\n#* CISCO_DEF_DOMAIN             -- default domain name\n#* CISCO_BANNER                 -- banner from server\n#* CISCO_SPLIT_INC              -- number of networks in split-network-list\n#* CISCO_SPLIT_INC_%d_ADDR      -- network address\n#* CISCO_SPLIT_INC_%d_MASK      -- subnet mask (for example: 255.255.255.0)\n#* CISCO_SPLIT_INC_%d_MASKLEN   -- subnet masklen (for example: 24)\n#* CISCO_SPLIT_INC_%d_PROTOCOL  -- protocol (often just 0)\n#* CISCO_SPLIT_INC_%d_SPORT     -- source port (often just 0)\n#* CISCO_SPLIT_INC_%d_DPORT     -- destination port (often just 0)\n#* CISCO_IPV6_SPLIT_INC         -- number of networks in IPv6 split-network-list\n#* CISCO_IPV6_SPLIT_INC_%d_ADDR -- IPv6 network address\n#* CISCO_IPV6_SPLIT_INC_$%d_MASKLEN -- IPv6 subnet masklen\n\n# FIXMEs:\n\n# Section A: route handling\n\n# 1) The 3 values CISCO_SPLIT_INC_%d_PROTOCOL/SPORT/DPORT are currently being ignored\n#   In order to use them, we'll probably need os specific solutions\n#   * Linux: iptables -t mangle -I PREROUTING <conditions> -j ROUTE --oif $TUNDEV\n#       This would be an *alternative* to changing the routes (and thus 2) and 3)\n#       shouldn't be relevant at all)\n# 2) There are two different functions to set routes: generic routes and the\n#   default route. Why isn't the defaultroute handled via the generic route case?\n# 3) In the split tunnel case, all routes but the default route might get replaced\n#   without getting restored later. We should explicitely check and save them just\n#   like the defaultroute\n# 4) Replies to a dhcp-server should never be sent into the tunnel\n\n# Section B: Split DNS handling\n\n# 1) Maybe dnsmasq can do something like that\n# 2) Parse dns packets going out via tunnel and redirect them to original dns-server\n\n#env | sort\n#set -x\n\n# =========== script (variable) setup ====================================\n\nPATH=/sbin:/usr/sbin:$PATH\n\nOS=\"`uname -s`\"\n\nHOOKS_DIR=/etc/vpnc\nDEFAULT_ROUTE_FILE=/var/run/vpnc/defaultroute\nRESOLV_CONF_BACKUP=/var/run/vpnc/resolv.conf-backup\nSCRIPTNAME=`basename $0`\n\n# some systems, eg. Darwin & FreeBSD, prune /var/run on boot\nif [ ! -d \"/var/run/vpnc\" ]; then\n\tmkdir -p /var/run/vpnc\n\t[ -x /sbin/restorecon ] && /sbin/restorecon /var/run/vpnc\nfi\n\n# stupid SunOS: no blubber in /usr/local/bin ... (on stdout)\nIPROUTE=\"`which ip 2> /dev/null | grep '^/'`\"\n\nif ifconfig --help 2>&1 | grep BusyBox > /dev/null; then\n\tifconfig_syntax_inet=\"\"\nelse\n\tifconfig_syntax_inet=\"inet\"\nfi\n\nif [ \"$OS\" = \"Linux\" ]; then\n\tifconfig_syntax_ptp=\"pointopoint\"\n\troute_syntax_gw=\"gw\"\n\troute_syntax_del=\"del\"\n\troute_syntax_netmask=\"netmask\"\nelse\n\tifconfig_syntax_ptp=\"\"\n\troute_syntax_gw=\"\"\n\troute_syntax_del=\"delete\"\n\troute_syntax_netmask=\"-netmask\"\nfi\nif [ \"$OS\" = \"SunOS\" ]; then\n\troute_syntax_interface=\"-interface\"\n\tifconfig_syntax_ptpv6=\"$INTERNAL_IP6_ADDRESS\"\nelse\n\troute_syntax_interface=\"\"\n\tifconfig_syntax_ptpv6=\"\"\nfi\n\nif [ -r /etc/openwrt_release ] && [ -n \"$OPENWRT_INTERFACE\" ]; then\n        . /etc/functions.sh\n\tinclude /lib/network\n\tMODIFYRESOLVCONF=modify_resolvconf_openwrt\n\tRESTORERESOLVCONF=restore_resolvconf_openwrt\nelif [ -x /usr/bin/busctl ]; then  # For systemd-resolved (version 229 and above)\n\tMODIFYRESOLVCONF=modify_resolved_manager\n\tRESTORERESOLVCONF=restore_resolved_manager\nelif [ -x /sbin/resolvconf ]; then # Optional tool on Debian, Ubuntu, Gentoo and FreeBSD\n\tMODIFYRESOLVCONF=modify_resolvconf_manager\n\tRESTORERESOLVCONF=restore_resolvconf_manager\nelif [ -x /sbin/netconfig ]; then # tool on Suse after 11.1\n\tMODIFYRESOLVCONF=modify_resolvconf_suse_netconfig\n\tRESTORERESOLVCONF=restore_resolvconf_suse_netconfig\nelif [ -x /sbin/modify_resolvconf ]; then # Mandatory tool on Suse earlier than 11.1\n\tMODIFYRESOLVCONF=modify_resolvconf_suse\n\tRESTORERESOLVCONF=restore_resolvconf_suse\nelif [ -x /usr/sbin/unbound-control ] && /usr/sbin/unbound-control status > /dev/null 2>&1; then\n\tMODIFYRESOLVCONF=modify_resolvconf_unbound\n\tRESTORERESOLVCONF=restore_resolvconf_unbound\nelse # Generic for any OS\n\tMODIFYRESOLVCONF=modify_resolvconf_generic\n\tRESTORERESOLVCONF=restore_resolvconf_generic\nfi\n\n\n# =========== script hooks =================================================\n\nrun_hooks() {\n\tHOOK=\"$1\"\n\n\tif [ -d ${HOOKS_DIR}/${HOOK}.d ]; then\n\t    for script in ${HOOKS_DIR}/${HOOK}.d/* ; do\n\t\t[ -f $script ] && . $script\n\t    done\n\tfi\n}\n\n# =========== tunnel interface handling ====================================\n\ndo_ifconfig() {\n\tif [ -n \"$INTERNAL_IP4_MTU\" ]; then\n\t\tMTU=$INTERNAL_IP4_MTU\n\telif [ -n \"$IPROUTE\" ]; then\n\t\tMTUDEV=`$IPROUTE route get \"$VPNGATEWAY\" | sed -ne 's/^.*dev \\([a-z0-9]*\\).*$/\\1/p'`\n\t\tMTU=`$IPROUTE link show \"$MTUDEV\" | sed -ne 's/^.*mtu \\([[:digit:]]\\+\\).*$/\\1/p'`\n\t\tif [ -n \"$MTU\" ]; then\n\t\t\tMTU=`expr $MTU - 88`\n\t\tfi\n\tfi\n\n\tif [ -z \"$MTU\" ]; then\n\t\tMTU=1412\n\tfi\n\n\t# Point to point interface require a netmask of 255.255.255.255 on some systems\n\tif [ -n \"$IPROUTE\" ]; then\n\t\t$IPROUTE link set dev \"$TUNDEV\" up mtu \"$MTU\"\n\t\t$IPROUTE addr add \"$INTERNAL_IP4_ADDRESS/32\" peer \"$INTERNAL_IP4_ADDRESS\" dev \"$TUNDEV\"\n\telse\n\t\tifconfig \"$TUNDEV\" ${ifconfig_syntax_inet} \"$INTERNAL_IP4_ADDRESS\" $ifconfig_syntax_ptp \"$INTERNAL_IP4_ADDRESS\" netmask 255.255.255.255 mtu ${MTU} up\n\tfi\n\n\tif [ -n \"$INTERNAL_IP4_NETMASK\" ]; then\n\t\tset_network_route $INTERNAL_IP4_NETADDR $INTERNAL_IP4_NETMASK $INTERNAL_IP4_NETMASKLEN\n\tfi\n\n\t# If the netmask is provided, it contains the address _and_ netmask\n\tif [ -n \"$INTERNAL_IP6_ADDRESS\" ] && [ -z \"$INTERNAL_IP6_NETMASK\" ]; then\n\t    INTERNAL_IP6_NETMASK=\"$INTERNAL_IP6_ADDRESS/128\"\n\tfi\n\tif [ -n \"$INTERNAL_IP6_NETMASK\" ]; then\n\t    if [ -n \"$IPROUTE\" ]; then\n\t\t$IPROUTE -6 addr add $INTERNAL_IP6_NETMASK dev $TUNDEV\n\t    else\n\t\t# Unlike for Legacy IP, we don't specify the dest_address\n\t\t# here on *BSD. OpenBSD for one will refuse to accept\n\t\t# incoming packets to that address if we do.\n\t\t# OpenVPN does the same (gives dest_address for Legacy IP\n\t\t# but not for IPv6).\n\t\t# Only Solaris needs it; hence $ifconfig_syntax_ptpv6\n\t        ifconfig \"$TUNDEV\" inet6 $INTERNAL_IP6_NETMASK $ifconfig_syntax_ptpv6 mtu $MTU up\n\t    fi\n\tfi\n}\n\ndestroy_tun_device() {\n\tcase \"$OS\" in\n\tNetBSD|OpenBSD) # and probably others...\n\t\tifconfig \"$TUNDEV\" destroy\n\t\t;;\n\tFreeBSD)\n\t\tifconfig \"$TUNDEV\" destroy > /dev/null 2>&1 &\n\t\t;;\n\tesac\n}\n\n# =========== route handling ====================================\n\nif [ -n \"$IPROUTE\" ]; then\n\tfix_ip_get_output () {\n\t\tsed -e 's/ /\\n/g' | \\\n\t\t    sed -ne '1p;/via/{N;p};/dev/{N;p};/src/{N;p};/mtu/{N;p}'\n\t}\n\n\tset_vpngateway_route() {\n\t\t$IPROUTE route add `$IPROUTE route get \"$VPNGATEWAY\" | fix_ip_get_output`\n\t\t$IPROUTE route flush cache\n\t}\n\n\tdel_vpngateway_route() {\n\t\t$IPROUTE route $route_syntax_del \"$VPNGATEWAY\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tset_default_route() {\n\t\t$IPROUTE route | grep '^default' | fix_ip_get_output > \"$DEFAULT_ROUTE_FILE\"\n\t\t$IPROUTE route replace default dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tset_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\t$IPROUTE route replace \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\treset_default_route() {\n\t\tif [ -s \"$DEFAULT_ROUTE_FILE\" ]; then\n\t\t\t$IPROUTE route replace `cat \"$DEFAULT_ROUTE_FILE\"`\n\t\t\t$IPROUTE route flush cache\n\t\t\trm -f -- \"$DEFAULT_ROUTE_FILE\"\n\t\tfi\n\t}\n\n\tdel_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\t$IPROUTE route $route_syntax_del \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tset_ipv6_default_route() {\n\t\t# We don't save/restore IPv6 default route; just add a higher-priority one.\n\t\t$IPROUTE -6 route add default dev \"$TUNDEV\" metric 1\n\t\t$IPROUTE -6 route flush cache\n\t}\n\n\tset_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASKLEN=\"$2\"\n\t\t$IPROUTE -6 route replace \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\treset_ipv6_default_route() {\n\t\t$IPROUTE -6 route del default dev \"$TUNDEV\"\n\t\t$IPROUTE route flush cache\n\t}\n\n\tdel_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASKLEN=\"$2\"\n\t\t$IPROUTE -6 route del \"$NETWORK/$NETMASKLEN\" dev \"$TUNDEV\"\n\t\t$IPROUTE -6 route flush cache\n\t}\nelse # use route command\n\tget_default_gw() {\n\t\t# isn't -n supposed to give --numeric output?\n\t\t# apperently not...\n\t\t# Get rid of lines containing IPv6 addresses (':')\n\t\tnetstat -r -n | awk '/:/ { next; } /^(default|0\\.0\\.0\\.0)/ { print $2; }'\n\t}\n\n\tset_vpngateway_route() {\n\t\troute add -host \"$VPNGATEWAY\" $route_syntax_gw \"`get_default_gw`\"\n\t}\n\n\tdel_vpngateway_route() {\n\t\troute $route_syntax_del -host \"$VPNGATEWAY\" $route_syntax_gw \"`get_default_gw`\"\n\t}\n\n\tset_default_route() {\n\t\tDEFAULTGW=\"`get_default_gw`\"\n\t\techo \"$DEFAULTGW\" > \"$DEFAULT_ROUTE_FILE\"\n\t\troute $route_syntax_del default $route_syntax_gw \"$DEFAULTGW\"\n\t\troute add default $route_syntax_gw \"$INTERNAL_IP4_ADDRESS\" $route_syntax_interface\n\t}\n\n\tset_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\tdel_network_route \"$NETWORK\" \"$NETMASK\" \"$NETMASKLEN\"\n\t\troute add -net \"$NETWORK\" $route_syntax_netmask \"$NETMASK\" $route_syntax_gw \"$INTERNAL_IP4_ADDRESS\" $route_syntax_interface\n\t}\n\n\treset_default_route() {\n\t\tif [ -s \"$DEFAULT_ROUTE_FILE\" ]; then\n\t\t\troute $route_syntax_del default $route_syntax_gw \"`get_default_gw`\" $route_syntax_interface\n\t\t\troute add default $route_syntax_gw `cat \"$DEFAULT_ROUTE_FILE\"`\n\t\t\trm -f -- \"$DEFAULT_ROUTE_FILE\"\n\t\tfi\n\t}\n\n\tdel_network_route() {\n\t\tcase \"$OS\" in\n\t\tLinux|NetBSD|OpenBSD|Darwin|SunOS) # and probably others...\n\t\t\t# routes are deleted automatically on device shutdown\n\t\t\treturn\n\t\t\t;;\n\t\tesac\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\tNETMASKLEN=\"$3\"\n\t\troute $route_syntax_del -net \"$NETWORK\" $route_syntax_netmask \"$NETMASK\" $route_syntax_gw \"$INTERNAL_IP4_ADDRESS\"\n\t}\n\n\tset_ipv6_default_route() {\n\t\troute add -inet6 default \"$INTERNAL_IP6_ADDRESS\" $route_syntax_interface\n\t}\n\n\tset_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\troute add -inet6 -net \"$NETWORK/$NETMASK\" \"$INTERNAL_IP6_ADDRESS\" $route_syntax_interface\n\t\t:\n\t}\n\n\treset_ipv6_default_route() {\n\t\troute $route_syntax_del -inet6 default \"$INTERNAL_IP6_ADDRESS\"\n\t\t:\n\t}\n\n\tdel_ipv6_network_route() {\n\t\tNETWORK=\"$1\"\n\t\tNETMASK=\"$2\"\n\t\troute $route_syntax_del -inet6 \"$NETWORK/$NETMASK\" \"$INTERNAL_IP6_ADDRESS\"\n\t\t:\n\t}\n\nfi\n\n# =========== resolv.conf handling ====================================\n\n# =========== resolv.conf handling for any OS =========================\n\nmodify_resolvconf_generic() {\n\tgrep '^#@VPNC_GENERATED@' /etc/resolv.conf > /dev/null 2>&1 || cp -- /etc/resolv.conf \"$RESOLV_CONF_BACKUP\"\n\tNEW_RESOLVCONF=\"#@VPNC_GENERATED@ -- this file is generated by vpnc\n# and will be overwritten by vpnc\n# as long as the above mark is intact\"\n\n\tDOMAINS=\"$CISCO_DEF_DOMAIN\"\n\n\texec 6< \"$RESOLV_CONF_BACKUP\"\n\twhile read LINE <&6 ; do\n\t\tcase \"$LINE\" in\n\t\t\t# omit; we will overwrite these\n\t\t\tnameserver*) ;;\n\t\t\t# extract listed domains and prepend to list\n\t\t\tdomain* | search*) DOMAINS=\"${LINE#* } $DOMAINS\" ;;\n\t\t\t# retain other lines\n\t\t\t*) NEW_RESOLVCONF=\"$NEW_RESOLVCONF\n$LINE\" ;;\n\t\tesac\n\tdone\n\texec 6<&-\n\n\tfor i in $INTERNAL_IP4_DNS ; do\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\nnameserver $i\"\n\tdone\n\t# note that \"search\" is mutually exclusive with \"domain\";\n\t# \"search\" allows multiple domains to be listed, so use that\n\tif [ -n \"$DOMAINS\" ]; then\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\nsearch $DOMAINS\"\n\tfi\n\techo \"$NEW_RESOLVCONF\" > /etc/resolv.conf\n\n\tif [ \"$OS\" = \"Darwin\" ]; then\n\t\tcase \"`uname -r`\" in\n\t\t\t# Skip for pre-10.4 systems\n\t\t\t4.*|5.*|6.*|7.*)\n\t\t\t\t;;\n\t\t\t# 10.4 and later require use of scutil for DNS to work properly\n\t\t\t*)\n\t\t\t\tOVERRIDE_PRIMARY=\"\"\n\t\t\t\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\t\t\t\tif [ $CISCO_SPLIT_INC -lt 1 ]; then\n\t\t\t\t\t\t# Must override for correct default route\n\t\t\t\t\t\t# Cannot use multiple DNS matching in this case\n\t\t\t\t\t\tOVERRIDE_PRIMARY='d.add OverridePrimary # 1'\n\t\t\t\t\tfi\n\t\t\t\t\t# Overriding the default gateway breaks split routing\n\t\t\t\t\tOVERRIDE_GATEWAY=\"\"\n\t\t\t\t\t# Not overriding the default gateway breaks usage of\n\t\t\t\t\t# INTERNAL_IP4_DNS. Prepend INTERNAL_IP4_DNS to list\n\t\t\t\t\t# of used DNS servers\n\t\t\t\t\tSERVICE=`echo \"show State:/Network/Global/IPv4\" | scutil | grep -oE '[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}'`\n\t\t\t\t\tSERVICE_DNS=`echo \"show State:/Network/Service/$SERVICE/DNS\" | scutil | grep -oE '([0-9]{1,3}[\\.]){3}[0-9]{1,3}' | xargs`\n\t\t\t\t\tif [ X\"$SERVICE_DNS\" != X\"$INTERNAL_IP4_DNS\" ]; then\n\t\t\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\tget State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\td.add ServerAddresses * $INTERNAL_IP4_DNS $SERVICE_DNS\n\t\t\t\t\t\t\tset State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\tclose\n\t\t\t\t\t\tEOF\n\t\t\t\t\tfi\n\t\t\t\telse\n\t\t\t\t\t# No split routing. Override default gateway\n\t\t\t\t\tOVERRIDE_GATEWAY=\"d.add Router $INTERNAL_IP4_ADDRESS\"\n\t\t\t\tfi\n\t\t\t\t# Uncomment the following if/fi pair to use multiple\n\t\t\t\t# DNS matching when available.  When multiple DNS matching\n\t\t\t\t# is present, anything reading the /etc/resolv.conf file\n\t\t\t\t# directly will probably not work as intended.\n\t\t\t\t#if [ -z \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t\t\t\t# Cannot use multiple DNS matching without a domain\n\t\t\t\t\tOVERRIDE_PRIMARY='d.add OverridePrimary # 1'\n\t\t\t\t#fi\n\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\topen\n\t\t\t\t\td.init\n\t\t\t\t\td.add ServerAddresses * $INTERNAL_IP4_DNS\n\t\t\t\t\tset State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\td.init\n\t\t\t\t\t$OVERRIDE_GATEWAY\n\t\t\t\t\td.add Addresses * $INTERNAL_IP4_ADDRESS\n\t\t\t\t\td.add SubnetMasks * 255.255.255.255\n\t\t\t\t\td.add InterfaceName $TUNDEV\n\t\t\t\t\t$OVERRIDE_PRIMARY\n\t\t\t\t\tset State:/Network/Service/$TUNDEV/IPv4\n\t\t\t\t\tclose\n\t\t\t\tEOF\n\t\t\t\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\t\topen\n\t\t\t\t\t\tget State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\t\td.add DomainName $CISCO_DEF_DOMAIN\n\t\t\t\t\t\td.add SearchDomains * $CISCO_DEF_DOMAIN\n\t\t\t\t\t\td.add SupplementalMatchDomains * $CISCO_DEF_DOMAIN\n\t\t\t\t\t\tset State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\t\tclose\n\t\t\t\t\tEOF\n\t\t\t\tfi\n\t\t\t\t;;\n\t\tesac\n\tfi\n}\n\nrestore_resolvconf_generic() {\n\tif [ ! -f \"$RESOLV_CONF_BACKUP\" ]; then\n\t\treturn\n\tfi\n\tgrep '^#@VPNC_GENERATED@' /etc/resolv.conf > /dev/null 2>&1 && cat \"$RESOLV_CONF_BACKUP\" > /etc/resolv.conf\n\trm -f -- \"$RESOLV_CONF_BACKUP\"\n\n\tif [ \"$OS\" = \"Darwin\" ]; then\n\t\tcase \"`uname -r`\" in\n\t\t\t# Skip for pre-10.4 systems\n\t\t\t4.*|5.*|6.*|7.*)\n\t\t\t\t;;\n\t\t\t# 10.4 and later require use of scutil for DNS to work properly\n\t\t\t*)\n\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\topen\n\t\t\t\t\tremove State:/Network/Service/$TUNDEV/IPv4\n\t\t\t\t\tremove State:/Network/Service/$TUNDEV/DNS\n\t\t\t\t\tclose\n\t\t\t\tEOF\n\t\t\t\t# Split routing required prepending of INTERNAL_IP4_DNS\n\t\t\t\t# to list of used DNS servers\n\t\t\t\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\t\t\t\tSERVICE=`echo \"show State:/Network/Global/IPv4\" | scutil | grep -oE '[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}'`\n\t\t\t\t\tSERVICE_DNS=`echo \"show State:/Network/Service/$SERVICE/DNS\" | scutil | grep -oE '([0-9]{1,3}[\\.]){3}[0-9]{1,3}' | xargs`\n\t\t\t\t\tif [ X\"$SERVICE_DNS\" != X\"$INTERNAL_IP4_DNS\" ]; then\n\t\t\t\t\t\tscutil >/dev/null 2>&1 <<-EOF\n\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\tget State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\td.add ServerAddresses * ${SERVICE_DNS##$INTERNAL_IP4_DNS}\n\t\t\t\t\t\t\tset State:/Network/Service/$SERVICE/DNS\n\t\t\t\t\t\t\tclose\n\t\t\t\t\t\tEOF\n\t\t\t\t\tfi\n\t\t\t\tfi\n\t\t\t\t;;\n\t\tesac\n\tfi\n}\n# === resolv.conf handling via /sbin/netconfig (Suse 11.1) =====================\n\n# Suse provides a script that modifies resolv.conf. Use it because it will\n# restart/reload all other services that care about it (e.g. lwresd).  [unclear if this is still true, but probably --mlk]\n\nmodify_resolvconf_suse_netconfig()\n{\n\t/sbin/netconfig modify -s vpnc -i \"$TUNDEV\" <<-EOF\n\t\tINTERFACE='$TUNDEV'\n\t\tDNSSERVERS='$INTERNAL_IP4_DNS'\n\t\tDNSDOMAIN='$CISCO_DEF_DOMAIN'\n\t\tEOF\n}\n# Restore resolv.conf to old contents on Suse\nrestore_resolvconf_suse_netconfig()\n{\n\t/sbin/netconfig remove -s vpnc -i \"$TUNDEV\"\n}\n\n# === resolv.conf handling via /sbin/modify_resolvconf (Suse) =====================\n\n# Suse provides a script that modifies resolv.conf. Use it because it will\n# restart/reload all other services that care about it (e.g. lwresd).\n\nmodify_resolvconf_suse()\n{\n\tFULL_SCRIPTNAME=`readlink -f $0`\n\tRESOLV_OPTS=''\n\ttest -n \"$INTERNAL_IP4_DNS\" && RESOLV_OPTS=\"-n \\\"$INTERNAL_IP4_DNS\\\"\"\n\ttest -n \"$CISCO_DEF_DOMAIN\" && RESOLV_OPTS=\"$RESOLV_OPTS -d $CISCO_DEF_DOMAIN\"\n\ttest -n \"$RESOLV_OPTS\" && eval /sbin/modify_resolvconf modify -s vpnc -p $SCRIPTNAME -f $FULL_SCRIPTNAME -e $TUNDEV $RESOLV_OPTS -t \\\"This file was created by $SCRIPTNAME\\\"\n}\n\n# Restore resolv.conf to old contents on Suse\nrestore_resolvconf_suse()\n{\n\tFULL_SCRIPTNAME=`readlink -f $0`\n\t/sbin/modify_resolvconf restore -s vpnc -p $SCRIPTNAME -f $FULL_SCRIPTNAME -e $TUNDEV\n}\n\n# === resolv.conf handling via UCI (OpenWRT) =========\n\nmodify_resolvconf_openwrt() {\n\tadd_dns $OPENWRT_INTERFACE $INTERNAL_IP4_DNS\n}\n\nrestore_resolvconf_openwrt() {\n\tremove_dns $OPENWRT_INTERFACE\n}\n# === resolv.conf handling via /sbin/resolvconf (Debian, Ubuntu, Gentoo)) =========\n\nmodify_resolvconf_manager() {\n\tNEW_RESOLVCONF=\"\"\n\tfor i in $INTERNAL_IP4_DNS; do\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\nnameserver $i\"\n\tdone\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\tNEW_RESOLVCONF=\"$NEW_RESOLVCONF\ndomain $CISCO_DEF_DOMAIN\"\n\tfi\n\techo \"$NEW_RESOLVCONF\" | /sbin/resolvconf -a $TUNDEV\n}\n\nrestore_resolvconf_manager() {\n\t/sbin/resolvconf -d $TUNDEV\n}\n\nAF_INET=2\n\nget_if_index() {\n\tlocal link\n\tlink=\"$(ip link show dev \"$1\")\" || return $?\n\techo ${link} | awk -F: '{print $1}'\n}\n\nbusctl_call() {\n\tlocal dest node\n\tdest=org.freedesktop.resolve1\n\tnode=/org/freedesktop/resolve1\n\tbusctl call \"$dest\" \"${node}\" \"${dest}.Manager\" \"$@\"\n}\n\nbusctl_set_nameservers() {\n\tlocal if_index addresses args addr\n\tif_index=$1\n\tshift\n\taddresses=\"$@\"\n\targs=\"$if_index $#\"\n\tfor addr in ${addresses}; do\n\t\targs=\"$args ${AF_INET} 4 $(echo $addr | sed 's/[.]/ /g')\"\n\tdone\n\tbusctl_call SetLinkDNS 'ia(iay)' ${args}\n}\n\nbusctl_set_search() {\n\tlocal if_index domains args domain\n\tif_index=$1\n\tshift\n\tdomains=\"$@\"\n\targs=\"$if_index $#\"\n\tfor domain in ${domains}; do\n\t\targs=\"$args ${domain} false\"\n\tdone\n\tbusctl_call SetLinkDomains 'ia(sb)' ${args}\n}\n\nmodify_resolved_manager() {\n\tlocal if_index\n\tif_index=$(get_if_index $TUNDEV)\n\tbusctl_set_nameservers $if_index $INTERNAL_IP4_DNS\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\tbusctl_set_search $if_index $CISCO_DEF_DOMAIN\n\tfi\n}\n\nrestore_resolved_manager() {\n\tlocal if_index\n\tif_index=$(get_if_index $TUNDEV)\n\tbusctl_call RevertLink 'i' $if_index\n}\n\n# === resolv.conf handling via unbound =========\n\nmodify_resolvconf_unbound() {\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t/usr/sbin/unbound-control forward_add +i ${CISCO_DEF_DOMAIN} ${INTERNAL_IP4_DNS}\n\t\t/usr/sbin/unbound-control flush_requestlist\n\t\t/usr/sbin/unbound-control flush_zone ${CISCO_DEF_DOMAIN}\n\tfi\n}\n\nrestore_resolvconf_unbound() {\n\tif [ -n \"$CISCO_DEF_DOMAIN\" ]; then\n\t\t/usr/sbin/unbound-control forward_remove +i ${CISCO_DEF_DOMAIN}\n\t\t/usr/sbin/unbound-control flush_zone ${CISCO_DEF_DOMAIN}\n\t\t/usr/sbin/unbound-control flush_requestlist\n\tfi\n}\n\n# ========= Toplevel state handling  =======================================\n\nkernel_is_2_6_or_above() {\n\tcase `uname -r` in\n\t\t1.*|2.[012345]*)\n\t\t\treturn 1\n\t\t\t;;\n\t\t*)\n\t\t\treturn 0\n\t\t\t;;\n\tesac\n}\n\ndo_pre_init() {\n\tif [ \"$OS\" = \"Linux\" ]; then\n\t\tif (exec 6< /dev/net/tun) > /dev/null 2>&1 ; then\n\t\t\t:\n\t\telse # can't open /dev/net/tun\n\t\t\ttest -e /proc/sys/kernel/modprobe && `cat /proc/sys/kernel/modprobe` tun 2>/dev/null\n\t\t\t# fix for broken devfs in kernel 2.6.x\n\t\t\tif [ \"`readlink /dev/net/tun`\" = misc/net/tun \\\n\t\t\t\t-a ! -e /dev/net/misc/net/tun -a -e /dev/misc/net/tun ] ; then\n\t\t\t\tln -sf /dev/misc/net/tun /dev/net/tun\n\t\t\tfi\n\t\t\t# make sure tun device exists\n\t\t\tif [ ! -e /dev/net/tun ]; then\n\t\t\t\tmkdir -p /dev/net\n\t\t\t\tmknod -m 0640 /dev/net/tun c 10 200\n\t\t\t\t[ -x /sbin/restorecon ] && /sbin/restorecon /dev/net/tun\n\t\t\tfi\n\t\t\t# workaround for a possible latency caused by udev, sleep max. 10s\n\t\t\tif kernel_is_2_6_or_above ; then\n\t\t\t\tfor x in `seq 100` ; do\n\t\t\t\t\t(exec 6<> /dev/net/tun) > /dev/null 2>&1 && break;\n\t\t\t\t\tsleep 0.1\n\t\t\t\tdone\n\t\t\tfi\n\t\tfi\n\telif [ \"$OS\" = \"FreeBSD\" ]; then\n\t\tif ! kldstat -q -m if_tun > /dev/null; then\n\t\t\tkldload if_tun\n\t\tfi\n\n\t\tif ! ifconfig $TUNDEV > /dev/null; then\n\t\t\tifconfig $TUNDEV create\n\t\tfi\n\telif [ \"$OS\" = \"GNU/kFreeBSD\" ]; then\n\t\tif [ ! -e /dev/tun ]; then\n\t\t\tkldload if_tun\n\t\tfi\n\telif [ \"$OS\" = \"NetBSD\" ]; then\n\t\t:\n\telif [ \"$OS\" = \"OpenBSD\" ]; then\n\t\tif ! ifconfig $TUNDEV > /dev/null; then\n\t\t\tifconfig $TUNDEV create\n\t\tfi\n\t\t:\n\telif [ \"$OS\" = \"SunOS\" ]; then\n\t\t:\n\telif [ \"$OS\" = \"Darwin\" ]; then\n\t\t:\n\tfi\n}\n\ndo_connect() {\n\tif [ -n \"$CISCO_BANNER\" ]; then\n\t\techo \"Connect Banner:\"\n\t\techo \"$CISCO_BANNER\" | while read LINE ; do echo \"|\" \"$LINE\" ; done\n\t\techo\n\tfi\n\n\tset_vpngateway_route\n\tdo_ifconfig\n\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASK=\"\\${CISCO_SPLIT_INC_${i}_MASK}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ \"$NETWORK\" != \"0.0.0.0\" ]; then\n\t\t\t\tset_network_route \"$NETWORK\" \"$NETMASK\" \"$NETMASKLEN\"\n\t\t\telse\n\t\t\t\tset_default_route\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP4_DNS ; do\n\t\t\techo \"$i\" | grep : >/dev/null || \\\n\t\t\t\tset_network_route \"$i\" \"255.255.255.255\" \"32\"\n\t\tdone\n\telif [ -n \"$INTERNAL_IP4_ADDRESS\" ]; then\n\t\tset_default_route\n\tfi\n\tif [ -n \"$CISCO_IPV6_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_IPV6_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_IPV6_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_IPV6_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ $NETMASKLEN -lt 128 ]; then\n\t\t\t\tset_ipv6_network_route \"$NETWORK\" \"$NETMASKLEN\"\n\t\t\telse\n\t\t\t\tset_ipv6_default_route\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP4_DNS ; do\n\t\t\tif echo \"$i\" | grep : >/dev/null; then\n\t\t\t\tset_ipv6_network_route \"$i\" \"128\"\n\t\t\tfi\n\t\tdone\n\telif [ -n \"$INTERNAL_IP6_NETMASK\" -o -n \"$INTERNAL_IP6_ADDRESS\" ]; then\n\t\tset_ipv6_default_route\n\tfi\n\n\tif [ -n \"$INTERNAL_IP4_DNS\" ]; then\n\t\t$MODIFYRESOLVCONF\n\tfi\n}\n\ndo_disconnect() {\n\tif [ -n \"$CISCO_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASK=\"\\${CISCO_SPLIT_INC_${i}_MASK}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ \"$NETWORK\" != \"0.0.0.0\" ]; then\n\t\t\t\t# FIXME: This doesn't restore previously overwritten\n\t\t\t\t#        routes.\n\t\t\t\tdel_network_route \"$NETWORK\" \"$NETMASK\" \"$NETMASKLEN\"\n\t\t\telse\n\t\t\t\treset_default_route\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP4_DNS ; do\n\t\t\tdel_network_route \"$i\" \"255.255.255.255\" \"32\"\n\t\tdone\n\telse\n\t\treset_default_route\n\tfi\n\tif [ -n \"$CISCO_IPV6_SPLIT_INC\" ]; then\n\t\ti=0\n\t\twhile [ $i -lt $CISCO_IPV6_SPLIT_INC ] ; do\n\t\t\teval NETWORK=\"\\${CISCO_IPV6_SPLIT_INC_${i}_ADDR}\"\n\t\t\teval NETMASKLEN=\"\\${CISCO_IPV6_SPLIT_INC_${i}_MASKLEN}\"\n\t\t\tif [ $NETMASKLEN -eq 0 ]; then\n\t\t\t\treset_ipv6_default_route\n\t\t\telse\n\t\t\t\tdel_ipv6_network_route \"$NETWORK\" \"$NETMASKLEN\"\n\t\t\tfi\n\t\t\ti=`expr $i + 1`\n\t\tdone\n\t\tfor i in $INTERNAL_IP6_DNS ; do\n\t\t\tdel_ipv6_network_route \"$i\" \"128\"\n\t\tdone\n\telif [ -n \"$INTERNAL_IP6_NETMASK\" -o -n \"$INTERNAL_IP6_ADDRESS\" ]; then\n\t\treset_ipv6_default_route\n\tfi\n\n\tdel_vpngateway_route\n\n\tif [ -n \"$INTERNAL_IP4_DNS\" ]; then\n\t\t$RESTORERESOLVCONF\n\tfi\n\n\n\tif [ -n \"$IPROUTE\" ]; then\n\t\tif [ -n \"$INTERNAL_IP4_ADDRESS\" ]; then\n\t\t\t$IPROUTE addr del \"$INTERNAL_IP4_ADDRESS/255.255.255.255\" peer \"$INTERNAL_IP4_ADDRESS\" dev \"$TUNDEV\"\n\t\tfi\n\t\t# If the netmask is provided, it contains the address _and_ netmask\n\t\tif [ -n \"$INTERNAL_IP6_ADDRESS\" ] && [ -z \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\tINTERNAL_IP6_NETMASK=\"$INTERNAL_IP6_ADDRESS/128\"\n\t\tfi\n\t\tif [ -n \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\t$IPROUTE -6 addr del $INTERNAL_IP6_NETMASK dev $TUNDEV\n\t\tfi\n\telse\n\t\tif [ -n \"$INTERNAL_IP4_ADDRESS\" ]; then\n\t\t\tifconfig \"$TUNDEV\" 0.0.0.0\n\t\tfi\n\t\tif [ -n \"$INTERNAL_IP6_ADDRESS\" ] && [ -z \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\tINTERNAL_IP6_NETMASK=\"$INTERNAL_IP6_ADDRESS/128\"\n\t\tfi\n\t\tif [ -n \"$INTERNAL_IP6_NETMASK\" ]; then\n\t\t\tifconfig \"$TUNDEV\" inet6 del $INTERNAL_IP6_NETMASK\n\t\tfi\n\tfi\n\n\tdestroy_tun_device\n}\n\n#### Main\n\nif [ -z \"$reason\" ]; then\n\techo \"this script must be called from vpnc\" 1>&2\n\texit 1\nfi\n\ncase \"$reason\" in\n\tpre-init)\n\t\trun_hooks pre-init\n\t\tdo_pre_init\n\t\t;;\n\tconnect)\n\t\trun_hooks connect\n\t\tdo_connect\n\t\trun_hooks post-connect\n\t\t;;\n\tdisconnect)\n\t\trun_hooks disconnect\n\t\tdo_disconnect\n\t\trun_hooks post-disconnect\n\t\t;;\n\treconnect)\n\t\trun_hooks reconnect\n\t\t;;\n\t*)\n\t\techo \"unknown reason '$reason'. Maybe vpnc-script is out of date\" 1>&2\n\t\texit 1\n\t\t;;\nesac\n\nexit 0\n```","slug":"201710091705","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a25c0008zizpoh0frzq7","content":"<p>AnyConnect为思科推出的VPN客户端，目前已有Windows、Android、IOS、Macintosh、Ubuntu、WebOS、Blackberry等操作系统的客户端。AnyConnection主要作用是方便员工在任何设备上安全地办公，AnyConnect最主要的优点是可以给客户端下发走VPN的路由表<br>本文介绍的是利用ocserv搭建openconnect服务器 </p>\n<a id=\"more\"></a>\n<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统: debian7<br>ocserv版本: 0.9.2</p>\n<h1 id=\"服务器端配置\"><a href=\"#服务器端配置\" class=\"headerlink\" title=\"服务器端配置\"></a>服务器端配置</h1><h2 id=\"1-安装依赖\"><a href=\"#1-安装依赖\" class=\"headerlink\" title=\"1. 安装依赖\"></a>1. 安装依赖</h2><p>ocserv使用GnuTLS作为SSL的library,所以编译时需要相应的dev包.Debian Stable里面带的版本太老(2.12.20),而ocserv需要的包版本在2.15以上,所以需要从backports安装:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">echo &quot;deb http://ftp.debian.org/debian wheezy-backports main contrib non-free&quot; &gt;&gt; /etc/apt/sources.list </div><div class=\"line\">apt-get update</div><div class=\"line\">apt-get upgarde</div><div class=\"line\">apt-get -t wheezy-backports install libgnutls28-dev -y </div><div class=\"line\">apt-get install libgmp3-dev m4 gcc pkg-config make gnutls-bin -y </div><div class=\"line\">apt-get install build-essential libwrap0-dev libpam0g-dev libdbus-1-dev libreadline-dev libnl-route-3-dev libprotobuf-c0-dev libpcl1-dev libopts25-dev autogen libgnutls28-dev libseccomp-dev liblz4-dev -y</div></pre></td></tr></table></figure></p>\n<h2 id=\"2-修改最大路由数目\"><a href=\"#2-修改最大路由数目\" class=\"headerlink\" title=\"2. 修改最大路由数目\"></a>2. 修改最大路由数目</h2><p>ocserv可以修改src/vpn.h来支持超过96行(ocserv默认值)但不超过200行(Cisco Anyconnect最大值)的路由表</p>\n<blockquote>\n<p># define MAX_CONFIG_ENTRIES 96</p>\n</blockquote>\n<p>注意根据Cisco官方文档,no-route和route不能同时使用</p>\n<h2 id=\"3-下载-amp-编译-amp-安装\"><a href=\"#3-下载-amp-编译-amp-安装\" class=\"headerlink\" title=\"3. 下载&amp;编译&amp;安装\"></a>3. 下载&amp;编译&amp;安装</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget ftp://ftp.infradead.org/pub/ocserv/ocserv-0.9.2.tar.xz </div><div class=\"line\">tar Jxvf ocserv-0.9.2.tar.xz </div><div class=\"line\">cd ocserv-0.9.2 </div><div class=\"line\">./configure --prefix=/usr --sysconfdir=/etc </div><div class=\"line\">make </div><div class=\"line\">make install</div></pre></td></tr></table></figure>\n<h2 id=\"4-生成证书\"><a href=\"#4-生成证书\" class=\"headerlink\" title=\"4. 生成证书\"></a>4. 生成证书</h2><h3 id=\"4-1-生成CA证书\"><a href=\"#4-1-生成CA证书\" class=\"headerlink\" title=\"4.1 生成CA证书\"></a>4.1 生成CA证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-privkey --outfile ca-key.pem</div><div class=\"line\">vim ca.tmpl</div></pre></td></tr></table></figure>\n<blockquote>\n<p>cn = “aya”<br>organization = “aya”<br>serial = 1<br>expiration_days = 3650<br>ca<br>signing_key<br>cert_signing_key<br>crl_signing_key  </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-self-signed --load-privkey ca-key.pem --template ca.tmpl --outfile ca-cert.pem</div></pre></td></tr></table></figure>\n<h3 id=\"4-2-生成本地服务器证书\"><a href=\"#4-2-生成本地服务器证书\" class=\"headerlink\" title=\"4.2 生成本地服务器证书\"></a>4.2 生成本地服务器证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-privkey --outfile server-key.pem</div><div class=\"line\">vim server.tmpl</div></pre></td></tr></table></figure>\n<blockquote>\n<p>cn = “littleya.com”<br>organization = “aya”<br>serial = 2<br>expiration_days = 3650<br>encryption_key<br>signing_key<br>tls_www_server  </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-certificate --load-privkey server-key.pem --load-ca-certificate ca-cert.pem --load-ca-privkey ca-key.pem --template server.tmpl --outfile server-cert.pem</div></pre></td></tr></table></figure>\n<h3 id=\"4-3-移动生成的证书\"><a href=\"#4-3-移动生成的证书\" class=\"headerlink\" title=\"4.3 移动生成的证书\"></a>4.3 移动生成的证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /etc/ssl </div><div class=\"line\">mkdir /etc/ssl/certs </div><div class=\"line\">mkdir /etc/ssl/private </div><div class=\"line\">cp ca-cert.pem /etc/ssl/certs </div><div class=\"line\">cp ca-key.pem /etc/ssl/private </div><div class=\"line\">cp server-cert.pem /etc/ssl/certs </div><div class=\"line\">cp server-key.pem /etc/ssl/private</div></pre></td></tr></table></figure>\n<h2 id=\"5-编辑配置文件\"><a href=\"#5-编辑配置文件\" class=\"headerlink\" title=\"5 编辑配置文件\"></a>5 编辑配置文件</h2><h3 id=\"5-1-拷贝配置文件到-etc-ocserv-中\"><a href=\"#5-1-拷贝配置文件到-etc-ocserv-中\" class=\"headerlink\" title=\"5.1 拷贝配置文件到 /etc/ocserv 中\"></a>5.1 拷贝配置文件到 <em>/etc/ocserv</em> 中</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /etc/ocserv  </div><div class=\"line\">cp ~/ocserv-0.9.2/doc/sample.config /etc/ocserv/ </div><div class=\"line\">cp /etc/ocserv/sample.config /etc/ocserv/ocserv.conf</div></pre></td></tr></table></figure>\n<h3 id=\"5-2-编辑配置文件\"><a href=\"#5-2-编辑配置文件\" class=\"headerlink\" title=\"5.2 编辑配置文件\"></a>5.2 编辑配置文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/ocserv/ocserv.conf</div></pre></td></tr></table></figure>\n<blockquote>\n<p>auth = “plain[/etc/ocserv/ocpasswd]”<br># ocserv支持多种认证方式，这是自带的密码认证，使用ocpasswd创建密码文件<br># ocserv还支持证书认证，可以通过Pluggable Authentication Modules (PAM)使用radius等认证方式<br><br></p>\n<p># 证书路径<br>server-cert = /etc/ssl/certs/server-cert.pem<br>server-key = /etc/ssl/private/server-key.pem<br><br></p>\n<p># if letsencrypt<br># server-cert = /etc/letsencrypt/live/example.com/fullchain.pem<br># server-key = /etc/letsencrypt/live/example.com/privkey.pem<br><br></p>\n<p># 同一个用户最多同时登陆数<br>max-same-clients = 10<br><br></p>\n<p># 运行组<br>run-as-group = nogroup<br><br></p>\n<p># 分配给VPN客户端的IP段<br>ipv4-network = 192.168.1.0<br><br></p>\n<p># DNS<br>dns = 8.8.8.8<br>dns = 8.8.4.4<br><br></p>\n<p># Keepalive in seconds<br>keepalive = 600<br><br></p>\n<p>#Dead peer detection in seconds.<br>dpd = 900<br><br></p>\n<p># Dead peer detection for mobile clients. The needs to<br># be much higher to prevent such clients being awaken too<br># often by the DPD messages, and save battery.<br># (clients that send the X-AnyConnect-Identifier-DeviceType)<br>mobile-dpd = 1800<br><br></p>\n<p>output-buffer = 23000<br>try-mtu-discovery = true<br><br></p>\n<p># The time (in seconds) that a client is allowed to stay idle (no traffic)<br># before being disconnected. Unset to disable.<br>idle-timeout = 3600<br><br></p>\n<p># The time (in seconds) that a mobile client is allowed to stay idle (no traffic) before being disconnected. Unset to disable.<br>mobile-idle-timeout = 3600<br><br></p>\n<p># 注释掉route的字段，这样表示所有流量都通过 VPN 发送<br># route = 192.168.16.0/255.255.255.0<br># route = 192.168.5.0/255.255.255.0</p>\n</blockquote>\n<p>其中路由表的信息,可以从Github上的 <a href=\"https://github.com/CNMan/ocserv-cn-no-route\" title=\"ocserv-cn-no-route\" target=\"_blank\" rel=\"external\">ocserv-cn-no-route</a> 项目配置</p>\n<h3 id=\"5-3-生成用户\"><a href=\"#5-3-生成用户\" class=\"headerlink\" title=\"5.3 生成用户\"></a>5.3 生成用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ocpasswd -c /etc/ocserv/ocpasswd user.name</div><div class=\"line\">#user.name为用户名</div></pre></td></tr></table></figure>\n<h2 id=\"6-其他配置\"><a href=\"#6-其他配置\" class=\"headerlink\" title=\"6. 其他配置\"></a>6. 其他配置</h2><h3 id=\"6-1-开启转发\"><a href=\"#6-1-开启转发\" class=\"headerlink\" title=\"6.1 开启转发\"></a>6.1 开启转发</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/sysctl.conf</div></pre></td></tr></table></figure>\n<blockquote>\n<p>net.ipv4.ip_forward = 1</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sysctl -p</div></pre></td></tr></table></figure>\n<h3 id=\"6-2-iptables表\"><a href=\"#6-2-iptables表\" class=\"headerlink\" title=\"6.2 iptables表\"></a>6.2 iptables表</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">iptables -t nat -A POSTROUTING -j MASQUERADE </div><div class=\"line\">iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu </div><div class=\"line\"> </div><div class=\"line\">#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式 </div><div class=\"line\"> </div><div class=\"line\">iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j SNAT --to-source VPN SERVER&apos;S IP </div><div class=\"line\">iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu </div><div class=\"line\"> </div><div class=\"line\">#若打开网页有问题可以尝试把mtu调小</div><div class=\"line\">iptables -A FORWARD -p tcp --syn -s 192.168.1.0/24 -j TCPMSS --set-mss 1356</div></pre></td></tr></table></figure>\n<h3 id=\"6-3-调试\"><a href=\"#6-3-调试\" class=\"headerlink\" title=\"6.3 调试\"></a>6.3 调试</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ocserv -c /etc/ocserv/ocserv.conf -f -d 1</div></pre></td></tr></table></figure>\n<h3 id=\"6-4-开机启动\"><a href=\"#6-4-开机启动\" class=\"headerlink\" title=\"6.4 开机启动\"></a>6.4 开机启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/rc.local</div></pre></td></tr></table></figure>\n<blockquote>\n<p>iptables -t nat -A POSTROUTING -j MASQUERADE<br>iptables -A FORWARD -p tcp –tcp-flags SYN,RST SYN -j TCPMSS –clamp-mss-to-pmtu<br><br></p>\n<p>#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式<br><br></p>\n<p>iptables -t nat -A POSTROUTING -s 192.168.110.0/24 -j SNAT –to-source VPN SERVER’S IP<br>iptables -A FORWARD -p tcp –tcp-flags SYN,RST SYN -j TCPMSS –clamp-mss-to-pmtu<br><br></p>\n<p>ocserv</p>\n</blockquote>\n<h1 id=\"客户端配置\"><a href=\"#客户端配置\" class=\"headerlink\" title=\"客户端配置\"></a>客户端配置</h1><h2 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux:\"></a>Linux:</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">apt-get install -y openconnect expect screen</div><div class=\"line\">vim /usr/local/sbin/ocdo.sh</div></pre></td></tr></table></figure>\n<blockquote>\n<p>#!/usr/bin/expect<br>spawn screen -S ocdo openconnect -u username –script=/etc/vpnc/vpnc-script –no-dtls vpn.example.com -b<br>expect “anything else”<br>send “yes\\r”<br>expect “Password:”<br>send “password\\r”<br>interact  </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">echo &quot;/usr/local/sbin/ocdo.sh&quot; &gt;&gt; /rc.local </div><div class=\"line\">mkdir /etc/vpnc &amp;&amp; cd /etc/vpnc </div><div class=\"line\">wget http://git.infradead.org/users/dwmw2/vpnc-scripts.git/blob_plain/HEAD:/vpnc-script</div></pre></td></tr></table></figure>\n<p>vpnc-script:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div><div class=\"line\">341</div><div class=\"line\">342</div><div class=\"line\">343</div><div class=\"line\">344</div><div class=\"line\">345</div><div class=\"line\">346</div><div class=\"line\">347</div><div class=\"line\">348</div><div class=\"line\">349</div><div class=\"line\">350</div><div class=\"line\">351</div><div class=\"line\">352</div><div class=\"line\">353</div><div class=\"line\">354</div><div class=\"line\">355</div><div class=\"line\">356</div><div class=\"line\">357</div><div class=\"line\">358</div><div class=\"line\">359</div><div class=\"line\">360</div><div class=\"line\">361</div><div class=\"line\">362</div><div class=\"line\">363</div><div class=\"line\">364</div><div class=\"line\">365</div><div class=\"line\">366</div><div class=\"line\">367</div><div class=\"line\">368</div><div class=\"line\">369</div><div class=\"line\">370</div><div class=\"line\">371</div><div class=\"line\">372</div><div class=\"line\">373</div><div class=\"line\">374</div><div class=\"line\">375</div><div class=\"line\">376</div><div class=\"line\">377</div><div class=\"line\">378</div><div class=\"line\">379</div><div class=\"line\">380</div><div class=\"line\">381</div><div class=\"line\">382</div><div class=\"line\">383</div><div class=\"line\">384</div><div class=\"line\">385</div><div class=\"line\">386</div><div class=\"line\">387</div><div class=\"line\">388</div><div class=\"line\">389</div><div class=\"line\">390</div><div class=\"line\">391</div><div class=\"line\">392</div><div class=\"line\">393</div><div class=\"line\">394</div><div class=\"line\">395</div><div class=\"line\">396</div><div class=\"line\">397</div><div class=\"line\">398</div><div class=\"line\">399</div><div class=\"line\">400</div><div class=\"line\">401</div><div class=\"line\">402</div><div class=\"line\">403</div><div class=\"line\">404</div><div class=\"line\">405</div><div class=\"line\">406</div><div class=\"line\">407</div><div class=\"line\">408</div><div class=\"line\">409</div><div class=\"line\">410</div><div class=\"line\">411</div><div class=\"line\">412</div><div class=\"line\">413</div><div class=\"line\">414</div><div class=\"line\">415</div><div class=\"line\">416</div><div class=\"line\">417</div><div class=\"line\">418</div><div class=\"line\">419</div><div class=\"line\">420</div><div class=\"line\">421</div><div class=\"line\">422</div><div class=\"line\">423</div><div class=\"line\">424</div><div class=\"line\">425</div><div class=\"line\">426</div><div class=\"line\">427</div><div class=\"line\">428</div><div class=\"line\">429</div><div class=\"line\">430</div><div class=\"line\">431</div><div class=\"line\">432</div><div class=\"line\">433</div><div class=\"line\">434</div><div class=\"line\">435</div><div class=\"line\">436</div><div class=\"line\">437</div><div class=\"line\">438</div><div class=\"line\">439</div><div class=\"line\">440</div><div class=\"line\">441</div><div class=\"line\">442</div><div class=\"line\">443</div><div class=\"line\">444</div><div class=\"line\">445</div><div class=\"line\">446</div><div class=\"line\">447</div><div class=\"line\">448</div><div class=\"line\">449</div><div class=\"line\">450</div><div class=\"line\">451</div><div class=\"line\">452</div><div class=\"line\">453</div><div class=\"line\">454</div><div class=\"line\">455</div><div class=\"line\">456</div><div class=\"line\">457</div><div class=\"line\">458</div><div class=\"line\">459</div><div class=\"line\">460</div><div class=\"line\">461</div><div class=\"line\">462</div><div class=\"line\">463</div><div class=\"line\">464</div><div class=\"line\">465</div><div class=\"line\">466</div><div class=\"line\">467</div><div class=\"line\">468</div><div class=\"line\">469</div><div class=\"line\">470</div><div class=\"line\">471</div><div class=\"line\">472</div><div class=\"line\">473</div><div class=\"line\">474</div><div class=\"line\">475</div><div class=\"line\">476</div><div class=\"line\">477</div><div class=\"line\">478</div><div class=\"line\">479</div><div class=\"line\">480</div><div class=\"line\">481</div><div class=\"line\">482</div><div class=\"line\">483</div><div class=\"line\">484</div><div class=\"line\">485</div><div class=\"line\">486</div><div class=\"line\">487</div><div class=\"line\">488</div><div class=\"line\">489</div><div class=\"line\">490</div><div class=\"line\">491</div><div class=\"line\">492</div><div class=\"line\">493</div><div class=\"line\">494</div><div class=\"line\">495</div><div class=\"line\">496</div><div class=\"line\">497</div><div class=\"line\">498</div><div class=\"line\">499</div><div class=\"line\">500</div><div class=\"line\">501</div><div class=\"line\">502</div><div class=\"line\">503</div><div class=\"line\">504</div><div class=\"line\">505</div><div class=\"line\">506</div><div class=\"line\">507</div><div class=\"line\">508</div><div class=\"line\">509</div><div class=\"line\">510</div><div class=\"line\">511</div><div class=\"line\">512</div><div class=\"line\">513</div><div class=\"line\">514</div><div class=\"line\">515</div><div class=\"line\">516</div><div class=\"line\">517</div><div class=\"line\">518</div><div class=\"line\">519</div><div class=\"line\">520</div><div class=\"line\">521</div><div class=\"line\">522</div><div class=\"line\">523</div><div class=\"line\">524</div><div class=\"line\">525</div><div class=\"line\">526</div><div class=\"line\">527</div><div class=\"line\">528</div><div class=\"line\">529</div><div class=\"line\">530</div><div class=\"line\">531</div><div class=\"line\">532</div><div class=\"line\">533</div><div class=\"line\">534</div><div class=\"line\">535</div><div class=\"line\">536</div><div class=\"line\">537</div><div class=\"line\">538</div><div class=\"line\">539</div><div class=\"line\">540</div><div class=\"line\">541</div><div class=\"line\">542</div><div class=\"line\">543</div><div class=\"line\">544</div><div class=\"line\">545</div><div class=\"line\">546</div><div class=\"line\">547</div><div class=\"line\">548</div><div class=\"line\">549</div><div class=\"line\">550</div><div class=\"line\">551</div><div class=\"line\">552</div><div class=\"line\">553</div><div class=\"line\">554</div><div class=\"line\">555</div><div class=\"line\">556</div><div class=\"line\">557</div><div class=\"line\">558</div><div class=\"line\">559</div><div class=\"line\">560</div><div class=\"line\">561</div><div class=\"line\">562</div><div class=\"line\">563</div><div class=\"line\">564</div><div class=\"line\">565</div><div class=\"line\">566</div><div class=\"line\">567</div><div class=\"line\">568</div><div class=\"line\">569</div><div class=\"line\">570</div><div class=\"line\">571</div><div class=\"line\">572</div><div class=\"line\">573</div><div class=\"line\">574</div><div class=\"line\">575</div><div class=\"line\">576</div><div class=\"line\">577</div><div class=\"line\">578</div><div class=\"line\">579</div><div class=\"line\">580</div><div class=\"line\">581</div><div class=\"line\">582</div><div class=\"line\">583</div><div class=\"line\">584</div><div class=\"line\">585</div><div class=\"line\">586</div><div class=\"line\">587</div><div class=\"line\">588</div><div class=\"line\">589</div><div class=\"line\">590</div><div class=\"line\">591</div><div class=\"line\">592</div><div class=\"line\">593</div><div class=\"line\">594</div><div class=\"line\">595</div><div class=\"line\">596</div><div class=\"line\">597</div><div class=\"line\">598</div><div class=\"line\">599</div><div class=\"line\">600</div><div class=\"line\">601</div><div class=\"line\">602</div><div class=\"line\">603</div><div class=\"line\">604</div><div class=\"line\">605</div><div class=\"line\">606</div><div class=\"line\">607</div><div class=\"line\">608</div><div class=\"line\">609</div><div class=\"line\">610</div><div class=\"line\">611</div><div class=\"line\">612</div><div class=\"line\">613</div><div class=\"line\">614</div><div class=\"line\">615</div><div class=\"line\">616</div><div class=\"line\">617</div><div class=\"line\">618</div><div class=\"line\">619</div><div class=\"line\">620</div><div class=\"line\">621</div><div class=\"line\">622</div><div class=\"line\">623</div><div class=\"line\">624</div><div class=\"line\">625</div><div class=\"line\">626</div><div class=\"line\">627</div><div class=\"line\">628</div><div class=\"line\">629</div><div class=\"line\">630</div><div class=\"line\">631</div><div class=\"line\">632</div><div class=\"line\">633</div><div class=\"line\">634</div><div class=\"line\">635</div><div class=\"line\">636</div><div class=\"line\">637</div><div class=\"line\">638</div><div class=\"line\">639</div><div class=\"line\">640</div><div class=\"line\">641</div><div class=\"line\">642</div><div class=\"line\">643</div><div class=\"line\">644</div><div class=\"line\">645</div><div class=\"line\">646</div><div class=\"line\">647</div><div class=\"line\">648</div><div class=\"line\">649</div><div class=\"line\">650</div><div class=\"line\">651</div><div class=\"line\">652</div><div class=\"line\">653</div><div class=\"line\">654</div><div class=\"line\">655</div><div class=\"line\">656</div><div class=\"line\">657</div><div class=\"line\">658</div><div class=\"line\">659</div><div class=\"line\">660</div><div class=\"line\">661</div><div class=\"line\">662</div><div class=\"line\">663</div><div class=\"line\">664</div><div class=\"line\">665</div><div class=\"line\">666</div><div class=\"line\">667</div><div class=\"line\">668</div><div class=\"line\">669</div><div class=\"line\">670</div><div class=\"line\">671</div><div class=\"line\">672</div><div class=\"line\">673</div><div class=\"line\">674</div><div class=\"line\">675</div><div class=\"line\">676</div><div class=\"line\">677</div><div class=\"line\">678</div><div class=\"line\">679</div><div class=\"line\">680</div><div class=\"line\">681</div><div class=\"line\">682</div><div class=\"line\">683</div><div class=\"line\">684</div><div class=\"line\">685</div><div class=\"line\">686</div><div class=\"line\">687</div><div class=\"line\">688</div><div class=\"line\">689</div><div class=\"line\">690</div><div class=\"line\">691</div><div class=\"line\">692</div><div class=\"line\">693</div><div class=\"line\">694</div><div class=\"line\">695</div><div class=\"line\">696</div><div class=\"line\">697</div><div class=\"line\">698</div><div class=\"line\">699</div><div class=\"line\">700</div><div class=\"line\">701</div><div class=\"line\">702</div><div class=\"line\">703</div><div class=\"line\">704</div><div class=\"line\">705</div><div class=\"line\">706</div><div class=\"line\">707</div><div class=\"line\">708</div><div class=\"line\">709</div><div class=\"line\">710</div><div class=\"line\">711</div><div class=\"line\">712</div><div class=\"line\">713</div><div class=\"line\">714</div><div class=\"line\">715</div><div class=\"line\">716</div><div class=\"line\">717</div><div class=\"line\">718</div><div class=\"line\">719</div><div class=\"line\">720</div><div class=\"line\">721</div><div class=\"line\">722</div><div class=\"line\">723</div><div class=\"line\">724</div><div class=\"line\">725</div><div class=\"line\">726</div><div class=\"line\">727</div><div class=\"line\">728</div><div class=\"line\">729</div><div class=\"line\">730</div><div class=\"line\">731</div><div class=\"line\">732</div><div class=\"line\">733</div><div class=\"line\">734</div><div class=\"line\">735</div><div class=\"line\">736</div><div class=\"line\">737</div><div class=\"line\">738</div><div class=\"line\">739</div><div class=\"line\">740</div><div class=\"line\">741</div><div class=\"line\">742</div><div class=\"line\">743</div><div class=\"line\">744</div><div class=\"line\">745</div><div class=\"line\">746</div><div class=\"line\">747</div><div class=\"line\">748</div><div class=\"line\">749</div><div class=\"line\">750</div><div class=\"line\">751</div><div class=\"line\">752</div><div class=\"line\">753</div><div class=\"line\">754</div><div class=\"line\">755</div><div class=\"line\">756</div><div class=\"line\">757</div><div class=\"line\">758</div><div class=\"line\">759</div><div class=\"line\">760</div><div class=\"line\">761</div><div class=\"line\">762</div><div class=\"line\">763</div><div class=\"line\">764</div><div class=\"line\">765</div><div class=\"line\">766</div><div class=\"line\">767</div><div class=\"line\">768</div><div class=\"line\">769</div><div class=\"line\">770</div><div class=\"line\">771</div><div class=\"line\">772</div><div class=\"line\">773</div><div class=\"line\">774</div><div class=\"line\">775</div><div class=\"line\">776</div><div class=\"line\">777</div><div class=\"line\">778</div><div class=\"line\">779</div><div class=\"line\">780</div><div class=\"line\">781</div><div class=\"line\">782</div><div class=\"line\">783</div><div class=\"line\">784</div><div class=\"line\">785</div><div class=\"line\">786</div><div class=\"line\">787</div><div class=\"line\">788</div><div class=\"line\">789</div><div class=\"line\">790</div><div class=\"line\">791</div><div class=\"line\">792</div><div class=\"line\">793</div><div class=\"line\">794</div><div class=\"line\">795</div><div class=\"line\">796</div><div class=\"line\">797</div><div class=\"line\">798</div><div class=\"line\">799</div><div class=\"line\">800</div><div class=\"line\">801</div><div class=\"line\">802</div><div class=\"line\">803</div><div class=\"line\">804</div><div class=\"line\">805</div><div class=\"line\">806</div><div class=\"line\">807</div><div class=\"line\">808</div><div class=\"line\">809</div><div class=\"line\">810</div><div class=\"line\">811</div><div class=\"line\">812</div><div class=\"line\">813</div><div class=\"line\">814</div><div class=\"line\">815</div><div class=\"line\">816</div><div class=\"line\">817</div><div class=\"line\">818</div><div class=\"line\">819</div><div class=\"line\">820</div><div class=\"line\">821</div><div class=\"line\">822</div><div class=\"line\">823</div><div class=\"line\">824</div><div class=\"line\">825</div><div class=\"line\">826</div><div class=\"line\">827</div><div class=\"line\">828</div><div class=\"line\">829</div><div class=\"line\">830</div><div class=\"line\">831</div><div class=\"line\">832</div><div class=\"line\">833</div><div class=\"line\">834</div><div class=\"line\">835</div><div class=\"line\">836</div><div class=\"line\">837</div><div class=\"line\">838</div><div class=\"line\">839</div><div class=\"line\">840</div><div class=\"line\">841</div><div class=\"line\">842</div><div class=\"line\">843</div><div class=\"line\">844</div><div class=\"line\">845</div><div class=\"line\">846</div><div class=\"line\">847</div><div class=\"line\">848</div><div class=\"line\">849</div><div class=\"line\">850</div><div class=\"line\">851</div><div class=\"line\">852</div><div class=\"line\">853</div><div class=\"line\">854</div><div class=\"line\">855</div><div class=\"line\">856</div><div class=\"line\">857</div><div class=\"line\">858</div><div class=\"line\">859</div><div class=\"line\">860</div><div class=\"line\">861</div><div class=\"line\">862</div><div class=\"line\">863</div><div class=\"line\">864</div><div class=\"line\">865</div><div class=\"line\">866</div><div class=\"line\">867</div><div class=\"line\">868</div><div class=\"line\">869</div><div class=\"line\">870</div><div class=\"line\">871</div><div class=\"line\">872</div><div class=\"line\">873</div><div class=\"line\">874</div><div class=\"line\">875</div><div class=\"line\">876</div><div class=\"line\">877</div><div class=\"line\">878</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/sh</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># Originally part of vpnc source code:</span></div><div class=\"line\"><span class=\"comment\"># Â© 2005-2012 Maurice Massar, JÃ¶rg Mayer, Antonio Borneo et al.</span></div><div class=\"line\"><span class=\"comment\"># Â© 2009-2012 David Woodhouse &lt;dwmw2@infradead.org&gt;</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># This program is free software; you can redistribute it and/or modify</span></div><div class=\"line\"><span class=\"comment\"># it under the terms of the GNU General Public License as published by</span></div><div class=\"line\"><span class=\"comment\"># the Free Software Foundation; either version 2 of the License, or</span></div><div class=\"line\"><span class=\"comment\"># (at your option) any later version.</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># This program is distributed in the hope that it will be useful,</span></div><div class=\"line\"><span class=\"comment\"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class=\"line\"><span class=\"comment\"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class=\"line\"><span class=\"comment\"># GNU General Public License for more details.</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># You should have received a copy of the GNU General Public License</span></div><div class=\"line\"><span class=\"comment\"># along with this program; if not, write to the Free Software</span></div><div class=\"line\"><span class=\"comment\"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\">################</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># List of parameters passed through environment</span></div><div class=\"line\"><span class=\"comment\">#* reason                       -- why this script was called, one of: pre-init connect disconnect reconnect</span></div><div class=\"line\"><span class=\"comment\">#* VPNGATEWAY                   -- vpn gateway address (always present)</span></div><div class=\"line\"><span class=\"comment\">#* TUNDEV                       -- tunnel device (always present)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_ADDRESS         -- address (always present)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_MTU             -- mtu (often unset)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NETMASK         -- netmask (often unset)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NETMASKLEN      -- netmask length (often unset)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NETADDR         -- address of network (only present if netmask is set)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_DNS             -- list of dns servers</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NBNS            -- list of wins servers</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP6_ADDRESS         -- IPv6 address</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP6_NETMASK         -- IPv6 netmask</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP6_DNS             -- IPv6 list of dns servers</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_DEF_DOMAIN             -- default domain name</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_BANNER                 -- banner from server</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC              -- number of networks in split-network-list</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_ADDR      -- network address</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_MASK      -- subnet mask (for example: 255.255.255.0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_MASKLEN   -- subnet masklen (for example: 24)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_PROTOCOL  -- protocol (often just 0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_SPORT     -- source port (often just 0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_DPORT     -- destination port (often just 0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_IPV6_SPLIT_INC         -- number of networks in IPv6 split-network-list</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_IPV6_SPLIT_INC_%d_ADDR -- IPv6 network address</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_IPV6_SPLIT_INC_$%d_MASKLEN -- IPv6 subnet masklen</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># FIXMEs:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Section A: route handling</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 1) The 3 values CISCO_SPLIT_INC_%d_PROTOCOL/SPORT/DPORT are currently being ignored</span></div><div class=\"line\"><span class=\"comment\">#   In order to use them, we'll probably need os specific solutions</span></div><div class=\"line\"><span class=\"comment\">#   * Linux: iptables -t mangle -I PREROUTING &lt;conditions&gt; -j ROUTE --oif $TUNDEV</span></div><div class=\"line\"><span class=\"comment\">#       This would be an *alternative* to changing the routes (and thus 2) and 3)</span></div><div class=\"line\"><span class=\"comment\">#       shouldn't be relevant at all)</span></div><div class=\"line\"><span class=\"comment\"># 2) There are two different functions to set routes: generic routes and the</span></div><div class=\"line\"><span class=\"comment\">#   default route. Why isn't the defaultroute handled via the generic route case?</span></div><div class=\"line\"><span class=\"comment\"># 3) In the split tunnel case, all routes but the default route might get replaced</span></div><div class=\"line\"><span class=\"comment\">#   without getting restored later. We should explicitely check and save them just</span></div><div class=\"line\"><span class=\"comment\">#   like the defaultroute</span></div><div class=\"line\"><span class=\"comment\"># 4) Replies to a dhcp-server should never be sent into the tunnel</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Section B: Split DNS handling</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 1) Maybe dnsmasq can do something like that</span></div><div class=\"line\"><span class=\"comment\"># 2) Parse dns packets going out via tunnel and redirect them to original dns-server</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#env | sort</span></div><div class=\"line\"><span class=\"comment\">#set -x</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== script (variable) setup ====================================</span></div><div class=\"line\"></div><div class=\"line\">PATH=/sbin:/usr/sbin:<span class=\"variable\">$PATH</span></div><div class=\"line\"></div><div class=\"line\">OS=<span class=\"string\">\"`uname -s`\"</span></div><div class=\"line\"></div><div class=\"line\">HOOKS_DIR=/etc/vpnc</div><div class=\"line\">DEFAULT_ROUTE_FILE=/var/run/vpnc/defaultroute</div><div class=\"line\">RESOLV_CONF_BACKUP=/var/run/vpnc/resolv.conf-backup</div><div class=\"line\">SCRIPTNAME=`basename <span class=\"variable\">$0</span>`</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># some systems, eg. Darwin &amp; FreeBSD, prune /var/run on boot</span></div><div class=\"line\"><span class=\"keyword\">if</span> [ ! -d <span class=\"string\">\"/var/run/vpnc\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\tmkdir -p /var/run/vpnc</div><div class=\"line\">\t[ -x /sbin/restorecon ] &amp;&amp; /sbin/restorecon /var/run/vpnc</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># stupid SunOS: no blubber in /usr/local/bin ... (on stdout)</span></div><div class=\"line\">IPROUTE=<span class=\"string\">\"`which ip 2&gt; /dev/null | grep '^/'`\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> ifconfig --<span class=\"built_in\">help</span> 2&gt;&amp;1 | grep BusyBox &gt; /dev/null; <span class=\"keyword\">then</span></div><div class=\"line\">\tifconfig_syntax_inet=<span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">\tifconfig_syntax_inet=<span class=\"string\">\"inet\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"Linux\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\tifconfig_syntax_ptp=<span class=\"string\">\"pointopoint\"</span></div><div class=\"line\">\troute_syntax_gw=<span class=\"string\">\"gw\"</span></div><div class=\"line\">\troute_syntax_del=<span class=\"string\">\"del\"</span></div><div class=\"line\">\troute_syntax_netmask=<span class=\"string\">\"netmask\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">\tifconfig_syntax_ptp=<span class=\"string\">\"\"</span></div><div class=\"line\">\troute_syntax_gw=<span class=\"string\">\"\"</span></div><div class=\"line\">\troute_syntax_del=<span class=\"string\">\"delete\"</span></div><div class=\"line\">\troute_syntax_netmask=<span class=\"string\">\"-netmask\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"SunOS\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\troute_syntax_interface=<span class=\"string\">\"-interface\"</span></div><div class=\"line\">\tifconfig_syntax_ptpv6=<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">\troute_syntax_interface=<span class=\"string\">\"\"</span></div><div class=\"line\">\tifconfig_syntax_ptpv6=<span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ -r /etc/openwrt_release ] &amp;&amp; [ -n <span class=\"string\">\"<span class=\"variable\">$OPENWRT_INTERFACE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">        . /etc/functions.sh</div><div class=\"line\">\tinclude /lib/network</div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_openwrt</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_openwrt</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /usr/bin/busctl ]; <span class=\"keyword\">then</span>  <span class=\"comment\"># For systemd-resolved (version 229 and above)</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolved_manager</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolved_manager</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /sbin/resolvconf ]; <span class=\"keyword\">then</span> <span class=\"comment\"># Optional tool on Debian, Ubuntu, Gentoo and FreeBSD</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_manager</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_manager</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /sbin/netconfig ]; <span class=\"keyword\">then</span> <span class=\"comment\"># tool on Suse after 11.1</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_suse_netconfig</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_suse_netconfig</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /sbin/modify_resolvconf ]; <span class=\"keyword\">then</span> <span class=\"comment\"># Mandatory tool on Suse earlier than 11.1</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_suse</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_suse</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /usr/sbin/unbound-control ] &amp;&amp; /usr/sbin/unbound-control status &gt; /dev/null 2&gt;&amp;1; <span class=\"keyword\">then</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_unbound</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_unbound</div><div class=\"line\"><span class=\"keyword\">else</span> <span class=\"comment\"># Generic for any OS</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_generic</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_generic</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== script hooks =================================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">run_hooks</span></span>() &#123;</div><div class=\"line\">\tHOOK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -d <span class=\"variable\">$&#123;HOOKS_DIR&#125;</span>/<span class=\"variable\">$&#123;HOOK&#125;</span>.d ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t    <span class=\"keyword\">for</span> script <span class=\"keyword\">in</span> <span class=\"variable\">$&#123;HOOKS_DIR&#125;</span>/<span class=\"variable\">$&#123;HOOK&#125;</span>.d/* ; <span class=\"keyword\">do</span></div><div class=\"line\">\t\t[ -f <span class=\"variable\">$script</span> ] &amp;&amp; . <span class=\"variable\">$script</span></div><div class=\"line\">\t    <span class=\"keyword\">done</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== tunnel interface handling ====================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">do_ifconfig</span></span>() &#123;</div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_MTU</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tMTU=<span class=\"variable\">$INTERNAL_IP4_MTU</span></div><div class=\"line\">\t<span class=\"keyword\">elif</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tMTUDEV=`<span class=\"variable\">$IPROUTE</span> route get <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> | sed -ne <span class=\"string\">'s/^.*dev \\([a-z0-9]*\\).*$/\\1/p'</span>`</div><div class=\"line\">\t\tMTU=`<span class=\"variable\">$IPROUTE</span> link show <span class=\"string\">\"<span class=\"variable\">$MTUDEV</span>\"</span> | sed -ne <span class=\"string\">'s/^.*mtu \\([[:digit:]]\\+\\).*$/\\1/p'</span>`</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$MTU</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\tMTU=`expr <span class=\"variable\">$MTU</span> - 88`</div><div class=\"line\">\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -z <span class=\"string\">\"<span class=\"variable\">$MTU</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tMTU=1412</div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># Point to point interface require a netmask of 255.255.255.255 on some systems</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> link <span class=\"built_in\">set</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> up mtu <span class=\"string\">\"<span class=\"variable\">$MTU</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> addr add <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>/32\"</span> peer <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">else</span></div><div class=\"line\">\t\tifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> <span class=\"variable\">$&#123;ifconfig_syntax_inet&#125;</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> <span class=\"variable\">$ifconfig_syntax_ptp</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> netmask 255.255.255.255 mtu <span class=\"variable\">$&#123;MTU&#125;</span> up</div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_NETMASK</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tset_network_route <span class=\"variable\">$INTERNAL_IP4_NETADDR</span> <span class=\"variable\">$INTERNAL_IP4_NETMASK</span> <span class=\"variable\">$INTERNAL_IP4_NETMASKLEN</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># If the netmask is provided, it contains the address _and_ netmask</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span> ] &amp;&amp; [ -z <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_NETMASK</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t    INTERNAL_IP6_NETMASK=<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>/128\"</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_NETMASK</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t    <span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 addr add <span class=\"variable\">$INTERNAL_IP6_NETMASK</span> dev <span class=\"variable\">$TUNDEV</span></div><div class=\"line\">\t    <span class=\"keyword\">else</span></div><div class=\"line\">\t\t<span class=\"comment\"># Unlike for Legacy IP, we don't specify the dest_address</span></div><div class=\"line\">\t\t<span class=\"comment\"># here on *BSD. OpenBSD for one will refuse to accept</span></div><div class=\"line\">\t\t<span class=\"comment\"># incoming packets to that address if we do.</span></div><div class=\"line\">\t\t<span class=\"comment\"># OpenVPN does the same (gives dest_address for Legacy IP</span></div><div class=\"line\">\t\t<span class=\"comment\"># but not for IPv6).</span></div><div class=\"line\">\t\t<span class=\"comment\"># Only Solaris needs it; hence $ifconfig_syntax_ptpv6</span></div><div class=\"line\">\t        ifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> inet6 <span class=\"variable\">$INTERNAL_IP6_NETMASK</span> <span class=\"variable\">$ifconfig_syntax_ptpv6</span> mtu <span class=\"variable\">$MTU</span> up</div><div class=\"line\">\t    <span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">destroy_tun_device</span></span>() &#123;</div><div class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\tNetBSD|OpenBSD) <span class=\"comment\"># and probably others...</span></div><div class=\"line\">\t\tifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> destroy</div><div class=\"line\">\t\t;;</div><div class=\"line\">\tFreeBSD)</div><div class=\"line\">\t\tifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> destroy &gt; /dev/null 2&gt;&amp;1 &amp;</div><div class=\"line\">\t\t;;</div><div class=\"line\">\t<span class=\"keyword\">esac</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== route handling ====================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">fix_ip_get_output</span></span> () &#123;</div><div class=\"line\">\t\tsed -e <span class=\"string\">'s/ /\\n/g'</span> | \\</div><div class=\"line\">\t\t    sed -ne <span class=\"string\">'1p;/via/&#123;N;p&#125;;/dev/&#123;N;p&#125;;/src/&#123;N;p&#125;;/mtu/&#123;N;p&#125;'</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route add `<span class=\"variable\">$IPROUTE</span> route get <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> | fix_ip_get_output`</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route <span class=\"variable\">$route_syntax_del</span> <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route | grep <span class=\"string\">'^default'</span> | fix_ip_get_output &gt; <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route replace default dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route replace <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> [ -s <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t<span class=\"variable\">$IPROUTE</span> route replace `cat <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span>`</div><div class=\"line\">\t\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t\t\trm -f -- <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route <span class=\"variable\">$route_syntax_del</span> <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"comment\"># We don't save/restore IPv6 default route; just add a higher-priority one.</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route add default dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> metric 1</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route replace <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route del default dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route del <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"><span class=\"keyword\">else</span> <span class=\"comment\"># use route command</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">get_default_gw</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"comment\"># isn't -n supposed to give --numeric output?</span></div><div class=\"line\">\t\t<span class=\"comment\"># apperently not...</span></div><div class=\"line\">\t\t<span class=\"comment\"># Get rid of lines containing IPv6 addresses (':')</span></div><div class=\"line\">\t\tnetstat -r -n | awk <span class=\"string\">'/:/ &#123; next; &#125; /^(default|0\\.0\\.0\\.0)/ &#123; print $2; &#125;'</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\troute add -host <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"`get_default_gw`\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -host <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"`get_default_gw`\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_default_route</span></span>() &#123;</div><div class=\"line\">\t\tDEFAULTGW=<span class=\"string\">\"`get_default_gw`\"</span></div><div class=\"line\">\t\t<span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$DEFAULTGW</span>\"</span> &gt; <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> default <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$DEFAULTGW</span>\"</span></div><div class=\"line\">\t\troute add default <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\tdel_network_route <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$NETMASKLEN</span>\"</span></div><div class=\"line\">\t\troute add -net <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>\"</span> <span class=\"variable\">$route_syntax_netmask</span> <span class=\"string\">\"<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> [ -s <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\troute <span class=\"variable\">$route_syntax_del</span> default <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"`get_default_gw`\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t\t\troute add default <span class=\"variable\">$route_syntax_gw</span> `cat <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span>`</div><div class=\"line\">\t\t\trm -f -- <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_network_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\tLinux|NetBSD|OpenBSD|Darwin|SunOS) <span class=\"comment\"># and probably others...</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># routes are deleted automatically on device shutdown</span></div><div class=\"line\">\t\t\t<span class=\"built_in\">return</span></div><div class=\"line\">\t\t\t;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -net <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>\"</span> <span class=\"variable\">$route_syntax_netmask</span> <span class=\"string\">\"<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\troute add -inet6 default <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\troute add -inet6 -net <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t\t:</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -inet6 default <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span></div><div class=\"line\">\t\t:</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -inet6 <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span></div><div class=\"line\">\t\t:</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== resolv.conf handling ====================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== resolv.conf handling for any OS =========================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">modify_resolvconf_generic</span></span>() &#123;</div><div class=\"line\">\tgrep <span class=\"string\">'^#@VPNC_GENERATED@'</span> /etc/resolv.conf &gt; /dev/null 2&gt;&amp;1 || cp -- /etc/resolv.conf <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span></div><div class=\"line\">\tNEW_RESOLVCONF=<span class=\"string\">\"#@VPNC_GENERATED@ -- this file is generated by vpnc</span></div><div class=\"line\"><span class=\"string\"># and will be overwritten by vpnc</span></div><div class=\"line\"><span class=\"string\"># as long as the above mark is intact\"</span></div><div class=\"line\"></div><div class=\"line\">\tDOMAINS=<span class=\"string\">\"<span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"built_in\">exec</span> 6&lt; <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">while</span> <span class=\"built_in\">read</span> LINE &lt;&amp;6 ; <span class=\"keyword\">do</span></div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$LINE</span>\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># omit; we will overwrite these</span></div><div class=\"line\">\t\t\tnameserver*) ;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># extract listed domains and prepend to list</span></div><div class=\"line\">\t\t\tdomain* | search*) DOMAINS=<span class=\"string\">\"<span class=\"variable\">$&#123;LINE#* &#125;</span> <span class=\"variable\">$DOMAINS</span>\"</span> ;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># retain other lines</span></div><div class=\"line\">\t\t\t*) NEW_RESOLVCONF=<span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\"><span class=\"variable\">$LINE</span>\"</span> ;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t<span class=\"keyword\">done</span></div><div class=\"line\">\t<span class=\"built_in\">exec</span> 6&lt;&amp;-</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; <span class=\"keyword\">do</span></div><div class=\"line\">\t\tNEW_RESOLVCONF=<span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">nameserver <span class=\"variable\">$i</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">done</span></div><div class=\"line\">\t<span class=\"comment\"># note that \"search\" is mutually exclusive with \"domain\";</span></div><div class=\"line\">\t<span class=\"comment\"># \"search\" allows multiple domains to be listed, so use that</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$DOMAINS</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tNEW_RESOLVCONF=<span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">search <span class=\"variable\">$DOMAINS</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span>\"</span> &gt; /etc/resolv.conf</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"Darwin\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"`uname -r`\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># Skip for pre-10.4 systems</span></div><div class=\"line\">\t\t\t4.*|5.*|6.*|7.*)</div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># 10.4 and later require use of scutil for DNS to work properly</span></div><div class=\"line\">\t\t\t*)</div><div class=\"line\">\t\t\t\tOVERRIDE_PRIMARY=<span class=\"string\">\"\"</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$CISCO_SPLIT_INC</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> [ <span class=\"variable\">$CISCO_SPLIT_INC</span> -lt 1 ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"comment\"># Must override for correct default route</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"comment\"># Cannot use multiple DNS matching in this case</span></div><div class=\"line\">\t\t\t\t\t\tOVERRIDE_PRIMARY=<span class=\"string\">'d.add OverridePrimary # 1'</span></div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># Overriding the default gateway breaks split routing</span></div><div class=\"line\">\t\t\t\t\tOVERRIDE_GATEWAY=<span class=\"string\">\"\"</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># Not overriding the default gateway breaks usage of</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># INTERNAL_IP4_DNS. Prepend INTERNAL_IP4_DNS to list</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># of used DNS servers</span></div><div class=\"line\">\t\t\t\t\tSERVICE=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Global/IPv4\"</span> | scutil | grep -oE <span class=\"string\">'[a-fA-F0-9]&#123;8&#125;-([a-fA-F0-9]&#123;4&#125;-)&#123;3&#125;[a-fA-F0-9]&#123;12&#125;'</span>`</div><div class=\"line\">\t\t\t\t\tSERVICE_DNS=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS\"</span> | scutil | grep -oE <span class=\"string\">'([0-9]&#123;1,3&#125;[\\.])&#123;3&#125;[0-9]&#123;1,3&#125;'</span> | xargs`</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> [ X<span class=\"string\">\"<span class=\"variable\">$SERVICE_DNS</span>\"</span> != X<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\t\t\tget State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\td.add ServerAddresses * <span class=\"variable\">$INTERNAL_IP4_DNS</span> <span class=\"variable\">$SERVICE_DNS</span></div><div class=\"line\">\t\t\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">else</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># No split routing. Override default gateway</span></div><div class=\"line\">\t\t\t\t\tOVERRIDE_GATEWAY=<span class=\"string\">\"d.add Router <span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># Uncomment the following if/fi pair to use multiple</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># DNS matching when available.  When multiple DNS matching</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># is present, anything reading the /etc/resolv.conf file</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># directly will probably not work as intended.</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\">#if [ -z \"$CISCO_DEF_DOMAIN\" ]; then</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># Cannot use multiple DNS matching without a domain</span></div><div class=\"line\">\t\t\t\t\tOVERRIDE_PRIMARY=<span class=\"string\">'d.add OverridePrimary # 1'</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\">#fi</span></div><div class=\"line\">\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\td.init</div><div class=\"line\">\t\t\t\t\td.add ServerAddresses * <span class=\"variable\">$INTERNAL_IP4_DNS</span></div><div class=\"line\">\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\td.init</div><div class=\"line\">\t\t\t\t\t<span class=\"variable\">$OVERRIDE_GATEWAY</span></div><div class=\"line\">\t\t\t\t\td.add Addresses * <span class=\"variable\">$INTERNAL_IP4_ADDRESS</span></div><div class=\"line\">\t\t\t\t\td.add SubnetMasks * 255.255.255.255</div><div class=\"line\">\t\t\t\t\td.add InterfaceName <span class=\"variable\">$TUNDEV</span></div><div class=\"line\">\t\t\t\t\t<span class=\"variable\">$OVERRIDE_PRIMARY</span></div><div class=\"line\">\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/IPv4</div><div class=\"line\">\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\t\tget State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\t\td.add DomainName <span class=\"variable\">$CISCO_DEF_DOMAIN</span></div><div class=\"line\">\t\t\t\t\t\td.add SearchDomains * <span class=\"variable\">$CISCO_DEF_DOMAIN</span></div><div class=\"line\">\t\t\t\t\t\td.add SupplementalMatchDomains * <span class=\"variable\">$CISCO_DEF_DOMAIN</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">restore_resolvconf_generic</span></span>() &#123;</div><div class=\"line\">\t<span class=\"keyword\">if</span> [ ! -f <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"built_in\">return</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">\tgrep <span class=\"string\">'^#@VPNC_GENERATED@'</span> /etc/resolv.conf &gt; /dev/null 2&gt;&amp;1 &amp;&amp; cat <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span> &gt; /etc/resolv.conf</div><div class=\"line\">\trm -f -- <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"Darwin\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"`uname -r`\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># Skip for pre-10.4 systems</span></div><div class=\"line\">\t\t\t4.*|5.*|6.*|7.*)</div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># 10.4 and later require use of scutil for DNS to work properly</span></div><div class=\"line\">\t\t\t*)</div><div class=\"line\">\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\tremove State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/IPv4</div><div class=\"line\">\t\t\t\t\tremove State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t<span class=\"comment\"># Split routing required prepending of INTERNAL_IP4_DNS</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># to list of used DNS servers</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$CISCO_SPLIT_INC</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\tSERVICE=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Global/IPv4\"</span> | scutil | grep -oE <span class=\"string\">'[a-fA-F0-9]&#123;8&#125;-([a-fA-F0-9]&#123;4&#125;-)&#123;3&#125;[a-fA-F0-9]&#123;12&#125;'</span>`</div><div class=\"line\">\t\t\t\t\tSERVICE_DNS=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS\"</span> | scutil | grep -oE <span class=\"string\">'([0-9]&#123;1,3&#125;[\\.])&#123;3&#125;[0-9]&#123;1,3&#125;'</span> | xargs`</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> [ X<span class=\"string\">\"<span class=\"variable\">$SERVICE_DNS</span>\"</span> != X<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\t\t\tget State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\td.add ServerAddresses * <span class=\"variable\">$&#123;SERVICE_DNS##$INTERNAL_IP4_DNS&#125;</span></div><div class=\"line\">\t\t\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\"># === resolv.conf handling via /sbin/netconfig (Suse 11.1) =====================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Suse provides a script that modifies resolv.conf. Use it because it will</span></div><div class=\"line\"><span class=\"comment\"># restart/reload all other services that care about it (e.g. lwresd).  [unclear if this is still true, but probably --mlk]</span></div><div class=\"line\"></div><div class=\"line\">modify_resolvconf_suse_netconfig()</div><div class=\"line\">&#123;</div><div class=\"line\">\t/sbin/netconfig modify -s vpnc -i <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> &lt;&lt;-EOF</div><div class=\"line\">\t\tINTERFACE=<span class=\"string\">'$TUNDEV'</span></div><div class=\"line\">\t\tDNSSERVERS=<span class=\"string\">'$INTERNAL_IP4_DNS'</span></div><div class=\"line\">\t\tDNSDOMAIN=<span class=\"string\">'$CISCO_DEF_DOMAIN'</span></div><div class=\"line\">\t\tEOF</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\"># Restore resolv.conf to old contents on Suse</span></div><div class=\"line\">restore_resolvconf_suse_netconfig()</div><div class=\"line\">&#123;</div><div class=\"line\">\t/sbin/netconfig remove -s vpnc -i <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># === resolv.conf handling via /sbin/modify_resolvconf (Suse) =====================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Suse provides a script that modifies resolv.conf. Use it because it will</span></div><div class=\"line\"><span class=\"comment\"># restart/reload all other services that care about it (e.g. lwresd).</span></div><div class=\"line\"></div><div class=\"line\">modify_resolvconf_suse()</div><div class=\"line\">&#123;</div><div class=\"line\">\tFULL_SCRIPTNAME=`readlink -f <span class=\"variable\">$0</span>`</div><div class=\"line\">\tRESOLV_OPTS=<span class=\"string\">''</span></div><div class=\"line\">\t<span class=\"built_in\">test</span> -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\"</span> &amp;&amp; RESOLV_OPTS=<span class=\"string\">\"-n \\\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\\\"\"</span></div><div class=\"line\">\t<span class=\"built_in\">test</span> -n <span class=\"string\">\"<span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span> &amp;&amp; RESOLV_OPTS=<span class=\"string\">\"<span class=\"variable\">$RESOLV_OPTS</span> -d <span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span></div><div class=\"line\">\t<span class=\"built_in\">test</span> -n <span class=\"string\">\"<span class=\"variable\">$RESOLV_OPTS</span>\"</span> &amp;&amp; <span class=\"built_in\">eval</span> /sbin/modify_resolvconf modify -s vpnc -p <span class=\"variable\">$SCRIPTNAME</span> -f <span class=\"variable\">$FULL_SCRIPTNAME</span> -e <span class=\"variable\">$TUNDEV</span> <span class=\"variable\">$RESOLV_OPTS</span> -t \\<span class=\"string\">\"This file was created by <span class=\"variable\">$SCRIPTNAME</span>\\\"</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># Restore resolv.conf to old contents on Suse</span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_suse()</span></div><div class=\"line\"><span class=\"string\">&#123;</span></div><div class=\"line\"><span class=\"string\">\tFULL_SCRIPTNAME=`readlink -f <span class=\"variable\">$0</span>`</span></div><div class=\"line\"><span class=\"string\">\t/sbin/modify_resolvconf restore -s vpnc -p <span class=\"variable\">$SCRIPTNAME</span> -f <span class=\"variable\">$FULL_SCRIPTNAME</span> -e <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># === resolv.conf handling via UCI (OpenWRT) =========</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolvconf_openwrt() &#123;</span></div><div class=\"line\"><span class=\"string\">\tadd_dns <span class=\"variable\">$OPENWRT_INTERFACE</span> <span class=\"variable\">$INTERNAL_IP4_DNS</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_openwrt() &#123;</span></div><div class=\"line\"><span class=\"string\">\tremove_dns <span class=\"variable\">$OPENWRT_INTERFACE</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"># === resolv.conf handling via /sbin/resolvconf (Debian, Ubuntu, Gentoo)) =========</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolvconf_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\tNEW_RESOLVCONF=\"</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span>; do</span></div><div class=\"line\"><span class=\"string\">\t\tNEW_RESOLVCONF=\"</span><span class=\"variable\">$NEW_RESOLVCONF</span></div><div class=\"line\">nameserver <span class=\"variable\">$i</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tdone</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tNEW_RESOLVCONF=\"</span><span class=\"variable\">$NEW_RESOLVCONF</span></div><div class=\"line\">domain <span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">\techo \"</span><span class=\"variable\">$NEW_RESOLVCONF</span><span class=\"string\">\" | /sbin/resolvconf -a <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\t/sbin/resolvconf -d <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">AF_INET=2</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">get_if_index() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal link</span></div><div class=\"line\"><span class=\"string\">\tlink=\"</span>$(ip link show dev <span class=\"string\">\"<span class=\"variable\">$1</span>\"</span>)<span class=\"string\">\" || return $?</span></div><div class=\"line\"><span class=\"string\">\techo <span class=\"variable\">$&#123;link&#125;</span> | awk -F: '&#123;print <span class=\"variable\">$1</span>&#125;'</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">busctl_call() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal dest node</span></div><div class=\"line\"><span class=\"string\">\tdest=org.freedesktop.resolve1</span></div><div class=\"line\"><span class=\"string\">\tnode=/org/freedesktop/resolve1</span></div><div class=\"line\"><span class=\"string\">\tbusctl call \"</span><span class=\"variable\">$dest</span><span class=\"string\">\" \"</span><span class=\"variable\">$&#123;node&#125;</span><span class=\"string\">\" \"</span><span class=\"variable\">$&#123;dest&#125;</span>.Manager<span class=\"string\">\" \"</span><span class=\"variable\">$@</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">busctl_set_nameservers() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index addresses args addr</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$1</span></span></div><div class=\"line\"><span class=\"string\">\tshift</span></div><div class=\"line\"><span class=\"string\">\taddresses=\"</span><span class=\"variable\">$@</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\targs=\"</span><span class=\"variable\">$if_index</span> <span class=\"variable\">$#</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfor addr in <span class=\"variable\">$&#123;addresses&#125;</span>; do</span></div><div class=\"line\"><span class=\"string\">\t\targs=\"</span><span class=\"variable\">$args</span> <span class=\"variable\">$&#123;AF_INET&#125;</span> 4 $(<span class=\"built_in\">echo</span> <span class=\"variable\">$addr</span> | sed <span class=\"string\">'s/[.]/ /g'</span>)<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tdone</span></div><div class=\"line\"><span class=\"string\">\tbusctl_call SetLinkDNS 'ia(iay)' <span class=\"variable\">$&#123;args&#125;</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">busctl_set_search() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index domains args domain</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$1</span></span></div><div class=\"line\"><span class=\"string\">\tshift</span></div><div class=\"line\"><span class=\"string\">\tdomains=\"</span><span class=\"variable\">$@</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\targs=\"</span><span class=\"variable\">$if_index</span> <span class=\"variable\">$#</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfor domain in <span class=\"variable\">$&#123;domains&#125;</span>; do</span></div><div class=\"line\"><span class=\"string\">\t\targs=\"</span><span class=\"variable\">$args</span> <span class=\"variable\">$&#123;domain&#125;</span> <span class=\"literal\">false</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tdone</span></div><div class=\"line\"><span class=\"string\">\tbusctl_call SetLinkDomains 'ia(sb)' <span class=\"variable\">$&#123;args&#125;</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolved_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$(get_if_index $TUNDEV)</span></span></div><div class=\"line\"><span class=\"string\">\tbusctl_set_nameservers <span class=\"variable\">$if_index</span> <span class=\"variable\">$INTERNAL_IP4_DNS</span></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tbusctl_set_search <span class=\"variable\">$if_index</span> <span class=\"variable\">$CISCO_DEF_DOMAIN</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolved_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$(get_if_index $TUNDEV)</span></span></div><div class=\"line\"><span class=\"string\">\tbusctl_call RevertLink 'i' <span class=\"variable\">$if_index</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># === resolv.conf handling via unbound =========</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolvconf_unbound() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control forward_add +i <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span> <span class=\"variable\">$&#123;INTERNAL_IP4_DNS&#125;</span></span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_requestlist</span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_zone <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_unbound() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control forward_remove +i <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span></span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_zone <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span></span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_requestlist</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># ========= Toplevel state handling  =======================================</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">kernel_is_2_6_or_above() &#123;</span></div><div class=\"line\"><span class=\"string\">\tcase `uname -r` in</span></div><div class=\"line\"><span class=\"string\">\t\t1.*|2.[012345]*)</span></div><div class=\"line\"><span class=\"string\">\t\t\treturn 1</span></div><div class=\"line\"><span class=\"string\">\t\t\t;;</span></div><div class=\"line\"><span class=\"string\">\t\t*)</span></div><div class=\"line\"><span class=\"string\">\t\t\treturn 0</span></div><div class=\"line\"><span class=\"string\">\t\t\t;;</span></div><div class=\"line\"><span class=\"string\">\tesac</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">do_pre_init() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>Linux<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif (exec 6&lt; /dev/net/tun) &gt; /dev/null 2&gt;&amp;1 ; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t:</span></div><div class=\"line\"><span class=\"string\">\t\telse # can't open /dev/net/tun</span></div><div class=\"line\"><span class=\"string\">\t\t\ttest -e /proc/sys/kernel/modprobe &amp;&amp; `cat /proc/sys/kernel/modprobe` tun 2&gt;/dev/null</span></div><div class=\"line\"><span class=\"string\">\t\t\t# fix for broken devfs in kernel 2.6.x</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ \"</span>`readlink /dev/net/tun`<span class=\"string\">\" = misc/net/tun \\</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t-a ! -e /dev/net/misc/net/tun -a -e /dev/misc/net/tun ] ; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tln -sf /dev/misc/net/tun /dev/net/tun</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\t# make sure tun device exists</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ ! -e /dev/net/tun ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tmkdir -p /dev/net</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tmknod -m 0640 /dev/net/tun c 10 200</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t[ -x /sbin/restorecon ] &amp;&amp; /sbin/restorecon /dev/net/tun</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\t# workaround for a possible latency caused by udev, sleep max. 10s</span></div><div class=\"line\"><span class=\"string\">\t\t\tif kernel_is_2_6_or_above ; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tfor x in `seq 100` ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t\t(exec 6&lt;&gt; /dev/net/tun) &gt; /dev/null 2&gt;&amp;1 &amp;&amp; break;</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t\tsleep 0.1</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>FreeBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif ! kldstat -q -m if_tun &gt; /dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tkldload if_tun</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\t\tif ! ifconfig <span class=\"variable\">$TUNDEV</span> &gt; /dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig <span class=\"variable\">$TUNDEV</span> create</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>GNU/kFreeBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif [ ! -e /dev/tun ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tkldload if_tun</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>NetBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>OpenBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif ! ifconfig <span class=\"variable\">$TUNDEV</span> &gt; /dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig <span class=\"variable\">$TUNDEV</span> create</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>SunOS<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>Darwin<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">do_connect() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_BANNER</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\techo \"</span>Connect Banner:<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\techo \"</span><span class=\"variable\">$CISCO_BANNER</span><span class=\"string\">\" | while read LINE ; do echo \"</span>|<span class=\"string\">\" \"</span><span class=\"variable\">$LINE</span><span class=\"string\">\" ; done</span></div><div class=\"line\"><span class=\"string\">\t\techo</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tset_vpngateway_route</span></div><div class=\"line\"><span class=\"string\">\tdo_ifconfig</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASK&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" != \"</span>0.0.0.0<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\techo \"</span><span class=\"variable\">$i</span><span class=\"string\">\" | grep : &gt;/dev/null || \\</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>255.255.255.255<span class=\"string\">\" \"</span>32<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tset_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ <span class=\"variable\">$NETMASKLEN</span> -lt 128 ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_ipv6_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\tif echo \"</span><span class=\"variable\">$i</span><span class=\"string\">\" | grep : &gt;/dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_ipv6_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" -o -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_DNS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t<span class=\"variable\">$MODIFYRESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">do_disconnect() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASK&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" != \"</span>0.0.0.0<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t# FIXME: This doesn't restore previously overwritten</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t#        routes.</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tdel_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\treset_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\tdel_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>255.255.255.255<span class=\"string\">\" \"</span>32<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telse</span></div><div class=\"line\"><span class=\"string\">\t\treset_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ <span class=\"variable\">$NETMASKLEN</span> -eq 0 ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\treset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tdel_ipv6_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP6_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\tdel_ipv6_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" -o -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\treset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tdel_vpngateway_route</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_DNS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t<span class=\"variable\">$RESTORERESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$IPROUTE</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t<span class=\"variable\">$IPROUTE</span> addr del \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>/255.255.255.255<span class=\"string\">\" peer \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" dev \"</span><span class=\"variable\">$TUNDEV</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t# If the netmask is provided, it contains the address _and_ netmask</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ] &amp;&amp; [ -z \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tINTERNAL_IP6_NETMASK=\"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>/128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t<span class=\"variable\">$IPROUTE</span> -6 addr del <span class=\"variable\">$INTERNAL_IP6_NETMASK</span> dev <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telse</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig \"</span><span class=\"variable\">$TUNDEV</span><span class=\"string\">\" 0.0.0.0</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ] &amp;&amp; [ -z \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tINTERNAL_IP6_NETMASK=\"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>/128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig \"</span><span class=\"variable\">$TUNDEV</span><span class=\"string\">\" inet6 del <span class=\"variable\">$INTERNAL_IP6_NETMASK</span></span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tdestroy_tun_device</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">#### Main</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">if [ -z \"</span><span class=\"variable\">$reason</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\techo \"</span>this script must be called from vpnc<span class=\"string\">\" 1&gt;&amp;2</span></div><div class=\"line\"><span class=\"string\">\texit 1</span></div><div class=\"line\"><span class=\"string\">fi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">case \"</span><span class=\"variable\">$reason</span><span class=\"string\">\" in</span></div><div class=\"line\"><span class=\"string\">\tpre-init)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks pre-init</span></div><div class=\"line\"><span class=\"string\">\t\tdo_pre_init</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\tconnect)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks connect</span></div><div class=\"line\"><span class=\"string\">\t\tdo_connect</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks post-connect</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\tdisconnect)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks disconnect</span></div><div class=\"line\"><span class=\"string\">\t\tdo_disconnect</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks post-disconnect</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\treconnect)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks reconnect</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\t*)</span></div><div class=\"line\"><span class=\"string\">\t\techo \"</span>unknown reason <span class=\"string\">'$reason'</span>. Maybe vpnc-script is out of date<span class=\"string\">\" 1&gt;&amp;2</span></div><div class=\"line\"><span class=\"string\">\t\texit 1</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">esac</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">exit 0</span></div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<p>AnyConnect为思科推出的VPN客户端，目前已有Windows、Android、IOS、Macintosh、Ubuntu、WebOS、Blackberry等操作系统的客户端。AnyConnection主要作用是方便员工在任何设备上安全地办公，AnyConnect最主要的优点是可以给客户端下发走VPN的路由表<br>本文介绍的是利用ocserv搭建openconnect服务器 </p>","more":"<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统: debian7<br>ocserv版本: 0.9.2</p>\n<h1 id=\"服务器端配置\"><a href=\"#服务器端配置\" class=\"headerlink\" title=\"服务器端配置\"></a>服务器端配置</h1><h2 id=\"1-安装依赖\"><a href=\"#1-安装依赖\" class=\"headerlink\" title=\"1. 安装依赖\"></a>1. 安装依赖</h2><p>ocserv使用GnuTLS作为SSL的library,所以编译时需要相应的dev包.Debian Stable里面带的版本太老(2.12.20),而ocserv需要的包版本在2.15以上,所以需要从backports安装:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">echo &quot;deb http://ftp.debian.org/debian wheezy-backports main contrib non-free&quot; &gt;&gt; /etc/apt/sources.list </div><div class=\"line\">apt-get update</div><div class=\"line\">apt-get upgarde</div><div class=\"line\">apt-get -t wheezy-backports install libgnutls28-dev -y </div><div class=\"line\">apt-get install libgmp3-dev m4 gcc pkg-config make gnutls-bin -y </div><div class=\"line\">apt-get install build-essential libwrap0-dev libpam0g-dev libdbus-1-dev libreadline-dev libnl-route-3-dev libprotobuf-c0-dev libpcl1-dev libopts25-dev autogen libgnutls28-dev libseccomp-dev liblz4-dev -y</div></pre></td></tr></table></figure></p>\n<h2 id=\"2-修改最大路由数目\"><a href=\"#2-修改最大路由数目\" class=\"headerlink\" title=\"2. 修改最大路由数目\"></a>2. 修改最大路由数目</h2><p>ocserv可以修改src/vpn.h来支持超过96行(ocserv默认值)但不超过200行(Cisco Anyconnect最大值)的路由表</p>\n<blockquote>\n<p># define MAX_CONFIG_ENTRIES 96</p>\n</blockquote>\n<p>注意根据Cisco官方文档,no-route和route不能同时使用</p>\n<h2 id=\"3-下载-amp-编译-amp-安装\"><a href=\"#3-下载-amp-编译-amp-安装\" class=\"headerlink\" title=\"3. 下载&amp;编译&amp;安装\"></a>3. 下载&amp;编译&amp;安装</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget ftp://ftp.infradead.org/pub/ocserv/ocserv-0.9.2.tar.xz </div><div class=\"line\">tar Jxvf ocserv-0.9.2.tar.xz </div><div class=\"line\">cd ocserv-0.9.2 </div><div class=\"line\">./configure --prefix=/usr --sysconfdir=/etc </div><div class=\"line\">make </div><div class=\"line\">make install</div></pre></td></tr></table></figure>\n<h2 id=\"4-生成证书\"><a href=\"#4-生成证书\" class=\"headerlink\" title=\"4. 生成证书\"></a>4. 生成证书</h2><h3 id=\"4-1-生成CA证书\"><a href=\"#4-1-生成CA证书\" class=\"headerlink\" title=\"4.1 生成CA证书\"></a>4.1 生成CA证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-privkey --outfile ca-key.pem</div><div class=\"line\">vim ca.tmpl</div></pre></td></tr></table></figure>\n<blockquote>\n<p>cn = “aya”<br>organization = “aya”<br>serial = 1<br>expiration_days = 3650<br>ca<br>signing_key<br>cert_signing_key<br>crl_signing_key  </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-self-signed --load-privkey ca-key.pem --template ca.tmpl --outfile ca-cert.pem</div></pre></td></tr></table></figure>\n<h3 id=\"4-2-生成本地服务器证书\"><a href=\"#4-2-生成本地服务器证书\" class=\"headerlink\" title=\"4.2 生成本地服务器证书\"></a>4.2 生成本地服务器证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-privkey --outfile server-key.pem</div><div class=\"line\">vim server.tmpl</div></pre></td></tr></table></figure>\n<blockquote>\n<p>cn = “littleya.com”<br>organization = “aya”<br>serial = 2<br>expiration_days = 3650<br>encryption_key<br>signing_key<br>tls_www_server  </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">certtool --generate-certificate --load-privkey server-key.pem --load-ca-certificate ca-cert.pem --load-ca-privkey ca-key.pem --template server.tmpl --outfile server-cert.pem</div></pre></td></tr></table></figure>\n<h3 id=\"4-3-移动生成的证书\"><a href=\"#4-3-移动生成的证书\" class=\"headerlink\" title=\"4.3 移动生成的证书\"></a>4.3 移动生成的证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /etc/ssl </div><div class=\"line\">mkdir /etc/ssl/certs </div><div class=\"line\">mkdir /etc/ssl/private </div><div class=\"line\">cp ca-cert.pem /etc/ssl/certs </div><div class=\"line\">cp ca-key.pem /etc/ssl/private </div><div class=\"line\">cp server-cert.pem /etc/ssl/certs </div><div class=\"line\">cp server-key.pem /etc/ssl/private</div></pre></td></tr></table></figure>\n<h2 id=\"5-编辑配置文件\"><a href=\"#5-编辑配置文件\" class=\"headerlink\" title=\"5 编辑配置文件\"></a>5 编辑配置文件</h2><h3 id=\"5-1-拷贝配置文件到-etc-ocserv-中\"><a href=\"#5-1-拷贝配置文件到-etc-ocserv-中\" class=\"headerlink\" title=\"5.1 拷贝配置文件到 /etc/ocserv 中\"></a>5.1 拷贝配置文件到 <em>/etc/ocserv</em> 中</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /etc/ocserv  </div><div class=\"line\">cp ~/ocserv-0.9.2/doc/sample.config /etc/ocserv/ </div><div class=\"line\">cp /etc/ocserv/sample.config /etc/ocserv/ocserv.conf</div></pre></td></tr></table></figure>\n<h3 id=\"5-2-编辑配置文件\"><a href=\"#5-2-编辑配置文件\" class=\"headerlink\" title=\"5.2 编辑配置文件\"></a>5.2 编辑配置文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/ocserv/ocserv.conf</div></pre></td></tr></table></figure>\n<blockquote>\n<p>auth = “plain[/etc/ocserv/ocpasswd]”<br># ocserv支持多种认证方式，这是自带的密码认证，使用ocpasswd创建密码文件<br># ocserv还支持证书认证，可以通过Pluggable Authentication Modules (PAM)使用radius等认证方式<br><br></p>\n<p># 证书路径<br>server-cert = /etc/ssl/certs/server-cert.pem<br>server-key = /etc/ssl/private/server-key.pem<br><br></p>\n<p># if letsencrypt<br># server-cert = /etc/letsencrypt/live/example.com/fullchain.pem<br># server-key = /etc/letsencrypt/live/example.com/privkey.pem<br><br></p>\n<p># 同一个用户最多同时登陆数<br>max-same-clients = 10<br><br></p>\n<p># 运行组<br>run-as-group = nogroup<br><br></p>\n<p># 分配给VPN客户端的IP段<br>ipv4-network = 192.168.1.0<br><br></p>\n<p># DNS<br>dns = 8.8.8.8<br>dns = 8.8.4.4<br><br></p>\n<p># Keepalive in seconds<br>keepalive = 600<br><br></p>\n<p>#Dead peer detection in seconds.<br>dpd = 900<br><br></p>\n<p># Dead peer detection for mobile clients. The needs to<br># be much higher to prevent such clients being awaken too<br># often by the DPD messages, and save battery.<br># (clients that send the X-AnyConnect-Identifier-DeviceType)<br>mobile-dpd = 1800<br><br></p>\n<p>output-buffer = 23000<br>try-mtu-discovery = true<br><br></p>\n<p># The time (in seconds) that a client is allowed to stay idle (no traffic)<br># before being disconnected. Unset to disable.<br>idle-timeout = 3600<br><br></p>\n<p># The time (in seconds) that a mobile client is allowed to stay idle (no traffic) before being disconnected. Unset to disable.<br>mobile-idle-timeout = 3600<br><br></p>\n<p># 注释掉route的字段，这样表示所有流量都通过 VPN 发送<br># route = 192.168.16.0/255.255.255.0<br># route = 192.168.5.0/255.255.255.0</p>\n</blockquote>\n<p>其中路由表的信息,可以从Github上的 <a href=\"https://github.com/CNMan/ocserv-cn-no-route\" title=\"ocserv-cn-no-route\" target=\"_blank\" rel=\"external\">ocserv-cn-no-route</a> 项目配置</p>\n<h3 id=\"5-3-生成用户\"><a href=\"#5-3-生成用户\" class=\"headerlink\" title=\"5.3 生成用户\"></a>5.3 生成用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ocpasswd -c /etc/ocserv/ocpasswd user.name</div><div class=\"line\">#user.name为用户名</div></pre></td></tr></table></figure>\n<h2 id=\"6-其他配置\"><a href=\"#6-其他配置\" class=\"headerlink\" title=\"6. 其他配置\"></a>6. 其他配置</h2><h3 id=\"6-1-开启转发\"><a href=\"#6-1-开启转发\" class=\"headerlink\" title=\"6.1 开启转发\"></a>6.1 开启转发</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/sysctl.conf</div></pre></td></tr></table></figure>\n<blockquote>\n<p>net.ipv4.ip_forward = 1</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sysctl -p</div></pre></td></tr></table></figure>\n<h3 id=\"6-2-iptables表\"><a href=\"#6-2-iptables表\" class=\"headerlink\" title=\"6.2 iptables表\"></a>6.2 iptables表</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">iptables -t nat -A POSTROUTING -j MASQUERADE </div><div class=\"line\">iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu </div><div class=\"line\"> </div><div class=\"line\">#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式 </div><div class=\"line\"> </div><div class=\"line\">iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j SNAT --to-source VPN SERVER&apos;S IP </div><div class=\"line\">iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu </div><div class=\"line\"> </div><div class=\"line\">#若打开网页有问题可以尝试把mtu调小</div><div class=\"line\">iptables -A FORWARD -p tcp --syn -s 192.168.1.0/24 -j TCPMSS --set-mss 1356</div></pre></td></tr></table></figure>\n<h3 id=\"6-3-调试\"><a href=\"#6-3-调试\" class=\"headerlink\" title=\"6.3 调试\"></a>6.3 调试</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ocserv -c /etc/ocserv/ocserv.conf -f -d 1</div></pre></td></tr></table></figure>\n<h3 id=\"6-4-开机启动\"><a href=\"#6-4-开机启动\" class=\"headerlink\" title=\"6.4 开机启动\"></a>6.4 开机启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/rc.local</div></pre></td></tr></table></figure>\n<blockquote>\n<p>iptables -t nat -A POSTROUTING -j MASQUERADE<br>iptables -A FORWARD -p tcp –tcp-flags SYN,RST SYN -j TCPMSS –clamp-mss-to-pmtu<br><br></p>\n<p>#上面是XEN/KVM架构设置方式,下面的是openvz架构的设置方式<br><br></p>\n<p>iptables -t nat -A POSTROUTING -s 192.168.110.0/24 -j SNAT –to-source VPN SERVER’S IP<br>iptables -A FORWARD -p tcp –tcp-flags SYN,RST SYN -j TCPMSS –clamp-mss-to-pmtu<br><br></p>\n<p>ocserv</p>\n</blockquote>\n<h1 id=\"客户端配置\"><a href=\"#客户端配置\" class=\"headerlink\" title=\"客户端配置\"></a>客户端配置</h1><h2 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux:\"></a>Linux:</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">apt-get install -y openconnect expect screen</div><div class=\"line\">vim /usr/local/sbin/ocdo.sh</div></pre></td></tr></table></figure>\n<blockquote>\n<p>#!/usr/bin/expect<br>spawn screen -S ocdo openconnect -u username –script=/etc/vpnc/vpnc-script –no-dtls vpn.example.com -b<br>expect “anything else”<br>send “yes\\r”<br>expect “Password:”<br>send “password\\r”<br>interact  </p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">echo &quot;/usr/local/sbin/ocdo.sh&quot; &gt;&gt; /rc.local </div><div class=\"line\">mkdir /etc/vpnc &amp;&amp; cd /etc/vpnc </div><div class=\"line\">wget http://git.infradead.org/users/dwmw2/vpnc-scripts.git/blob_plain/HEAD:/vpnc-script</div></pre></td></tr></table></figure>\n<p>vpnc-script:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div><div class=\"line\">341</div><div class=\"line\">342</div><div class=\"line\">343</div><div class=\"line\">344</div><div class=\"line\">345</div><div class=\"line\">346</div><div class=\"line\">347</div><div class=\"line\">348</div><div class=\"line\">349</div><div class=\"line\">350</div><div class=\"line\">351</div><div class=\"line\">352</div><div class=\"line\">353</div><div class=\"line\">354</div><div class=\"line\">355</div><div class=\"line\">356</div><div class=\"line\">357</div><div class=\"line\">358</div><div class=\"line\">359</div><div class=\"line\">360</div><div class=\"line\">361</div><div class=\"line\">362</div><div class=\"line\">363</div><div class=\"line\">364</div><div class=\"line\">365</div><div class=\"line\">366</div><div class=\"line\">367</div><div class=\"line\">368</div><div class=\"line\">369</div><div class=\"line\">370</div><div class=\"line\">371</div><div class=\"line\">372</div><div class=\"line\">373</div><div class=\"line\">374</div><div class=\"line\">375</div><div class=\"line\">376</div><div class=\"line\">377</div><div class=\"line\">378</div><div class=\"line\">379</div><div class=\"line\">380</div><div class=\"line\">381</div><div class=\"line\">382</div><div class=\"line\">383</div><div class=\"line\">384</div><div class=\"line\">385</div><div class=\"line\">386</div><div class=\"line\">387</div><div class=\"line\">388</div><div class=\"line\">389</div><div class=\"line\">390</div><div class=\"line\">391</div><div class=\"line\">392</div><div class=\"line\">393</div><div class=\"line\">394</div><div class=\"line\">395</div><div class=\"line\">396</div><div class=\"line\">397</div><div class=\"line\">398</div><div class=\"line\">399</div><div class=\"line\">400</div><div class=\"line\">401</div><div class=\"line\">402</div><div class=\"line\">403</div><div class=\"line\">404</div><div class=\"line\">405</div><div class=\"line\">406</div><div class=\"line\">407</div><div class=\"line\">408</div><div class=\"line\">409</div><div class=\"line\">410</div><div class=\"line\">411</div><div class=\"line\">412</div><div class=\"line\">413</div><div class=\"line\">414</div><div class=\"line\">415</div><div class=\"line\">416</div><div class=\"line\">417</div><div class=\"line\">418</div><div class=\"line\">419</div><div class=\"line\">420</div><div class=\"line\">421</div><div class=\"line\">422</div><div class=\"line\">423</div><div class=\"line\">424</div><div class=\"line\">425</div><div class=\"line\">426</div><div class=\"line\">427</div><div class=\"line\">428</div><div class=\"line\">429</div><div class=\"line\">430</div><div class=\"line\">431</div><div class=\"line\">432</div><div class=\"line\">433</div><div class=\"line\">434</div><div class=\"line\">435</div><div class=\"line\">436</div><div class=\"line\">437</div><div class=\"line\">438</div><div class=\"line\">439</div><div class=\"line\">440</div><div class=\"line\">441</div><div class=\"line\">442</div><div class=\"line\">443</div><div class=\"line\">444</div><div class=\"line\">445</div><div class=\"line\">446</div><div class=\"line\">447</div><div class=\"line\">448</div><div class=\"line\">449</div><div class=\"line\">450</div><div class=\"line\">451</div><div class=\"line\">452</div><div class=\"line\">453</div><div class=\"line\">454</div><div class=\"line\">455</div><div class=\"line\">456</div><div class=\"line\">457</div><div class=\"line\">458</div><div class=\"line\">459</div><div class=\"line\">460</div><div class=\"line\">461</div><div class=\"line\">462</div><div class=\"line\">463</div><div class=\"line\">464</div><div class=\"line\">465</div><div class=\"line\">466</div><div class=\"line\">467</div><div class=\"line\">468</div><div class=\"line\">469</div><div class=\"line\">470</div><div class=\"line\">471</div><div class=\"line\">472</div><div class=\"line\">473</div><div class=\"line\">474</div><div class=\"line\">475</div><div class=\"line\">476</div><div class=\"line\">477</div><div class=\"line\">478</div><div class=\"line\">479</div><div class=\"line\">480</div><div class=\"line\">481</div><div class=\"line\">482</div><div class=\"line\">483</div><div class=\"line\">484</div><div class=\"line\">485</div><div class=\"line\">486</div><div class=\"line\">487</div><div class=\"line\">488</div><div class=\"line\">489</div><div class=\"line\">490</div><div class=\"line\">491</div><div class=\"line\">492</div><div class=\"line\">493</div><div class=\"line\">494</div><div class=\"line\">495</div><div class=\"line\">496</div><div class=\"line\">497</div><div class=\"line\">498</div><div class=\"line\">499</div><div class=\"line\">500</div><div class=\"line\">501</div><div class=\"line\">502</div><div class=\"line\">503</div><div class=\"line\">504</div><div class=\"line\">505</div><div class=\"line\">506</div><div class=\"line\">507</div><div class=\"line\">508</div><div class=\"line\">509</div><div class=\"line\">510</div><div class=\"line\">511</div><div class=\"line\">512</div><div class=\"line\">513</div><div class=\"line\">514</div><div class=\"line\">515</div><div class=\"line\">516</div><div class=\"line\">517</div><div class=\"line\">518</div><div class=\"line\">519</div><div class=\"line\">520</div><div class=\"line\">521</div><div class=\"line\">522</div><div class=\"line\">523</div><div class=\"line\">524</div><div class=\"line\">525</div><div class=\"line\">526</div><div class=\"line\">527</div><div class=\"line\">528</div><div class=\"line\">529</div><div class=\"line\">530</div><div class=\"line\">531</div><div class=\"line\">532</div><div class=\"line\">533</div><div class=\"line\">534</div><div class=\"line\">535</div><div class=\"line\">536</div><div class=\"line\">537</div><div class=\"line\">538</div><div class=\"line\">539</div><div class=\"line\">540</div><div class=\"line\">541</div><div class=\"line\">542</div><div class=\"line\">543</div><div class=\"line\">544</div><div class=\"line\">545</div><div class=\"line\">546</div><div class=\"line\">547</div><div class=\"line\">548</div><div class=\"line\">549</div><div class=\"line\">550</div><div class=\"line\">551</div><div class=\"line\">552</div><div class=\"line\">553</div><div class=\"line\">554</div><div class=\"line\">555</div><div class=\"line\">556</div><div class=\"line\">557</div><div class=\"line\">558</div><div class=\"line\">559</div><div class=\"line\">560</div><div class=\"line\">561</div><div class=\"line\">562</div><div class=\"line\">563</div><div class=\"line\">564</div><div class=\"line\">565</div><div class=\"line\">566</div><div class=\"line\">567</div><div class=\"line\">568</div><div class=\"line\">569</div><div class=\"line\">570</div><div class=\"line\">571</div><div class=\"line\">572</div><div class=\"line\">573</div><div class=\"line\">574</div><div class=\"line\">575</div><div class=\"line\">576</div><div class=\"line\">577</div><div class=\"line\">578</div><div class=\"line\">579</div><div class=\"line\">580</div><div class=\"line\">581</div><div class=\"line\">582</div><div class=\"line\">583</div><div class=\"line\">584</div><div class=\"line\">585</div><div class=\"line\">586</div><div class=\"line\">587</div><div class=\"line\">588</div><div class=\"line\">589</div><div class=\"line\">590</div><div class=\"line\">591</div><div class=\"line\">592</div><div class=\"line\">593</div><div class=\"line\">594</div><div class=\"line\">595</div><div class=\"line\">596</div><div class=\"line\">597</div><div class=\"line\">598</div><div class=\"line\">599</div><div class=\"line\">600</div><div class=\"line\">601</div><div class=\"line\">602</div><div class=\"line\">603</div><div class=\"line\">604</div><div class=\"line\">605</div><div class=\"line\">606</div><div class=\"line\">607</div><div class=\"line\">608</div><div class=\"line\">609</div><div class=\"line\">610</div><div class=\"line\">611</div><div class=\"line\">612</div><div class=\"line\">613</div><div class=\"line\">614</div><div class=\"line\">615</div><div class=\"line\">616</div><div class=\"line\">617</div><div class=\"line\">618</div><div class=\"line\">619</div><div class=\"line\">620</div><div class=\"line\">621</div><div class=\"line\">622</div><div class=\"line\">623</div><div class=\"line\">624</div><div class=\"line\">625</div><div class=\"line\">626</div><div class=\"line\">627</div><div class=\"line\">628</div><div class=\"line\">629</div><div class=\"line\">630</div><div class=\"line\">631</div><div class=\"line\">632</div><div class=\"line\">633</div><div class=\"line\">634</div><div class=\"line\">635</div><div class=\"line\">636</div><div class=\"line\">637</div><div class=\"line\">638</div><div class=\"line\">639</div><div class=\"line\">640</div><div class=\"line\">641</div><div class=\"line\">642</div><div class=\"line\">643</div><div class=\"line\">644</div><div class=\"line\">645</div><div class=\"line\">646</div><div class=\"line\">647</div><div class=\"line\">648</div><div class=\"line\">649</div><div class=\"line\">650</div><div class=\"line\">651</div><div class=\"line\">652</div><div class=\"line\">653</div><div class=\"line\">654</div><div class=\"line\">655</div><div class=\"line\">656</div><div class=\"line\">657</div><div class=\"line\">658</div><div class=\"line\">659</div><div class=\"line\">660</div><div class=\"line\">661</div><div class=\"line\">662</div><div class=\"line\">663</div><div class=\"line\">664</div><div class=\"line\">665</div><div class=\"line\">666</div><div class=\"line\">667</div><div class=\"line\">668</div><div class=\"line\">669</div><div class=\"line\">670</div><div class=\"line\">671</div><div class=\"line\">672</div><div class=\"line\">673</div><div class=\"line\">674</div><div class=\"line\">675</div><div class=\"line\">676</div><div class=\"line\">677</div><div class=\"line\">678</div><div class=\"line\">679</div><div class=\"line\">680</div><div class=\"line\">681</div><div class=\"line\">682</div><div class=\"line\">683</div><div class=\"line\">684</div><div class=\"line\">685</div><div class=\"line\">686</div><div class=\"line\">687</div><div class=\"line\">688</div><div class=\"line\">689</div><div class=\"line\">690</div><div class=\"line\">691</div><div class=\"line\">692</div><div class=\"line\">693</div><div class=\"line\">694</div><div class=\"line\">695</div><div class=\"line\">696</div><div class=\"line\">697</div><div class=\"line\">698</div><div class=\"line\">699</div><div class=\"line\">700</div><div class=\"line\">701</div><div class=\"line\">702</div><div class=\"line\">703</div><div class=\"line\">704</div><div class=\"line\">705</div><div class=\"line\">706</div><div class=\"line\">707</div><div class=\"line\">708</div><div class=\"line\">709</div><div class=\"line\">710</div><div class=\"line\">711</div><div class=\"line\">712</div><div class=\"line\">713</div><div class=\"line\">714</div><div class=\"line\">715</div><div class=\"line\">716</div><div class=\"line\">717</div><div class=\"line\">718</div><div class=\"line\">719</div><div class=\"line\">720</div><div class=\"line\">721</div><div class=\"line\">722</div><div class=\"line\">723</div><div class=\"line\">724</div><div class=\"line\">725</div><div class=\"line\">726</div><div class=\"line\">727</div><div class=\"line\">728</div><div class=\"line\">729</div><div class=\"line\">730</div><div class=\"line\">731</div><div class=\"line\">732</div><div class=\"line\">733</div><div class=\"line\">734</div><div class=\"line\">735</div><div class=\"line\">736</div><div class=\"line\">737</div><div class=\"line\">738</div><div class=\"line\">739</div><div class=\"line\">740</div><div class=\"line\">741</div><div class=\"line\">742</div><div class=\"line\">743</div><div class=\"line\">744</div><div class=\"line\">745</div><div class=\"line\">746</div><div class=\"line\">747</div><div class=\"line\">748</div><div class=\"line\">749</div><div class=\"line\">750</div><div class=\"line\">751</div><div class=\"line\">752</div><div class=\"line\">753</div><div class=\"line\">754</div><div class=\"line\">755</div><div class=\"line\">756</div><div class=\"line\">757</div><div class=\"line\">758</div><div class=\"line\">759</div><div class=\"line\">760</div><div class=\"line\">761</div><div class=\"line\">762</div><div class=\"line\">763</div><div class=\"line\">764</div><div class=\"line\">765</div><div class=\"line\">766</div><div class=\"line\">767</div><div class=\"line\">768</div><div class=\"line\">769</div><div class=\"line\">770</div><div class=\"line\">771</div><div class=\"line\">772</div><div class=\"line\">773</div><div class=\"line\">774</div><div class=\"line\">775</div><div class=\"line\">776</div><div class=\"line\">777</div><div class=\"line\">778</div><div class=\"line\">779</div><div class=\"line\">780</div><div class=\"line\">781</div><div class=\"line\">782</div><div class=\"line\">783</div><div class=\"line\">784</div><div class=\"line\">785</div><div class=\"line\">786</div><div class=\"line\">787</div><div class=\"line\">788</div><div class=\"line\">789</div><div class=\"line\">790</div><div class=\"line\">791</div><div class=\"line\">792</div><div class=\"line\">793</div><div class=\"line\">794</div><div class=\"line\">795</div><div class=\"line\">796</div><div class=\"line\">797</div><div class=\"line\">798</div><div class=\"line\">799</div><div class=\"line\">800</div><div class=\"line\">801</div><div class=\"line\">802</div><div class=\"line\">803</div><div class=\"line\">804</div><div class=\"line\">805</div><div class=\"line\">806</div><div class=\"line\">807</div><div class=\"line\">808</div><div class=\"line\">809</div><div class=\"line\">810</div><div class=\"line\">811</div><div class=\"line\">812</div><div class=\"line\">813</div><div class=\"line\">814</div><div class=\"line\">815</div><div class=\"line\">816</div><div class=\"line\">817</div><div class=\"line\">818</div><div class=\"line\">819</div><div class=\"line\">820</div><div class=\"line\">821</div><div class=\"line\">822</div><div class=\"line\">823</div><div class=\"line\">824</div><div class=\"line\">825</div><div class=\"line\">826</div><div class=\"line\">827</div><div class=\"line\">828</div><div class=\"line\">829</div><div class=\"line\">830</div><div class=\"line\">831</div><div class=\"line\">832</div><div class=\"line\">833</div><div class=\"line\">834</div><div class=\"line\">835</div><div class=\"line\">836</div><div class=\"line\">837</div><div class=\"line\">838</div><div class=\"line\">839</div><div class=\"line\">840</div><div class=\"line\">841</div><div class=\"line\">842</div><div class=\"line\">843</div><div class=\"line\">844</div><div class=\"line\">845</div><div class=\"line\">846</div><div class=\"line\">847</div><div class=\"line\">848</div><div class=\"line\">849</div><div class=\"line\">850</div><div class=\"line\">851</div><div class=\"line\">852</div><div class=\"line\">853</div><div class=\"line\">854</div><div class=\"line\">855</div><div class=\"line\">856</div><div class=\"line\">857</div><div class=\"line\">858</div><div class=\"line\">859</div><div class=\"line\">860</div><div class=\"line\">861</div><div class=\"line\">862</div><div class=\"line\">863</div><div class=\"line\">864</div><div class=\"line\">865</div><div class=\"line\">866</div><div class=\"line\">867</div><div class=\"line\">868</div><div class=\"line\">869</div><div class=\"line\">870</div><div class=\"line\">871</div><div class=\"line\">872</div><div class=\"line\">873</div><div class=\"line\">874</div><div class=\"line\">875</div><div class=\"line\">876</div><div class=\"line\">877</div><div class=\"line\">878</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/sh</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># Originally part of vpnc source code:</span></div><div class=\"line\"><span class=\"comment\"># Â© 2005-2012 Maurice Massar, JÃ¶rg Mayer, Antonio Borneo et al.</span></div><div class=\"line\"><span class=\"comment\"># Â© 2009-2012 David Woodhouse &lt;dwmw2@infradead.org&gt;</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># This program is free software; you can redistribute it and/or modify</span></div><div class=\"line\"><span class=\"comment\"># it under the terms of the GNU General Public License as published by</span></div><div class=\"line\"><span class=\"comment\"># the Free Software Foundation; either version 2 of the License, or</span></div><div class=\"line\"><span class=\"comment\"># (at your option) any later version.</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># This program is distributed in the hope that it will be useful,</span></div><div class=\"line\"><span class=\"comment\"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class=\"line\"><span class=\"comment\"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class=\"line\"><span class=\"comment\"># GNU General Public License for more details.</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># You should have received a copy of the GNU General Public License</span></div><div class=\"line\"><span class=\"comment\"># along with this program; if not, write to the Free Software</span></div><div class=\"line\"><span class=\"comment\"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\">################</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># List of parameters passed through environment</span></div><div class=\"line\"><span class=\"comment\">#* reason                       -- why this script was called, one of: pre-init connect disconnect reconnect</span></div><div class=\"line\"><span class=\"comment\">#* VPNGATEWAY                   -- vpn gateway address (always present)</span></div><div class=\"line\"><span class=\"comment\">#* TUNDEV                       -- tunnel device (always present)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_ADDRESS         -- address (always present)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_MTU             -- mtu (often unset)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NETMASK         -- netmask (often unset)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NETMASKLEN      -- netmask length (often unset)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NETADDR         -- address of network (only present if netmask is set)</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_DNS             -- list of dns servers</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP4_NBNS            -- list of wins servers</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP6_ADDRESS         -- IPv6 address</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP6_NETMASK         -- IPv6 netmask</span></div><div class=\"line\"><span class=\"comment\">#* INTERNAL_IP6_DNS             -- IPv6 list of dns servers</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_DEF_DOMAIN             -- default domain name</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_BANNER                 -- banner from server</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC              -- number of networks in split-network-list</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_ADDR      -- network address</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_MASK      -- subnet mask (for example: 255.255.255.0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_MASKLEN   -- subnet masklen (for example: 24)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_PROTOCOL  -- protocol (often just 0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_SPORT     -- source port (often just 0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_SPLIT_INC_%d_DPORT     -- destination port (often just 0)</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_IPV6_SPLIT_INC         -- number of networks in IPv6 split-network-list</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_IPV6_SPLIT_INC_%d_ADDR -- IPv6 network address</span></div><div class=\"line\"><span class=\"comment\">#* CISCO_IPV6_SPLIT_INC_$%d_MASKLEN -- IPv6 subnet masklen</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># FIXMEs:</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Section A: route handling</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 1) The 3 values CISCO_SPLIT_INC_%d_PROTOCOL/SPORT/DPORT are currently being ignored</span></div><div class=\"line\"><span class=\"comment\">#   In order to use them, we'll probably need os specific solutions</span></div><div class=\"line\"><span class=\"comment\">#   * Linux: iptables -t mangle -I PREROUTING &lt;conditions&gt; -j ROUTE --oif $TUNDEV</span></div><div class=\"line\"><span class=\"comment\">#       This would be an *alternative* to changing the routes (and thus 2) and 3)</span></div><div class=\"line\"><span class=\"comment\">#       shouldn't be relevant at all)</span></div><div class=\"line\"><span class=\"comment\"># 2) There are two different functions to set routes: generic routes and the</span></div><div class=\"line\"><span class=\"comment\">#   default route. Why isn't the defaultroute handled via the generic route case?</span></div><div class=\"line\"><span class=\"comment\"># 3) In the split tunnel case, all routes but the default route might get replaced</span></div><div class=\"line\"><span class=\"comment\">#   without getting restored later. We should explicitely check and save them just</span></div><div class=\"line\"><span class=\"comment\">#   like the defaultroute</span></div><div class=\"line\"><span class=\"comment\"># 4) Replies to a dhcp-server should never be sent into the tunnel</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Section B: Split DNS handling</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 1) Maybe dnsmasq can do something like that</span></div><div class=\"line\"><span class=\"comment\"># 2) Parse dns packets going out via tunnel and redirect them to original dns-server</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#env | sort</span></div><div class=\"line\"><span class=\"comment\">#set -x</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== script (variable) setup ====================================</span></div><div class=\"line\"></div><div class=\"line\">PATH=/sbin:/usr/sbin:<span class=\"variable\">$PATH</span></div><div class=\"line\"></div><div class=\"line\">OS=<span class=\"string\">\"`uname -s`\"</span></div><div class=\"line\"></div><div class=\"line\">HOOKS_DIR=/etc/vpnc</div><div class=\"line\">DEFAULT_ROUTE_FILE=/var/run/vpnc/defaultroute</div><div class=\"line\">RESOLV_CONF_BACKUP=/var/run/vpnc/resolv.conf-backup</div><div class=\"line\">SCRIPTNAME=`basename <span class=\"variable\">$0</span>`</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># some systems, eg. Darwin &amp; FreeBSD, prune /var/run on boot</span></div><div class=\"line\"><span class=\"keyword\">if</span> [ ! -d <span class=\"string\">\"/var/run/vpnc\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\tmkdir -p /var/run/vpnc</div><div class=\"line\">\t[ -x /sbin/restorecon ] &amp;&amp; /sbin/restorecon /var/run/vpnc</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># stupid SunOS: no blubber in /usr/local/bin ... (on stdout)</span></div><div class=\"line\">IPROUTE=<span class=\"string\">\"`which ip 2&gt; /dev/null | grep '^/'`\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> ifconfig --<span class=\"built_in\">help</span> 2&gt;&amp;1 | grep BusyBox &gt; /dev/null; <span class=\"keyword\">then</span></div><div class=\"line\">\tifconfig_syntax_inet=<span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">\tifconfig_syntax_inet=<span class=\"string\">\"inet\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"Linux\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\tifconfig_syntax_ptp=<span class=\"string\">\"pointopoint\"</span></div><div class=\"line\">\troute_syntax_gw=<span class=\"string\">\"gw\"</span></div><div class=\"line\">\troute_syntax_del=<span class=\"string\">\"del\"</span></div><div class=\"line\">\troute_syntax_netmask=<span class=\"string\">\"netmask\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">\tifconfig_syntax_ptp=<span class=\"string\">\"\"</span></div><div class=\"line\">\troute_syntax_gw=<span class=\"string\">\"\"</span></div><div class=\"line\">\troute_syntax_del=<span class=\"string\">\"delete\"</span></div><div class=\"line\">\troute_syntax_netmask=<span class=\"string\">\"-netmask\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"SunOS\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\troute_syntax_interface=<span class=\"string\">\"-interface\"</span></div><div class=\"line\">\tifconfig_syntax_ptpv6=<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">\troute_syntax_interface=<span class=\"string\">\"\"</span></div><div class=\"line\">\tifconfig_syntax_ptpv6=<span class=\"string\">\"\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ -r /etc/openwrt_release ] &amp;&amp; [ -n <span class=\"string\">\"<span class=\"variable\">$OPENWRT_INTERFACE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">        . /etc/functions.sh</div><div class=\"line\">\tinclude /lib/network</div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_openwrt</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_openwrt</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /usr/bin/busctl ]; <span class=\"keyword\">then</span>  <span class=\"comment\"># For systemd-resolved (version 229 and above)</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolved_manager</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolved_manager</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /sbin/resolvconf ]; <span class=\"keyword\">then</span> <span class=\"comment\"># Optional tool on Debian, Ubuntu, Gentoo and FreeBSD</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_manager</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_manager</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /sbin/netconfig ]; <span class=\"keyword\">then</span> <span class=\"comment\"># tool on Suse after 11.1</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_suse_netconfig</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_suse_netconfig</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /sbin/modify_resolvconf ]; <span class=\"keyword\">then</span> <span class=\"comment\"># Mandatory tool on Suse earlier than 11.1</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_suse</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_suse</div><div class=\"line\"><span class=\"keyword\">elif</span> [ -x /usr/sbin/unbound-control ] &amp;&amp; /usr/sbin/unbound-control status &gt; /dev/null 2&gt;&amp;1; <span class=\"keyword\">then</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_unbound</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_unbound</div><div class=\"line\"><span class=\"keyword\">else</span> <span class=\"comment\"># Generic for any OS</span></div><div class=\"line\">\tMODIFYRESOLVCONF=modify_resolvconf_generic</div><div class=\"line\">\tRESTORERESOLVCONF=restore_resolvconf_generic</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== script hooks =================================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">run_hooks</span></span>() &#123;</div><div class=\"line\">\tHOOK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -d <span class=\"variable\">$&#123;HOOKS_DIR&#125;</span>/<span class=\"variable\">$&#123;HOOK&#125;</span>.d ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t    <span class=\"keyword\">for</span> script <span class=\"keyword\">in</span> <span class=\"variable\">$&#123;HOOKS_DIR&#125;</span>/<span class=\"variable\">$&#123;HOOK&#125;</span>.d/* ; <span class=\"keyword\">do</span></div><div class=\"line\">\t\t[ -f <span class=\"variable\">$script</span> ] &amp;&amp; . <span class=\"variable\">$script</span></div><div class=\"line\">\t    <span class=\"keyword\">done</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== tunnel interface handling ====================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">do_ifconfig</span></span>() &#123;</div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_MTU</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tMTU=<span class=\"variable\">$INTERNAL_IP4_MTU</span></div><div class=\"line\">\t<span class=\"keyword\">elif</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tMTUDEV=`<span class=\"variable\">$IPROUTE</span> route get <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> | sed -ne <span class=\"string\">'s/^.*dev \\([a-z0-9]*\\).*$/\\1/p'</span>`</div><div class=\"line\">\t\tMTU=`<span class=\"variable\">$IPROUTE</span> link show <span class=\"string\">\"<span class=\"variable\">$MTUDEV</span>\"</span> | sed -ne <span class=\"string\">'s/^.*mtu \\([[:digit:]]\\+\\).*$/\\1/p'</span>`</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$MTU</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\tMTU=`expr <span class=\"variable\">$MTU</span> - 88`</div><div class=\"line\">\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -z <span class=\"string\">\"<span class=\"variable\">$MTU</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tMTU=1412</div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># Point to point interface require a netmask of 255.255.255.255 on some systems</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> link <span class=\"built_in\">set</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> up mtu <span class=\"string\">\"<span class=\"variable\">$MTU</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> addr add <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>/32\"</span> peer <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">else</span></div><div class=\"line\">\t\tifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> <span class=\"variable\">$&#123;ifconfig_syntax_inet&#125;</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> <span class=\"variable\">$ifconfig_syntax_ptp</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> netmask 255.255.255.255 mtu <span class=\"variable\">$&#123;MTU&#125;</span> up</div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_NETMASK</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tset_network_route <span class=\"variable\">$INTERNAL_IP4_NETADDR</span> <span class=\"variable\">$INTERNAL_IP4_NETMASK</span> <span class=\"variable\">$INTERNAL_IP4_NETMASKLEN</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\"># If the netmask is provided, it contains the address _and_ netmask</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span> ] &amp;&amp; [ -z <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_NETMASK</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t    INTERNAL_IP6_NETMASK=<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>/128\"</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_NETMASK</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t    <span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 addr add <span class=\"variable\">$INTERNAL_IP6_NETMASK</span> dev <span class=\"variable\">$TUNDEV</span></div><div class=\"line\">\t    <span class=\"keyword\">else</span></div><div class=\"line\">\t\t<span class=\"comment\"># Unlike for Legacy IP, we don't specify the dest_address</span></div><div class=\"line\">\t\t<span class=\"comment\"># here on *BSD. OpenBSD for one will refuse to accept</span></div><div class=\"line\">\t\t<span class=\"comment\"># incoming packets to that address if we do.</span></div><div class=\"line\">\t\t<span class=\"comment\"># OpenVPN does the same (gives dest_address for Legacy IP</span></div><div class=\"line\">\t\t<span class=\"comment\"># but not for IPv6).</span></div><div class=\"line\">\t\t<span class=\"comment\"># Only Solaris needs it; hence $ifconfig_syntax_ptpv6</span></div><div class=\"line\">\t        ifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> inet6 <span class=\"variable\">$INTERNAL_IP6_NETMASK</span> <span class=\"variable\">$ifconfig_syntax_ptpv6</span> mtu <span class=\"variable\">$MTU</span> up</div><div class=\"line\">\t    <span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">destroy_tun_device</span></span>() &#123;</div><div class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\tNetBSD|OpenBSD) <span class=\"comment\"># and probably others...</span></div><div class=\"line\">\t\tifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> destroy</div><div class=\"line\">\t\t;;</div><div class=\"line\">\tFreeBSD)</div><div class=\"line\">\t\tifconfig <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> destroy &gt; /dev/null 2&gt;&amp;1 &amp;</div><div class=\"line\">\t\t;;</div><div class=\"line\">\t<span class=\"keyword\">esac</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== route handling ====================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$IPROUTE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">fix_ip_get_output</span></span> () &#123;</div><div class=\"line\">\t\tsed -e <span class=\"string\">'s/ /\\n/g'</span> | \\</div><div class=\"line\">\t\t    sed -ne <span class=\"string\">'1p;/via/&#123;N;p&#125;;/dev/&#123;N;p&#125;;/src/&#123;N;p&#125;;/mtu/&#123;N;p&#125;'</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route add `<span class=\"variable\">$IPROUTE</span> route get <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> | fix_ip_get_output`</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route <span class=\"variable\">$route_syntax_del</span> <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route | grep <span class=\"string\">'^default'</span> | fix_ip_get_output &gt; <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route replace default dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route replace <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> [ -s <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t<span class=\"variable\">$IPROUTE</span> route replace `cat <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span>`</div><div class=\"line\">\t\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t\t\trm -f -- <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route <span class=\"variable\">$route_syntax_del</span> <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"comment\"># We don't save/restore IPv6 default route; just add a higher-priority one.</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route add default dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> metric 1</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route replace <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route del default dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route del <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASKLEN</span>\"</span> dev <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">\t\t<span class=\"variable\">$IPROUTE</span> -6 route flush cache</div><div class=\"line\">\t&#125;</div><div class=\"line\"><span class=\"keyword\">else</span> <span class=\"comment\"># use route command</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">get_default_gw</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"comment\"># isn't -n supposed to give --numeric output?</span></div><div class=\"line\">\t\t<span class=\"comment\"># apperently not...</span></div><div class=\"line\">\t\t<span class=\"comment\"># Get rid of lines containing IPv6 addresses (':')</span></div><div class=\"line\">\t\tnetstat -r -n | awk <span class=\"string\">'/:/ &#123; next; &#125; /^(default|0\\.0\\.0\\.0)/ &#123; print $2; &#125;'</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\troute add -host <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"`get_default_gw`\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_vpngateway_route</span></span>() &#123;</div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -host <span class=\"string\">\"<span class=\"variable\">$VPNGATEWAY</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"`get_default_gw`\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_default_route</span></span>() &#123;</div><div class=\"line\">\t\tDEFAULTGW=<span class=\"string\">\"`get_default_gw`\"</span></div><div class=\"line\">\t\t<span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$DEFAULTGW</span>\"</span> &gt; <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> default <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$DEFAULTGW</span>\"</span></div><div class=\"line\">\t\troute add default <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\tdel_network_route <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$NETMASKLEN</span>\"</span></div><div class=\"line\">\t\troute add -net <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>\"</span> <span class=\"variable\">$route_syntax_netmask</span> <span class=\"string\">\"<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_default_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> [ -s <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\troute <span class=\"variable\">$route_syntax_del</span> default <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"`get_default_gw`\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t\t\troute add default <span class=\"variable\">$route_syntax_gw</span> `cat <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span>`</div><div class=\"line\">\t\t\trm -f -- <span class=\"string\">\"<span class=\"variable\">$DEFAULT_ROUTE_FILE</span>\"</span></div><div class=\"line\">\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_network_route</span></span>() &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\tLinux|NetBSD|OpenBSD|Darwin|SunOS) <span class=\"comment\"># and probably others...</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># routes are deleted automatically on device shutdown</span></div><div class=\"line\">\t\t\t<span class=\"built_in\">return</span></div><div class=\"line\">\t\t\t;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\tNETMASKLEN=<span class=\"string\">\"<span class=\"variable\">$3</span>\"</span></div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -net <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>\"</span> <span class=\"variable\">$route_syntax_netmask</span> <span class=\"string\">\"<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"variable\">$route_syntax_gw</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\troute add -inet6 default <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">set_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\troute add -inet6 -net <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span> <span class=\"variable\">$route_syntax_interface</span></div><div class=\"line\">\t\t:</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">reset_ipv6_default_route</span></span>() &#123;</div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -inet6 default <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span></div><div class=\"line\">\t\t:</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"title\">del_ipv6_network_route</span></span>() &#123;</div><div class=\"line\">\t\tNETWORK=<span class=\"string\">\"<span class=\"variable\">$1</span>\"</span></div><div class=\"line\">\t\tNETMASK=<span class=\"string\">\"<span class=\"variable\">$2</span>\"</span></div><div class=\"line\">\t\troute <span class=\"variable\">$route_syntax_del</span> -inet6 <span class=\"string\">\"<span class=\"variable\">$NETWORK</span>/<span class=\"variable\">$NETMASK</span>\"</span> <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>\"</span></div><div class=\"line\">\t\t:</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== resolv.conf handling ====================================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># =========== resolv.conf handling for any OS =========================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">modify_resolvconf_generic</span></span>() &#123;</div><div class=\"line\">\tgrep <span class=\"string\">'^#@VPNC_GENERATED@'</span> /etc/resolv.conf &gt; /dev/null 2&gt;&amp;1 || cp -- /etc/resolv.conf <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span></div><div class=\"line\">\tNEW_RESOLVCONF=<span class=\"string\">\"#@VPNC_GENERATED@ -- this file is generated by vpnc</span></div><div class=\"line\"><span class=\"string\"># and will be overwritten by vpnc</span></div><div class=\"line\"><span class=\"string\"># as long as the above mark is intact\"</span></div><div class=\"line\"></div><div class=\"line\">\tDOMAINS=<span class=\"string\">\"<span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"built_in\">exec</span> 6&lt; <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">while</span> <span class=\"built_in\">read</span> LINE &lt;&amp;6 ; <span class=\"keyword\">do</span></div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$LINE</span>\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># omit; we will overwrite these</span></div><div class=\"line\">\t\t\tnameserver*) ;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># extract listed domains and prepend to list</span></div><div class=\"line\">\t\t\tdomain* | search*) DOMAINS=<span class=\"string\">\"<span class=\"variable\">$&#123;LINE#* &#125;</span> <span class=\"variable\">$DOMAINS</span>\"</span> ;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># retain other lines</span></div><div class=\"line\">\t\t\t*) NEW_RESOLVCONF=<span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\"><span class=\"variable\">$LINE</span>\"</span> ;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t<span class=\"keyword\">done</span></div><div class=\"line\">\t<span class=\"built_in\">exec</span> 6&lt;&amp;-</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; <span class=\"keyword\">do</span></div><div class=\"line\">\t\tNEW_RESOLVCONF=<span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">nameserver <span class=\"variable\">$i</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">done</span></div><div class=\"line\">\t<span class=\"comment\"># note that \"search\" is mutually exclusive with \"domain\";</span></div><div class=\"line\">\t<span class=\"comment\"># \"search\" allows multiple domains to be listed, so use that</span></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$DOMAINS</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\tNEW_RESOLVCONF=<span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">search <span class=\"variable\">$DOMAINS</span>\"</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t<span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$NEW_RESOLVCONF</span>\"</span> &gt; /etc/resolv.conf</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"Darwin\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"`uname -r`\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># Skip for pre-10.4 systems</span></div><div class=\"line\">\t\t\t4.*|5.*|6.*|7.*)</div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># 10.4 and later require use of scutil for DNS to work properly</span></div><div class=\"line\">\t\t\t*)</div><div class=\"line\">\t\t\t\tOVERRIDE_PRIMARY=<span class=\"string\">\"\"</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$CISCO_SPLIT_INC</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> [ <span class=\"variable\">$CISCO_SPLIT_INC</span> -lt 1 ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"comment\"># Must override for correct default route</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"comment\"># Cannot use multiple DNS matching in this case</span></div><div class=\"line\">\t\t\t\t\t\tOVERRIDE_PRIMARY=<span class=\"string\">'d.add OverridePrimary # 1'</span></div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># Overriding the default gateway breaks split routing</span></div><div class=\"line\">\t\t\t\t\tOVERRIDE_GATEWAY=<span class=\"string\">\"\"</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># Not overriding the default gateway breaks usage of</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># INTERNAL_IP4_DNS. Prepend INTERNAL_IP4_DNS to list</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># of used DNS servers</span></div><div class=\"line\">\t\t\t\t\tSERVICE=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Global/IPv4\"</span> | scutil | grep -oE <span class=\"string\">'[a-fA-F0-9]&#123;8&#125;-([a-fA-F0-9]&#123;4&#125;-)&#123;3&#125;[a-fA-F0-9]&#123;12&#125;'</span>`</div><div class=\"line\">\t\t\t\t\tSERVICE_DNS=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS\"</span> | scutil | grep -oE <span class=\"string\">'([0-9]&#123;1,3&#125;[\\.])&#123;3&#125;[0-9]&#123;1,3&#125;'</span> | xargs`</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> [ X<span class=\"string\">\"<span class=\"variable\">$SERVICE_DNS</span>\"</span> != X<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\t\t\tget State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\td.add ServerAddresses * <span class=\"variable\">$INTERNAL_IP4_DNS</span> <span class=\"variable\">$SERVICE_DNS</span></div><div class=\"line\">\t\t\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">else</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># No split routing. Override default gateway</span></div><div class=\"line\">\t\t\t\t\tOVERRIDE_GATEWAY=<span class=\"string\">\"d.add Router <span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>\"</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># Uncomment the following if/fi pair to use multiple</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># DNS matching when available.  When multiple DNS matching</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># is present, anything reading the /etc/resolv.conf file</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># directly will probably not work as intended.</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\">#if [ -z \"$CISCO_DEF_DOMAIN\" ]; then</span></div><div class=\"line\">\t\t\t\t\t<span class=\"comment\"># Cannot use multiple DNS matching without a domain</span></div><div class=\"line\">\t\t\t\t\tOVERRIDE_PRIMARY=<span class=\"string\">'d.add OverridePrimary # 1'</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\">#fi</span></div><div class=\"line\">\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\td.init</div><div class=\"line\">\t\t\t\t\td.add ServerAddresses * <span class=\"variable\">$INTERNAL_IP4_DNS</span></div><div class=\"line\">\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\td.init</div><div class=\"line\">\t\t\t\t\t<span class=\"variable\">$OVERRIDE_GATEWAY</span></div><div class=\"line\">\t\t\t\t\td.add Addresses * <span class=\"variable\">$INTERNAL_IP4_ADDRESS</span></div><div class=\"line\">\t\t\t\t\td.add SubnetMasks * 255.255.255.255</div><div class=\"line\">\t\t\t\t\td.add InterfaceName <span class=\"variable\">$TUNDEV</span></div><div class=\"line\">\t\t\t\t\t<span class=\"variable\">$OVERRIDE_PRIMARY</span></div><div class=\"line\">\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/IPv4</div><div class=\"line\">\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\t\tget State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\t\td.add DomainName <span class=\"variable\">$CISCO_DEF_DOMAIN</span></div><div class=\"line\">\t\t\t\t\t\td.add SearchDomains * <span class=\"variable\">$CISCO_DEF_DOMAIN</span></div><div class=\"line\">\t\t\t\t\t\td.add SupplementalMatchDomains * <span class=\"variable\">$CISCO_DEF_DOMAIN</span></div><div class=\"line\">\t\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">restore_resolvconf_generic</span></span>() &#123;</div><div class=\"line\">\t<span class=\"keyword\">if</span> [ ! -f <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"built_in\">return</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">\tgrep <span class=\"string\">'^#@VPNC_GENERATED@'</span> /etc/resolv.conf &gt; /dev/null 2&gt;&amp;1 &amp;&amp; cat <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span> &gt; /etc/resolv.conf</div><div class=\"line\">\trm -f -- <span class=\"string\">\"<span class=\"variable\">$RESOLV_CONF_BACKUP</span>\"</span></div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$OS</span>\"</span> = <span class=\"string\">\"Darwin\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"string\">\"`uname -r`\"</span> <span class=\"keyword\">in</span></div><div class=\"line\">\t\t\t<span class=\"comment\"># Skip for pre-10.4 systems</span></div><div class=\"line\">\t\t\t4.*|5.*|6.*|7.*)</div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t\t<span class=\"comment\"># 10.4 and later require use of scutil for DNS to work properly</span></div><div class=\"line\">\t\t\t*)</div><div class=\"line\">\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\tremove State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/IPv4</div><div class=\"line\">\t\t\t\t\tremove State:/Network/Service/<span class=\"variable\">$TUNDEV</span>/DNS</div><div class=\"line\">\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t<span class=\"comment\"># Split routing required prepending of INTERNAL_IP4_DNS</span></div><div class=\"line\">\t\t\t\t<span class=\"comment\"># to list of used DNS servers</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$CISCO_SPLIT_INC</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\tSERVICE=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Global/IPv4\"</span> | scutil | grep -oE <span class=\"string\">'[a-fA-F0-9]&#123;8&#125;-([a-fA-F0-9]&#123;4&#125;-)&#123;3&#125;[a-fA-F0-9]&#123;12&#125;'</span>`</div><div class=\"line\">\t\t\t\t\tSERVICE_DNS=`<span class=\"built_in\">echo</span> <span class=\"string\">\"show State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS\"</span> | scutil | grep -oE <span class=\"string\">'([0-9]&#123;1,3&#125;[\\.])&#123;3&#125;[0-9]&#123;1,3&#125;'</span> | xargs`</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> [ X<span class=\"string\">\"<span class=\"variable\">$SERVICE_DNS</span>\"</span> != X<span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">\t\t\t\t\t\tscutil &gt;/dev/null 2&gt;&amp;1 &lt;&lt;-EOF</div><div class=\"line\">\t\t\t\t\t\t\topen</div><div class=\"line\">\t\t\t\t\t\t\tget State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\td.add ServerAddresses * <span class=\"variable\">$&#123;SERVICE_DNS##$INTERNAL_IP4_DNS&#125;</span></div><div class=\"line\">\t\t\t\t\t\t\t<span class=\"built_in\">set</span> State:/Network/Service/<span class=\"variable\">$SERVICE</span>/DNS</div><div class=\"line\">\t\t\t\t\t\t\tclose</div><div class=\"line\">\t\t\t\t\t\tEOF</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">fi</span></div><div class=\"line\">\t\t\t\t;;</div><div class=\"line\">\t\t<span class=\"keyword\">esac</span></div><div class=\"line\">\t<span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\"># === resolv.conf handling via /sbin/netconfig (Suse 11.1) =====================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Suse provides a script that modifies resolv.conf. Use it because it will</span></div><div class=\"line\"><span class=\"comment\"># restart/reload all other services that care about it (e.g. lwresd).  [unclear if this is still true, but probably --mlk]</span></div><div class=\"line\"></div><div class=\"line\">modify_resolvconf_suse_netconfig()</div><div class=\"line\">&#123;</div><div class=\"line\">\t/sbin/netconfig modify -s vpnc -i <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span> &lt;&lt;-EOF</div><div class=\"line\">\t\tINTERFACE=<span class=\"string\">'$TUNDEV'</span></div><div class=\"line\">\t\tDNSSERVERS=<span class=\"string\">'$INTERNAL_IP4_DNS'</span></div><div class=\"line\">\t\tDNSDOMAIN=<span class=\"string\">'$CISCO_DEF_DOMAIN'</span></div><div class=\"line\">\t\tEOF</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\"># Restore resolv.conf to old contents on Suse</span></div><div class=\"line\">restore_resolvconf_suse_netconfig()</div><div class=\"line\">&#123;</div><div class=\"line\">\t/sbin/netconfig remove -s vpnc -i <span class=\"string\">\"<span class=\"variable\">$TUNDEV</span>\"</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># === resolv.conf handling via /sbin/modify_resolvconf (Suse) =====================</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Suse provides a script that modifies resolv.conf. Use it because it will</span></div><div class=\"line\"><span class=\"comment\"># restart/reload all other services that care about it (e.g. lwresd).</span></div><div class=\"line\"></div><div class=\"line\">modify_resolvconf_suse()</div><div class=\"line\">&#123;</div><div class=\"line\">\tFULL_SCRIPTNAME=`readlink -f <span class=\"variable\">$0</span>`</div><div class=\"line\">\tRESOLV_OPTS=<span class=\"string\">''</span></div><div class=\"line\">\t<span class=\"built_in\">test</span> -n <span class=\"string\">\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\"</span> &amp;&amp; RESOLV_OPTS=<span class=\"string\">\"-n \\\"<span class=\"variable\">$INTERNAL_IP4_DNS</span>\\\"\"</span></div><div class=\"line\">\t<span class=\"built_in\">test</span> -n <span class=\"string\">\"<span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span> &amp;&amp; RESOLV_OPTS=<span class=\"string\">\"<span class=\"variable\">$RESOLV_OPTS</span> -d <span class=\"variable\">$CISCO_DEF_DOMAIN</span>\"</span></div><div class=\"line\">\t<span class=\"built_in\">test</span> -n <span class=\"string\">\"<span class=\"variable\">$RESOLV_OPTS</span>\"</span> &amp;&amp; <span class=\"built_in\">eval</span> /sbin/modify_resolvconf modify -s vpnc -p <span class=\"variable\">$SCRIPTNAME</span> -f <span class=\"variable\">$FULL_SCRIPTNAME</span> -e <span class=\"variable\">$TUNDEV</span> <span class=\"variable\">$RESOLV_OPTS</span> -t \\<span class=\"string\">\"This file was created by <span class=\"variable\">$SCRIPTNAME</span>\\\"</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># Restore resolv.conf to old contents on Suse</span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_suse()</span></div><div class=\"line\"><span class=\"string\">&#123;</span></div><div class=\"line\"><span class=\"string\">\tFULL_SCRIPTNAME=`readlink -f <span class=\"variable\">$0</span>`</span></div><div class=\"line\"><span class=\"string\">\t/sbin/modify_resolvconf restore -s vpnc -p <span class=\"variable\">$SCRIPTNAME</span> -f <span class=\"variable\">$FULL_SCRIPTNAME</span> -e <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># === resolv.conf handling via UCI (OpenWRT) =========</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolvconf_openwrt() &#123;</span></div><div class=\"line\"><span class=\"string\">\tadd_dns <span class=\"variable\">$OPENWRT_INTERFACE</span> <span class=\"variable\">$INTERNAL_IP4_DNS</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_openwrt() &#123;</span></div><div class=\"line\"><span class=\"string\">\tremove_dns <span class=\"variable\">$OPENWRT_INTERFACE</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"># === resolv.conf handling via /sbin/resolvconf (Debian, Ubuntu, Gentoo)) =========</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolvconf_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\tNEW_RESOLVCONF=\"</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span>; do</span></div><div class=\"line\"><span class=\"string\">\t\tNEW_RESOLVCONF=\"</span><span class=\"variable\">$NEW_RESOLVCONF</span></div><div class=\"line\">nameserver <span class=\"variable\">$i</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tdone</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tNEW_RESOLVCONF=\"</span><span class=\"variable\">$NEW_RESOLVCONF</span></div><div class=\"line\">domain <span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">\techo \"</span><span class=\"variable\">$NEW_RESOLVCONF</span><span class=\"string\">\" | /sbin/resolvconf -a <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\t/sbin/resolvconf -d <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">AF_INET=2</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">get_if_index() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal link</span></div><div class=\"line\"><span class=\"string\">\tlink=\"</span>$(ip link show dev <span class=\"string\">\"<span class=\"variable\">$1</span>\"</span>)<span class=\"string\">\" || return $?</span></div><div class=\"line\"><span class=\"string\">\techo <span class=\"variable\">$&#123;link&#125;</span> | awk -F: '&#123;print <span class=\"variable\">$1</span>&#125;'</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">busctl_call() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal dest node</span></div><div class=\"line\"><span class=\"string\">\tdest=org.freedesktop.resolve1</span></div><div class=\"line\"><span class=\"string\">\tnode=/org/freedesktop/resolve1</span></div><div class=\"line\"><span class=\"string\">\tbusctl call \"</span><span class=\"variable\">$dest</span><span class=\"string\">\" \"</span><span class=\"variable\">$&#123;node&#125;</span><span class=\"string\">\" \"</span><span class=\"variable\">$&#123;dest&#125;</span>.Manager<span class=\"string\">\" \"</span><span class=\"variable\">$@</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">busctl_set_nameservers() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index addresses args addr</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$1</span></span></div><div class=\"line\"><span class=\"string\">\tshift</span></div><div class=\"line\"><span class=\"string\">\taddresses=\"</span><span class=\"variable\">$@</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\targs=\"</span><span class=\"variable\">$if_index</span> <span class=\"variable\">$#</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfor addr in <span class=\"variable\">$&#123;addresses&#125;</span>; do</span></div><div class=\"line\"><span class=\"string\">\t\targs=\"</span><span class=\"variable\">$args</span> <span class=\"variable\">$&#123;AF_INET&#125;</span> 4 $(<span class=\"built_in\">echo</span> <span class=\"variable\">$addr</span> | sed <span class=\"string\">'s/[.]/ /g'</span>)<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tdone</span></div><div class=\"line\"><span class=\"string\">\tbusctl_call SetLinkDNS 'ia(iay)' <span class=\"variable\">$&#123;args&#125;</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">busctl_set_search() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index domains args domain</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$1</span></span></div><div class=\"line\"><span class=\"string\">\tshift</span></div><div class=\"line\"><span class=\"string\">\tdomains=\"</span><span class=\"variable\">$@</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\targs=\"</span><span class=\"variable\">$if_index</span> <span class=\"variable\">$#</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tfor domain in <span class=\"variable\">$&#123;domains&#125;</span>; do</span></div><div class=\"line\"><span class=\"string\">\t\targs=\"</span><span class=\"variable\">$args</span> <span class=\"variable\">$&#123;domain&#125;</span> <span class=\"literal\">false</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\tdone</span></div><div class=\"line\"><span class=\"string\">\tbusctl_call SetLinkDomains 'ia(sb)' <span class=\"variable\">$&#123;args&#125;</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolved_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$(get_if_index $TUNDEV)</span></span></div><div class=\"line\"><span class=\"string\">\tbusctl_set_nameservers <span class=\"variable\">$if_index</span> <span class=\"variable\">$INTERNAL_IP4_DNS</span></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tbusctl_set_search <span class=\"variable\">$if_index</span> <span class=\"variable\">$CISCO_DEF_DOMAIN</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolved_manager() &#123;</span></div><div class=\"line\"><span class=\"string\">\tlocal if_index</span></div><div class=\"line\"><span class=\"string\">\tif_index=<span class=\"variable\">$(get_if_index $TUNDEV)</span></span></div><div class=\"line\"><span class=\"string\">\tbusctl_call RevertLink 'i' <span class=\"variable\">$if_index</span></span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># === resolv.conf handling via unbound =========</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">modify_resolvconf_unbound() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control forward_add +i <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span> <span class=\"variable\">$&#123;INTERNAL_IP4_DNS&#125;</span></span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_requestlist</span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_zone <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">restore_resolvconf_unbound() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_DEF_DOMAIN</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control forward_remove +i <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span></span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_zone <span class=\"variable\">$&#123;CISCO_DEF_DOMAIN&#125;</span></span></div><div class=\"line\"><span class=\"string\">\t\t/usr/sbin/unbound-control flush_requestlist</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"># ========= Toplevel state handling  =======================================</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">kernel_is_2_6_or_above() &#123;</span></div><div class=\"line\"><span class=\"string\">\tcase `uname -r` in</span></div><div class=\"line\"><span class=\"string\">\t\t1.*|2.[012345]*)</span></div><div class=\"line\"><span class=\"string\">\t\t\treturn 1</span></div><div class=\"line\"><span class=\"string\">\t\t\t;;</span></div><div class=\"line\"><span class=\"string\">\t\t*)</span></div><div class=\"line\"><span class=\"string\">\t\t\treturn 0</span></div><div class=\"line\"><span class=\"string\">\t\t\t;;</span></div><div class=\"line\"><span class=\"string\">\tesac</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">do_pre_init() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>Linux<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif (exec 6&lt; /dev/net/tun) &gt; /dev/null 2&gt;&amp;1 ; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t:</span></div><div class=\"line\"><span class=\"string\">\t\telse # can't open /dev/net/tun</span></div><div class=\"line\"><span class=\"string\">\t\t\ttest -e /proc/sys/kernel/modprobe &amp;&amp; `cat /proc/sys/kernel/modprobe` tun 2&gt;/dev/null</span></div><div class=\"line\"><span class=\"string\">\t\t\t# fix for broken devfs in kernel 2.6.x</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ \"</span>`readlink /dev/net/tun`<span class=\"string\">\" = misc/net/tun \\</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t-a ! -e /dev/net/misc/net/tun -a -e /dev/misc/net/tun ] ; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tln -sf /dev/misc/net/tun /dev/net/tun</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\t# make sure tun device exists</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ ! -e /dev/net/tun ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tmkdir -p /dev/net</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tmknod -m 0640 /dev/net/tun c 10 200</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t[ -x /sbin/restorecon ] &amp;&amp; /sbin/restorecon /dev/net/tun</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\t# workaround for a possible latency caused by udev, sleep max. 10s</span></div><div class=\"line\"><span class=\"string\">\t\t\tif kernel_is_2_6_or_above ; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tfor x in `seq 100` ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t\t(exec 6&lt;&gt; /dev/net/tun) &gt; /dev/null 2&gt;&amp;1 &amp;&amp; break;</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t\tsleep 0.1</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>FreeBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif ! kldstat -q -m if_tun &gt; /dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tkldload if_tun</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\t\tif ! ifconfig <span class=\"variable\">$TUNDEV</span> &gt; /dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig <span class=\"variable\">$TUNDEV</span> create</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>GNU/kFreeBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif [ ! -e /dev/tun ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tkldload if_tun</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>NetBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>OpenBSD<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif ! ifconfig <span class=\"variable\">$TUNDEV</span> &gt; /dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig <span class=\"variable\">$TUNDEV</span> create</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>SunOS<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\telif [ \"</span><span class=\"variable\">$OS</span><span class=\"string\">\" = \"</span>Darwin<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t:</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">do_connect() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_BANNER</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\techo \"</span>Connect Banner:<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\techo \"</span><span class=\"variable\">$CISCO_BANNER</span><span class=\"string\">\" | while read LINE ; do echo \"</span>|<span class=\"string\">\" \"</span><span class=\"variable\">$LINE</span><span class=\"string\">\" ; done</span></div><div class=\"line\"><span class=\"string\">\t\techo</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tset_vpngateway_route</span></div><div class=\"line\"><span class=\"string\">\tdo_ifconfig</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASK&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" != \"</span>0.0.0.0<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\techo \"</span><span class=\"variable\">$i</span><span class=\"string\">\" | grep : &gt;/dev/null || \\</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>255.255.255.255<span class=\"string\">\" \"</span>32<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tset_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ <span class=\"variable\">$NETMASKLEN</span> -lt 128 ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_ipv6_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\tif echo \"</span><span class=\"variable\">$i</span><span class=\"string\">\" | grep : &gt;/dev/null; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tset_ipv6_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" -o -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_DNS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t<span class=\"variable\">$MODIFYRESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">do_disconnect() &#123;</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASK=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASK&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" != \"</span>0.0.0.0<span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t# FIXME: This doesn't restore previously overwritten</span></div><div class=\"line\"><span class=\"string\">\t\t\t\t#        routes.</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tdel_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\treset_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP4_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\tdel_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>255.255.255.255<span class=\"string\">\" \"</span>32<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telse</span></div><div class=\"line\"><span class=\"string\">\t\treset_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\ti=0</span></div><div class=\"line\"><span class=\"string\">\t\twhile [ <span class=\"variable\">$i</span> -lt <span class=\"variable\">$CISCO_IPV6_SPLIT_INC</span> ] ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETWORK=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_ADDR&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\teval NETMASKLEN=\"</span>\\<span class=\"variable\">$&#123;CISCO_IPV6_SPLIT_INC_$&#123;i&#125;</span>_MASKLEN&#125;<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tif [ <span class=\"variable\">$NETMASKLEN</span> -eq 0 ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t\treset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\t\t\telse</span></div><div class=\"line\"><span class=\"string\">\t\t\t\tdel_ipv6_network_route \"</span><span class=\"variable\">$NETWORK</span><span class=\"string\">\" \"</span><span class=\"variable\">$NETMASKLEN</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t\ti=`expr <span class=\"variable\">$i</span> + 1`</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\t\tfor i in <span class=\"variable\">$INTERNAL_IP6_DNS</span> ; do</span></div><div class=\"line\"><span class=\"string\">\t\t\tdel_ipv6_network_route \"</span><span class=\"variable\">$i</span><span class=\"string\">\" \"</span>128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tdone</span></div><div class=\"line\"><span class=\"string\">\telif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" -o -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\treset_ipv6_default_route</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tdel_vpngateway_route</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_DNS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t<span class=\"variable\">$RESTORERESOLVCONF</span></span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tif [ -n \"</span><span class=\"variable\">$IPROUTE</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t<span class=\"variable\">$IPROUTE</span> addr del \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span>/255.255.255.255<span class=\"string\">\" peer \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" dev \"</span><span class=\"variable\">$TUNDEV</span><span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\t# If the netmask is provided, it contains the address _and_ netmask</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ] &amp;&amp; [ -z \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tINTERNAL_IP6_NETMASK=\"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>/128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\t<span class=\"variable\">$IPROUTE</span> -6 addr del <span class=\"variable\">$INTERNAL_IP6_NETMASK</span> dev <span class=\"variable\">$TUNDEV</span></span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\telse</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP4_ADDRESS</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig \"</span><span class=\"variable\">$TUNDEV</span><span class=\"string\">\" 0.0.0.0</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span><span class=\"string\">\" ] &amp;&amp; [ -z \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tINTERNAL_IP6_NETMASK=\"</span><span class=\"variable\">$INTERNAL_IP6_ADDRESS</span>/128<span class=\"string\">\"</span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\t\tif [ -n \"</span><span class=\"variable\">$INTERNAL_IP6_NETMASK</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\t\t\tifconfig \"</span><span class=\"variable\">$TUNDEV</span><span class=\"string\">\" inet6 del <span class=\"variable\">$INTERNAL_IP6_NETMASK</span></span></div><div class=\"line\"><span class=\"string\">\t\tfi</span></div><div class=\"line\"><span class=\"string\">\tfi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">\tdestroy_tun_device</span></div><div class=\"line\"><span class=\"string\">&#125;</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">#### Main</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">if [ -z \"</span><span class=\"variable\">$reason</span><span class=\"string\">\" ]; then</span></div><div class=\"line\"><span class=\"string\">\techo \"</span>this script must be called from vpnc<span class=\"string\">\" 1&gt;&amp;2</span></div><div class=\"line\"><span class=\"string\">\texit 1</span></div><div class=\"line\"><span class=\"string\">fi</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">case \"</span><span class=\"variable\">$reason</span><span class=\"string\">\" in</span></div><div class=\"line\"><span class=\"string\">\tpre-init)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks pre-init</span></div><div class=\"line\"><span class=\"string\">\t\tdo_pre_init</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\tconnect)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks connect</span></div><div class=\"line\"><span class=\"string\">\t\tdo_connect</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks post-connect</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\tdisconnect)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks disconnect</span></div><div class=\"line\"><span class=\"string\">\t\tdo_disconnect</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks post-disconnect</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\treconnect)</span></div><div class=\"line\"><span class=\"string\">\t\trun_hooks reconnect</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">\t*)</span></div><div class=\"line\"><span class=\"string\">\t\techo \"</span>unknown reason <span class=\"string\">'$reason'</span>. Maybe vpnc-script is out of date<span class=\"string\">\" 1&gt;&amp;2</span></div><div class=\"line\"><span class=\"string\">\t\texit 1</span></div><div class=\"line\"><span class=\"string\">\t\t;;</span></div><div class=\"line\"><span class=\"string\">esac</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">exit 0</span></div></pre></td></tr></table></figure></p>"},{"title":"linux SSH内网穿透","date":"2017-10-09T09:06:47.000Z","_content":"\nlinux SSH内网穿透\n\n<!-- more -->\n\n# 简单使用\n\n## 1.内网设置:\n\n```\nssh -qnfNT -g -R 3322:localhost:22 myname@vpshost\n```\n\n这会在vpshost上面开一个端口3322,和内网的22端口建立一个ssh隧道,在vpshost上,通过以下命令即可连接到内网\n```\nssh -p 3322 localhost\n```\n\n## 2. vpshost设置\n\n编辑/etc/ssh/sshd_config文件\n在文件的最后加入\n> gatewayports yes \n\n重启ssh服务\n```\nservice ssh restart\n```\n\n这时即可在第三方机器连接到内网中\n```\nssh myname@vpshost:3322\n```","source":"_posts/201710091706.md","raw":"---\ntitle: linux SSH内网穿透\ndate: 2017-10-09 17:06:47\ntags:\n  - linux\n  - network\n---\n\nlinux SSH内网穿透\n\n<!-- more -->\n\n# 简单使用\n\n## 1.内网设置:\n\n```\nssh -qnfNT -g -R 3322:localhost:22 myname@vpshost\n```\n\n这会在vpshost上面开一个端口3322,和内网的22端口建立一个ssh隧道,在vpshost上,通过以下命令即可连接到内网\n```\nssh -p 3322 localhost\n```\n\n## 2. vpshost设置\n\n编辑/etc/ssh/sshd_config文件\n在文件的最后加入\n> gatewayports yes \n\n重启ssh服务\n```\nservice ssh restart\n```\n\n这时即可在第三方机器连接到内网中\n```\nssh myname@vpshost:3322\n```","slug":"201710091706","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a25i0009zizpa4snopvh","content":"<p>linux SSH内网穿透</p>\n<a id=\"more\"></a>\n<h1 id=\"简单使用\"><a href=\"#简单使用\" class=\"headerlink\" title=\"简单使用\"></a>简单使用</h1><h2 id=\"1-内网设置\"><a href=\"#1-内网设置\" class=\"headerlink\" title=\"1.内网设置:\"></a>1.内网设置:</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh -qnfNT -g -R 3322:localhost:22 myname@vpshost</div></pre></td></tr></table></figure>\n<p>这会在vpshost上面开一个端口3322,和内网的22端口建立一个ssh隧道,在vpshost上,通过以下命令即可连接到内网<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh -p 3322 localhost</div></pre></td></tr></table></figure></p>\n<h2 id=\"2-vpshost设置\"><a href=\"#2-vpshost设置\" class=\"headerlink\" title=\"2. vpshost设置\"></a>2. vpshost设置</h2><p>编辑/etc/ssh/sshd_config文件<br>在文件的最后加入</p>\n<blockquote>\n<p>gatewayports yes </p>\n</blockquote>\n<p>重启ssh服务<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service ssh restart</div></pre></td></tr></table></figure></p>\n<p>这时即可在第三方机器连接到内网中<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh myname@vpshost:3322</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<p>linux SSH内网穿透</p>","more":"<h1 id=\"简单使用\"><a href=\"#简单使用\" class=\"headerlink\" title=\"简单使用\"></a>简单使用</h1><h2 id=\"1-内网设置\"><a href=\"#1-内网设置\" class=\"headerlink\" title=\"1.内网设置:\"></a>1.内网设置:</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh -qnfNT -g -R 3322:localhost:22 myname@vpshost</div></pre></td></tr></table></figure>\n<p>这会在vpshost上面开一个端口3322,和内网的22端口建立一个ssh隧道,在vpshost上,通过以下命令即可连接到内网<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh -p 3322 localhost</div></pre></td></tr></table></figure></p>\n<h2 id=\"2-vpshost设置\"><a href=\"#2-vpshost设置\" class=\"headerlink\" title=\"2. vpshost设置\"></a>2. vpshost设置</h2><p>编辑/etc/ssh/sshd_config文件<br>在文件的最后加入</p>\n<blockquote>\n<p>gatewayports yes </p>\n</blockquote>\n<p>重启ssh服务<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">service ssh restart</div></pre></td></tr></table></figure></p>\n<p>这时即可在第三方机器连接到内网中<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh myname@vpshost:3322</div></pre></td></tr></table></figure></p>"},{"title":"linux 多网卡同一网段设置","date":"2017-10-09T09:08:12.000Z","_content":"\nlinux 多网卡同一网段设置\n\n<!-- more -->\n\n# 机器环境\n\n操作系统:debian7.8\n\n## 1. 配置 */etc/sysctl*\n\n> net.ipv4.conf.default.rp_filter = 1  \n> net.ipv4.conf.all.rp_filter = 1  \n```\nsysctl -p\n```\n\n## 2. 新建文件 */usr/local/sbin/iproute.sh*\n\n> \\#!/bin/bash\n> <br>\n>  \n> ip route del default\n> <br>\n>  \n> ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77 table 2  \n> ip route add default via 10.110.1.254 dev eth0 table 2  \n> ip rule add from 10.110.1.77 table 2  \n> ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77\n> <br />\n>  \n> ip route add 10.110.1.0/24 dev eth1 src 10.110.1.21 table 3  \n> ip route add default via 10.110.1.254 dev eth1 table 3  \n> ip rule add from 10.110.1.21 table 3  \n> ip route add 10.110.1.0/24 dev eth0 src 10.110.1.21\n> <br />\n>  \n> ip route add default via 10.110.1.254 dev eth0\n\n## 3. 运行\n\n```\nchmod 755 /usr/local/sbin/iproute.sh\n/usr/local/sbin/iproute.sh\necho \"/usr/local/sbin/iproute.sh\" >> /etc/rc.local\n```","source":"_posts/201710091708.md","raw":"---\ntitle: linux 多网卡同一网段设置\ndate: 2017-10-09 17:08:12\ntags:\n  - linux\n  - network\n---\n\nlinux 多网卡同一网段设置\n\n<!-- more -->\n\n# 机器环境\n\n操作系统:debian7.8\n\n## 1. 配置 */etc/sysctl*\n\n> net.ipv4.conf.default.rp_filter = 1  \n> net.ipv4.conf.all.rp_filter = 1  \n```\nsysctl -p\n```\n\n## 2. 新建文件 */usr/local/sbin/iproute.sh*\n\n> \\#!/bin/bash\n> <br>\n>  \n> ip route del default\n> <br>\n>  \n> ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77 table 2  \n> ip route add default via 10.110.1.254 dev eth0 table 2  \n> ip rule add from 10.110.1.77 table 2  \n> ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77\n> <br />\n>  \n> ip route add 10.110.1.0/24 dev eth1 src 10.110.1.21 table 3  \n> ip route add default via 10.110.1.254 dev eth1 table 3  \n> ip rule add from 10.110.1.21 table 3  \n> ip route add 10.110.1.0/24 dev eth0 src 10.110.1.21\n> <br />\n>  \n> ip route add default via 10.110.1.254 dev eth0\n\n## 3. 运行\n\n```\nchmod 755 /usr/local/sbin/iproute.sh\n/usr/local/sbin/iproute.sh\necho \"/usr/local/sbin/iproute.sh\" >> /etc/rc.local\n```","slug":"201710091708","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a25n000bzizpzi3jj641","content":"<p>linux 多网卡同一网段设置</p>\n<a id=\"more\"></a>\n<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统:debian7.8</p>\n<h2 id=\"1-配置-etc-sysctl\"><a href=\"#1-配置-etc-sysctl\" class=\"headerlink\" title=\"1. 配置 /etc/sysctl\"></a>1. 配置 <em>/etc/sysctl</em></h2><blockquote>\n<p>net.ipv4.conf.default.rp_filter = 1<br>net.ipv4.conf.all.rp_filter = 1<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sysctl -p</div></pre></td></tr></table></figure></p>\n</blockquote>\n<h2 id=\"2-新建文件-usr-local-sbin-iproute-sh\"><a href=\"#2-新建文件-usr-local-sbin-iproute-sh\" class=\"headerlink\" title=\"2. 新建文件 /usr/local/sbin/iproute.sh\"></a>2. 新建文件 <em>/usr/local/sbin/iproute.sh</em></h2><blockquote>\n<p>#!/bin/bash<br><br></p>\n<p>ip route del default<br><br></p>\n<p>ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77 table 2<br>ip route add default via 10.110.1.254 dev eth0 table 2<br>ip rule add from 10.110.1.77 table 2<br>ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77<br><br></p>\n<p>ip route add 10.110.1.0/24 dev eth1 src 10.110.1.21 table 3<br>ip route add default via 10.110.1.254 dev eth1 table 3<br>ip rule add from 10.110.1.21 table 3<br>ip route add 10.110.1.0/24 dev eth0 src 10.110.1.21<br><br></p>\n<p>ip route add default via 10.110.1.254 dev eth0</p>\n</blockquote>\n<h2 id=\"3-运行\"><a href=\"#3-运行\" class=\"headerlink\" title=\"3. 运行\"></a>3. 运行</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">chmod 755 /usr/local/sbin/iproute.sh</div><div class=\"line\">/usr/local/sbin/iproute.sh</div><div class=\"line\">echo &quot;/usr/local/sbin/iproute.sh&quot; &gt;&gt; /etc/rc.local</div></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<p>linux 多网卡同一网段设置</p>","more":"<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统:debian7.8</p>\n<h2 id=\"1-配置-etc-sysctl\"><a href=\"#1-配置-etc-sysctl\" class=\"headerlink\" title=\"1. 配置 /etc/sysctl\"></a>1. 配置 <em>/etc/sysctl</em></h2><blockquote>\n<p>net.ipv4.conf.default.rp_filter = 1<br>net.ipv4.conf.all.rp_filter = 1<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sysctl -p</div></pre></td></tr></table></figure></p>\n</blockquote>\n<h2 id=\"2-新建文件-usr-local-sbin-iproute-sh\"><a href=\"#2-新建文件-usr-local-sbin-iproute-sh\" class=\"headerlink\" title=\"2. 新建文件 /usr/local/sbin/iproute.sh\"></a>2. 新建文件 <em>/usr/local/sbin/iproute.sh</em></h2><blockquote>\n<p>#!/bin/bash<br><br></p>\n<p>ip route del default<br><br></p>\n<p>ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77 table 2<br>ip route add default via 10.110.1.254 dev eth0 table 2<br>ip rule add from 10.110.1.77 table 2<br>ip route add 10.110.1.0/24 dev eth0 src 10.110.1.77<br><br></p>\n<p>ip route add 10.110.1.0/24 dev eth1 src 10.110.1.21 table 3<br>ip route add default via 10.110.1.254 dev eth1 table 3<br>ip rule add from 10.110.1.21 table 3<br>ip route add 10.110.1.0/24 dev eth0 src 10.110.1.21<br><br></p>\n<p>ip route add default via 10.110.1.254 dev eth0</p>\n</blockquote>\n<h2 id=\"3-运行\"><a href=\"#3-运行\" class=\"headerlink\" title=\"3. 运行\"></a>3. 运行</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">chmod 755 /usr/local/sbin/iproute.sh</div><div class=\"line\">/usr/local/sbin/iproute.sh</div><div class=\"line\">echo &quot;/usr/local/sbin/iproute.sh&quot; &gt;&gt; /etc/rc.local</div></pre></td></tr></table></figure>"},{"title":"linux 通过Bonding实现网卡绑定","date":"2017-10-09T09:09:12.000Z","_content":"\nlinux 通过Bonding实现网卡绑定\n\n<!-- more -->\n\n# 机器环境\n\n操作系统:debian7.8  \n\n## 1. 安装ifenslave\n\n```\nsudo apt-get install -y ifenslave\n```\n\n## 2. 配置 */etc/network/interfaces*\n\n> \\#This file describes the network interfaces available on your system  \n> \\#and how to activate them. For more information, see interfaces(5).  \n> \\#The loopback network interfaces\n> <br>\n>\n> auto lo  \n> iface lo inet loopback\n> <br>\n>   \n> auto eth0  \n> iface eth0 inet manual  \n> bond-master bond0\n> <br>\n>   \n> auto eth1  \n> iface eth1 inet manual  \n> bond-master bond0\n> <br>\n>   \n> auto bond0  \n> iface bond0 inet dhcp  \n> slaves all  \n> bond-mode 6  \n> bond-miimon 100 \n\n## 3. 运行\n``` bash\nmodprobe bonding mode=6 miimon=100\n/etc/init.d/networking restart\n```\n\n> 注:  \n> 共有7种mode,常用的三种  \n> - mode=0,负载平衡模式,此时网卡轮询,即eth0发一个> 包,eth1发下一个包,此时两张网卡负载差不多\n> - mode=1,冗余备份模式,此时只有一张网卡工作,另一张备份,监视时间由miimon设定\n> - mode=6,负载平衡模式,当一张网卡负载满了之后使用另一张网卡","source":"_posts/201710091709.md","raw":"---\ntitle: linux 通过Bonding实现网卡绑定\ndate: 2017-10-09 17:09:12\ntags:\n  - linux\n  - network\n---\n\nlinux 通过Bonding实现网卡绑定\n\n<!-- more -->\n\n# 机器环境\n\n操作系统:debian7.8  \n\n## 1. 安装ifenslave\n\n```\nsudo apt-get install -y ifenslave\n```\n\n## 2. 配置 */etc/network/interfaces*\n\n> \\#This file describes the network interfaces available on your system  \n> \\#and how to activate them. For more information, see interfaces(5).  \n> \\#The loopback network interfaces\n> <br>\n>\n> auto lo  \n> iface lo inet loopback\n> <br>\n>   \n> auto eth0  \n> iface eth0 inet manual  \n> bond-master bond0\n> <br>\n>   \n> auto eth1  \n> iface eth1 inet manual  \n> bond-master bond0\n> <br>\n>   \n> auto bond0  \n> iface bond0 inet dhcp  \n> slaves all  \n> bond-mode 6  \n> bond-miimon 100 \n\n## 3. 运行\n``` bash\nmodprobe bonding mode=6 miimon=100\n/etc/init.d/networking restart\n```\n\n> 注:  \n> 共有7种mode,常用的三种  \n> - mode=0,负载平衡模式,此时网卡轮询,即eth0发一个> 包,eth1发下一个包,此时两张网卡负载差不多\n> - mode=1,冗余备份模式,此时只有一张网卡工作,另一张备份,监视时间由miimon设定\n> - mode=6,负载平衡模式,当一张网卡负载满了之后使用另一张网卡","slug":"201710091709","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a25r000czizpi60b5ib8","content":"<p>linux 通过Bonding实现网卡绑定</p>\n<a id=\"more\"></a>\n<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统:debian7.8  </p>\n<h2 id=\"1-安装ifenslave\"><a href=\"#1-安装ifenslave\" class=\"headerlink\" title=\"1. 安装ifenslave\"></a>1. 安装ifenslave</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get install -y ifenslave</div></pre></td></tr></table></figure>\n<h2 id=\"2-配置-etc-network-interfaces\"><a href=\"#2-配置-etc-network-interfaces\" class=\"headerlink\" title=\"2. 配置 /etc/network/interfaces\"></a>2. 配置 <em>/etc/network/interfaces</em></h2><blockquote>\n<p>#This file describes the network interfaces available on your system<br>#and how to activate them. For more information, see interfaces(5).<br>#The loopback network interfaces<br><br></p>\n<p>auto lo<br>iface lo inet loopback<br><br></p>\n<p>auto eth0<br>iface eth0 inet manual<br>bond-master bond0<br><br></p>\n<p>auto eth1<br>iface eth1 inet manual<br>bond-master bond0<br><br></p>\n<p>auto bond0<br>iface bond0 inet dhcp<br>slaves all<br>bond-mode 6<br>bond-miimon 100 </p>\n</blockquote>\n<h2 id=\"3-运行\"><a href=\"#3-运行\" class=\"headerlink\" title=\"3. 运行\"></a>3. 运行</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">modprobe bonding mode=6 miimon=100</div><div class=\"line\">/etc/init.d/networking restart</div></pre></td></tr></table></figure>\n<blockquote>\n<p>注:<br>共有7种mode,常用的三种  </p>\n<ul>\n<li>mode=0,负载平衡模式,此时网卡轮询,即eth0发一个&gt; 包,eth1发下一个包,此时两张网卡负载差不多</li>\n<li>mode=1,冗余备份模式,此时只有一张网卡工作,另一张备份,监视时间由miimon设定</li>\n<li>mode=6,负载平衡模式,当一张网卡负载满了之后使用另一张网卡</li>\n</ul>\n</blockquote>\n","site":{"data":{}},"excerpt":"<p>linux 通过Bonding实现网卡绑定</p>","more":"<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统:debian7.8  </p>\n<h2 id=\"1-安装ifenslave\"><a href=\"#1-安装ifenslave\" class=\"headerlink\" title=\"1. 安装ifenslave\"></a>1. 安装ifenslave</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get install -y ifenslave</div></pre></td></tr></table></figure>\n<h2 id=\"2-配置-etc-network-interfaces\"><a href=\"#2-配置-etc-network-interfaces\" class=\"headerlink\" title=\"2. 配置 /etc/network/interfaces\"></a>2. 配置 <em>/etc/network/interfaces</em></h2><blockquote>\n<p>#This file describes the network interfaces available on your system<br>#and how to activate them. For more information, see interfaces(5).<br>#The loopback network interfaces<br><br></p>\n<p>auto lo<br>iface lo inet loopback<br><br></p>\n<p>auto eth0<br>iface eth0 inet manual<br>bond-master bond0<br><br></p>\n<p>auto eth1<br>iface eth1 inet manual<br>bond-master bond0<br><br></p>\n<p>auto bond0<br>iface bond0 inet dhcp<br>slaves all<br>bond-mode 6<br>bond-miimon 100 </p>\n</blockquote>\n<h2 id=\"3-运行\"><a href=\"#3-运行\" class=\"headerlink\" title=\"3. 运行\"></a>3. 运行</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">modprobe bonding mode=6 miimon=100</div><div class=\"line\">/etc/init.d/networking restart</div></pre></td></tr></table></figure>\n<blockquote>\n<p>注:<br>共有7种mode,常用的三种  </p>\n<ul>\n<li>mode=0,负载平衡模式,此时网卡轮询,即eth0发一个&gt; 包,eth1发下一个包,此时两张网卡负载差不多</li>\n<li>mode=1,冗余备份模式,此时只有一张网卡工作,另一张备份,监视时间由miimon设定</li>\n<li>mode=6,负载平衡模式,当一张网卡负载满了之后使用另一张网卡</li>\n</ul>\n</blockquote>"},{"title":"linux pptp客户端使用","date":"2017-10-09T09:10:22.000Z","_content":"\nlinux pptp客户端使用\n\n<!-- more -->\n\n\n# 机器环境\n\n操作系统:debian7.8\n```\nsudo apt-get install -y pptp-linux iproute\n\npptpsetup --create pptpvpn --server server.domain --username vpn.user --password vpn.passwd --encrypt\n#pptpvpn为创建的vpn连接名称,server.domain为vpn地址,vpn.user为vpn用户名,vpn.passwd为密码\n\npon pptpvpn\n#启动vpn连接\n\npoff pptpvpn\n#关闭vpn连接\n\npptpsetup --delete pptpvpn\n#删除pptpvpn的连接配置\n\necho \"pon pptpvpn\" >> /etc/rc.local\n#开机自动连接\n```","source":"_posts/201710091710.md","raw":"---\ntitle: linux pptp客户端使用\ndate: 2017-10-09 17:10:22\ntags:\n  - linux\n  - network\n---\n\nlinux pptp客户端使用\n\n<!-- more -->\n\n\n# 机器环境\n\n操作系统:debian7.8\n```\nsudo apt-get install -y pptp-linux iproute\n\npptpsetup --create pptpvpn --server server.domain --username vpn.user --password vpn.passwd --encrypt\n#pptpvpn为创建的vpn连接名称,server.domain为vpn地址,vpn.user为vpn用户名,vpn.passwd为密码\n\npon pptpvpn\n#启动vpn连接\n\npoff pptpvpn\n#关闭vpn连接\n\npptpsetup --delete pptpvpn\n#删除pptpvpn的连接配置\n\necho \"pon pptpvpn\" >> /etc/rc.local\n#开机自动连接\n```","slug":"201710091710","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a25v000ezizpo6aiv5zf","content":"<p>linux pptp客户端使用</p>\n<a id=\"more\"></a>\n<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统:debian7.8<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get install -y pptp-linux iproute</div><div class=\"line\"></div><div class=\"line\">pptpsetup --create pptpvpn --server server.domain --username vpn.user --password vpn.passwd --encrypt</div><div class=\"line\">#pptpvpn为创建的vpn连接名称,server.domain为vpn地址,vpn.user为vpn用户名,vpn.passwd为密码</div><div class=\"line\"></div><div class=\"line\">pon pptpvpn</div><div class=\"line\">#启动vpn连接</div><div class=\"line\"></div><div class=\"line\">poff pptpvpn</div><div class=\"line\">#关闭vpn连接</div><div class=\"line\"></div><div class=\"line\">pptpsetup --delete pptpvpn</div><div class=\"line\">#删除pptpvpn的连接配置</div><div class=\"line\"></div><div class=\"line\">echo &quot;pon pptpvpn&quot; &gt;&gt; /etc/rc.local</div><div class=\"line\">#开机自动连接</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<p>linux pptp客户端使用</p>","more":"<h1 id=\"机器环境\"><a href=\"#机器环境\" class=\"headerlink\" title=\"机器环境\"></a>机器环境</h1><p>操作系统:debian7.8<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get install -y pptp-linux iproute</div><div class=\"line\"></div><div class=\"line\">pptpsetup --create pptpvpn --server server.domain --username vpn.user --password vpn.passwd --encrypt</div><div class=\"line\">#pptpvpn为创建的vpn连接名称,server.domain为vpn地址,vpn.user为vpn用户名,vpn.passwd为密码</div><div class=\"line\"></div><div class=\"line\">pon pptpvpn</div><div class=\"line\">#启动vpn连接</div><div class=\"line\"></div><div class=\"line\">poff pptpvpn</div><div class=\"line\">#关闭vpn连接</div><div class=\"line\"></div><div class=\"line\">pptpsetup --delete pptpvpn</div><div class=\"line\">#删除pptpvpn的连接配置</div><div class=\"line\"></div><div class=\"line\">echo &quot;pon pptpvpn&quot; &gt;&gt; /etc/rc.local</div><div class=\"line\">#开机自动连接</div></pre></td></tr></table></figure></p>"},{"title":"dpkg 使用","date":"2017-10-09T09:12:08.000Z","_content":"\n`deb`是debian linus的安装格式,跟red hat的rpm非常相似,最基本的安装命令是:\n`dpkg -i file.deb`\n\n<!-- more -->\n\n`dpkg` 是Debian Package的简写,是为Debian专门开发的套件管理系统,方便软件的安装&更新及移除.所有源自Debian的Linux发行版都使用`dpkg`,例如Ubuntu&Knoppix等.\n\n以下是一些Dpkg的普通用法:\n\n- `dpkg -i <package.deb>`\n安装一个Debian 软件包，如你手动下载的文件。\n\n- `dpkg -c <package.deb>`\n列出< package.deb> 的内容.\n\n- `dpkg -I <package.deb>`\n从< package.deb> 中提取包信息.\n\n- `dpkg -r <package>`\n移除一个已安装的包.\n\n- `dpkg -P <package>`\n完全清除一个已安装的包.和remove 不同的是,remove 只是删掉数据和可执行文件,purge 另外还删除所有的配制文件.\n\n- `dpkg -L <package>`\n列出<package> 安装的所有文件清单.同时请看dpkg -c 来检查一个.deb 文件的内容.\n\n- `dpkg -s <package>`\n显示已安装包的信息.同时请看apt-cache 显示Debian 存档中的包信息,以及dpkg -I 来显示从一个.deb 文件中提取的包信息.\n\n- `dpkg-reconfigure <package>`\n重新配制一个已经安装的包,如果它使用的是debconf (debconf 为包安装提供了一个统一的配制界面).\n","source":"_posts/201710091712.md","raw":"---\ntitle: dpkg 使用\ndate: 2017-10-09 17:12:08\ntags:\n  - linux\n  - tools\n---\n\n`deb`是debian linus的安装格式,跟red hat的rpm非常相似,最基本的安装命令是:\n`dpkg -i file.deb`\n\n<!-- more -->\n\n`dpkg` 是Debian Package的简写,是为Debian专门开发的套件管理系统,方便软件的安装&更新及移除.所有源自Debian的Linux发行版都使用`dpkg`,例如Ubuntu&Knoppix等.\n\n以下是一些Dpkg的普通用法:\n\n- `dpkg -i <package.deb>`\n安装一个Debian 软件包，如你手动下载的文件。\n\n- `dpkg -c <package.deb>`\n列出< package.deb> 的内容.\n\n- `dpkg -I <package.deb>`\n从< package.deb> 中提取包信息.\n\n- `dpkg -r <package>`\n移除一个已安装的包.\n\n- `dpkg -P <package>`\n完全清除一个已安装的包.和remove 不同的是,remove 只是删掉数据和可执行文件,purge 另外还删除所有的配制文件.\n\n- `dpkg -L <package>`\n列出<package> 安装的所有文件清单.同时请看dpkg -c 来检查一个.deb 文件的内容.\n\n- `dpkg -s <package>`\n显示已安装包的信息.同时请看apt-cache 显示Debian 存档中的包信息,以及dpkg -I 来显示从一个.deb 文件中提取的包信息.\n\n- `dpkg-reconfigure <package>`\n重新配制一个已经安装的包,如果它使用的是debconf (debconf 为包安装提供了一个统一的配制界面).\n","slug":"201710091712","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a25y000gzizp3s4g3ix9","content":"<p><code>deb</code>是debian linus的安装格式,跟red hat的rpm非常相似,最基本的安装命令是:<br><code>dpkg -i file.deb</code></p>\n<a id=\"more\"></a>\n<p><code>dpkg</code> 是Debian Package的简写,是为Debian专门开发的套件管理系统,方便软件的安装&amp;更新及移除.所有源自Debian的Linux发行版都使用<code>dpkg</code>,例如Ubuntu&amp;Knoppix等.</p>\n<p>以下是一些Dpkg的普通用法:</p>\n<ul>\n<li><p><code>dpkg -i &lt;package.deb&gt;</code><br>安装一个Debian 软件包，如你手动下载的文件。</p>\n</li>\n<li><p><code>dpkg -c &lt;package.deb&gt;</code><br>列出&lt; package.deb&gt; 的内容.</p>\n</li>\n<li><p><code>dpkg -I &lt;package.deb&gt;</code><br>从&lt; package.deb&gt; 中提取包信息.</p>\n</li>\n<li><p><code>dpkg -r &lt;package&gt;</code><br>移除一个已安装的包.</p>\n</li>\n<li><p><code>dpkg -P &lt;package&gt;</code><br>完全清除一个已安装的包.和remove 不同的是,remove 只是删掉数据和可执行文件,purge 另外还删除所有的配制文件.</p>\n</li>\n<li><p><code>dpkg -L &lt;package&gt;</code><br>列出<package> 安装的所有文件清单.同时请看dpkg -c 来检查一个.deb 文件的内容.</package></p>\n</li>\n<li><p><code>dpkg -s &lt;package&gt;</code><br>显示已安装包的信息.同时请看apt-cache 显示Debian 存档中的包信息,以及dpkg -I 来显示从一个.deb 文件中提取的包信息.</p>\n</li>\n<li><p><code>dpkg-reconfigure &lt;package&gt;</code><br>重新配制一个已经安装的包,如果它使用的是debconf (debconf 为包安装提供了一个统一的配制界面).</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p><code>deb</code>是debian linus的安装格式,跟red hat的rpm非常相似,最基本的安装命令是:<br><code>dpkg -i file.deb</code></p>","more":"<p><code>dpkg</code> 是Debian Package的简写,是为Debian专门开发的套件管理系统,方便软件的安装&amp;更新及移除.所有源自Debian的Linux发行版都使用<code>dpkg</code>,例如Ubuntu&amp;Knoppix等.</p>\n<p>以下是一些Dpkg的普通用法:</p>\n<ul>\n<li><p><code>dpkg -i &lt;package.deb&gt;</code><br>安装一个Debian 软件包，如你手动下载的文件。</p>\n</li>\n<li><p><code>dpkg -c &lt;package.deb&gt;</code><br>列出&lt; package.deb&gt; 的内容.</p>\n</li>\n<li><p><code>dpkg -I &lt;package.deb&gt;</code><br>从&lt; package.deb&gt; 中提取包信息.</p>\n</li>\n<li><p><code>dpkg -r &lt;package&gt;</code><br>移除一个已安装的包.</p>\n</li>\n<li><p><code>dpkg -P &lt;package&gt;</code><br>完全清除一个已安装的包.和remove 不同的是,remove 只是删掉数据和可执行文件,purge 另外还删除所有的配制文件.</p>\n</li>\n<li><p><code>dpkg -L &lt;package&gt;</code><br>列出<package> 安装的所有文件清单.同时请看dpkg -c 来检查一个.deb 文件的内容.</package></p>\n</li>\n<li><p><code>dpkg -s &lt;package&gt;</code><br>显示已安装包的信息.同时请看apt-cache 显示Debian 存档中的包信息,以及dpkg -I 来显示从一个.deb 文件中提取的包信息.</p>\n</li>\n<li><p><code>dpkg-reconfigure &lt;package&gt;</code><br>重新配制一个已经安装的包,如果它使用的是debconf (debconf 为包安装提供了一个统一的配制界面).</p>\n</li>\n</ul>"},{"title":"git 简单使用","date":"2017-10-09T09:14:02.000Z","_content":"\ngit 简单使用\n\n<!-- more -->\n\n# 分布式版本控制\n\n-   集中式版本控制系统  \n    &emsp;&emsp;版本库集中存放在中央服务器,中央服务器保存着最新最全的版本信息  \n    &emsp;&emsp;问题在于必须联网才能正常使用\n-   分布式版本控制系统  \n    &emsp;&emsp;放弃\"中央服务器\",每个分布式节点都是完整的版本库\n\n## 设置\n---\n\n```\ngit config --global user.name \"name\"\ngit config --global user.email \"email\"\n```\n\n其中,config命令的--global参数,表示这台机器上的所有Git仓库都会使用这个配置.\n也可以对某个仓库指定不同的用户名和Email地址\n\n<br>\n\n## 创建版本库\n---\n\n```\ngit init \n#将目录变成Git仓库,然后git会在当前目录下生成.git目录,用于跟踪管理版本库\n\ngit add filename or filename list \n#添加文件到库中\n\ngit commit -m \"comments\" \n#提交,**-m**是本次提交的说明\n```\n\n<br>\n\n## 版本管理\n---\n\n```\ngit status\n#查看结果,显示仓库当前的状态,查看文件的修改情况\n\ngit diff filename\n#查看difference,显示修改内容\n\ngit log\n#查看从最近到最远的提交日志,可以加上--pretty=oneline减少输出信息\n\ngit reflog\n#记录每一次的命令\n\ngit reset\n    git reset --hard HEAD^\n    #退回上一个版本\n    git reset --hard serialno\n    #serialno为commit id\n#Git中，用HEAD表示当前版本，上一个版本为HEAD^，上上一个版本就是HEAD^^，多个^可以简写，如HEAD~2\n\n#工作区和暂存区\n#工作区中隐藏目录.git是Git的版本库,包括了称为stage(或index)的暂存区,以及分支,以及指向master的指针HEAD\n#向Git版本库添加文件,分两步执行:\n#   用git add把文件添加进去,将文件修改添加到暂存区\n#   用git commit提交更改,将暂存区的所有内容提交到当前分支\n#每次修改,如果不add到暂存区,也就不会加入到commit中\n\ngit check -- filename\n#丢弃工作区的修改,--很重要,否则就变成了切换到另一个分支\n#   file自修改后还没有被放到暂存区,撤销修改回到和版本库一模一样的状态\n#   file已经添加到暂存区,又做了修改,撤销修改就回到添加暂存区后的状态\n#   也就是让文件回到最近一次git commit或者git add时的状态\n#git reset可以把暂存区的修改回退到工作区,HEAD表示最新版本\n\ngit reset HEAD file\n#撤销暂存区的修改\n\ngit rm filename\n#将文件从版本库中删除,git checkout -- file 可以将误删除的文件找回\n```\n\n<br>\n\n## 远程仓库Github\n---\n\n#### 准备\n\n本地Git仓库和Github仓库之间通过ssh加密传输,进行验证设置\n\n创建ssh key\n\n```\nssh-keygen -t rsa -C \"mail\"\n```\n在主目录找到.ssh目录,里面有生成的id_rsa(私钥)和id_rsa.pub(公钥)两个文件  \n登陆github,id_ras.pub的内容添加到ssh key\n\n#### 添加远程仓库\n\n```\ngit remote add origin git@github.com:xxxx/xxx.git \n#origin设定为远程库的名字\n\ngit push -u origin master\n#将本地库的内容推送到远程\n#-u参数,git会把本地master分支内容推送至远程新的master分支,并对master分支进行关联\n#后续推送执行git push master即可\n```\n\n#### clone 远程库\n\n```\ngit clone git@github.com:xxx/xxx.git\n```\n\n<br>\n\n## 分支管理\n---\n\n#### 创建与合并分支\n\ngit通过指针使得分支的创建和合并简介迅速\n\n```\ngit branch\n#查看分支\n\ngit branch <name>\n#创建分支\n\ngit checkout <name>\n#切换分支\n\ngit checkout -b <name>\n#创建+切换分支\n\ngit merge <name>\n#合并某分支到当前分支\n\ngit branch -d <name>\n#删除分支\n```\n\n#### 管理策略\n\n当git无法自动合并分支时,需要首先解决冲突,然后再提交,完成合并\n\n```\ngit log --graph\n#查看分支合并图\n```\n\n合并分支时,git会尽可能使用fast forward模式,删除分支后,会丢掉分支信息,禁止该模式(加上 --no-ff参数)时,git会在merge时生成一个新的commit,从而在分支历史上看到该分支信息\n\n```\ngit checkout -b dev\ngit add filename\ngit commit -m \"add merge\"\ngit checkout master\ngit merge --no-ff -m \"merge with no-ff\" dev\n```\n\n#### 分支原则\n\n- master分支应该是稳定的,仅用来发布新版本\n- 开发再其他分支上\n\n#### Bug分支\n\n```\ngit stash\n#将当前工作现场\"储藏起来\"\n\ngit stash list\n#查看保存的工作现场\n\n#恢复\ngit stash apply\n#'stash'内容不删除,删除使用git stash drop\n\ngit stash pop\n#恢复的同时也将stash内容删除\n\ngit stash apply stash@{0}\n#恢复制定的stash\n```\n\n#### feature分支\n\n开发一个新的feature,最好新建一个分支  \n如果要丢弃一个没有被合并的分支,通过下面的命令强行删除\n\n```\ngit branch -D <name>\n```\n\n#### 多人协作\n\n从远程仓库clone时,git自动把本地master分支和远程的master分支对应起来,远程仓库的默认名称是origin\n\n```\ngit remote\n#查看远程库的信息,-v参数可以显示更详细的信息\n\ngit branch --set-upstream branch-name origin/branch-name\n#创建本地分支与远程分支的链接,否则pull时可能会出现\"no tracking information\"错误\n```","source":"_posts/201710091714.md","raw":"---\ntitle: git 简单使用\ndate: 2017-10-09 17:14:02\ntags:\n  - linux\n  - tools\n---\n\ngit 简单使用\n\n<!-- more -->\n\n# 分布式版本控制\n\n-   集中式版本控制系统  \n    &emsp;&emsp;版本库集中存放在中央服务器,中央服务器保存着最新最全的版本信息  \n    &emsp;&emsp;问题在于必须联网才能正常使用\n-   分布式版本控制系统  \n    &emsp;&emsp;放弃\"中央服务器\",每个分布式节点都是完整的版本库\n\n## 设置\n---\n\n```\ngit config --global user.name \"name\"\ngit config --global user.email \"email\"\n```\n\n其中,config命令的--global参数,表示这台机器上的所有Git仓库都会使用这个配置.\n也可以对某个仓库指定不同的用户名和Email地址\n\n<br>\n\n## 创建版本库\n---\n\n```\ngit init \n#将目录变成Git仓库,然后git会在当前目录下生成.git目录,用于跟踪管理版本库\n\ngit add filename or filename list \n#添加文件到库中\n\ngit commit -m \"comments\" \n#提交,**-m**是本次提交的说明\n```\n\n<br>\n\n## 版本管理\n---\n\n```\ngit status\n#查看结果,显示仓库当前的状态,查看文件的修改情况\n\ngit diff filename\n#查看difference,显示修改内容\n\ngit log\n#查看从最近到最远的提交日志,可以加上--pretty=oneline减少输出信息\n\ngit reflog\n#记录每一次的命令\n\ngit reset\n    git reset --hard HEAD^\n    #退回上一个版本\n    git reset --hard serialno\n    #serialno为commit id\n#Git中，用HEAD表示当前版本，上一个版本为HEAD^，上上一个版本就是HEAD^^，多个^可以简写，如HEAD~2\n\n#工作区和暂存区\n#工作区中隐藏目录.git是Git的版本库,包括了称为stage(或index)的暂存区,以及分支,以及指向master的指针HEAD\n#向Git版本库添加文件,分两步执行:\n#   用git add把文件添加进去,将文件修改添加到暂存区\n#   用git commit提交更改,将暂存区的所有内容提交到当前分支\n#每次修改,如果不add到暂存区,也就不会加入到commit中\n\ngit check -- filename\n#丢弃工作区的修改,--很重要,否则就变成了切换到另一个分支\n#   file自修改后还没有被放到暂存区,撤销修改回到和版本库一模一样的状态\n#   file已经添加到暂存区,又做了修改,撤销修改就回到添加暂存区后的状态\n#   也就是让文件回到最近一次git commit或者git add时的状态\n#git reset可以把暂存区的修改回退到工作区,HEAD表示最新版本\n\ngit reset HEAD file\n#撤销暂存区的修改\n\ngit rm filename\n#将文件从版本库中删除,git checkout -- file 可以将误删除的文件找回\n```\n\n<br>\n\n## 远程仓库Github\n---\n\n#### 准备\n\n本地Git仓库和Github仓库之间通过ssh加密传输,进行验证设置\n\n创建ssh key\n\n```\nssh-keygen -t rsa -C \"mail\"\n```\n在主目录找到.ssh目录,里面有生成的id_rsa(私钥)和id_rsa.pub(公钥)两个文件  \n登陆github,id_ras.pub的内容添加到ssh key\n\n#### 添加远程仓库\n\n```\ngit remote add origin git@github.com:xxxx/xxx.git \n#origin设定为远程库的名字\n\ngit push -u origin master\n#将本地库的内容推送到远程\n#-u参数,git会把本地master分支内容推送至远程新的master分支,并对master分支进行关联\n#后续推送执行git push master即可\n```\n\n#### clone 远程库\n\n```\ngit clone git@github.com:xxx/xxx.git\n```\n\n<br>\n\n## 分支管理\n---\n\n#### 创建与合并分支\n\ngit通过指针使得分支的创建和合并简介迅速\n\n```\ngit branch\n#查看分支\n\ngit branch <name>\n#创建分支\n\ngit checkout <name>\n#切换分支\n\ngit checkout -b <name>\n#创建+切换分支\n\ngit merge <name>\n#合并某分支到当前分支\n\ngit branch -d <name>\n#删除分支\n```\n\n#### 管理策略\n\n当git无法自动合并分支时,需要首先解决冲突,然后再提交,完成合并\n\n```\ngit log --graph\n#查看分支合并图\n```\n\n合并分支时,git会尽可能使用fast forward模式,删除分支后,会丢掉分支信息,禁止该模式(加上 --no-ff参数)时,git会在merge时生成一个新的commit,从而在分支历史上看到该分支信息\n\n```\ngit checkout -b dev\ngit add filename\ngit commit -m \"add merge\"\ngit checkout master\ngit merge --no-ff -m \"merge with no-ff\" dev\n```\n\n#### 分支原则\n\n- master分支应该是稳定的,仅用来发布新版本\n- 开发再其他分支上\n\n#### Bug分支\n\n```\ngit stash\n#将当前工作现场\"储藏起来\"\n\ngit stash list\n#查看保存的工作现场\n\n#恢复\ngit stash apply\n#'stash'内容不删除,删除使用git stash drop\n\ngit stash pop\n#恢复的同时也将stash内容删除\n\ngit stash apply stash@{0}\n#恢复制定的stash\n```\n\n#### feature分支\n\n开发一个新的feature,最好新建一个分支  \n如果要丢弃一个没有被合并的分支,通过下面的命令强行删除\n\n```\ngit branch -D <name>\n```\n\n#### 多人协作\n\n从远程仓库clone时,git自动把本地master分支和远程的master分支对应起来,远程仓库的默认名称是origin\n\n```\ngit remote\n#查看远程库的信息,-v参数可以显示更详细的信息\n\ngit branch --set-upstream branch-name origin/branch-name\n#创建本地分支与远程分支的链接,否则pull时可能会出现\"no tracking information\"错误\n```","slug":"201710091714","published":1,"updated":"2017-10-09T10:04:21.527Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a261000jzizpwf3fw5ic","content":"<p>git 简单使用</p>\n<a id=\"more\"></a>\n<h1 id=\"分布式版本控制\"><a href=\"#分布式版本控制\" class=\"headerlink\" title=\"分布式版本控制\"></a>分布式版本控制</h1><ul>\n<li>集中式版本控制系统<br>&emsp;&emsp;版本库集中存放在中央服务器,中央服务器保存着最新最全的版本信息<br>&emsp;&emsp;问题在于必须联网才能正常使用</li>\n<li>分布式版本控制系统<br>&emsp;&emsp;放弃”中央服务器”,每个分布式节点都是完整的版本库</li>\n</ul>\n<h2 id=\"设置\"><a href=\"#设置\" class=\"headerlink\" title=\"设置\"></a>设置</h2><hr>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git config --global user.name &quot;name&quot;</div><div class=\"line\">git config --global user.email &quot;email&quot;</div></pre></td></tr></table></figure>\n<p>其中,config命令的–global参数,表示这台机器上的所有Git仓库都会使用这个配置.<br>也可以对某个仓库指定不同的用户名和Email地址</p>\n<p><br></p>\n<h2 id=\"创建版本库\"><a href=\"#创建版本库\" class=\"headerlink\" title=\"创建版本库\"></a>创建版本库</h2><hr>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">git init </div><div class=\"line\">#将目录变成Git仓库,然后git会在当前目录下生成.git目录,用于跟踪管理版本库</div><div class=\"line\"></div><div class=\"line\">git add filename or filename list </div><div class=\"line\">#添加文件到库中</div><div class=\"line\"></div><div class=\"line\">git commit -m &quot;comments&quot; </div><div class=\"line\">#提交,**-m**是本次提交的说明</div></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"版本管理\"><a href=\"#版本管理\" class=\"headerlink\" title=\"版本管理\"></a>版本管理</h2><hr>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div></pre></td><td class=\"code\"><pre><div class=\"line\">git status</div><div class=\"line\">#查看结果,显示仓库当前的状态,查看文件的修改情况</div><div class=\"line\"></div><div class=\"line\">git diff filename</div><div class=\"line\">#查看difference,显示修改内容</div><div class=\"line\"></div><div class=\"line\">git log</div><div class=\"line\">#查看从最近到最远的提交日志,可以加上--pretty=oneline减少输出信息</div><div class=\"line\"></div><div class=\"line\">git reflog</div><div class=\"line\">#记录每一次的命令</div><div class=\"line\"></div><div class=\"line\">git reset</div><div class=\"line\">    git reset --hard HEAD^</div><div class=\"line\">    #退回上一个版本</div><div class=\"line\">    git reset --hard serialno</div><div class=\"line\">    #serialno为commit id</div><div class=\"line\">#Git中，用HEAD表示当前版本，上一个版本为HEAD^，上上一个版本就是HEAD^^，多个^可以简写，如HEAD~2</div><div class=\"line\"></div><div class=\"line\">#工作区和暂存区</div><div class=\"line\">#工作区中隐藏目录.git是Git的版本库,包括了称为stage(或index)的暂存区,以及分支,以及指向master的指针HEAD</div><div class=\"line\">#向Git版本库添加文件,分两步执行:</div><div class=\"line\">#   用git add把文件添加进去,将文件修改添加到暂存区</div><div class=\"line\">#   用git commit提交更改,将暂存区的所有内容提交到当前分支</div><div class=\"line\">#每次修改,如果不add到暂存区,也就不会加入到commit中</div><div class=\"line\"></div><div class=\"line\">git check -- filename</div><div class=\"line\">#丢弃工作区的修改,--很重要,否则就变成了切换到另一个分支</div><div class=\"line\">#   file自修改后还没有被放到暂存区,撤销修改回到和版本库一模一样的状态</div><div class=\"line\">#   file已经添加到暂存区,又做了修改,撤销修改就回到添加暂存区后的状态</div><div class=\"line\">#   也就是让文件回到最近一次git commit或者git add时的状态</div><div class=\"line\">#git reset可以把暂存区的修改回退到工作区,HEAD表示最新版本</div><div class=\"line\"></div><div class=\"line\">git reset HEAD file</div><div class=\"line\">#撤销暂存区的修改</div><div class=\"line\"></div><div class=\"line\">git rm filename</div><div class=\"line\">#将文件从版本库中删除,git checkout -- file 可以将误删除的文件找回</div></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"远程仓库Github\"><a href=\"#远程仓库Github\" class=\"headerlink\" title=\"远程仓库Github\"></a>远程仓库Github</h2><hr>\n<h4 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h4><p>本地Git仓库和Github仓库之间通过ssh加密传输,进行验证设置</p>\n<p>创建ssh key</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh-keygen -t rsa -C &quot;mail&quot;</div></pre></td></tr></table></figure>\n<p>在主目录找到.ssh目录,里面有生成的id_rsa(私钥)和id_rsa.pub(公钥)两个文件<br>登陆github,id_ras.pub的内容添加到ssh key</p>\n<h4 id=\"添加远程仓库\"><a href=\"#添加远程仓库\" class=\"headerlink\" title=\"添加远程仓库\"></a>添加远程仓库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">git remote add origin git@github.com:xxxx/xxx.git </div><div class=\"line\">#origin设定为远程库的名字</div><div class=\"line\"></div><div class=\"line\">git push -u origin master</div><div class=\"line\">#将本地库的内容推送到远程</div><div class=\"line\">#-u参数,git会把本地master分支内容推送至远程新的master分支,并对master分支进行关联</div><div class=\"line\">#后续推送执行git push master即可</div></pre></td></tr></table></figure>\n<h4 id=\"clone-远程库\"><a href=\"#clone-远程库\" class=\"headerlink\" title=\"clone 远程库\"></a>clone 远程库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">git clone git@github.com:xxx/xxx.git</div></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"分支管理\"><a href=\"#分支管理\" class=\"headerlink\" title=\"分支管理\"></a>分支管理</h2><hr>\n<h4 id=\"创建与合并分支\"><a href=\"#创建与合并分支\" class=\"headerlink\" title=\"创建与合并分支\"></a>创建与合并分支</h4><p>git通过指针使得分支的创建和合并简介迅速</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">git branch</div><div class=\"line\">#查看分支</div><div class=\"line\"></div><div class=\"line\">git branch &lt;name&gt;</div><div class=\"line\">#创建分支</div><div class=\"line\"></div><div class=\"line\">git checkout &lt;name&gt;</div><div class=\"line\">#切换分支</div><div class=\"line\"></div><div class=\"line\">git checkout -b &lt;name&gt;</div><div class=\"line\">#创建+切换分支</div><div class=\"line\"></div><div class=\"line\">git merge &lt;name&gt;</div><div class=\"line\">#合并某分支到当前分支</div><div class=\"line\"></div><div class=\"line\">git branch -d &lt;name&gt;</div><div class=\"line\">#删除分支</div></pre></td></tr></table></figure>\n<h4 id=\"管理策略\"><a href=\"#管理策略\" class=\"headerlink\" title=\"管理策略\"></a>管理策略</h4><p>当git无法自动合并分支时,需要首先解决冲突,然后再提交,完成合并</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git log --graph</div><div class=\"line\">#查看分支合并图</div></pre></td></tr></table></figure>\n<p>合并分支时,git会尽可能使用fast forward模式,删除分支后,会丢掉分支信息,禁止该模式(加上 –no-ff参数)时,git会在merge时生成一个新的commit,从而在分支历史上看到该分支信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">git checkout -b dev</div><div class=\"line\">git add filename</div><div class=\"line\">git commit -m &quot;add merge&quot;</div><div class=\"line\">git checkout master</div><div class=\"line\">git merge --no-ff -m &quot;merge with no-ff&quot; dev</div></pre></td></tr></table></figure>\n<h4 id=\"分支原则\"><a href=\"#分支原则\" class=\"headerlink\" title=\"分支原则\"></a>分支原则</h4><ul>\n<li>master分支应该是稳定的,仅用来发布新版本</li>\n<li>开发再其他分支上</li>\n</ul>\n<h4 id=\"Bug分支\"><a href=\"#Bug分支\" class=\"headerlink\" title=\"Bug分支\"></a>Bug分支</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">git stash</div><div class=\"line\">#将当前工作现场&quot;储藏起来&quot;</div><div class=\"line\"></div><div class=\"line\">git stash list</div><div class=\"line\">#查看保存的工作现场</div><div class=\"line\"></div><div class=\"line\">#恢复</div><div class=\"line\">git stash apply</div><div class=\"line\">#&apos;stash&apos;内容不删除,删除使用git stash drop</div><div class=\"line\"></div><div class=\"line\">git stash pop</div><div class=\"line\">#恢复的同时也将stash内容删除</div><div class=\"line\"></div><div class=\"line\">git stash apply stash@&#123;0&#125;</div><div class=\"line\">#恢复制定的stash</div></pre></td></tr></table></figure>\n<h4 id=\"feature分支\"><a href=\"#feature分支\" class=\"headerlink\" title=\"feature分支\"></a>feature分支</h4><p>开发一个新的feature,最好新建一个分支<br>如果要丢弃一个没有被合并的分支,通过下面的命令强行删除</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">git branch -D &lt;name&gt;</div></pre></td></tr></table></figure>\n<h4 id=\"多人协作\"><a href=\"#多人协作\" class=\"headerlink\" title=\"多人协作\"></a>多人协作</h4><p>从远程仓库clone时,git自动把本地master分支和远程的master分支对应起来,远程仓库的默认名称是origin</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">git remote</div><div class=\"line\">#查看远程库的信息,-v参数可以显示更详细的信息</div><div class=\"line\"></div><div class=\"line\">git branch --set-upstream branch-name origin/branch-name</div><div class=\"line\">#创建本地分支与远程分支的链接,否则pull时可能会出现&quot;no tracking information&quot;错误</div></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<p>git 简单使用</p>","more":"<h1 id=\"分布式版本控制\"><a href=\"#分布式版本控制\" class=\"headerlink\" title=\"分布式版本控制\"></a>分布式版本控制</h1><ul>\n<li>集中式版本控制系统<br>&emsp;&emsp;版本库集中存放在中央服务器,中央服务器保存着最新最全的版本信息<br>&emsp;&emsp;问题在于必须联网才能正常使用</li>\n<li>分布式版本控制系统<br>&emsp;&emsp;放弃”中央服务器”,每个分布式节点都是完整的版本库</li>\n</ul>\n<h2 id=\"设置\"><a href=\"#设置\" class=\"headerlink\" title=\"设置\"></a>设置</h2><hr>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git config --global user.name &quot;name&quot;</div><div class=\"line\">git config --global user.email &quot;email&quot;</div></pre></td></tr></table></figure>\n<p>其中,config命令的–global参数,表示这台机器上的所有Git仓库都会使用这个配置.<br>也可以对某个仓库指定不同的用户名和Email地址</p>\n<p><br></p>\n<h2 id=\"创建版本库\"><a href=\"#创建版本库\" class=\"headerlink\" title=\"创建版本库\"></a>创建版本库</h2><hr>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">git init </div><div class=\"line\">#将目录变成Git仓库,然后git会在当前目录下生成.git目录,用于跟踪管理版本库</div><div class=\"line\"></div><div class=\"line\">git add filename or filename list </div><div class=\"line\">#添加文件到库中</div><div class=\"line\"></div><div class=\"line\">git commit -m &quot;comments&quot; </div><div class=\"line\">#提交,**-m**是本次提交的说明</div></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"版本管理\"><a href=\"#版本管理\" class=\"headerlink\" title=\"版本管理\"></a>版本管理</h2><hr>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div></pre></td><td class=\"code\"><pre><div class=\"line\">git status</div><div class=\"line\">#查看结果,显示仓库当前的状态,查看文件的修改情况</div><div class=\"line\"></div><div class=\"line\">git diff filename</div><div class=\"line\">#查看difference,显示修改内容</div><div class=\"line\"></div><div class=\"line\">git log</div><div class=\"line\">#查看从最近到最远的提交日志,可以加上--pretty=oneline减少输出信息</div><div class=\"line\"></div><div class=\"line\">git reflog</div><div class=\"line\">#记录每一次的命令</div><div class=\"line\"></div><div class=\"line\">git reset</div><div class=\"line\">    git reset --hard HEAD^</div><div class=\"line\">    #退回上一个版本</div><div class=\"line\">    git reset --hard serialno</div><div class=\"line\">    #serialno为commit id</div><div class=\"line\">#Git中，用HEAD表示当前版本，上一个版本为HEAD^，上上一个版本就是HEAD^^，多个^可以简写，如HEAD~2</div><div class=\"line\"></div><div class=\"line\">#工作区和暂存区</div><div class=\"line\">#工作区中隐藏目录.git是Git的版本库,包括了称为stage(或index)的暂存区,以及分支,以及指向master的指针HEAD</div><div class=\"line\">#向Git版本库添加文件,分两步执行:</div><div class=\"line\">#   用git add把文件添加进去,将文件修改添加到暂存区</div><div class=\"line\">#   用git commit提交更改,将暂存区的所有内容提交到当前分支</div><div class=\"line\">#每次修改,如果不add到暂存区,也就不会加入到commit中</div><div class=\"line\"></div><div class=\"line\">git check -- filename</div><div class=\"line\">#丢弃工作区的修改,--很重要,否则就变成了切换到另一个分支</div><div class=\"line\">#   file自修改后还没有被放到暂存区,撤销修改回到和版本库一模一样的状态</div><div class=\"line\">#   file已经添加到暂存区,又做了修改,撤销修改就回到添加暂存区后的状态</div><div class=\"line\">#   也就是让文件回到最近一次git commit或者git add时的状态</div><div class=\"line\">#git reset可以把暂存区的修改回退到工作区,HEAD表示最新版本</div><div class=\"line\"></div><div class=\"line\">git reset HEAD file</div><div class=\"line\">#撤销暂存区的修改</div><div class=\"line\"></div><div class=\"line\">git rm filename</div><div class=\"line\">#将文件从版本库中删除,git checkout -- file 可以将误删除的文件找回</div></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"远程仓库Github\"><a href=\"#远程仓库Github\" class=\"headerlink\" title=\"远程仓库Github\"></a>远程仓库Github</h2><hr>\n<h4 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h4><p>本地Git仓库和Github仓库之间通过ssh加密传输,进行验证设置</p>\n<p>创建ssh key</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh-keygen -t rsa -C &quot;mail&quot;</div></pre></td></tr></table></figure>\n<p>在主目录找到.ssh目录,里面有生成的id_rsa(私钥)和id_rsa.pub(公钥)两个文件<br>登陆github,id_ras.pub的内容添加到ssh key</p>\n<h4 id=\"添加远程仓库\"><a href=\"#添加远程仓库\" class=\"headerlink\" title=\"添加远程仓库\"></a>添加远程仓库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">git remote add origin git@github.com:xxxx/xxx.git </div><div class=\"line\">#origin设定为远程库的名字</div><div class=\"line\"></div><div class=\"line\">git push -u origin master</div><div class=\"line\">#将本地库的内容推送到远程</div><div class=\"line\">#-u参数,git会把本地master分支内容推送至远程新的master分支,并对master分支进行关联</div><div class=\"line\">#后续推送执行git push master即可</div></pre></td></tr></table></figure>\n<h4 id=\"clone-远程库\"><a href=\"#clone-远程库\" class=\"headerlink\" title=\"clone 远程库\"></a>clone 远程库</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">git clone git@github.com:xxx/xxx.git</div></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"分支管理\"><a href=\"#分支管理\" class=\"headerlink\" title=\"分支管理\"></a>分支管理</h2><hr>\n<h4 id=\"创建与合并分支\"><a href=\"#创建与合并分支\" class=\"headerlink\" title=\"创建与合并分支\"></a>创建与合并分支</h4><p>git通过指针使得分支的创建和合并简介迅速</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">git branch</div><div class=\"line\">#查看分支</div><div class=\"line\"></div><div class=\"line\">git branch &lt;name&gt;</div><div class=\"line\">#创建分支</div><div class=\"line\"></div><div class=\"line\">git checkout &lt;name&gt;</div><div class=\"line\">#切换分支</div><div class=\"line\"></div><div class=\"line\">git checkout -b &lt;name&gt;</div><div class=\"line\">#创建+切换分支</div><div class=\"line\"></div><div class=\"line\">git merge &lt;name&gt;</div><div class=\"line\">#合并某分支到当前分支</div><div class=\"line\"></div><div class=\"line\">git branch -d &lt;name&gt;</div><div class=\"line\">#删除分支</div></pre></td></tr></table></figure>\n<h4 id=\"管理策略\"><a href=\"#管理策略\" class=\"headerlink\" title=\"管理策略\"></a>管理策略</h4><p>当git无法自动合并分支时,需要首先解决冲突,然后再提交,完成合并</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git log --graph</div><div class=\"line\">#查看分支合并图</div></pre></td></tr></table></figure>\n<p>合并分支时,git会尽可能使用fast forward模式,删除分支后,会丢掉分支信息,禁止该模式(加上 –no-ff参数)时,git会在merge时生成一个新的commit,从而在分支历史上看到该分支信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">git checkout -b dev</div><div class=\"line\">git add filename</div><div class=\"line\">git commit -m &quot;add merge&quot;</div><div class=\"line\">git checkout master</div><div class=\"line\">git merge --no-ff -m &quot;merge with no-ff&quot; dev</div></pre></td></tr></table></figure>\n<h4 id=\"分支原则\"><a href=\"#分支原则\" class=\"headerlink\" title=\"分支原则\"></a>分支原则</h4><ul>\n<li>master分支应该是稳定的,仅用来发布新版本</li>\n<li>开发再其他分支上</li>\n</ul>\n<h4 id=\"Bug分支\"><a href=\"#Bug分支\" class=\"headerlink\" title=\"Bug分支\"></a>Bug分支</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">git stash</div><div class=\"line\">#将当前工作现场&quot;储藏起来&quot;</div><div class=\"line\"></div><div class=\"line\">git stash list</div><div class=\"line\">#查看保存的工作现场</div><div class=\"line\"></div><div class=\"line\">#恢复</div><div class=\"line\">git stash apply</div><div class=\"line\">#&apos;stash&apos;内容不删除,删除使用git stash drop</div><div class=\"line\"></div><div class=\"line\">git stash pop</div><div class=\"line\">#恢复的同时也将stash内容删除</div><div class=\"line\"></div><div class=\"line\">git stash apply stash@&#123;0&#125;</div><div class=\"line\">#恢复制定的stash</div></pre></td></tr></table></figure>\n<h4 id=\"feature分支\"><a href=\"#feature分支\" class=\"headerlink\" title=\"feature分支\"></a>feature分支</h4><p>开发一个新的feature,最好新建一个分支<br>如果要丢弃一个没有被合并的分支,通过下面的命令强行删除</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">git branch -D &lt;name&gt;</div></pre></td></tr></table></figure>\n<h4 id=\"多人协作\"><a href=\"#多人协作\" class=\"headerlink\" title=\"多人协作\"></a>多人协作</h4><p>从远程仓库clone时,git自动把本地master分支和远程的master分支对应起来,远程仓库的默认名称是origin</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">git remote</div><div class=\"line\">#查看远程库的信息,-v参数可以显示更详细的信息</div><div class=\"line\"></div><div class=\"line\">git branch --set-upstream branch-name origin/branch-name</div><div class=\"line\">#创建本地分支与远程分支的链接,否则pull时可能会出现&quot;no tracking information&quot;错误</div></pre></td></tr></table></figure>"},{"title":"linux 文件解压缩","date":"2017-10-09T09:15:01.000Z","_content":"\nlinux 文件解压缩\n\n<!-- more -->\n\n# 常见压缩文件的解压缩\n\n---\n\n``` bash\n#.tar\ntar xvf archive.tar\n#解包\ntar cvf archive.tar foo\n#打包(不是压缩)\n\n#.gz\ngunzip archive.gz\n#解压\ngzip -d archive.gz\n#解压\ngzip foo\n#压缩\n\n#.tar.gz\ntar zxvf archive.tar.gz\n#解压\ntar zcvf archive.tar.gz foo\n#压缩\n\n#.bz2\nbzip2 -d archive.bz2\n#解压\nbunzip2 archive.bz2\n#解压\nbzip2 -z foo\n#压缩\n\n#.tar.bz2\ntar jxvf archive.tar.bz2\n#解压\ntar jcvf archive.tar.bz2 foo\n#压缩\n\n#.bz\nbzip2 -d archive.bz\n#解压\nbunzip2 archive.bz\n#解压\n\n#.tar.bz\ntar jxvf archive.tar.bz\n#解压\n\n#.Z\nuncompress archive.Z\n#解压\ncompress foo\n#压缩\n\n#.tar.Z\ntar Zxvf archive.tar.Z\n#解压\ntar Zcvf archive.tar.Z foo\n#压缩\n\n#.tgz\ntar zxvf archive.tgz\n#解压\n\n#.tar.tgz\ntar zxvf archive.tar.tgz\n#解压\ntar zcvf archive.tar.tgz foo\n#压缩\n\n#.zip\nunzip archive.zip\n#解压\nzip archive.zip foo\n#压缩\n\n#.lha\nlha -e archive.lha\n#解压\nlha -a archive.lha foo\n#压缩\n\n#.rar\nrar e archive.rar\n#解压\nrar a archive.rar foo\n#压缩\n```","source":"_posts/201710091715.md","raw":"---\ntitle: linux 文件解压缩\ndate: 2017-10-09 17:15:01\ntags:\n  - linux\n  - tools\n---\n\nlinux 文件解压缩\n\n<!-- more -->\n\n# 常见压缩文件的解压缩\n\n---\n\n``` bash\n#.tar\ntar xvf archive.tar\n#解包\ntar cvf archive.tar foo\n#打包(不是压缩)\n\n#.gz\ngunzip archive.gz\n#解压\ngzip -d archive.gz\n#解压\ngzip foo\n#压缩\n\n#.tar.gz\ntar zxvf archive.tar.gz\n#解压\ntar zcvf archive.tar.gz foo\n#压缩\n\n#.bz2\nbzip2 -d archive.bz2\n#解压\nbunzip2 archive.bz2\n#解压\nbzip2 -z foo\n#压缩\n\n#.tar.bz2\ntar jxvf archive.tar.bz2\n#解压\ntar jcvf archive.tar.bz2 foo\n#压缩\n\n#.bz\nbzip2 -d archive.bz\n#解压\nbunzip2 archive.bz\n#解压\n\n#.tar.bz\ntar jxvf archive.tar.bz\n#解压\n\n#.Z\nuncompress archive.Z\n#解压\ncompress foo\n#压缩\n\n#.tar.Z\ntar Zxvf archive.tar.Z\n#解压\ntar Zcvf archive.tar.Z foo\n#压缩\n\n#.tgz\ntar zxvf archive.tgz\n#解压\n\n#.tar.tgz\ntar zxvf archive.tar.tgz\n#解压\ntar zcvf archive.tar.tgz foo\n#压缩\n\n#.zip\nunzip archive.zip\n#解压\nzip archive.zip foo\n#压缩\n\n#.lha\nlha -e archive.lha\n#解压\nlha -a archive.lha foo\n#压缩\n\n#.rar\nrar e archive.rar\n#解压\nrar a archive.rar foo\n#压缩\n```","slug":"201710091715","published":1,"updated":"2017-10-09T09:19:21.083Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a264000kzizptgi918ap","content":"<p>linux 文件解压缩</p>\n<a id=\"more\"></a>\n<h1 id=\"常见压缩文件的解压缩\"><a href=\"#常见压缩文件的解压缩\" class=\"headerlink\" title=\"常见压缩文件的解压缩\"></a>常见压缩文件的解压缩</h1><hr>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#.tar</span></div><div class=\"line\">tar xvf archive.tar</div><div class=\"line\"><span class=\"comment\">#解包</span></div><div class=\"line\">tar cvf archive.tar foo</div><div class=\"line\"><span class=\"comment\">#打包(不是压缩)</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.gz</span></div><div class=\"line\">gunzip archive.gz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">gzip -d archive.gz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">gzip foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.gz</span></div><div class=\"line\">tar zxvf archive.tar.gz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar zcvf archive.tar.gz foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.bz2</span></div><div class=\"line\">bzip2 -d archive.bz2</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">bunzip2 archive.bz2</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">bzip2 -z foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.bz2</span></div><div class=\"line\">tar jxvf archive.tar.bz2</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar jcvf archive.tar.bz2 foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.bz</span></div><div class=\"line\">bzip2 -d archive.bz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">bunzip2 archive.bz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.bz</span></div><div class=\"line\">tar jxvf archive.tar.bz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.Z</span></div><div class=\"line\">uncompress archive.Z</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">compress foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.Z</span></div><div class=\"line\">tar Zxvf archive.tar.Z</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar Zcvf archive.tar.Z foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tgz</span></div><div class=\"line\">tar zxvf archive.tgz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.tgz</span></div><div class=\"line\">tar zxvf archive.tar.tgz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar zcvf archive.tar.tgz foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.zip</span></div><div class=\"line\">unzip archive.zip</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">zip archive.zip foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.lha</span></div><div class=\"line\">lha -e archive.lha</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">lha -a archive.lha foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.rar</span></div><div class=\"line\">rar e archive.rar</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">rar a archive.rar foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<p>linux 文件解压缩</p>","more":"<h1 id=\"常见压缩文件的解压缩\"><a href=\"#常见压缩文件的解压缩\" class=\"headerlink\" title=\"常见压缩文件的解压缩\"></a>常见压缩文件的解压缩</h1><hr>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#.tar</span></div><div class=\"line\">tar xvf archive.tar</div><div class=\"line\"><span class=\"comment\">#解包</span></div><div class=\"line\">tar cvf archive.tar foo</div><div class=\"line\"><span class=\"comment\">#打包(不是压缩)</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.gz</span></div><div class=\"line\">gunzip archive.gz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">gzip -d archive.gz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">gzip foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.gz</span></div><div class=\"line\">tar zxvf archive.tar.gz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar zcvf archive.tar.gz foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.bz2</span></div><div class=\"line\">bzip2 -d archive.bz2</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">bunzip2 archive.bz2</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">bzip2 -z foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.bz2</span></div><div class=\"line\">tar jxvf archive.tar.bz2</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar jcvf archive.tar.bz2 foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.bz</span></div><div class=\"line\">bzip2 -d archive.bz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">bunzip2 archive.bz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.bz</span></div><div class=\"line\">tar jxvf archive.tar.bz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.Z</span></div><div class=\"line\">uncompress archive.Z</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">compress foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.Z</span></div><div class=\"line\">tar Zxvf archive.tar.Z</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar Zcvf archive.tar.Z foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tgz</span></div><div class=\"line\">tar zxvf archive.tgz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.tar.tgz</span></div><div class=\"line\">tar zxvf archive.tar.tgz</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">tar zcvf archive.tar.tgz foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.zip</span></div><div class=\"line\">unzip archive.zip</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">zip archive.zip foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.lha</span></div><div class=\"line\">lha -e archive.lha</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">lha -a archive.lha foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#.rar</span></div><div class=\"line\">rar e archive.rar</div><div class=\"line\"><span class=\"comment\">#解压</span></div><div class=\"line\">rar a archive.rar foo</div><div class=\"line\"><span class=\"comment\">#压缩</span></div></pre></td></tr></table></figure>"},{"title":"arch linux安装使用hexo","date":"2017-10-09T09:23:01.000Z","_content":"\n由于leanote客户端的一些故障, 所以现在迁移至github pages, 使用hexo生成静态页面, 这里写下如何在arch linux上搭建hexo环境\n\n<!-- more -->\n\n## 环境\n- 系统: arch linux\n- nodejs: v8.6.0\n- hexo: 3.3.9\n\n## 1. 安装组件\n\n安装git, nodejs, npm, hexo\n```\npacman -S git nodejs npm\nnpm config set unsafe-perm true\nnpm install hexo -g\n```\n\n## 2. 初始化及使用\n\n### 2.1 初始化\n\n创建一个文件夹blog, 进入blog\n```\nhexo init\nnpm install\nnpm install https://github.com/CodeFalling/hexo-asset-image --save\nnpm install hexo-deployer-git --save\n```\n\n### 2.2 配置\n\nhexo配置文件_config.yml\n```\n# Hexo Configuration\n## Docs: https://hexo.io/docs/configuration.html\n## Source: https://github.com/hexojs/hexo/\n\n# Site\ntitle: littleya\nsubtitle:\ndescription:\nauthor: littleya\nlanguage: en\ntimezone: Asia/Shanghai\n\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: https://littleya.github.io\nroot: /\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n\n# Directory\nsource_dir: source\npublic_dir: public\ntag_dir: tags\narchive_dir: archives\ncategory_dir: categories\ncode_dir: downloads/code\ni18n_dir: :lang\nskip_render:\n\n# Writing\nnew_post_name: :title.md # File name of new posts\ndefault_layout: post\ntitlecase: false # Transform title into titlecase\nexternal_link: true # Open external links in new tab\nfilename_case: 0\nrender_drafts: false\npost_asset_folder: true\nrelative_link: false\nfuture: true\nhighlight:\n  enable: true\n  line_number: true\n  auto_detect: false\n  tab_replace:\n  \n# Home page setting\n# path: Root path for your blogs index page. (default = '')\n# per_page: Posts displayed per page. (0 = disable pagination)\n# order_by: Posts order. (Order by date descending by default)\nindex_generator:\n  path: ''\n  per_page: 10\n  order_by: -date\n  \n# Category & Tag\ndefault_category: uncategorized\ncategory_map:\ntag_map:\n\n# Date / Time format\n## Hexo uses Moment.js to parse and display date\n## You can customize the date format as defined in\n## http://momentjs.com/docs/#/displaying/format/\ndate_format: YYYY-MM-DD\ntime_format: HH:mm:ss\n\n# Pagination\n## Set per_page to 0 to disable pagination\nper_page: 10\npagination_dir: page\n\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: yilia\n\n# Deployment\n## Docs: https://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo: git@github.com:littleya/littleya.github.io.git\n  branch: master\n\njsonContent:\n    meta: false\n    pages: false\n    posts:\n      title: true\n      date: true\n      path: true\n      text: false\n      raw: false\n      content: false\n      slug: false\n      updated: false\n      comments: false\n      link: false\n      permalink: false\n      excerpt: false\n      categories: false\n      tags: true\n```\n\nyilia配置文件_config.yml\n```\n# Header\n\nmenu:\n  Home: /\n  # 随笔: /tags/随笔/\n\n# SubNav\nsubnav:\n  github: \"#\"\n  weibo: \"#\"\n  rss: \"#\"\n  zhihu: \"#\"\n  #qq: \"#\"\n  #weixin: \"#\"\n  #jianshu: \"#\"\n  #douban: \"#\"\n  #segmentfault: \"#\"\n  #bilibili: \"#\"\n  #acfun: \"#\"\n  #mail: \"mailto:litten225@qq.com\"\n  #facebook: \"#\"\n  #google: \"#\"\n  #twitter: \"#\"\n  #linkedin: \"#\"\n\nrss: /atom.xml\n\n# 是否需要修改 root 路径\n# 如果您的网站存放在子目录中，例如 http://yoursite.com/blog，\n# 请将您的 url 设为 http://yoursite.com/blog 并把 root 设为 /blog/。\nroot: \n\n# Content\n\n# 文章太长，截断按钮文字，不需要请设置为false\nexcerpt_link: false\n# 文章卡片右下角常驻链接，不需要请设置为false\nshow_all_link: \"Read more\"\n# 数学公式\nmathjax: false\n# 是否在新窗口打开链接\nopen_in_new: false\n\n# 打赏\n# 打赏type设定：0-关闭打赏； 1-文章对应的md文件里有reward:true属性，才有打赏； 2-所有文章均有打赏\n# reward_type: 2\n# 打赏wording\n# reward_wording: '谢谢你请我吃糖果'\n# 支付宝二维码图片地址，跟你设置头像的方式一样。比如：/assets/img/alipay.jpg\n# alipay: \n# 微信二维码图片地址\n# weixin: \n\n# 目录\n# 目录设定：0-不显示目录； 1-文章对应的md文件里有toc:true属性，才有目录； 2-所有文章均显示目录\ntoc: 1\n# 根据自己的习惯来设置，如果你的目录标题习惯有标号，置为true即可隐藏hexo重复的序号；否则置为false\ntoc_hide_index: true\n# 目录为空时的提示\ntoc_empty_wording: '目录，不存在的…'\n\n# 是否有快速回到顶部的按钮\ntop: true\n\n# Miscellaneous\nbaidu_analytics: ''\ngoogle_analytics: ''\nfavicon: /favicon.png\n\n#你的头像url\navatar:\n\n#是否开启分享\nshare_jia: false\n\n#评论：1、多说；2、网易云跟帖；3、畅言；4、Disqus；5、Gitment\n#不需要使用某项，直接设置值为false，或注释掉\n#具体请参考wiki：https://github.com/litten/hexo-theme-yilia/wiki/\n\n#1、多说\nduoshuo: false\n\n#2、网易云跟帖\nwangyiyun: false\n\n#3、畅言\nchangyan_appid: false\nchangyan_conf: false\n\n#4、Disqus 在hexo根目录的config里也有disqus_shortname字段，优先使用yilia的\ndisqus: false\n\n#5、Gitment\ngitment_owner: false      #你的 GitHub ID\ngitment_repo: ''          #存储评论的 repo\ngitment_oauth:\n  client_id: ''           #client ID\n  client_secret: ''       #client secret\n\n# 样式定制 - 一般不需要修改，除非有很强的定制欲望…\nstyle:\n  # 头像上面的背景颜色\n  header: '#4d4d4d'\n  # 右滑板块背景\n  slider: 'linear-gradient(200deg,#a0cfe4,#e8c37e)'\n\n# slider的设置\nslider:\n  # 是否默认展开tags板块\n  showTags: false\n\n# 智能菜单\n# 如不需要，将该对应项置为false\n# 比如\n#smart_menu:\n#  friends: false\nsmart_menu:\n  innerArchive: 'All articles'\n  # friends: '友链'\n  aboutme: 'About me'\n\n# friends:\n#   友情链接1: http://localhost:4000/\n#   友情链接2: http://localhost:4000/\n#   友情链接3: http://localhost:4000/\n#   友情链接4: http://localhost:4000/\n#   友情链接5: http://localhost:4000/\n#   友情链接6: http://localhost:4000/\n\naboutme: 很惭愧<br><br>只做了一点微小的工作<br>谢谢大家\n```\n\n### 2.3 使用\n\n- 新建文章\n`hexo new <title>`\n\n- 新建页面\n`hexo new page <title>`\n\n- 生成静态页面\n`hexo generate`\n\n- 启用本地服务器以便于预览\n`hexo server`\n\n- 部署到github\n`hexo deploy`\n\n## 3. 通过分支保存原始文件\n\n### 3.1 部署\n\n- github创建仓库littleya.github.io\n\n- 创建两个分支: master, hexo; 设置hexo为默认分支\n\n- git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来\n\n- 参考2.1 初始化\n\n- 修改_config.yml中的deploy参数, 分支为master, 具体参考2.2 配置\n\n- 新建文件.gitignore, 忽略public/和.deploy*/两个文件夹\n\n- git add .; git commit -m \"...\"; git push origin hexo (上传hexo源文件到hexo分支)\n\n- hexo g -d (上传静态网页到master分支)\n\n### 3.2 日常使用\n\n添加修改后:\n\n- git add .; git commit -m \"...\"; git push origin hexo (上传hexo源文件到hexo分支)\n\n- hexo g -d (上传静态网页到master分支)\n\n### 3.3 切换设备\n\n- git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来\n\n- 参考 1, 2.1, 2.2进行初始化(不需要hexo init 指令)","source":"_posts/201710091723.md","raw":"---\ntitle: arch linux安装使用hexo\ndate: 2017-10-09 17:23:01\ntags:\n  - linux\n  - other\n---\n\n由于leanote客户端的一些故障, 所以现在迁移至github pages, 使用hexo生成静态页面, 这里写下如何在arch linux上搭建hexo环境\n\n<!-- more -->\n\n## 环境\n- 系统: arch linux\n- nodejs: v8.6.0\n- hexo: 3.3.9\n\n## 1. 安装组件\n\n安装git, nodejs, npm, hexo\n```\npacman -S git nodejs npm\nnpm config set unsafe-perm true\nnpm install hexo -g\n```\n\n## 2. 初始化及使用\n\n### 2.1 初始化\n\n创建一个文件夹blog, 进入blog\n```\nhexo init\nnpm install\nnpm install https://github.com/CodeFalling/hexo-asset-image --save\nnpm install hexo-deployer-git --save\n```\n\n### 2.2 配置\n\nhexo配置文件_config.yml\n```\n# Hexo Configuration\n## Docs: https://hexo.io/docs/configuration.html\n## Source: https://github.com/hexojs/hexo/\n\n# Site\ntitle: littleya\nsubtitle:\ndescription:\nauthor: littleya\nlanguage: en\ntimezone: Asia/Shanghai\n\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: https://littleya.github.io\nroot: /\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n\n# Directory\nsource_dir: source\npublic_dir: public\ntag_dir: tags\narchive_dir: archives\ncategory_dir: categories\ncode_dir: downloads/code\ni18n_dir: :lang\nskip_render:\n\n# Writing\nnew_post_name: :title.md # File name of new posts\ndefault_layout: post\ntitlecase: false # Transform title into titlecase\nexternal_link: true # Open external links in new tab\nfilename_case: 0\nrender_drafts: false\npost_asset_folder: true\nrelative_link: false\nfuture: true\nhighlight:\n  enable: true\n  line_number: true\n  auto_detect: false\n  tab_replace:\n  \n# Home page setting\n# path: Root path for your blogs index page. (default = '')\n# per_page: Posts displayed per page. (0 = disable pagination)\n# order_by: Posts order. (Order by date descending by default)\nindex_generator:\n  path: ''\n  per_page: 10\n  order_by: -date\n  \n# Category & Tag\ndefault_category: uncategorized\ncategory_map:\ntag_map:\n\n# Date / Time format\n## Hexo uses Moment.js to parse and display date\n## You can customize the date format as defined in\n## http://momentjs.com/docs/#/displaying/format/\ndate_format: YYYY-MM-DD\ntime_format: HH:mm:ss\n\n# Pagination\n## Set per_page to 0 to disable pagination\nper_page: 10\npagination_dir: page\n\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: yilia\n\n# Deployment\n## Docs: https://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo: git@github.com:littleya/littleya.github.io.git\n  branch: master\n\njsonContent:\n    meta: false\n    pages: false\n    posts:\n      title: true\n      date: true\n      path: true\n      text: false\n      raw: false\n      content: false\n      slug: false\n      updated: false\n      comments: false\n      link: false\n      permalink: false\n      excerpt: false\n      categories: false\n      tags: true\n```\n\nyilia配置文件_config.yml\n```\n# Header\n\nmenu:\n  Home: /\n  # 随笔: /tags/随笔/\n\n# SubNav\nsubnav:\n  github: \"#\"\n  weibo: \"#\"\n  rss: \"#\"\n  zhihu: \"#\"\n  #qq: \"#\"\n  #weixin: \"#\"\n  #jianshu: \"#\"\n  #douban: \"#\"\n  #segmentfault: \"#\"\n  #bilibili: \"#\"\n  #acfun: \"#\"\n  #mail: \"mailto:litten225@qq.com\"\n  #facebook: \"#\"\n  #google: \"#\"\n  #twitter: \"#\"\n  #linkedin: \"#\"\n\nrss: /atom.xml\n\n# 是否需要修改 root 路径\n# 如果您的网站存放在子目录中，例如 http://yoursite.com/blog，\n# 请将您的 url 设为 http://yoursite.com/blog 并把 root 设为 /blog/。\nroot: \n\n# Content\n\n# 文章太长，截断按钮文字，不需要请设置为false\nexcerpt_link: false\n# 文章卡片右下角常驻链接，不需要请设置为false\nshow_all_link: \"Read more\"\n# 数学公式\nmathjax: false\n# 是否在新窗口打开链接\nopen_in_new: false\n\n# 打赏\n# 打赏type设定：0-关闭打赏； 1-文章对应的md文件里有reward:true属性，才有打赏； 2-所有文章均有打赏\n# reward_type: 2\n# 打赏wording\n# reward_wording: '谢谢你请我吃糖果'\n# 支付宝二维码图片地址，跟你设置头像的方式一样。比如：/assets/img/alipay.jpg\n# alipay: \n# 微信二维码图片地址\n# weixin: \n\n# 目录\n# 目录设定：0-不显示目录； 1-文章对应的md文件里有toc:true属性，才有目录； 2-所有文章均显示目录\ntoc: 1\n# 根据自己的习惯来设置，如果你的目录标题习惯有标号，置为true即可隐藏hexo重复的序号；否则置为false\ntoc_hide_index: true\n# 目录为空时的提示\ntoc_empty_wording: '目录，不存在的…'\n\n# 是否有快速回到顶部的按钮\ntop: true\n\n# Miscellaneous\nbaidu_analytics: ''\ngoogle_analytics: ''\nfavicon: /favicon.png\n\n#你的头像url\navatar:\n\n#是否开启分享\nshare_jia: false\n\n#评论：1、多说；2、网易云跟帖；3、畅言；4、Disqus；5、Gitment\n#不需要使用某项，直接设置值为false，或注释掉\n#具体请参考wiki：https://github.com/litten/hexo-theme-yilia/wiki/\n\n#1、多说\nduoshuo: false\n\n#2、网易云跟帖\nwangyiyun: false\n\n#3、畅言\nchangyan_appid: false\nchangyan_conf: false\n\n#4、Disqus 在hexo根目录的config里也有disqus_shortname字段，优先使用yilia的\ndisqus: false\n\n#5、Gitment\ngitment_owner: false      #你的 GitHub ID\ngitment_repo: ''          #存储评论的 repo\ngitment_oauth:\n  client_id: ''           #client ID\n  client_secret: ''       #client secret\n\n# 样式定制 - 一般不需要修改，除非有很强的定制欲望…\nstyle:\n  # 头像上面的背景颜色\n  header: '#4d4d4d'\n  # 右滑板块背景\n  slider: 'linear-gradient(200deg,#a0cfe4,#e8c37e)'\n\n# slider的设置\nslider:\n  # 是否默认展开tags板块\n  showTags: false\n\n# 智能菜单\n# 如不需要，将该对应项置为false\n# 比如\n#smart_menu:\n#  friends: false\nsmart_menu:\n  innerArchive: 'All articles'\n  # friends: '友链'\n  aboutme: 'About me'\n\n# friends:\n#   友情链接1: http://localhost:4000/\n#   友情链接2: http://localhost:4000/\n#   友情链接3: http://localhost:4000/\n#   友情链接4: http://localhost:4000/\n#   友情链接5: http://localhost:4000/\n#   友情链接6: http://localhost:4000/\n\naboutme: 很惭愧<br><br>只做了一点微小的工作<br>谢谢大家\n```\n\n### 2.3 使用\n\n- 新建文章\n`hexo new <title>`\n\n- 新建页面\n`hexo new page <title>`\n\n- 生成静态页面\n`hexo generate`\n\n- 启用本地服务器以便于预览\n`hexo server`\n\n- 部署到github\n`hexo deploy`\n\n## 3. 通过分支保存原始文件\n\n### 3.1 部署\n\n- github创建仓库littleya.github.io\n\n- 创建两个分支: master, hexo; 设置hexo为默认分支\n\n- git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来\n\n- 参考2.1 初始化\n\n- 修改_config.yml中的deploy参数, 分支为master, 具体参考2.2 配置\n\n- 新建文件.gitignore, 忽略public/和.deploy*/两个文件夹\n\n- git add .; git commit -m \"...\"; git push origin hexo (上传hexo源文件到hexo分支)\n\n- hexo g -d (上传静态网页到master分支)\n\n### 3.2 日常使用\n\n添加修改后:\n\n- git add .; git commit -m \"...\"; git push origin hexo (上传hexo源文件到hexo分支)\n\n- hexo g -d (上传静态网页到master分支)\n\n### 3.3 切换设备\n\n- git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来\n\n- 参考 1, 2.1, 2.2进行初始化(不需要hexo init 指令)","slug":"201710091723","published":1,"updated":"2017-10-09T10:54:49.360Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj8k2a26c000mzizpja4q2k33","content":"<p>由于leanote客户端的一些故障, 所以现在迁移至github pages, 使用hexo生成静态页面, 这里写下如何在arch linux上搭建hexo环境</p>\n<a id=\"more\"></a>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li>系统: arch linux</li>\n<li>nodejs: v8.6.0</li>\n<li>hexo: 3.3.9</li>\n</ul>\n<h2 id=\"1-安装组件\"><a href=\"#1-安装组件\" class=\"headerlink\" title=\"1. 安装组件\"></a>1. 安装组件</h2><p>安装git, nodejs, npm, hexo<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">pacman -S git nodejs npm</div><div class=\"line\">npm config set unsafe-perm true</div><div class=\"line\">npm install hexo -g</div></pre></td></tr></table></figure></p>\n<h2 id=\"2-初始化及使用\"><a href=\"#2-初始化及使用\" class=\"headerlink\" title=\"2. 初始化及使用\"></a>2. 初始化及使用</h2><h3 id=\"2-1-初始化\"><a href=\"#2-1-初始化\" class=\"headerlink\" title=\"2.1 初始化\"></a>2.1 初始化</h3><p>创建一个文件夹blog, 进入blog<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo init</div><div class=\"line\">npm install</div><div class=\"line\">npm install https://github.com/CodeFalling/hexo-asset-image --save</div><div class=\"line\">npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-2-配置\"><a href=\"#2-2-配置\" class=\"headerlink\" title=\"2.2 配置\"></a>2.2 配置</h3><p>hexo配置文件_config.yml<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Hexo Configuration</div><div class=\"line\">## Docs: https://hexo.io/docs/configuration.html</div><div class=\"line\">## Source: https://github.com/hexojs/hexo/</div><div class=\"line\"></div><div class=\"line\"># Site</div><div class=\"line\">title: littleya</div><div class=\"line\">subtitle:</div><div class=\"line\">description:</div><div class=\"line\">author: littleya</div><div class=\"line\">language: en</div><div class=\"line\">timezone: Asia/Shanghai</div><div class=\"line\"></div><div class=\"line\"># URL</div><div class=\"line\">## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;</div><div class=\"line\">url: https://littleya.github.io</div><div class=\"line\">root: /</div><div class=\"line\">permalink: :year/:month/:day/:title/</div><div class=\"line\">permalink_defaults:</div><div class=\"line\"></div><div class=\"line\"># Directory</div><div class=\"line\">source_dir: source</div><div class=\"line\">public_dir: public</div><div class=\"line\">tag_dir: tags</div><div class=\"line\">archive_dir: archives</div><div class=\"line\">category_dir: categories</div><div class=\"line\">code_dir: downloads/code</div><div class=\"line\">i18n_dir: :lang</div><div class=\"line\">skip_render:</div><div class=\"line\"></div><div class=\"line\"># Writing</div><div class=\"line\">new_post_name: :title.md # File name of new posts</div><div class=\"line\">default_layout: post</div><div class=\"line\">titlecase: false # Transform title into titlecase</div><div class=\"line\">external_link: true # Open external links in new tab</div><div class=\"line\">filename_case: 0</div><div class=\"line\">render_drafts: false</div><div class=\"line\">post_asset_folder: true</div><div class=\"line\">relative_link: false</div><div class=\"line\">future: true</div><div class=\"line\">highlight:</div><div class=\"line\">  enable: true</div><div class=\"line\">  line_number: true</div><div class=\"line\">  auto_detect: false</div><div class=\"line\">  tab_replace:</div><div class=\"line\">  </div><div class=\"line\"># Home page setting</div><div class=\"line\"># path: Root path for your blogs index page. (default = &apos;&apos;)</div><div class=\"line\"># per_page: Posts displayed per page. (0 = disable pagination)</div><div class=\"line\"># order_by: Posts order. (Order by date descending by default)</div><div class=\"line\">index_generator:</div><div class=\"line\">  path: &apos;&apos;</div><div class=\"line\">  per_page: 10</div><div class=\"line\">  order_by: -date</div><div class=\"line\">  </div><div class=\"line\"># Category &amp; Tag</div><div class=\"line\">default_category: uncategorized</div><div class=\"line\">category_map:</div><div class=\"line\">tag_map:</div><div class=\"line\"></div><div class=\"line\"># Date / Time format</div><div class=\"line\">## Hexo uses Moment.js to parse and display date</div><div class=\"line\">## You can customize the date format as defined in</div><div class=\"line\">## http://momentjs.com/docs/#/displaying/format/</div><div class=\"line\">date_format: YYYY-MM-DD</div><div class=\"line\">time_format: HH:mm:ss</div><div class=\"line\"></div><div class=\"line\"># Pagination</div><div class=\"line\">## Set per_page to 0 to disable pagination</div><div class=\"line\">per_page: 10</div><div class=\"line\">pagination_dir: page</div><div class=\"line\"></div><div class=\"line\"># Extensions</div><div class=\"line\">## Plugins: https://hexo.io/plugins/</div><div class=\"line\">## Themes: https://hexo.io/themes/</div><div class=\"line\">theme: yilia</div><div class=\"line\"></div><div class=\"line\"># Deployment</div><div class=\"line\">## Docs: https://hexo.io/docs/deployment.html</div><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: git@github.com:littleya/littleya.github.io.git</div><div class=\"line\">  branch: master</div><div class=\"line\"></div><div class=\"line\">jsonContent:</div><div class=\"line\">    meta: false</div><div class=\"line\">    pages: false</div><div class=\"line\">    posts:</div><div class=\"line\">      title: true</div><div class=\"line\">      date: true</div><div class=\"line\">      path: true</div><div class=\"line\">      text: false</div><div class=\"line\">      raw: false</div><div class=\"line\">      content: false</div><div class=\"line\">      slug: false</div><div class=\"line\">      updated: false</div><div class=\"line\">      comments: false</div><div class=\"line\">      link: false</div><div class=\"line\">      permalink: false</div><div class=\"line\">      excerpt: false</div><div class=\"line\">      categories: false</div><div class=\"line\">      tags: true</div></pre></td></tr></table></figure></p>\n<p>yilia配置文件_config.yml<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Header</div><div class=\"line\"></div><div class=\"line\">menu:</div><div class=\"line\">  Home: /</div><div class=\"line\">  # 随笔: /tags/随笔/</div><div class=\"line\"></div><div class=\"line\"># SubNav</div><div class=\"line\">subnav:</div><div class=\"line\">  github: &quot;#&quot;</div><div class=\"line\">  weibo: &quot;#&quot;</div><div class=\"line\">  rss: &quot;#&quot;</div><div class=\"line\">  zhihu: &quot;#&quot;</div><div class=\"line\">  #qq: &quot;#&quot;</div><div class=\"line\">  #weixin: &quot;#&quot;</div><div class=\"line\">  #jianshu: &quot;#&quot;</div><div class=\"line\">  #douban: &quot;#&quot;</div><div class=\"line\">  #segmentfault: &quot;#&quot;</div><div class=\"line\">  #bilibili: &quot;#&quot;</div><div class=\"line\">  #acfun: &quot;#&quot;</div><div class=\"line\">  #mail: &quot;mailto:litten225@qq.com&quot;</div><div class=\"line\">  #facebook: &quot;#&quot;</div><div class=\"line\">  #google: &quot;#&quot;</div><div class=\"line\">  #twitter: &quot;#&quot;</div><div class=\"line\">  #linkedin: &quot;#&quot;</div><div class=\"line\"></div><div class=\"line\">rss: /atom.xml</div><div class=\"line\"></div><div class=\"line\"># 是否需要修改 root 路径</div><div class=\"line\"># 如果您的网站存放在子目录中，例如 http://yoursite.com/blog，</div><div class=\"line\"># 请将您的 url 设为 http://yoursite.com/blog 并把 root 设为 /blog/。</div><div class=\"line\">root: </div><div class=\"line\"></div><div class=\"line\"># Content</div><div class=\"line\"></div><div class=\"line\"># 文章太长，截断按钮文字，不需要请设置为false</div><div class=\"line\">excerpt_link: false</div><div class=\"line\"># 文章卡片右下角常驻链接，不需要请设置为false</div><div class=\"line\">show_all_link: &quot;Read more&quot;</div><div class=\"line\"># 数学公式</div><div class=\"line\">mathjax: false</div><div class=\"line\"># 是否在新窗口打开链接</div><div class=\"line\">open_in_new: false</div><div class=\"line\"></div><div class=\"line\"># 打赏</div><div class=\"line\"># 打赏type设定：0-关闭打赏； 1-文章对应的md文件里有reward:true属性，才有打赏； 2-所有文章均有打赏</div><div class=\"line\"># reward_type: 2</div><div class=\"line\"># 打赏wording</div><div class=\"line\"># reward_wording: &apos;谢谢你请我吃糖果&apos;</div><div class=\"line\"># 支付宝二维码图片地址，跟你设置头像的方式一样。比如：/assets/img/alipay.jpg</div><div class=\"line\"># alipay: </div><div class=\"line\"># 微信二维码图片地址</div><div class=\"line\"># weixin: </div><div class=\"line\"></div><div class=\"line\"># 目录</div><div class=\"line\"># 目录设定：0-不显示目录； 1-文章对应的md文件里有toc:true属性，才有目录； 2-所有文章均显示目录</div><div class=\"line\">toc: 1</div><div class=\"line\"># 根据自己的习惯来设置，如果你的目录标题习惯有标号，置为true即可隐藏hexo重复的序号；否则置为false</div><div class=\"line\">toc_hide_index: true</div><div class=\"line\"># 目录为空时的提示</div><div class=\"line\">toc_empty_wording: &apos;目录，不存在的…&apos;</div><div class=\"line\"></div><div class=\"line\"># 是否有快速回到顶部的按钮</div><div class=\"line\">top: true</div><div class=\"line\"></div><div class=\"line\"># Miscellaneous</div><div class=\"line\">baidu_analytics: &apos;&apos;</div><div class=\"line\">google_analytics: &apos;&apos;</div><div class=\"line\">favicon: /favicon.png</div><div class=\"line\"></div><div class=\"line\">#你的头像url</div><div class=\"line\">avatar:</div><div class=\"line\"></div><div class=\"line\">#是否开启分享</div><div class=\"line\">share_jia: false</div><div class=\"line\"></div><div class=\"line\">#评论：1、多说；2、网易云跟帖；3、畅言；4、Disqus；5、Gitment</div><div class=\"line\">#不需要使用某项，直接设置值为false，或注释掉</div><div class=\"line\">#具体请参考wiki：https://github.com/litten/hexo-theme-yilia/wiki/</div><div class=\"line\"></div><div class=\"line\">#1、多说</div><div class=\"line\">duoshuo: false</div><div class=\"line\"></div><div class=\"line\">#2、网易云跟帖</div><div class=\"line\">wangyiyun: false</div><div class=\"line\"></div><div class=\"line\">#3、畅言</div><div class=\"line\">changyan_appid: false</div><div class=\"line\">changyan_conf: false</div><div class=\"line\"></div><div class=\"line\">#4、Disqus 在hexo根目录的config里也有disqus_shortname字段，优先使用yilia的</div><div class=\"line\">disqus: false</div><div class=\"line\"></div><div class=\"line\">#5、Gitment</div><div class=\"line\">gitment_owner: false      #你的 GitHub ID</div><div class=\"line\">gitment_repo: &apos;&apos;          #存储评论的 repo</div><div class=\"line\">gitment_oauth:</div><div class=\"line\">  client_id: &apos;&apos;           #client ID</div><div class=\"line\">  client_secret: &apos;&apos;       #client secret</div><div class=\"line\"></div><div class=\"line\"># 样式定制 - 一般不需要修改，除非有很强的定制欲望…</div><div class=\"line\">style:</div><div class=\"line\">  # 头像上面的背景颜色</div><div class=\"line\">  header: &apos;#4d4d4d&apos;</div><div class=\"line\">  # 右滑板块背景</div><div class=\"line\">  slider: &apos;linear-gradient(200deg,#a0cfe4,#e8c37e)&apos;</div><div class=\"line\"></div><div class=\"line\"># slider的设置</div><div class=\"line\">slider:</div><div class=\"line\">  # 是否默认展开tags板块</div><div class=\"line\">  showTags: false</div><div class=\"line\"></div><div class=\"line\"># 智能菜单</div><div class=\"line\"># 如不需要，将该对应项置为false</div><div class=\"line\"># 比如</div><div class=\"line\">#smart_menu:</div><div class=\"line\">#  friends: false</div><div class=\"line\">smart_menu:</div><div class=\"line\">  innerArchive: &apos;All articles&apos;</div><div class=\"line\">  # friends: &apos;友链&apos;</div><div class=\"line\">  aboutme: &apos;About me&apos;</div><div class=\"line\"></div><div class=\"line\"># friends:</div><div class=\"line\">#   友情链接1: http://localhost:4000/</div><div class=\"line\">#   友情链接2: http://localhost:4000/</div><div class=\"line\">#   友情链接3: http://localhost:4000/</div><div class=\"line\">#   友情链接4: http://localhost:4000/</div><div class=\"line\">#   友情链接5: http://localhost:4000/</div><div class=\"line\">#   友情链接6: http://localhost:4000/</div><div class=\"line\"></div><div class=\"line\">aboutme: 很惭愧&lt;br&gt;&lt;br&gt;只做了一点微小的工作&lt;br&gt;谢谢大家</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-使用\"><a href=\"#2-3-使用\" class=\"headerlink\" title=\"2.3 使用\"></a>2.3 使用</h3><ul>\n<li><p>新建文章<br><code>hexo new &lt;title&gt;</code></p>\n</li>\n<li><p>新建页面<br><code>hexo new page &lt;title&gt;</code></p>\n</li>\n<li><p>生成静态页面<br><code>hexo generate</code></p>\n</li>\n<li><p>启用本地服务器以便于预览<br><code>hexo server</code></p>\n</li>\n<li><p>部署到github<br><code>hexo deploy</code></p>\n</li>\n</ul>\n<h2 id=\"3-通过分支保存原始文件\"><a href=\"#3-通过分支保存原始文件\" class=\"headerlink\" title=\"3. 通过分支保存原始文件\"></a>3. 通过分支保存原始文件</h2><h3 id=\"3-1-部署\"><a href=\"#3-1-部署\" class=\"headerlink\" title=\"3.1 部署\"></a>3.1 部署</h3><ul>\n<li><p>github创建仓库littleya.github.io</p>\n</li>\n<li><p>创建两个分支: master, hexo; 设置hexo为默认分支</p>\n</li>\n<li><p>git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来</p>\n</li>\n<li><p>参考2.1 初始化</p>\n</li>\n<li><p>修改_config.yml中的deploy参数, 分支为master, 具体参考2.2 配置</p>\n</li>\n<li><p>新建文件.gitignore, 忽略public/和.deploy*/两个文件夹</p>\n</li>\n<li><p>git add .; git commit -m “…”; git push origin hexo (上传hexo源文件到hexo分支)</p>\n</li>\n<li><p>hexo g -d (上传静态网页到master分支)</p>\n</li>\n</ul>\n<h3 id=\"3-2-日常使用\"><a href=\"#3-2-日常使用\" class=\"headerlink\" title=\"3.2 日常使用\"></a>3.2 日常使用</h3><p>添加修改后:</p>\n<ul>\n<li><p>git add .; git commit -m “…”; git push origin hexo (上传hexo源文件到hexo分支)</p>\n</li>\n<li><p>hexo g -d (上传静态网页到master分支)</p>\n</li>\n</ul>\n<h3 id=\"3-3-切换设备\"><a href=\"#3-3-切换设备\" class=\"headerlink\" title=\"3.3 切换设备\"></a>3.3 切换设备</h3><ul>\n<li><p>git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来</p>\n</li>\n<li><p>参考 1, 2.1, 2.2进行初始化(不需要hexo init 指令)</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>由于leanote客户端的一些故障, 所以现在迁移至github pages, 使用hexo生成静态页面, 这里写下如何在arch linux上搭建hexo环境</p>","more":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li>系统: arch linux</li>\n<li>nodejs: v8.6.0</li>\n<li>hexo: 3.3.9</li>\n</ul>\n<h2 id=\"1-安装组件\"><a href=\"#1-安装组件\" class=\"headerlink\" title=\"1. 安装组件\"></a>1. 安装组件</h2><p>安装git, nodejs, npm, hexo<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">pacman -S git nodejs npm</div><div class=\"line\">npm config set unsafe-perm true</div><div class=\"line\">npm install hexo -g</div></pre></td></tr></table></figure></p>\n<h2 id=\"2-初始化及使用\"><a href=\"#2-初始化及使用\" class=\"headerlink\" title=\"2. 初始化及使用\"></a>2. 初始化及使用</h2><h3 id=\"2-1-初始化\"><a href=\"#2-1-初始化\" class=\"headerlink\" title=\"2.1 初始化\"></a>2.1 初始化</h3><p>创建一个文件夹blog, 进入blog<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo init</div><div class=\"line\">npm install</div><div class=\"line\">npm install https://github.com/CodeFalling/hexo-asset-image --save</div><div class=\"line\">npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-2-配置\"><a href=\"#2-2-配置\" class=\"headerlink\" title=\"2.2 配置\"></a>2.2 配置</h3><p>hexo配置文件_config.yml<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Hexo Configuration</div><div class=\"line\">## Docs: https://hexo.io/docs/configuration.html</div><div class=\"line\">## Source: https://github.com/hexojs/hexo/</div><div class=\"line\"></div><div class=\"line\"># Site</div><div class=\"line\">title: littleya</div><div class=\"line\">subtitle:</div><div class=\"line\">description:</div><div class=\"line\">author: littleya</div><div class=\"line\">language: en</div><div class=\"line\">timezone: Asia/Shanghai</div><div class=\"line\"></div><div class=\"line\"># URL</div><div class=\"line\">## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;</div><div class=\"line\">url: https://littleya.github.io</div><div class=\"line\">root: /</div><div class=\"line\">permalink: :year/:month/:day/:title/</div><div class=\"line\">permalink_defaults:</div><div class=\"line\"></div><div class=\"line\"># Directory</div><div class=\"line\">source_dir: source</div><div class=\"line\">public_dir: public</div><div class=\"line\">tag_dir: tags</div><div class=\"line\">archive_dir: archives</div><div class=\"line\">category_dir: categories</div><div class=\"line\">code_dir: downloads/code</div><div class=\"line\">i18n_dir: :lang</div><div class=\"line\">skip_render:</div><div class=\"line\"></div><div class=\"line\"># Writing</div><div class=\"line\">new_post_name: :title.md # File name of new posts</div><div class=\"line\">default_layout: post</div><div class=\"line\">titlecase: false # Transform title into titlecase</div><div class=\"line\">external_link: true # Open external links in new tab</div><div class=\"line\">filename_case: 0</div><div class=\"line\">render_drafts: false</div><div class=\"line\">post_asset_folder: true</div><div class=\"line\">relative_link: false</div><div class=\"line\">future: true</div><div class=\"line\">highlight:</div><div class=\"line\">  enable: true</div><div class=\"line\">  line_number: true</div><div class=\"line\">  auto_detect: false</div><div class=\"line\">  tab_replace:</div><div class=\"line\">  </div><div class=\"line\"># Home page setting</div><div class=\"line\"># path: Root path for your blogs index page. (default = &apos;&apos;)</div><div class=\"line\"># per_page: Posts displayed per page. (0 = disable pagination)</div><div class=\"line\"># order_by: Posts order. (Order by date descending by default)</div><div class=\"line\">index_generator:</div><div class=\"line\">  path: &apos;&apos;</div><div class=\"line\">  per_page: 10</div><div class=\"line\">  order_by: -date</div><div class=\"line\">  </div><div class=\"line\"># Category &amp; Tag</div><div class=\"line\">default_category: uncategorized</div><div class=\"line\">category_map:</div><div class=\"line\">tag_map:</div><div class=\"line\"></div><div class=\"line\"># Date / Time format</div><div class=\"line\">## Hexo uses Moment.js to parse and display date</div><div class=\"line\">## You can customize the date format as defined in</div><div class=\"line\">## http://momentjs.com/docs/#/displaying/format/</div><div class=\"line\">date_format: YYYY-MM-DD</div><div class=\"line\">time_format: HH:mm:ss</div><div class=\"line\"></div><div class=\"line\"># Pagination</div><div class=\"line\">## Set per_page to 0 to disable pagination</div><div class=\"line\">per_page: 10</div><div class=\"line\">pagination_dir: page</div><div class=\"line\"></div><div class=\"line\"># Extensions</div><div class=\"line\">## Plugins: https://hexo.io/plugins/</div><div class=\"line\">## Themes: https://hexo.io/themes/</div><div class=\"line\">theme: yilia</div><div class=\"line\"></div><div class=\"line\"># Deployment</div><div class=\"line\">## Docs: https://hexo.io/docs/deployment.html</div><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: git@github.com:littleya/littleya.github.io.git</div><div class=\"line\">  branch: master</div><div class=\"line\"></div><div class=\"line\">jsonContent:</div><div class=\"line\">    meta: false</div><div class=\"line\">    pages: false</div><div class=\"line\">    posts:</div><div class=\"line\">      title: true</div><div class=\"line\">      date: true</div><div class=\"line\">      path: true</div><div class=\"line\">      text: false</div><div class=\"line\">      raw: false</div><div class=\"line\">      content: false</div><div class=\"line\">      slug: false</div><div class=\"line\">      updated: false</div><div class=\"line\">      comments: false</div><div class=\"line\">      link: false</div><div class=\"line\">      permalink: false</div><div class=\"line\">      excerpt: false</div><div class=\"line\">      categories: false</div><div class=\"line\">      tags: true</div></pre></td></tr></table></figure></p>\n<p>yilia配置文件_config.yml<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Header</div><div class=\"line\"></div><div class=\"line\">menu:</div><div class=\"line\">  Home: /</div><div class=\"line\">  # 随笔: /tags/随笔/</div><div class=\"line\"></div><div class=\"line\"># SubNav</div><div class=\"line\">subnav:</div><div class=\"line\">  github: &quot;#&quot;</div><div class=\"line\">  weibo: &quot;#&quot;</div><div class=\"line\">  rss: &quot;#&quot;</div><div class=\"line\">  zhihu: &quot;#&quot;</div><div class=\"line\">  #qq: &quot;#&quot;</div><div class=\"line\">  #weixin: &quot;#&quot;</div><div class=\"line\">  #jianshu: &quot;#&quot;</div><div class=\"line\">  #douban: &quot;#&quot;</div><div class=\"line\">  #segmentfault: &quot;#&quot;</div><div class=\"line\">  #bilibili: &quot;#&quot;</div><div class=\"line\">  #acfun: &quot;#&quot;</div><div class=\"line\">  #mail: &quot;mailto:litten225@qq.com&quot;</div><div class=\"line\">  #facebook: &quot;#&quot;</div><div class=\"line\">  #google: &quot;#&quot;</div><div class=\"line\">  #twitter: &quot;#&quot;</div><div class=\"line\">  #linkedin: &quot;#&quot;</div><div class=\"line\"></div><div class=\"line\">rss: /atom.xml</div><div class=\"line\"></div><div class=\"line\"># 是否需要修改 root 路径</div><div class=\"line\"># 如果您的网站存放在子目录中，例如 http://yoursite.com/blog，</div><div class=\"line\"># 请将您的 url 设为 http://yoursite.com/blog 并把 root 设为 /blog/。</div><div class=\"line\">root: </div><div class=\"line\"></div><div class=\"line\"># Content</div><div class=\"line\"></div><div class=\"line\"># 文章太长，截断按钮文字，不需要请设置为false</div><div class=\"line\">excerpt_link: false</div><div class=\"line\"># 文章卡片右下角常驻链接，不需要请设置为false</div><div class=\"line\">show_all_link: &quot;Read more&quot;</div><div class=\"line\"># 数学公式</div><div class=\"line\">mathjax: false</div><div class=\"line\"># 是否在新窗口打开链接</div><div class=\"line\">open_in_new: false</div><div class=\"line\"></div><div class=\"line\"># 打赏</div><div class=\"line\"># 打赏type设定：0-关闭打赏； 1-文章对应的md文件里有reward:true属性，才有打赏； 2-所有文章均有打赏</div><div class=\"line\"># reward_type: 2</div><div class=\"line\"># 打赏wording</div><div class=\"line\"># reward_wording: &apos;谢谢你请我吃糖果&apos;</div><div class=\"line\"># 支付宝二维码图片地址，跟你设置头像的方式一样。比如：/assets/img/alipay.jpg</div><div class=\"line\"># alipay: </div><div class=\"line\"># 微信二维码图片地址</div><div class=\"line\"># weixin: </div><div class=\"line\"></div><div class=\"line\"># 目录</div><div class=\"line\"># 目录设定：0-不显示目录； 1-文章对应的md文件里有toc:true属性，才有目录； 2-所有文章均显示目录</div><div class=\"line\">toc: 1</div><div class=\"line\"># 根据自己的习惯来设置，如果你的目录标题习惯有标号，置为true即可隐藏hexo重复的序号；否则置为false</div><div class=\"line\">toc_hide_index: true</div><div class=\"line\"># 目录为空时的提示</div><div class=\"line\">toc_empty_wording: &apos;目录，不存在的…&apos;</div><div class=\"line\"></div><div class=\"line\"># 是否有快速回到顶部的按钮</div><div class=\"line\">top: true</div><div class=\"line\"></div><div class=\"line\"># Miscellaneous</div><div class=\"line\">baidu_analytics: &apos;&apos;</div><div class=\"line\">google_analytics: &apos;&apos;</div><div class=\"line\">favicon: /favicon.png</div><div class=\"line\"></div><div class=\"line\">#你的头像url</div><div class=\"line\">avatar:</div><div class=\"line\"></div><div class=\"line\">#是否开启分享</div><div class=\"line\">share_jia: false</div><div class=\"line\"></div><div class=\"line\">#评论：1、多说；2、网易云跟帖；3、畅言；4、Disqus；5、Gitment</div><div class=\"line\">#不需要使用某项，直接设置值为false，或注释掉</div><div class=\"line\">#具体请参考wiki：https://github.com/litten/hexo-theme-yilia/wiki/</div><div class=\"line\"></div><div class=\"line\">#1、多说</div><div class=\"line\">duoshuo: false</div><div class=\"line\"></div><div class=\"line\">#2、网易云跟帖</div><div class=\"line\">wangyiyun: false</div><div class=\"line\"></div><div class=\"line\">#3、畅言</div><div class=\"line\">changyan_appid: false</div><div class=\"line\">changyan_conf: false</div><div class=\"line\"></div><div class=\"line\">#4、Disqus 在hexo根目录的config里也有disqus_shortname字段，优先使用yilia的</div><div class=\"line\">disqus: false</div><div class=\"line\"></div><div class=\"line\">#5、Gitment</div><div class=\"line\">gitment_owner: false      #你的 GitHub ID</div><div class=\"line\">gitment_repo: &apos;&apos;          #存储评论的 repo</div><div class=\"line\">gitment_oauth:</div><div class=\"line\">  client_id: &apos;&apos;           #client ID</div><div class=\"line\">  client_secret: &apos;&apos;       #client secret</div><div class=\"line\"></div><div class=\"line\"># 样式定制 - 一般不需要修改，除非有很强的定制欲望…</div><div class=\"line\">style:</div><div class=\"line\">  # 头像上面的背景颜色</div><div class=\"line\">  header: &apos;#4d4d4d&apos;</div><div class=\"line\">  # 右滑板块背景</div><div class=\"line\">  slider: &apos;linear-gradient(200deg,#a0cfe4,#e8c37e)&apos;</div><div class=\"line\"></div><div class=\"line\"># slider的设置</div><div class=\"line\">slider:</div><div class=\"line\">  # 是否默认展开tags板块</div><div class=\"line\">  showTags: false</div><div class=\"line\"></div><div class=\"line\"># 智能菜单</div><div class=\"line\"># 如不需要，将该对应项置为false</div><div class=\"line\"># 比如</div><div class=\"line\">#smart_menu:</div><div class=\"line\">#  friends: false</div><div class=\"line\">smart_menu:</div><div class=\"line\">  innerArchive: &apos;All articles&apos;</div><div class=\"line\">  # friends: &apos;友链&apos;</div><div class=\"line\">  aboutme: &apos;About me&apos;</div><div class=\"line\"></div><div class=\"line\"># friends:</div><div class=\"line\">#   友情链接1: http://localhost:4000/</div><div class=\"line\">#   友情链接2: http://localhost:4000/</div><div class=\"line\">#   友情链接3: http://localhost:4000/</div><div class=\"line\">#   友情链接4: http://localhost:4000/</div><div class=\"line\">#   友情链接5: http://localhost:4000/</div><div class=\"line\">#   友情链接6: http://localhost:4000/</div><div class=\"line\"></div><div class=\"line\">aboutme: 很惭愧&lt;br&gt;&lt;br&gt;只做了一点微小的工作&lt;br&gt;谢谢大家</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-使用\"><a href=\"#2-3-使用\" class=\"headerlink\" title=\"2.3 使用\"></a>2.3 使用</h3><ul>\n<li><p>新建文章<br><code>hexo new &lt;title&gt;</code></p>\n</li>\n<li><p>新建页面<br><code>hexo new page &lt;title&gt;</code></p>\n</li>\n<li><p>生成静态页面<br><code>hexo generate</code></p>\n</li>\n<li><p>启用本地服务器以便于预览<br><code>hexo server</code></p>\n</li>\n<li><p>部署到github<br><code>hexo deploy</code></p>\n</li>\n</ul>\n<h2 id=\"3-通过分支保存原始文件\"><a href=\"#3-通过分支保存原始文件\" class=\"headerlink\" title=\"3. 通过分支保存原始文件\"></a>3. 通过分支保存原始文件</h2><h3 id=\"3-1-部署\"><a href=\"#3-1-部署\" class=\"headerlink\" title=\"3.1 部署\"></a>3.1 部署</h3><ul>\n<li><p>github创建仓库littleya.github.io</p>\n</li>\n<li><p>创建两个分支: master, hexo; 设置hexo为默认分支</p>\n</li>\n<li><p>git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来</p>\n</li>\n<li><p>参考2.1 初始化</p>\n</li>\n<li><p>修改_config.yml中的deploy参数, 分支为master, 具体参考2.2 配置</p>\n</li>\n<li><p>新建文件.gitignore, 忽略public/和.deploy*/两个文件夹</p>\n</li>\n<li><p>git add .; git commit -m “…”; git push origin hexo (上传hexo源文件到hexo分支)</p>\n</li>\n<li><p>hexo g -d (上传静态网页到master分支)</p>\n</li>\n</ul>\n<h3 id=\"3-2-日常使用\"><a href=\"#3-2-日常使用\" class=\"headerlink\" title=\"3.2 日常使用\"></a>3.2 日常使用</h3><p>添加修改后:</p>\n<ul>\n<li><p>git add .; git commit -m “…”; git push origin hexo (上传hexo源文件到hexo分支)</p>\n</li>\n<li><p>hexo g -d (上传静态网页到master分支)</p>\n</li>\n</ul>\n<h3 id=\"3-3-切换设备\"><a href=\"#3-3-切换设备\" class=\"headerlink\" title=\"3.3 切换设备\"></a>3.3 切换设备</h3><ul>\n<li><p>git clone git@github.com:littleya/littleya.github.io.git 将仓库拉下来</p>\n</li>\n<li><p>参考 1, 2.1, 2.2进行初始化(不需要hexo init 指令)</p>\n</li>\n</ul>"}],"PostAsset":[{"_id":"source/_posts/201710091601/183e05351cd1cd68.jpg","slug":"183e05351cd1cd68.jpg","post":"cj8k2a24r0000zizpavcpsk1z","modified":1,"renderable":0},{"_id":"source/_posts/201710091601/295ffe7e24431533.jpg","slug":"295ffe7e24431533.jpg","post":"cj8k2a24r0000zizpavcpsk1z","modified":1,"renderable":0},{"_id":"source/_posts/201710091601/59918027883d893c.jpg","slug":"59918027883d893c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","modified":1,"renderable":0},{"_id":"source/_posts/201710091601/68b12c83fd82b947.jpg","slug":"68b12c83fd82b947.jpg","post":"cj8k2a24r0000zizpavcpsk1z","modified":1,"renderable":0},{"_id":"source/_posts/201710091601/90b48b8f16df2557.jpg","slug":"90b48b8f16df2557.jpg","post":"cj8k2a24r0000zizpavcpsk1z","modified":1,"renderable":0},{"_id":"source/_posts/201710091601/ba39d3720b24a03f.jpg","slug":"ba39d3720b24a03f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","modified":1,"renderable":0},{"_id":"source/_posts/201710091643/183e05351cd1cd68.jpg","slug":"183e05351cd1cd68.jpg","post":"cj8k2a24w0001zizpmwxpmio4","modified":1,"renderable":0},{"_id":"source/_posts/201710091643/295ffe7e24431533.jpg","slug":"295ffe7e24431533.jpg","post":"cj8k2a24w0001zizpmwxpmio4","modified":1,"renderable":0},{"_id":"source/_posts/201710091643/59918027883d893c.jpg","slug":"59918027883d893c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","modified":1,"renderable":0},{"_id":"source/_posts/201710091643/68b12c83fd82b947.jpg","slug":"68b12c83fd82b947.jpg","post":"cj8k2a24w0001zizpmwxpmio4","modified":1,"renderable":0},{"_id":"source/_posts/201710091643/90b48b8f16df2557.jpg","slug":"90b48b8f16df2557.jpg","post":"cj8k2a24w0001zizpmwxpmio4","modified":1,"renderable":0},{"_id":"source/_posts/201710091643/ba39d3720b24a03f.jpg","slug":"ba39d3720b24a03f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","modified":1,"renderable":0},{"_id":"source/_posts/201710091601/031b589e22e15416.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"031b589e22e15416.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/06132485ab59545a.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"06132485ab59545a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/06c092ba2bbcc190.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"06c092ba2bbcc190.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/07d3ef73b5c3f8ce.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"07d3ef73b5c3f8ce.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/0afa78fbca1dc288.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"0afa78fbca1dc288.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/0c837e38c20eba10.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"0c837e38c20eba10.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/0cfc23cd25d88711.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"0cfc23cd25d88711.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/0e655e34fd585501.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"0e655e34fd585501.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/0feee6754fbdf152.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"0feee6754fbdf152.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/1508a77d6a8ea1c8.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"1508a77d6a8ea1c8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/1673c7249c05f467.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"1673c7249c05f467.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/180a716339eaac7d.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"180a716339eaac7d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/1a594160a1ba91e0.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"1a594160a1ba91e0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/1cda4b829db27966.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"1cda4b829db27966.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/1d6b5e876b43563e.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"1d6b5e876b43563e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/21eef25b932cef4f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"21eef25b932cef4f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/2324f721115c3785.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"2324f721115c3785.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/2354389b190af5b4.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"2354389b190af5b4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/266f5cf2a5c7db28.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"266f5cf2a5c7db28.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/2a5be182dfce2f21.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"2a5be182dfce2f21.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/2d6ca36262af1fb1.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"2d6ca36262af1fb1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/2d95d2595ef8cf3b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"2d95d2595ef8cf3b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/2f56d5f920ff1ade.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"2f56d5f920ff1ade.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/32e3eb023f6ee3ba.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"32e3eb023f6ee3ba.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/339c821002d465d5.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"339c821002d465d5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/37bfc853a59b3cea.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"37bfc853a59b3cea.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/3d6c3c2b7962e631.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"3d6c3c2b7962e631.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/42997c9404fbb3c5.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"42997c9404fbb3c5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/42d722931576c18a.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"42d722931576c18a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/48071838f3615424.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"48071838f3615424.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/4812df9dc90e7725.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"4812df9dc90e7725.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/4c9a2f038cdaeb71.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"4c9a2f038cdaeb71.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/50b60481426d3afd.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"50b60481426d3afd.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/528dcf36c7d52e6e.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"528dcf36c7d52e6e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/545eaec054fd5218.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"545eaec054fd5218.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/551b7ab676551748.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"551b7ab676551748.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/566bae7cacf04cc7.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"566bae7cacf04cc7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/5691d99da449aeb2.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"5691d99da449aeb2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/5a74c07b6f07c6d7.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"5a74c07b6f07c6d7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/5ae453ac46cb1abd.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"5ae453ac46cb1abd.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/5b4ae1ddf38c5bac.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"5b4ae1ddf38c5bac.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/5cf991d40fd5681e.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"5cf991d40fd5681e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/6062c404ce14a9d1.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"6062c404ce14a9d1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/61e865e896205541.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"61e865e896205541.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/62ab2af515b36b54.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"62ab2af515b36b54.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/633b5face3642b7c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"633b5face3642b7c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/63d531446c748da6.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"63d531446c748da6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/66e88f1227120852.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"66e88f1227120852.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/6848d154f70459a4.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"6848d154f70459a4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/6a9abbd5bcd8ae9b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"6a9abbd5bcd8ae9b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/6cbc855c0e0788ca.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"6cbc855c0e0788ca.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/6e480ad0f8a2f6f8.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"6e480ad0f8a2f6f8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/6e979887453d65b1.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"6e979887453d65b1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/73411fbff77a7f7f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"73411fbff77a7f7f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/744d4a1d9493956f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"744d4a1d9493956f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/751bb2b097bb76bf.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"751bb2b097bb76bf.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/7775353d41d1249a.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"7775353d41d1249a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/785e0001fc28c841.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"785e0001fc28c841.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/7896501557e9646b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"7896501557e9646b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/7977fce67fad7ab2.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"7977fce67fad7ab2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/7d3f472d90225cb6.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"7d3f472d90225cb6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/873b13631b0a2d43.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"873b13631b0a2d43.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/89d7a010bcc96bca.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"89d7a010bcc96bca.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/89edccb8d8efc05c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"89edccb8d8efc05c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/8e5ebabc9106f714.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"8e5ebabc9106f714.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/8f4b4c50b604bbdf.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"8f4b4c50b604bbdf.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/8f64eab0ae66fc3a.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"8f64eab0ae66fc3a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/8f82cb2725fa616e.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"8f82cb2725fa616e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/8ff306dda9496ae3.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"8ff306dda9496ae3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/939dfa4b1fcc1ce4.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"939dfa4b1fcc1ce4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/941e2ac251f1c098.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"941e2ac251f1c098.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/95811662f155207b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"95811662f155207b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/95b0d3bf93fe30ff.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"95b0d3bf93fe30ff.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/96ac1f339e1a918c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"96ac1f339e1a918c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/973098e8bf92ca7d.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"973098e8bf92ca7d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/99c342e6c648a626.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"99c342e6c648a626.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/9aecf98177c7cca2.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"9aecf98177c7cca2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/9b3ba694564ec5f0.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"9b3ba694564ec5f0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/9e2505199e03c37c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"9e2505199e03c37c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/9f4a8ebbc574434d.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"9f4a8ebbc574434d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/a182ce0049370fe2.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"a182ce0049370fe2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/a20500ba11982b27.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"a20500ba11982b27.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/a2709486cef98dd9.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"a2709486cef98dd9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/a5e44268d9368b5e.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"a5e44268d9368b5e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/a73157c0e03e0bef.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"a73157c0e03e0bef.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/a88904ba22eff8e8.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"a88904ba22eff8e8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/abfe4002d809a330.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"abfe4002d809a330.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/ad32819d93b8330c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"ad32819d93b8330c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/ae6370a150336ea8.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"ae6370a150336ea8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/af16537d53144f5b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"af16537d53144f5b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/aff21e7004340e15.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"aff21e7004340e15.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b121ca70c26deb9b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b121ca70c26deb9b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b169f5c72441e23a.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b169f5c72441e23a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b1969927bd8996fc.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b1969927bd8996fc.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b1e83ae7831df206.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b1e83ae7831df206.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b39860a01ad48dc3.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b39860a01ad48dc3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b4b3d6a322cdc35d.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b4b3d6a322cdc35d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b54c525c75ddad2c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b54c525c75ddad2c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/b9575e72d62e7474.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"b9575e72d62e7474.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/ba5c85b09c522978.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"ba5c85b09c522978.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/bd5f4888a2ae5a64.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"bd5f4888a2ae5a64.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/c1e7b073aa72b3c1.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"c1e7b073aa72b3c1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/c3138d78572d2472.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"c3138d78572d2472.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/c34e5c68c50e2534.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"c34e5c68c50e2534.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/c48ab6841594e0ac.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"c48ab6841594e0ac.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/c4c9fe68e495067a.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"c4c9fe68e495067a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/c50e8879ac7789e9.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"c50e8879ac7789e9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/cbedaa2848096de4.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"cbedaa2848096de4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/cdbf09ff9e323ccf.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"cdbf09ff9e323ccf.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d0e16aa7a3eecca7.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d0e16aa7a3eecca7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d4c4710cfbbb1b48.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d4c4710cfbbb1b48.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d52ef53e746bc4cb.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d52ef53e746bc4cb.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d547095ccdfa9a70.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d547095ccdfa9a70.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d6e56c27934793e5.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d6e56c27934793e5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d805875fea4f71d5.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d805875fea4f71d5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d84386cd9bcedc8f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d84386cd9bcedc8f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/d9fd15b03ad56209.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"d9fd15b03ad56209.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e0099648baa42e6f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e0099648baa42e6f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e01e25032e3cd3a8.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e01e25032e3cd3a8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e0b95334d12d044f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e0b95334d12d044f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e0b981f651d23679.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e0b981f651d23679.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e0bb2f4c6b455757.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e0bb2f4c6b455757.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e53df4dd51341905.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e53df4dd51341905.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e5aa907519fce1c0.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e5aa907519fce1c0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e620aae6ab7c8e13.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e620aae6ab7c8e13.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e649a7b010a24b60.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e649a7b010a24b60.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e696685082cabdab.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e696685082cabdab.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e6eaabb5e0327380.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e6eaabb5e0327380.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/e83ee1ff8a839a1c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"e83ee1ff8a839a1c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/eb9fae41092bd441.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"eb9fae41092bd441.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f10b4296db3e0a05.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f10b4296db3e0a05.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f410bb787d1fb33f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f410bb787d1fb33f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f4526c5a2570e5b2.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f4526c5a2570e5b2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f48bf0716013ac11.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f48bf0716013ac11.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f48dc945f00e213f.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f48dc945f00e213f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f9120d53fb7c396b.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f9120d53fb7c396b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/f92ff5e1e860a45c.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"f92ff5e1e860a45c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/fb218f399632a938.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"fb218f399632a938.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/fb85018c73538669.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"fb85018c73538669.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091601/fba20274fc7b6174.jpg","post":"cj8k2a24r0000zizpavcpsk1z","slug":"fba20274fc7b6174.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/031b589e22e15416.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"031b589e22e15416.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/06132485ab59545a.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"06132485ab59545a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/06c092ba2bbcc190.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"06c092ba2bbcc190.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/07d3ef73b5c3f8ce.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"07d3ef73b5c3f8ce.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/0afa78fbca1dc288.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"0afa78fbca1dc288.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/0c837e38c20eba10.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"0c837e38c20eba10.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/0cfc23cd25d88711.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"0cfc23cd25d88711.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/0e655e34fd585501.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"0e655e34fd585501.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/0feee6754fbdf152.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"0feee6754fbdf152.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/1508a77d6a8ea1c8.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"1508a77d6a8ea1c8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/1673c7249c05f467.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"1673c7249c05f467.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/180a716339eaac7d.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"180a716339eaac7d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/1a594160a1ba91e0.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"1a594160a1ba91e0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/1cda4b829db27966.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"1cda4b829db27966.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/1d6b5e876b43563e.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"1d6b5e876b43563e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/21eef25b932cef4f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"21eef25b932cef4f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/2324f721115c3785.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"2324f721115c3785.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/2354389b190af5b4.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"2354389b190af5b4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/266f5cf2a5c7db28.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"266f5cf2a5c7db28.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/2a5be182dfce2f21.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"2a5be182dfce2f21.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/2d6ca36262af1fb1.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"2d6ca36262af1fb1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/2d95d2595ef8cf3b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"2d95d2595ef8cf3b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/2f56d5f920ff1ade.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"2f56d5f920ff1ade.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/32e3eb023f6ee3ba.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"32e3eb023f6ee3ba.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/339c821002d465d5.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"339c821002d465d5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/37bfc853a59b3cea.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"37bfc853a59b3cea.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/3d6c3c2b7962e631.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"3d6c3c2b7962e631.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/42997c9404fbb3c5.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"42997c9404fbb3c5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/42d722931576c18a.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"42d722931576c18a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/48071838f3615424.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"48071838f3615424.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/4812df9dc90e7725.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"4812df9dc90e7725.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/4c9a2f038cdaeb71.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"4c9a2f038cdaeb71.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/50b60481426d3afd.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"50b60481426d3afd.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/528dcf36c7d52e6e.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"528dcf36c7d52e6e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/545eaec054fd5218.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"545eaec054fd5218.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/551b7ab676551748.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"551b7ab676551748.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/566bae7cacf04cc7.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"566bae7cacf04cc7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/5691d99da449aeb2.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"5691d99da449aeb2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/5a74c07b6f07c6d7.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"5a74c07b6f07c6d7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/5ae453ac46cb1abd.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"5ae453ac46cb1abd.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/5b4ae1ddf38c5bac.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"5b4ae1ddf38c5bac.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/5cf991d40fd5681e.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"5cf991d40fd5681e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/6062c404ce14a9d1.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"6062c404ce14a9d1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/61e865e896205541.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"61e865e896205541.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/62ab2af515b36b54.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"62ab2af515b36b54.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/633b5face3642b7c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"633b5face3642b7c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/63d531446c748da6.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"63d531446c748da6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/66e88f1227120852.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"66e88f1227120852.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/6848d154f70459a4.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"6848d154f70459a4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/6a9abbd5bcd8ae9b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"6a9abbd5bcd8ae9b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/6cbc855c0e0788ca.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"6cbc855c0e0788ca.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/6e480ad0f8a2f6f8.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"6e480ad0f8a2f6f8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/6e979887453d65b1.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"6e979887453d65b1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/73411fbff77a7f7f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"73411fbff77a7f7f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/744d4a1d9493956f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"744d4a1d9493956f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/751bb2b097bb76bf.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"751bb2b097bb76bf.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/7775353d41d1249a.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"7775353d41d1249a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/785e0001fc28c841.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"785e0001fc28c841.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/7896501557e9646b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"7896501557e9646b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/7977fce67fad7ab2.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"7977fce67fad7ab2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/7d3f472d90225cb6.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"7d3f472d90225cb6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/873b13631b0a2d43.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"873b13631b0a2d43.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/89d7a010bcc96bca.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"89d7a010bcc96bca.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/89edccb8d8efc05c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"89edccb8d8efc05c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/8e5ebabc9106f714.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"8e5ebabc9106f714.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/8f4b4c50b604bbdf.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"8f4b4c50b604bbdf.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/8f64eab0ae66fc3a.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"8f64eab0ae66fc3a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/8f82cb2725fa616e.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"8f82cb2725fa616e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/8ff306dda9496ae3.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"8ff306dda9496ae3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/939dfa4b1fcc1ce4.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"939dfa4b1fcc1ce4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/941e2ac251f1c098.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"941e2ac251f1c098.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/95811662f155207b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"95811662f155207b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/95b0d3bf93fe30ff.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"95b0d3bf93fe30ff.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/96ac1f339e1a918c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"96ac1f339e1a918c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/973098e8bf92ca7d.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"973098e8bf92ca7d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/99c342e6c648a626.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"99c342e6c648a626.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/9aecf98177c7cca2.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"9aecf98177c7cca2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/9b3ba694564ec5f0.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"9b3ba694564ec5f0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/9e2505199e03c37c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"9e2505199e03c37c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/9f4a8ebbc574434d.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"9f4a8ebbc574434d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/a182ce0049370fe2.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"a182ce0049370fe2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/a20500ba11982b27.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"a20500ba11982b27.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/a2709486cef98dd9.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"a2709486cef98dd9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/a5e44268d9368b5e.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"a5e44268d9368b5e.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/a73157c0e03e0bef.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"a73157c0e03e0bef.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/a88904ba22eff8e8.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"a88904ba22eff8e8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/abfe4002d809a330.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"abfe4002d809a330.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/ad32819d93b8330c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"ad32819d93b8330c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/ae6370a150336ea8.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"ae6370a150336ea8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/af16537d53144f5b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"af16537d53144f5b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/aff21e7004340e15.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"aff21e7004340e15.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b121ca70c26deb9b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b121ca70c26deb9b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b169f5c72441e23a.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b169f5c72441e23a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b1969927bd8996fc.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b1969927bd8996fc.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b1e83ae7831df206.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b1e83ae7831df206.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b39860a01ad48dc3.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b39860a01ad48dc3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b4b3d6a322cdc35d.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b4b3d6a322cdc35d.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b54c525c75ddad2c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b54c525c75ddad2c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/b9575e72d62e7474.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"b9575e72d62e7474.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/ba5c85b09c522978.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"ba5c85b09c522978.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/bd5f4888a2ae5a64.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"bd5f4888a2ae5a64.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/c1e7b073aa72b3c1.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"c1e7b073aa72b3c1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/c3138d78572d2472.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"c3138d78572d2472.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/c34e5c68c50e2534.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"c34e5c68c50e2534.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/c48ab6841594e0ac.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"c48ab6841594e0ac.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/c4c9fe68e495067a.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"c4c9fe68e495067a.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/c50e8879ac7789e9.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"c50e8879ac7789e9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/cbedaa2848096de4.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"cbedaa2848096de4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/cdbf09ff9e323ccf.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"cdbf09ff9e323ccf.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d0e16aa7a3eecca7.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d0e16aa7a3eecca7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d4c4710cfbbb1b48.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d4c4710cfbbb1b48.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d52ef53e746bc4cb.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d52ef53e746bc4cb.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d547095ccdfa9a70.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d547095ccdfa9a70.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d6e56c27934793e5.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d6e56c27934793e5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d805875fea4f71d5.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d805875fea4f71d5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d84386cd9bcedc8f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d84386cd9bcedc8f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/d9fd15b03ad56209.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"d9fd15b03ad56209.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e0099648baa42e6f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e0099648baa42e6f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e01e25032e3cd3a8.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e01e25032e3cd3a8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e0b95334d12d044f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e0b95334d12d044f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e0b981f651d23679.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e0b981f651d23679.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e0bb2f4c6b455757.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e0bb2f4c6b455757.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e53df4dd51341905.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e53df4dd51341905.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e5aa907519fce1c0.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e5aa907519fce1c0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e620aae6ab7c8e13.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e620aae6ab7c8e13.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e649a7b010a24b60.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e649a7b010a24b60.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e696685082cabdab.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e696685082cabdab.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e6eaabb5e0327380.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e6eaabb5e0327380.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/e83ee1ff8a839a1c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"e83ee1ff8a839a1c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/eb9fae41092bd441.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"eb9fae41092bd441.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f10b4296db3e0a05.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f10b4296db3e0a05.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f410bb787d1fb33f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f410bb787d1fb33f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f4526c5a2570e5b2.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f4526c5a2570e5b2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f48bf0716013ac11.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f48bf0716013ac11.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f48dc945f00e213f.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f48dc945f00e213f.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f9120d53fb7c396b.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f9120d53fb7c396b.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/f92ff5e1e860a45c.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"f92ff5e1e860a45c.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/fb218f399632a938.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"fb218f399632a938.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/fb85018c73538669.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"fb85018c73538669.jpg","modified":1,"renderable":1},{"_id":"source/_posts/201710091643/fba20274fc7b6174.jpg","post":"cj8k2a24w0001zizpmwxpmio4","slug":"fba20274fc7b6174.jpg","modified":1,"renderable":1}],"PostCategory":[],"PostTag":[{"post_id":"cj8k2a24r0000zizpavcpsk1z","tag_id":"cj8k2a24z0002zizpryamv0j7","_id":"cj8k2a25c0007zizpbernuedd"},{"post_id":"cj8k2a24w0001zizpmwxpmio4","tag_id":"cj8k2a24z0002zizpryamv0j7","_id":"cj8k2a25v000fzizpyqpgedcy"},{"post_id":"cj8k2a24w0001zizpmwxpmio4","tag_id":"cj8k2a25j000azizp8m5qfh9d","_id":"cj8k2a25y000hzizpk3h6r99y"},{"post_id":"cj8k2a2500003zizp2431a05b","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26f000nzizpkqvhaeit"},{"post_id":"cj8k2a2500003zizp2431a05b","tag_id":"cj8k2a260000izizpel2swh2e","_id":"cj8k2a26g000ozizpjmq4tldn"},{"post_id":"cj8k2a26c000mzizpja4q2k33","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26h000qzizprncafkrd"},{"post_id":"cj8k2a26c000mzizpja4q2k33","tag_id":"cj8k2a260000izizpel2swh2e","_id":"cj8k2a26h000rzizpo4u9gu6h"},{"post_id":"cj8k2a2530004zizpbersf4t5","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26i000tzizpk4oy018q"},{"post_id":"cj8k2a2530004zizpbersf4t5","tag_id":"cj8k2a260000izizpel2swh2e","_id":"cj8k2a26i000uzizplcpf7wjf"},{"post_id":"cj8k2a2570005zizpideapban","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26k000xzizpuhc4mxqx"},{"post_id":"cj8k2a2570005zizpideapban","tag_id":"cj8k2a260000izizpel2swh2e","_id":"cj8k2a26k000yzizp54rayasr"},{"post_id":"cj8k2a25c0008zizpoh0frzq7","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26m0012zizpgg6zdgnd"},{"post_id":"cj8k2a25c0008zizpoh0frzq7","tag_id":"cj8k2a26l000zzizprh2vur5q","_id":"cj8k2a26m0013zizpupoc3oal"},{"post_id":"cj8k2a25c0008zizpoh0frzq7","tag_id":"cj8k2a26l0010zizpbzggxj6z","_id":"cj8k2a26n0015zizpjhuxo774"},{"post_id":"cj8k2a25i0009zizpa4snopvh","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26o0017zizpo1ynixyb"},{"post_id":"cj8k2a25i0009zizpa4snopvh","tag_id":"cj8k2a26l000zzizprh2vur5q","_id":"cj8k2a26o0018zizppm2pf2e6"},{"post_id":"cj8k2a25n000bzizpzi3jj641","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26p001bzizp28lqh6f9"},{"post_id":"cj8k2a25n000bzizpzi3jj641","tag_id":"cj8k2a26l000zzizprh2vur5q","_id":"cj8k2a26q001czizpkgjo376z"},{"post_id":"cj8k2a25r000czizpi60b5ib8","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26r001fzizpeyq831fr"},{"post_id":"cj8k2a25r000czizpi60b5ib8","tag_id":"cj8k2a26l000zzizprh2vur5q","_id":"cj8k2a26r001gzizpifmr0zo0"},{"post_id":"cj8k2a25v000ezizpo6aiv5zf","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26r001izizpge0hmcyt"},{"post_id":"cj8k2a25v000ezizpo6aiv5zf","tag_id":"cj8k2a26l000zzizprh2vur5q","_id":"cj8k2a26s001jzizpst63j29f"},{"post_id":"cj8k2a25y000gzizp3s4g3ix9","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26s001lzizpju7hsom1"},{"post_id":"cj8k2a25y000gzizp3s4g3ix9","tag_id":"cj8k2a26r001hzizplhno90ui","_id":"cj8k2a26s001mzizpqo9yzxya"},{"post_id":"cj8k2a261000jzizpwf3fw5ic","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26t001ozizp96smvhqd"},{"post_id":"cj8k2a261000jzizpwf3fw5ic","tag_id":"cj8k2a26r001hzizplhno90ui","_id":"cj8k2a26t001pzizpk8naif1t"},{"post_id":"cj8k2a264000kzizptgi918ap","tag_id":"cj8k2a25s000dzizp8crfcz2z","_id":"cj8k2a26t001qzizpe5x3nb6b"},{"post_id":"cj8k2a264000kzizptgi918ap","tag_id":"cj8k2a26r001hzizplhno90ui","_id":"cj8k2a26t001rzizp926dmooe"}],"Tag":[{"name":"virtualization","_id":"cj8k2a24z0002zizpryamv0j7"},{"name":"ESXi","_id":"cj8k2a25j000azizp8m5qfh9d"},{"name":"linux","_id":"cj8k2a25s000dzizp8crfcz2z"},{"name":"other","_id":"cj8k2a260000izizpel2swh2e"},{"name":"network","_id":"cj8k2a26l000zzizprh2vur5q"},{"name":"gfw","_id":"cj8k2a26l0010zizpbzggxj6z"},{"name":"tools","_id":"cj8k2a26r001hzizplhno90ui"}]}}